var Eh=Object.defineProperty;var Ah=(t,e,n)=>e in t?Eh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var it=(t,e,n)=>(Ah(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function Ki(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ka(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function zu(t){let e,n,i;t.length!==2?(e=Ki,n=(c,f)=>Ki(t(c),f),i=(c,f)=>t(c)-f):(e=t===Ki||t===ka?t:Mh,n=t,i=t);function r(c,f,u=0,d=c.length){if(u<d){if(e(f,f)!==0)return d;do{const p=u+d>>>1;n(c[p],f)<0?u=p+1:d=p}while(u<d)}return u}function a(c,f,u=0,d=c.length){if(u<d){if(e(f,f)!==0)return d;do{const p=u+d>>>1;n(c[p],f)<=0?u=p+1:d=p}while(u<d)}return u}function s(c,f,u=0,d=c.length){const p=r(c,f,u,d-1);return p>u&&i(c[p-1],f)>-i(c[p],f)?p-1:p}return{left:r,center:s,right:a}}function Mh(){return 0}function Th(t){return t===null?NaN:+t}const Lh=zu(Ki),kh=Lh.right;zu(Th).center;const Nh=kh;function Ih(t,e){let n,i;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let a of t)(a=e(a,++r,t))!=null&&(n===void 0?a>=a&&(n=i=a):(n>a&&(n=a),i<a&&(i=a)))}return[n,i]}class ke{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const a=n[r],s=e+a,c=Math.abs(e)<Math.abs(a)?e-(s-a):a-(s-e);c&&(n[i++]=c),e=s}return n[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let n=this._n,i,r,a,s=0;if(n>0){for(s=e[--n];n>0&&(i=s,r=e[--n],s=i+r,a=r-(s-i),!a););n>0&&(a<0&&e[n-1]<0||a>0&&e[n-1]>0)&&(r=a*2,i=s+r,r==i-s&&(s=i))}return s}}class dl extends Map{constructor(e,n=Bu){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,r]of e)this.set(i,r)}get(e){return super.get(Qo(this,e))}has(e){return super.has(Qo(this,e))}set(e,n){return super.set($u(this,e),n)}delete(e){return super.delete(Fu(this,e))}}class Ch extends Set{constructor(e,n=Bu){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const i of e)this.add(i)}has(e){return super.has(Qo(this,e))}add(e){return super.add($u(this,e))}delete(e){return super.delete(Fu(this,e))}}function Qo({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function $u({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function Fu({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function Bu(t){return t!==null&&typeof t=="object"?t.valueOf():t}const Dh=Math.sqrt(50),Ph=Math.sqrt(10),Oh=Math.sqrt(2);function ir(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),a=i/Math.pow(10,r),s=a>=Dh?10:a>=Ph?5:a>=Oh?2:1;let c,f,u;return r<0?(u=Math.pow(10,-r)/s,c=Math.round(t*u),f=Math.round(e*u),c/u<t&&++c,f/u>e&&--f,u=-u):(u=Math.pow(10,r)*s,c=Math.round(t/u),f=Math.round(e/u),c*u<t&&++c,f*u>e&&--f),f<c&&.5<=n&&n<2?ir(t,e,n*2):[c,f,u]}function Rh(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,a,s]=i?ir(e,t,n):ir(t,e,n);if(!(a>=r))return[];const c=a-r+1,f=new Array(c);if(i)if(s<0)for(let u=0;u<c;++u)f[u]=(a-u)/-s;else for(let u=0;u<c;++u)f[u]=(a-u)*s;else if(s<0)for(let u=0;u<c;++u)f[u]=(r+u)/-s;else for(let u=0;u<c;++u)f[u]=(r+u)*s;return f}function ta(t,e,n){return e=+e,t=+t,n=+n,ir(t,e,n)[2]}function zh(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?ta(e,t,n):ta(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function Na(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function $h(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function*Fh(t){for(const e of t)yield*e}function Hu(t){return Array.from(Fh(t))}function Bh(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}function ae(t,e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof e!="function")throw new TypeError("mapper is not a function");return Array.from(t,(n,i)=>e(n,i,t))}function Hh(...t){const e=new Ch;for(const n of t)for(const i of n)e.add(i);return e}function qh(t){return t}var Co=1,Do=2,ea=3,Rn=4,hl=1e-6;function Vh(t){return"translate("+t+",0)"}function jh(t){return"translate(0,"+t+")"}function Wh(t){return e=>+t(e)}function Uh(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Gh(){return!this.__axis}function qu(t,e){var n=[],i=null,r=null,a=6,s=6,c=3,f=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===Co||t===Rn?-1:1,d=t===Rn||t===Do?"x":"y",p=t===Co||t===ea?Vh:jh;function g(m){var v=i??(e.ticks?e.ticks.apply(e,n):e.domain()),A=r??(e.tickFormat?e.tickFormat.apply(e,n):qh),S=Math.max(a,0)+c,w=e.range(),k=+w[0]+f,I=+w[w.length-1]+f,b=(e.bandwidth?Uh:Wh)(e.copy(),f),C=m.selection?m.selection():m,$=C.selectAll(".domain").data([null]),F=C.selectAll(".tick").data(v,e).order(),B=F.exit(),U=F.enter().append("g").attr("class","tick"),G=F.select("line"),O=F.select("text");$=$.merge($.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),F=F.merge(U),G=G.merge(U.append("line").attr("stroke","currentColor").attr(d+"2",u*a)),O=O.merge(U.append("text").attr("fill","currentColor").attr(d,u*S).attr("dy",t===Co?"0em":t===ea?"0.71em":"0.32em")),m!==C&&($=$.transition(m),F=F.transition(m),G=G.transition(m),O=O.transition(m),B=B.transition(m).attr("opacity",hl).attr("transform",function(q){return isFinite(q=b(q))?p(q+f):this.getAttribute("transform")}),U.attr("opacity",hl).attr("transform",function(q){var W=this.parentNode.__axis;return p((W&&isFinite(W=W(q))?W:b(q))+f)})),B.remove(),$.attr("d",t===Rn||t===Do?s?"M"+u*s+","+k+"H"+f+"V"+I+"H"+u*s:"M"+f+","+k+"V"+I:s?"M"+k+","+u*s+"V"+f+"H"+I+"V"+u*s:"M"+k+","+f+"H"+I),F.attr("opacity",1).attr("transform",function(q){return p(b(q)+f)}),G.attr(d+"2",u*a),O.attr(d,u*S).text(A),C.filter(Gh).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Do?"start":t===Rn?"end":"middle"),C.each(function(){this.__axis=b})}return g.scale=function(m){return arguments.length?(e=m,g):e},g.ticks=function(){return n=Array.from(arguments),g},g.tickArguments=function(m){return arguments.length?(n=m==null?[]:Array.from(m),g):n.slice()},g.tickValues=function(m){return arguments.length?(i=m==null?null:Array.from(m),g):i&&i.slice()},g.tickFormat=function(m){return arguments.length?(r=m,g):r},g.tickSize=function(m){return arguments.length?(a=s=+m,g):a},g.tickSizeInner=function(m){return arguments.length?(a=+m,g):a},g.tickSizeOuter=function(m){return arguments.length?(s=+m,g):s},g.tickPadding=function(m){return arguments.length?(c=+m,g):c},g.offset=function(m){return arguments.length?(f=+m,g):f},g}function Ne(t){return qu(ea,t)}function Un(t){return qu(Rn,t)}var Yh={value:()=>{}};function ti(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Zi(n)}function Zi(t){this._=t}function Xh(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Zi.prototype=ti.prototype={constructor:Zi,on:function(t,e){var n=this._,i=Xh(t+"",n),r,a=-1,s=i.length;if(arguments.length<2){for(;++a<s;)if((r=(t=i[a]).type)&&(r=Kh(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=i[a]).type)n[r]=pl(n[r],t.name,e);else if(e==null)for(r in n)n[r]=pl(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Zi(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,a;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],i=0,r=a.length;i<r;++i)a[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};function Kh(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function pl(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Yh,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var na="http://www.w3.org/1999/xhtml";const gl={svg:"http://www.w3.org/2000/svg",xhtml:na,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mr(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),gl.hasOwnProperty(e)?{space:gl[e],local:t}:t}function Zh(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===na&&e.documentElement.namespaceURI===na?e.createElement(t):e.createElementNS(n,t)}}function Jh(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Vu(t){var e=Mr(t);return(e.local?Jh:Zh)(e)}function Qh(){}function Ia(t){return t==null?Qh:function(){return this.querySelector(t)}}function tp(t){typeof t!="function"&&(t=Ia(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,c=i[r]=new Array(s),f,u,d=0;d<s;++d)(f=a[d])&&(u=t.call(f,f.__data__,d,a))&&("__data__"in f&&(u.__data__=f.__data__),c[d]=u);return new Lt(i,this._parents)}function ju(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ep(){return[]}function Wu(t){return t==null?ep:function(){return this.querySelectorAll(t)}}function np(t){return function(){return ju(t.apply(this,arguments))}}function ip(t){typeof t=="function"?t=np(t):t=Wu(t);for(var e=this._groups,n=e.length,i=[],r=[],a=0;a<n;++a)for(var s=e[a],c=s.length,f,u=0;u<c;++u)(f=s[u])&&(i.push(t.call(f,f.__data__,u,s)),r.push(f));return new Lt(i,r)}function Uu(t){return function(){return this.matches(t)}}function Gu(t){return function(e){return e.matches(t)}}var rp=Array.prototype.find;function op(t){return function(){return rp.call(this.children,t)}}function ap(){return this.firstElementChild}function sp(t){return this.select(t==null?ap:op(typeof t=="function"?t:Gu(t)))}var lp=Array.prototype.filter;function up(){return Array.from(this.children)}function cp(t){return function(){return lp.call(this.children,t)}}function fp(t){return this.selectAll(t==null?up:cp(typeof t=="function"?t:Gu(t)))}function dp(t){typeof t!="function"&&(t=Uu(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,c=i[r]=[],f,u=0;u<s;++u)(f=a[u])&&t.call(f,f.__data__,u,a)&&c.push(f);return new Lt(i,this._parents)}function Yu(t){return new Array(t.length)}function hp(){return new Lt(this._enter||this._groups.map(Yu),this._parents)}function rr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}rr.prototype={constructor:rr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function pp(t){return function(){return t}}function gp(t,e,n,i,r,a){for(var s=0,c,f=e.length,u=a.length;s<u;++s)(c=e[s])?(c.__data__=a[s],i[s]=c):n[s]=new rr(t,a[s]);for(;s<f;++s)(c=e[s])&&(r[s]=c)}function vp(t,e,n,i,r,a,s){var c,f,u=new Map,d=e.length,p=a.length,g=new Array(d),m;for(c=0;c<d;++c)(f=e[c])&&(g[c]=m=s.call(f,f.__data__,c,e)+"",u.has(m)?r[c]=f:u.set(m,f));for(c=0;c<p;++c)m=s.call(t,a[c],c,a)+"",(f=u.get(m))?(i[c]=f,f.__data__=a[c],u.delete(m)):n[c]=new rr(t,a[c]);for(c=0;c<d;++c)(f=e[c])&&u.get(g[c])===f&&(r[c]=f)}function mp(t){return t.__data__}function yp(t,e){if(!arguments.length)return Array.from(this,mp);var n=e?vp:gp,i=this._parents,r=this._groups;typeof t!="function"&&(t=pp(t));for(var a=r.length,s=new Array(a),c=new Array(a),f=new Array(a),u=0;u<a;++u){var d=i[u],p=r[u],g=p.length,m=_p(t.call(d,d&&d.__data__,u,i)),v=m.length,A=c[u]=new Array(v),S=s[u]=new Array(v),w=f[u]=new Array(g);n(d,p,A,S,w,m,e);for(var k=0,I=0,b,C;k<v;++k)if(b=A[k]){for(k>=I&&(I=k+1);!(C=S[I])&&++I<v;);b._next=C||null}}return s=new Lt(s,i),s._enter=c,s._exit=f,s}function _p(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xp(){return new Lt(this._exit||this._groups.map(Yu),this._parents)}function Sp(t,e,n){var i=this.enter(),r=this,a=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?a.remove():n(a),i&&r?i.merge(r).order():r}function wp(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,a=i.length,s=Math.min(r,a),c=new Array(r),f=0;f<s;++f)for(var u=n[f],d=i[f],p=u.length,g=c[f]=new Array(p),m,v=0;v<p;++v)(m=u[v]||d[v])&&(g[v]=m);for(;f<r;++f)c[f]=n[f];return new Lt(c,this._parents)}function bp(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,a=i[r],s;--r>=0;)(s=i[r])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Ep(t){t||(t=Ap);function e(p,g){return p&&g?t(p.__data__,g.__data__):!p-!g}for(var n=this._groups,i=n.length,r=new Array(i),a=0;a<i;++a){for(var s=n[a],c=s.length,f=r[a]=new Array(c),u,d=0;d<c;++d)(u=s[d])&&(f[d]=u);f.sort(e)}return new Lt(r,this._parents).order()}function Ap(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Mp(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Tp(){return Array.from(this)}function Lp(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var s=i[r];if(s)return s}return null}function kp(){let t=0;for(const e of this)++t;return t}function Np(){return!this.node()}function Ip(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],a=0,s=r.length,c;a<s;++a)(c=r[a])&&t.call(c,c.__data__,a,r);return this}function Cp(t){return function(){this.removeAttribute(t)}}function Dp(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pp(t,e){return function(){this.setAttribute(t,e)}}function Op(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Rp(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function zp(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function $p(t,e){var n=Mr(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?Dp:Cp:typeof e=="function"?n.local?zp:Rp:n.local?Op:Pp)(n,e))}function Xu(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Fp(t){return function(){this.style.removeProperty(t)}}function Bp(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Hp(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function qp(t,e,n){return arguments.length>1?this.each((e==null?Fp:typeof e=="function"?Hp:Bp)(t,e,n??"")):an(this.node(),t)}function an(t,e){return t.style.getPropertyValue(e)||Xu(t).getComputedStyle(t,null).getPropertyValue(e)}function Vp(t){return function(){delete this[t]}}function jp(t,e){return function(){this[t]=e}}function Wp(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Up(t,e){return arguments.length>1?this.each((e==null?Vp:typeof e=="function"?Wp:jp)(t,e)):this.node()[t]}function Ku(t){return t.trim().split(/^|\s+/)}function Ca(t){return t.classList||new Zu(t)}function Zu(t){this._node=t,this._names=Ku(t.getAttribute("class")||"")}Zu.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ju(t,e){for(var n=Ca(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Qu(t,e){for(var n=Ca(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Gp(t){return function(){Ju(this,t)}}function Yp(t){return function(){Qu(this,t)}}function Xp(t,e){return function(){(e.apply(this,arguments)?Ju:Qu)(this,t)}}function Kp(t,e){var n=Ku(t+"");if(arguments.length<2){for(var i=Ca(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Xp:e?Gp:Yp)(n,e))}function Zp(){this.textContent=""}function Jp(t){return function(){this.textContent=t}}function Qp(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function tg(t){return arguments.length?this.each(t==null?Zp:(typeof t=="function"?Qp:Jp)(t)):this.node().textContent}function eg(){this.innerHTML=""}function ng(t){return function(){this.innerHTML=t}}function ig(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function rg(t){return arguments.length?this.each(t==null?eg:(typeof t=="function"?ig:ng)(t)):this.node().innerHTML}function og(){this.nextSibling&&this.parentNode.appendChild(this)}function ag(){return this.each(og)}function sg(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lg(){return this.each(sg)}function ug(t){var e=typeof t=="function"?t:Vu(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function cg(){return null}function fg(t,e){var n=typeof t=="function"?t:Vu(t),i=e==null?cg:typeof e=="function"?e:Ia(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function dg(){var t=this.parentNode;t&&t.removeChild(this)}function hg(){return this.each(dg)}function pg(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function gg(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vg(t){return this.select(t?gg:pg)}function mg(t){return arguments.length?this.property("__data__",t):this.node().__data__}function yg(t){return function(e){t.call(this,e,this.__data__)}}function _g(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function xg(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,a;n<r;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++i]=a;++i?e.length=i:delete this.__on}}}function Sg(t,e,n){return function(){var i=this.__on,r,a=yg(e);if(i){for(var s=0,c=i.length;s<c;++s)if((r=i[s]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),r.value=e;return}}this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function wg(t,e,n){var i=_g(t+""),r,a=i.length,s;if(arguments.length<2){var c=this.node().__on;if(c){for(var f=0,u=c.length,d;f<u;++f)for(r=0,d=c[f];r<a;++r)if((s=i[r]).type===d.type&&s.name===d.name)return d.value}return}for(c=e?Sg:xg,r=0;r<a;++r)this.each(c(i[r],e,n));return this}function tc(t,e,n){var i=Xu(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function bg(t,e){return function(){return tc(this,t,e)}}function Eg(t,e){return function(){return tc(this,t,e.apply(this,arguments))}}function Ag(t,e){return this.each((typeof e=="function"?Eg:bg)(t,e))}function*Mg(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length,s;r<a;++r)(s=i[r])&&(yield s)}var Da=[null];function Lt(t,e){this._groups=t,this._parents=e}function ei(){return new Lt([[document.documentElement]],Da)}function Tg(){return this}Lt.prototype=ei.prototype={constructor:Lt,select:tp,selectAll:ip,selectChild:sp,selectChildren:fp,filter:dp,data:yp,enter:hp,exit:xp,join:Sp,merge:wp,selection:Tg,order:bp,sort:Ep,call:Mp,nodes:Tp,node:Lp,size:kp,empty:Np,each:Ip,attr:$p,style:qp,property:Up,classed:Kp,text:tg,html:rg,raise:ag,lower:lg,append:ug,insert:fg,remove:hg,clone:vg,datum:mg,on:wg,dispatch:Ag,[Symbol.iterator]:Mg};function Q(t){return typeof t=="string"?new Lt([[document.querySelector(t)]],[document.documentElement]):new Lt([[t]],Da)}function Lg(t){let e;for(;e=t.sourceEvent;)t=e;return t}function le(t,e){if(t=Lg(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}function Ci(t){return typeof t=="string"?new Lt([document.querySelectorAll(t)],[document.documentElement]):new Lt([ju(t)],Da)}const kg={passive:!1},Gn={capture:!0,passive:!1};function Po(t){t.stopImmediatePropagation()}function en(t){t.preventDefault(),t.stopImmediatePropagation()}function ec(t){var e=t.document.documentElement,n=Q(t).on("dragstart.drag",en,Gn);"onselectstart"in e?n.on("selectstart.drag",en,Gn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function nc(t,e){var n=t.document.documentElement,i=Q(t).on("dragstart.drag",null);e&&(i.on("click.drag",en,Gn),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Di=t=>()=>t;function ia(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:a,x:s,y:c,dx:f,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}ia.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Ng(t){return!t.ctrlKey&&!t.button}function Ig(){return this.parentNode}function Cg(t,e){return e??{x:t.x,y:t.y}}function Dg(){return navigator.maxTouchPoints||"ontouchstart"in this}function Pg(){var t=Ng,e=Ig,n=Cg,i=Dg,r={},a=ti("start","drag","end"),s=0,c,f,u,d,p=0;function g(b){b.on("mousedown.drag",m).filter(i).on("touchstart.drag",S).on("touchmove.drag",w,kg).on("touchend.drag touchcancel.drag",k).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(b,C){if(!(d||!t.call(this,b,C))){var $=I(this,e.call(this,b,C),b,C,"mouse");$&&(Q(b.view).on("mousemove.drag",v,Gn).on("mouseup.drag",A,Gn),ec(b.view),Po(b),u=!1,c=b.clientX,f=b.clientY,$("start",b))}}function v(b){if(en(b),!u){var C=b.clientX-c,$=b.clientY-f;u=C*C+$*$>p}r.mouse("drag",b)}function A(b){Q(b.view).on("mousemove.drag mouseup.drag",null),nc(b.view,u),en(b),r.mouse("end",b)}function S(b,C){if(t.call(this,b,C)){var $=b.changedTouches,F=e.call(this,b,C),B=$.length,U,G;for(U=0;U<B;++U)(G=I(this,F,b,C,$[U].identifier,$[U]))&&(Po(b),G("start",b,$[U]))}}function w(b){var C=b.changedTouches,$=C.length,F,B;for(F=0;F<$;++F)(B=r[C[F].identifier])&&(en(b),B("drag",b,C[F]))}function k(b){var C=b.changedTouches,$=C.length,F,B;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),F=0;F<$;++F)(B=r[C[F].identifier])&&(Po(b),B("end",b,C[F]))}function I(b,C,$,F,B,U){var G=a.copy(),O=le(U||$,C),q,W,M;if((M=n.call(b,new ia("beforestart",{sourceEvent:$,target:g,identifier:B,active:s,x:O[0],y:O[1],dx:0,dy:0,dispatch:G}),F))!=null)return q=M.x-O[0]||0,W=M.y-O[1]||0,function _(E,N,P){var L=O,H;switch(E){case"start":r[B]=_,H=s++;break;case"end":delete r[B],--s;case"drag":O=le(P||N,C),H=s;break}G.call(E,b,new ia(E,{sourceEvent:N,subject:M,target:g,identifier:B,active:H,x:O[0]+q,y:O[1]+W,dx:O[0]-L[0],dy:O[1]-L[1],dispatch:G}),F)}}return g.filter=function(b){return arguments.length?(t=typeof b=="function"?b:Di(!!b),g):t},g.container=function(b){return arguments.length?(e=typeof b=="function"?b:Di(b),g):e},g.subject=function(b){return arguments.length?(n=typeof b=="function"?b:Di(b),g):n},g.touchable=function(b){return arguments.length?(i=typeof b=="function"?b:Di(!!b),g):i},g.on=function(){var b=a.on.apply(a,arguments);return b===a?g:b},g.clickDistance=function(b){return arguments.length?(p=(b=+b)*b,g):Math.sqrt(p)},g}function ni(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Tr(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Pe(){}var Yn=.7,or=1/Yn,nn="\\s*([+-]?\\d+)\\s*",Xn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",te="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Og=/^#([0-9a-f]{3,8})$/,Rg=new RegExp(`^rgb\\(${nn},${nn},${nn}\\)$`),zg=new RegExp(`^rgb\\(${te},${te},${te}\\)$`),$g=new RegExp(`^rgba\\(${nn},${nn},${nn},${Xn}\\)$`),Fg=new RegExp(`^rgba\\(${te},${te},${te},${Xn}\\)$`),Bg=new RegExp(`^hsl\\(${Xn},${te},${te}\\)$`),Hg=new RegExp(`^hsla\\(${Xn},${te},${te},${Xn}\\)$`),vl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ni(Pe,Ie,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ml,formatHex:ml,formatHex8:qg,formatHsl:Vg,formatRgb:yl,toString:yl});function ml(){return this.rgb().formatHex()}function qg(){return this.rgb().formatHex8()}function Vg(){return rc(this).formatHsl()}function yl(){return this.rgb().formatRgb()}function Ie(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Og.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?_l(e):n===3?new At(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Pi(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Pi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Rg.exec(t))?new At(e[1],e[2],e[3],1):(e=zg.exec(t))?new At(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=$g.exec(t))?Pi(e[1],e[2],e[3],e[4]):(e=Fg.exec(t))?Pi(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Bg.exec(t))?wl(e[1],e[2]/100,e[3]/100,1):(e=Hg.exec(t))?wl(e[1],e[2]/100,e[3]/100,e[4]):vl.hasOwnProperty(t)?_l(vl[t]):t==="transparent"?new At(NaN,NaN,NaN,0):null}function _l(t){return new At(t>>16&255,t>>8&255,t&255,1)}function Pi(t,e,n,i){return i<=0&&(t=e=n=NaN),new At(t,e,n,i)}function ic(t){return t instanceof Pe||(t=Ie(t)),t?(t=t.rgb(),new At(t.r,t.g,t.b,t.opacity)):new At}function ar(t,e,n,i){return arguments.length===1?ic(t):new At(t,e,n,i??1)}function At(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}ni(At,ar,Tr(Pe,{brighter(t){return t=t==null?or:Math.pow(or,t),new At(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Yn:Math.pow(Yn,t),new At(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new At(Me(this.r),Me(this.g),Me(this.b),sr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xl,formatHex:xl,formatHex8:jg,formatRgb:Sl,toString:Sl}));function xl(){return`#${Ae(this.r)}${Ae(this.g)}${Ae(this.b)}`}function jg(){return`#${Ae(this.r)}${Ae(this.g)}${Ae(this.b)}${Ae((isNaN(this.opacity)?1:this.opacity)*255)}`}function Sl(){const t=sr(this.opacity);return`${t===1?"rgb(":"rgba("}${Me(this.r)}, ${Me(this.g)}, ${Me(this.b)}${t===1?")":`, ${t})`}`}function sr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Me(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ae(t){return t=Me(t),(t<16?"0":"")+t.toString(16)}function wl(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new jt(t,e,n,i)}function rc(t){if(t instanceof jt)return new jt(t.h,t.s,t.l,t.opacity);if(t instanceof Pe||(t=Ie(t)),!t)return new jt;if(t instanceof jt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),s=NaN,c=a-r,f=(a+r)/2;return c?(e===a?s=(n-i)/c+(n<i)*6:n===a?s=(i-e)/c+2:s=(e-n)/c+4,c/=f<.5?a+r:2-a-r,s*=60):c=f>0&&f<1?0:s,new jt(s,c,f,t.opacity)}function Wg(t,e,n,i){return arguments.length===1?rc(t):new jt(t,e,n,i??1)}function jt(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}ni(jt,Wg,Tr(Pe,{brighter(t){return t=t==null?or:Math.pow(or,t),new jt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Yn:Math.pow(Yn,t),new jt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new At(Oo(t>=240?t-240:t+120,r,i),Oo(t,r,i),Oo(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new jt(bl(this.h),Oi(this.s),Oi(this.l),sr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=sr(this.opacity);return`${t===1?"hsl(":"hsla("}${bl(this.h)}, ${Oi(this.s)*100}%, ${Oi(this.l)*100}%${t===1?")":`, ${t})`}`}}));function bl(t){return t=(t||0)%360,t<0?t+360:t}function Oi(t){return Math.max(0,Math.min(1,t||0))}function Oo(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Ug=Math.PI/180,Gg=180/Math.PI,lr=18,oc=.96422,ac=1,sc=.82521,lc=4/29,rn=6/29,uc=3*rn*rn,Yg=rn*rn*rn;function cc(t){if(t instanceof ee)return new ee(t.l,t.a,t.b,t.opacity);if(t instanceof ue)return fc(t);t instanceof At||(t=ic(t));var e=Fo(t.r),n=Fo(t.g),i=Fo(t.b),r=Ro((.2225045*e+.7168786*n+.0606169*i)/ac),a,s;return e===n&&n===i?a=s=r:(a=Ro((.4360747*e+.3850649*n+.1430804*i)/oc),s=Ro((.0139322*e+.0971045*n+.7141733*i)/sc)),new ee(116*r-16,500*(a-r),200*(r-s),t.opacity)}function Xg(t,e,n,i){return arguments.length===1?cc(t):new ee(t,e,n,i??1)}function ee(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}ni(ee,Xg,Tr(Pe,{brighter(t){return new ee(this.l+lr*(t??1),this.a,this.b,this.opacity)},darker(t){return new ee(this.l-lr*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=oc*zo(e),t=ac*zo(t),n=sc*zo(n),new At($o(3.1338561*e-1.6168667*t-.4906146*n),$o(-.9787684*e+1.9161415*t+.033454*n),$o(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Ro(t){return t>Yg?Math.pow(t,1/3):t/uc+lc}function zo(t){return t>rn?t*t*t:uc*(t-lc)}function $o(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fo(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Kg(t){if(t instanceof ue)return new ue(t.h,t.c,t.l,t.opacity);if(t instanceof ee||(t=cc(t)),t.a===0&&t.b===0)return new ue(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Gg;return new ue(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function qt(t,e,n,i){return arguments.length===1?Kg(t):new ue(t,e,n,i??1)}function ue(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function fc(t){if(isNaN(t.h))return new ee(t.l,0,0,t.opacity);var e=t.h*Ug;return new ee(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}ni(ue,qt,Tr(Pe,{brighter(t){return new ue(this.h,this.c,this.l+lr*(t??1),this.opacity)},darker(t){return new ue(this.h,this.c,this.l-lr*(t??1),this.opacity)},rgb(){return fc(this).rgb()}}));function Zg(t,e,n,i,r){var a=t*t,s=a*t;return((1-3*t+3*a-s)*e+(4-6*a+3*s)*n+(1+3*t+3*a-3*s)*i+s*r)/6}function Jg(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],s=i>0?t[i-1]:2*r-a,c=i<e-1?t[i+2]:2*a-r;return Zg((n-i/e)*e,s,r,a,c)}}const Lr=t=>()=>t;function dc(t,e){return function(n){return t+n*e}}function Qg(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function tv(t,e){var n=e-t;return n?dc(t,n>180||n<-180?n-360*Math.round(n/360):n):Lr(isNaN(t)?e:t)}function ev(t){return(t=+t)==1?Wn:function(e,n){return n-e?Qg(e,n,t):Lr(isNaN(e)?n:e)}}function Wn(t,e){var n=e-t;return n?dc(t,n):Lr(isNaN(t)?e:t)}const ur=function t(e){var n=ev(e);function i(r,a){var s=n((r=ar(r)).r,(a=ar(a)).r),c=n(r.g,a.g),f=n(r.b,a.b),u=Wn(r.opacity,a.opacity);return function(d){return r.r=s(d),r.g=c(d),r.b=f(d),r.opacity=u(d),r+""}}return i.gamma=t,i}(1);function nv(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),a=new Array(n),s,c;for(s=0;s<n;++s)c=ar(e[s]),i[s]=c.r||0,r[s]=c.g||0,a[s]=c.b||0;return i=t(i),r=t(r),a=t(a),c.opacity=1,function(f){return c.r=i(f),c.g=r(f),c.b=a(f),c+""}}}var iv=nv(Jg);function rv(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(a){for(r=0;r<n;++r)i[r]=t[r]*(1-a)+e[r]*a;return i}}function ov(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function av(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),a=new Array(n),s;for(s=0;s<i;++s)r[s]=kr(t[s],e[s]);for(;s<n;++s)a[s]=e[s];return function(c){for(s=0;s<i;++s)a[s]=r[s](c);return a}}function sv(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Vt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function lv(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=kr(t[r],e[r]):i[r]=e[r];return function(a){for(r in n)i[r]=n[r](a);return i}}var ra=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bo=new RegExp(ra.source,"g");function uv(t){return function(){return t}}function cv(t){return function(e){return t(e)+""}}function hc(t,e){var n=ra.lastIndex=Bo.lastIndex=0,i,r,a,s=-1,c=[],f=[];for(t=t+"",e=e+"";(i=ra.exec(t))&&(r=Bo.exec(e));)(a=r.index)>n&&(a=e.slice(n,a),c[s]?c[s]+=a:c[++s]=a),(i=i[0])===(r=r[0])?c[s]?c[s]+=r:c[++s]=r:(c[++s]=null,f.push({i:s,x:Vt(i,r)})),n=Bo.lastIndex;return n<e.length&&(a=e.slice(n),c[s]?c[s]+=a:c[++s]=a),c.length<2?f[0]?cv(f[0].x):uv(e):(e=f.length,function(u){for(var d=0,p;d<e;++d)c[(p=f[d]).i]=p.x(u);return c.join("")})}function kr(t,e){var n=typeof e,i;return e==null||n==="boolean"?Lr(e):(n==="number"?Vt:n==="string"?(i=Ie(e))?(e=i,ur):hc:e instanceof Ie?ur:e instanceof Date?sv:ov(e)?rv:Array.isArray(e)?av:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?lv:Vt)(t,e)}function pc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var El=180/Math.PI,oa={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gc(t,e,n,i,r,a){var s,c,f;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(f=t*n+e*i)&&(n-=t*f,i-=e*f),(c=Math.sqrt(n*n+i*i))&&(n/=c,i/=c,f/=c),t*i<e*n&&(t=-t,e=-e,f=-f,s=-s),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*El,skewX:Math.atan(f)*El,scaleX:s,scaleY:c}}var Ri;function fv(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?oa:gc(e.a,e.b,e.c,e.d,e.e,e.f)}function dv(t){return t==null||(Ri||(Ri=document.createElementNS("http://www.w3.org/2000/svg","g")),Ri.setAttribute("transform",t),!(t=Ri.transform.baseVal.consolidate()))?oa:(t=t.matrix,gc(t.a,t.b,t.c,t.d,t.e,t.f))}function vc(t,e,n,i){function r(u){return u.length?u.pop()+" ":""}function a(u,d,p,g,m,v){if(u!==p||d!==g){var A=m.push("translate(",null,e,null,n);v.push({i:A-4,x:Vt(u,p)},{i:A-2,x:Vt(d,g)})}else(p||g)&&m.push("translate("+p+e+g+n)}function s(u,d,p,g){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),g.push({i:p.push(r(p)+"rotate(",null,i)-2,x:Vt(u,d)})):d&&p.push(r(p)+"rotate("+d+i)}function c(u,d,p,g){u!==d?g.push({i:p.push(r(p)+"skewX(",null,i)-2,x:Vt(u,d)}):d&&p.push(r(p)+"skewX("+d+i)}function f(u,d,p,g,m,v){if(u!==p||d!==g){var A=m.push(r(m)+"scale(",null,",",null,")");v.push({i:A-4,x:Vt(u,p)},{i:A-2,x:Vt(d,g)})}else(p!==1||g!==1)&&m.push(r(m)+"scale("+p+","+g+")")}return function(u,d){var p=[],g=[];return u=t(u),d=t(d),a(u.translateX,u.translateY,d.translateX,d.translateY,p,g),s(u.rotate,d.rotate,p,g),c(u.skewX,d.skewX,p,g),f(u.scaleX,u.scaleY,d.scaleX,d.scaleY,p,g),u=d=null,function(m){for(var v=-1,A=g.length,S;++v<A;)p[(S=g[v]).i]=S.x(m);return p.join("")}}}var hv=vc(fv,"px, ","px)","deg)"),pv=vc(dv,", ",")",")"),gv=1e-12;function Al(t){return((t=Math.exp(t))+1/t)/2}function vv(t){return((t=Math.exp(t))-1/t)/2}function mv(t){return((t=Math.exp(2*t))-1)/(t+1)}const mc=function t(e,n,i){function r(a,s){var c=a[0],f=a[1],u=a[2],d=s[0],p=s[1],g=s[2],m=d-c,v=p-f,A=m*m+v*v,S,w;if(A<gv)w=Math.log(g/u)/e,S=function(F){return[c+F*m,f+F*v,u*Math.exp(e*F*w)]};else{var k=Math.sqrt(A),I=(g*g-u*u+i*A)/(2*u*n*k),b=(g*g-u*u-i*A)/(2*g*n*k),C=Math.log(Math.sqrt(I*I+1)-I),$=Math.log(Math.sqrt(b*b+1)-b);w=($-C)/e,S=function(F){var B=F*w,U=Al(C),G=u/(n*k)*(U*mv(e*B+C)-vv(C));return[c+G*m,f+G*v,u*U/Al(e*B+C)]}}return S.duration=w*1e3*e/Math.SQRT2,S}return r.rho=function(a){var s=Math.max(.001,+a),c=s*s,f=c*c;return t(s,c,f)},r}(Math.SQRT2,2,4);function yv(t){return function(e,n){var i=t((e=qt(e)).h,(n=qt(n)).h),r=Wn(e.c,n.c),a=Wn(e.l,n.l),s=Wn(e.opacity,n.opacity);return function(c){return e.h=i(c),e.c=r(c),e.l=a(c),e.opacity=s(c),e+""}}}const zi=yv(tv);var sn=0,zn=0,Cn=0,yc=1e3,cr,$n,fr=0,Ce=0,Nr=0,Kn=typeof performance=="object"&&performance.now?performance:Date,_c=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Pa(){return Ce||(_c(_v),Ce=Kn.now()+Nr)}function _v(){Ce=0}function dr(){this._call=this._time=this._next=null}dr.prototype=Oa.prototype={constructor:dr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Pa():+n)+(e==null?0:+e),!this._next&&$n!==this&&($n?$n._next=this:cr=this,$n=this),this._call=t,this._time=n,aa()},stop:function(){this._call&&(this._call=null,this._time=1/0,aa())}};function Oa(t,e,n){var i=new dr;return i.restart(t,e,n),i}function xv(){Pa(),++sn;for(var t=cr,e;t;)(e=Ce-t._time)>=0&&t._call.call(void 0,e),t=t._next;--sn}function Ml(){Ce=(fr=Kn.now())+Nr,sn=zn=0;try{xv()}finally{sn=0,wv(),Ce=0}}function Sv(){var t=Kn.now(),e=t-fr;e>yc&&(Nr-=e,fr=t)}function wv(){for(var t,e=cr,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:cr=n);$n=t,aa(i)}function aa(t){if(!sn){zn&&(zn=clearTimeout(zn));var e=t-Ce;e>24?(t<1/0&&(zn=setTimeout(Ml,t-Kn.now()-Nr)),Cn&&(Cn=clearInterval(Cn))):(Cn||(fr=Kn.now(),Cn=setInterval(Sv,yc)),sn=1,_c(Ml))}}function Tl(t,e,n){var i=new dr;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var bv=ti("start","end","cancel","interrupt"),Ev=[],xc=0,Ll=1,sa=2,Ji=3,kl=4,la=5,Qi=6;function Ir(t,e,n,i,r,a){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Av(t,n,{name:e,index:i,group:r,on:bv,tween:Ev,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:xc})}function Ra(t,e){var n=Ut(t,e);if(n.state>xc)throw new Error("too late; already scheduled");return n}function ne(t,e){var n=Ut(t,e);if(n.state>Ji)throw new Error("too late; already running");return n}function Ut(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Av(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=Oa(a,0,n.time);function a(u){n.state=Ll,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var d,p,g,m;if(n.state!==Ll)return f();for(d in i)if(m=i[d],m.name===n.name){if(m.state===Ji)return Tl(s);m.state===kl?(m.state=Qi,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete i[d]):+d<e&&(m.state=Qi,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete i[d])}if(Tl(function(){n.state===Ji&&(n.state=kl,n.timer.restart(c,n.delay,n.time),c(u))}),n.state=sa,n.on.call("start",t,t.__data__,n.index,n.group),n.state===sa){for(n.state=Ji,r=new Array(g=n.tween.length),d=0,p=-1;d<g;++d)(m=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(r[++p]=m);r.length=p+1}}function c(u){for(var d=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(f),n.state=la,1),p=-1,g=r.length;++p<g;)r[p].call(t,d);n.state===la&&(n.on.call("end",t,t.__data__,n.index,n.group),f())}function f(){n.state=Qi,n.timer.stop(),delete i[e];for(var u in i)return;delete t.__transition}}function tr(t,e){var n=t.__transition,i,r,a=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((i=n[s]).name!==e){a=!1;continue}r=i.state>sa&&i.state<la,i.state=Qi,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[s]}a&&delete t.__transition}}function Mv(t){return this.each(function(){tr(this,t)})}function Tv(t,e){var n,i;return function(){var r=ne(this,t),a=r.tween;if(a!==n){i=n=a;for(var s=0,c=i.length;s<c;++s)if(i[s].name===e){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function Lv(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var a=ne(this,t),s=a.tween;if(s!==i){r=(i=s).slice();for(var c={name:e,value:n},f=0,u=r.length;f<u;++f)if(r[f].name===e){r[f]=c;break}f===u&&r.push(c)}a.tween=r}}function kv(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Ut(this.node(),n).tween,r=0,a=i.length,s;r<a;++r)if((s=i[r]).name===t)return s.value;return null}return this.each((e==null?Tv:Lv)(n,t,e))}function za(t,e,n){var i=t._id;return t.each(function(){var r=ne(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Ut(r,i).value[e]}}function Sc(t,e){var n;return(typeof e=="number"?Vt:e instanceof Ie?ur:(n=Ie(e))?(e=n,ur):hc)(t,e)}function Nv(t){return function(){this.removeAttribute(t)}}function Iv(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Cv(t,e,n){var i,r=n+"",a;return function(){var s=this.getAttribute(t);return s===r?null:s===i?a:a=e(i=s,n)}}function Dv(t,e,n){var i,r=n+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?a:a=e(i=s,n)}}function Pv(t,e,n){var i,r,a;return function(){var s,c=n(this),f;return c==null?void this.removeAttribute(t):(s=this.getAttribute(t),f=c+"",s===f?null:s===i&&f===r?a:(r=f,a=e(i=s,c)))}}function Ov(t,e,n){var i,r,a;return function(){var s,c=n(this),f;return c==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),f=c+"",s===f?null:s===i&&f===r?a:(r=f,a=e(i=s,c)))}}function Rv(t,e){var n=Mr(t),i=n==="transform"?pv:Sc;return this.attrTween(t,typeof e=="function"?(n.local?Ov:Pv)(n,i,za(this,"attr."+t,e)):e==null?(n.local?Iv:Nv)(n):(n.local?Dv:Cv)(n,i,e))}function zv(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function $v(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Fv(t,e){var n,i;function r(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&$v(t,a)),n}return r._value=e,r}function Bv(t,e){var n,i;function r(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&zv(t,a)),n}return r._value=e,r}function Hv(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=Mr(t);return this.tween(n,(i.local?Fv:Bv)(i,e))}function qv(t,e){return function(){Ra(this,t).delay=+e.apply(this,arguments)}}function Vv(t,e){return e=+e,function(){Ra(this,t).delay=e}}function jv(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?qv:Vv)(e,t)):Ut(this.node(),e).delay}function Wv(t,e){return function(){ne(this,t).duration=+e.apply(this,arguments)}}function Uv(t,e){return e=+e,function(){ne(this,t).duration=e}}function Gv(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Wv:Uv)(e,t)):Ut(this.node(),e).duration}function Yv(t,e){if(typeof e!="function")throw new Error;return function(){ne(this,t).ease=e}}function Xv(t){var e=this._id;return arguments.length?this.each(Yv(e,t)):Ut(this.node(),e).ease}function Kv(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ne(this,t).ease=n}}function Zv(t){if(typeof t!="function")throw new Error;return this.each(Kv(this._id,t))}function Jv(t){typeof t!="function"&&(t=Uu(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a=e[r],s=a.length,c=i[r]=[],f,u=0;u<s;++u)(f=a[u])&&t.call(f,f.__data__,u,a)&&c.push(f);return new fe(i,this._parents,this._name,this._id)}function Qv(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),s=new Array(i),c=0;c<a;++c)for(var f=e[c],u=n[c],d=f.length,p=s[c]=new Array(d),g,m=0;m<d;++m)(g=f[m]||u[m])&&(p[m]=g);for(;c<i;++c)s[c]=e[c];return new fe(s,this._parents,this._name,this._id)}function tm(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function em(t,e,n){var i,r,a=tm(e)?Ra:ne;return function(){var s=a(this,t),c=s.on;c!==i&&(r=(i=c).copy()).on(e,n),s.on=r}}function nm(t,e){var n=this._id;return arguments.length<2?Ut(this.node(),n).on.on(t):this.each(em(n,t,e))}function im(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function rm(){return this.on("end.remove",im(this._id))}function om(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ia(t));for(var i=this._groups,r=i.length,a=new Array(r),s=0;s<r;++s)for(var c=i[s],f=c.length,u=a[s]=new Array(f),d,p,g=0;g<f;++g)(d=c[g])&&(p=t.call(d,d.__data__,g,c))&&("__data__"in d&&(p.__data__=d.__data__),u[g]=p,Ir(u[g],e,n,g,u,Ut(d,n)));return new fe(a,this._parents,e,n)}function am(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Wu(t));for(var i=this._groups,r=i.length,a=[],s=[],c=0;c<r;++c)for(var f=i[c],u=f.length,d,p=0;p<u;++p)if(d=f[p]){for(var g=t.call(d,d.__data__,p,f),m,v=Ut(d,n),A=0,S=g.length;A<S;++A)(m=g[A])&&Ir(m,e,n,A,g,v);a.push(g),s.push(d)}return new fe(a,s,e,n)}var sm=ei.prototype.constructor;function lm(){return new sm(this._groups,this._parents)}function um(t,e){var n,i,r;return function(){var a=an(this,t),s=(this.style.removeProperty(t),an(this,t));return a===s?null:a===n&&s===i?r:r=e(n=a,i=s)}}function wc(t){return function(){this.style.removeProperty(t)}}function cm(t,e,n){var i,r=n+"",a;return function(){var s=an(this,t);return s===r?null:s===i?a:a=e(i=s,n)}}function fm(t,e,n){var i,r,a;return function(){var s=an(this,t),c=n(this),f=c+"";return c==null&&(f=c=(this.style.removeProperty(t),an(this,t))),s===f?null:s===i&&f===r?a:(r=f,a=e(i=s,c))}}function dm(t,e){var n,i,r,a="style."+e,s="end."+a,c;return function(){var f=ne(this,t),u=f.on,d=f.value[a]==null?c||(c=wc(e)):void 0;(u!==n||r!==d)&&(i=(n=u).copy()).on(s,r=d),f.on=i}}function hm(t,e,n){var i=(t+="")=="transform"?hv:Sc;return e==null?this.styleTween(t,um(t,i)).on("end.style."+t,wc(t)):typeof e=="function"?this.styleTween(t,fm(t,i,za(this,"style."+t,e))).each(dm(this._id,t)):this.styleTween(t,cm(t,i,e),n).on("end.style."+t,null)}function pm(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function gm(t,e,n){var i,r;function a(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&pm(t,s,n)),i}return a._value=e,a}function vm(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,gm(t,e,n??""))}function mm(t){return function(){this.textContent=t}}function ym(t){return function(){var e=t(this);this.textContent=e??""}}function _m(t){return this.tween("text",typeof t=="function"?ym(za(this,"text",t)):mm(t==null?"":t+""))}function xm(t){return function(e){this.textContent=t.call(this,e)}}function Sm(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&xm(r)),e}return i._value=t,i}function wm(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Sm(t))}function bm(){for(var t=this._name,e=this._id,n=bc(),i=this._groups,r=i.length,a=0;a<r;++a)for(var s=i[a],c=s.length,f,u=0;u<c;++u)if(f=s[u]){var d=Ut(f,e);Ir(f,t,n,u,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new fe(i,this._parents,t,n)}function Em(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(a,s){var c={value:s},f={value:function(){--r===0&&a()}};n.each(function(){var u=ne(this,i),d=u.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(c),e._.interrupt.push(c),e._.end.push(f)),u.on=e}),r===0&&a()})}var Am=0;function fe(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function bc(){return++Am}var se=ei.prototype;fe.prototype={constructor:fe,select:om,selectAll:am,selectChild:se.selectChild,selectChildren:se.selectChildren,filter:Jv,merge:Qv,selection:lm,transition:bm,call:se.call,nodes:se.nodes,node:se.node,size:se.size,empty:se.empty,each:se.each,on:nm,attr:Rv,attrTween:Hv,style:hm,styleTween:vm,text:_m,textTween:wm,remove:rm,tween:kv,delay:jv,duration:Gv,ease:Xv,easeVarying:Zv,end:Em,[Symbol.iterator]:se[Symbol.iterator]};function Mm(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Tm={time:null,delay:0,duration:250,ease:Mm};function Lm(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function km(t){var e,n;t instanceof fe?(e=t._id,t=t._name):(e=bc(),(n=Tm).time=Pa(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var s=i[a],c=s.length,f,u=0;u<c;++u)(f=s[u])&&Ir(f,t,e,u,s,n||Lm(f,e));return new fe(i,this._parents,t,e)}ei.prototype.interrupt=Mv;ei.prototype.transition=km;function Nm(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function Te(t,e){return fetch(t,e).then(Nm)}function Im(t,e){var n,i=1;t==null&&(t=0),e==null&&(e=0);function r(){var a,s=n.length,c,f=0,u=0;for(a=0;a<s;++a)c=n[a],f+=c.x,u+=c.y;for(f=(f/s-t)*i,u=(u/s-e)*i,a=0;a<s;++a)c=n[a],c.x-=f,c.y-=u}return r.initialize=function(a){n=a},r.x=function(a){return arguments.length?(t=+a,r):t},r.y=function(a){return arguments.length?(e=+a,r):e},r.strength=function(a){return arguments.length?(i=+a,r):i},r}function Cm(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Ec(this.cover(e,n),e,n,t)}function Ec(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a=t._root,s={data:i},c=t._x0,f=t._y0,u=t._x1,d=t._y1,p,g,m,v,A,S,w,k;if(!a)return t._root=s,t;for(;a.length;)if((A=e>=(p=(c+u)/2))?c=p:u=p,(S=n>=(g=(f+d)/2))?f=g:d=g,r=a,!(a=a[w=S<<1|A]))return r[w]=s,t;if(m=+t._x.call(null,a.data),v=+t._y.call(null,a.data),e===m&&n===v)return s.next=a,r?r[w]=s:t._root=s,t;do r=r?r[w]=new Array(4):t._root=new Array(4),(A=e>=(p=(c+u)/2))?c=p:u=p,(S=n>=(g=(f+d)/2))?f=g:d=g;while((w=S<<1|A)===(k=(v>=g)<<1|m>=p));return r[k]=a,r[w]=s,t}function Dm(t){var e,n,i=t.length,r,a,s=new Array(i),c=new Array(i),f=1/0,u=1/0,d=-1/0,p=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(s[n]=r,c[n]=a,r<f&&(f=r),r>d&&(d=r),a<u&&(u=a),a>p&&(p=a));if(f>d||u>p)return this;for(this.cover(f,u).cover(d,p),n=0;n<i;++n)Ec(this,s[n],c[n],t[n]);return this}function Pm(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var s=r-n||1,c=this._root,f,u;n>t||t>=r||i>e||e>=a;)switch(u=(e<i)<<1|t<n,f=new Array(4),f[u]=c,c=f,s*=2,u){case 0:r=n+s,a=i+s;break;case 1:n=r-s,a=i+s;break;case 2:r=n+s,i=a-s;break;case 3:n=r-s,i=a-s;break}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this}function Om(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Rm(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Tt(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function zm(t,e,n){var i,r=this._x0,a=this._y0,s,c,f,u,d=this._x1,p=this._y1,g=[],m=this._root,v,A;for(m&&g.push(new Tt(m,r,a,d,p)),n==null?n=1/0:(r=t-n,a=e-n,d=t+n,p=e+n,n*=n);v=g.pop();)if(!(!(m=v.node)||(s=v.x0)>d||(c=v.y0)>p||(f=v.x1)<r||(u=v.y1)<a))if(m.length){var S=(s+f)/2,w=(c+u)/2;g.push(new Tt(m[3],S,w,f,u),new Tt(m[2],s,w,S,u),new Tt(m[1],S,c,f,w),new Tt(m[0],s,c,S,w)),(A=(e>=w)<<1|t>=S)&&(v=g[g.length-1],g[g.length-1]=g[g.length-1-A],g[g.length-1-A]=v)}else{var k=t-+this._x.call(null,m.data),I=e-+this._y.call(null,m.data),b=k*k+I*I;if(b<n){var C=Math.sqrt(n=b);r=t-C,a=e-C,d=t+C,p=e+C,i=m.data}}return i}function $m(t){if(isNaN(d=+this._x.call(null,t))||isNaN(p=+this._y.call(null,t)))return this;var e,n=this._root,i,r,a,s=this._x0,c=this._y0,f=this._x1,u=this._y1,d,p,g,m,v,A,S,w;if(!n)return this;if(n.length)for(;;){if((v=d>=(g=(s+f)/2))?s=g:f=g,(A=p>=(m=(c+u)/2))?c=m:u=m,e=n,!(n=n[S=A<<1|v]))return this;if(!n.length)break;(e[S+1&3]||e[S+2&3]||e[S+3&3])&&(i=e,w=S)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,r?(a?r.next=a:delete r.next,this):e?(a?e[S]=a:delete e[S],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[w]=n:this._root=n),this):(this._root=a,this)}function Fm(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Bm(){return this._root}function Hm(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function qm(t){var e=[],n,i=this._root,r,a,s,c,f;for(i&&e.push(new Tt(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,a=n.x0,s=n.y0,c=n.x1,f=n.y1)&&i.length){var u=(a+c)/2,d=(s+f)/2;(r=i[3])&&e.push(new Tt(r,u,d,c,f)),(r=i[2])&&e.push(new Tt(r,a,d,u,f)),(r=i[1])&&e.push(new Tt(r,u,s,c,d)),(r=i[0])&&e.push(new Tt(r,a,s,u,d))}return this}function Vm(t){var e=[],n=[],i;for(this._root&&e.push(new Tt(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var a,s=i.x0,c=i.y0,f=i.x1,u=i.y1,d=(s+f)/2,p=(c+u)/2;(a=r[0])&&e.push(new Tt(a,s,c,d,p)),(a=r[1])&&e.push(new Tt(a,d,c,f,p)),(a=r[2])&&e.push(new Tt(a,s,p,d,u)),(a=r[3])&&e.push(new Tt(a,d,p,f,u))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function jm(t){return t[0]}function Wm(t){return arguments.length?(this._x=t,this):this._x}function Um(t){return t[1]}function Gm(t){return arguments.length?(this._y=t,this):this._y}function $a(t,e,n){var i=new Fa(e??jm,n??Um,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function Fa(t,e,n,i,r,a){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function Nl(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var kt=$a.prototype=Fa.prototype;kt.copy=function(){var t=new Fa(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=Nl(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=Nl(i));return t};kt.add=Cm;kt.addAll=Dm;kt.cover=Pm;kt.data=Om;kt.extent=Rm;kt.find=zm;kt.remove=$m;kt.removeAll=Fm;kt.root=Bm;kt.size=Hm;kt.visit=qm;kt.visitAfter=Vm;kt.x=Wm;kt.y=Gm;function Le(t){return function(){return t}}function ge(t){return(t()-.5)*1e-6}function Ym(t){return t.x+t.vx}function Xm(t){return t.y+t.vy}function Km(t){var e,n,i,r=1,a=1;typeof t!="function"&&(t=Le(t==null?1:+t));function s(){for(var u,d=e.length,p,g,m,v,A,S,w=0;w<a;++w)for(p=$a(e,Ym,Xm).visitAfter(c),u=0;u<d;++u)g=e[u],A=n[g.index],S=A*A,m=g.x+g.vx,v=g.y+g.vy,p.visit(k);function k(I,b,C,$,F){var B=I.data,U=I.r,G=A+U;if(B){if(B.index>g.index){var O=m-B.x-B.vx,q=v-B.y-B.vy,W=O*O+q*q;W<G*G&&(O===0&&(O=ge(i),W+=O*O),q===0&&(q=ge(i),W+=q*q),W=(G-(W=Math.sqrt(W)))/W*r,g.vx+=(O*=W)*(G=(U*=U)/(S+U)),g.vy+=(q*=W)*G,B.vx-=O*(G=1-G),B.vy-=q*G)}return}return b>m+G||$<m-G||C>v+G||F<v-G}}function c(u){if(u.data)return u.r=n[u.data.index];for(var d=u.r=0;d<4;++d)u[d]&&u[d].r>u.r&&(u.r=u[d].r)}function f(){if(e){var u,d=e.length,p;for(n=new Array(d),u=0;u<d;++u)p=e[u],n[p.index]=+t(p,u,e)}}return s.initialize=function(u,d){e=u,i=d,f()},s.iterations=function(u){return arguments.length?(a=+u,s):a},s.strength=function(u){return arguments.length?(r=+u,s):r},s.radius=function(u){return arguments.length?(t=typeof u=="function"?u:Le(+u),f(),s):t},s}function Zm(t){return t.index}function Il(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function Jm(t){var e=Zm,n=p,i,r=Le(30),a,s,c,f,u,d=1;t==null&&(t=[]);function p(S){return 1/Math.min(c[S.source.index],c[S.target.index])}function g(S){for(var w=0,k=t.length;w<d;++w)for(var I=0,b,C,$,F,B,U,G;I<k;++I)b=t[I],C=b.source,$=b.target,F=$.x+$.vx-C.x-C.vx||ge(u),B=$.y+$.vy-C.y-C.vy||ge(u),U=Math.sqrt(F*F+B*B),U=(U-a[I])/U*S*i[I],F*=U,B*=U,$.vx-=F*(G=f[I]),$.vy-=B*G,C.vx+=F*(G=1-G),C.vy+=B*G}function m(){if(s){var S,w=s.length,k=t.length,I=new Map(s.map((C,$)=>[e(C,$,s),C])),b;for(S=0,c=new Array(w);S<k;++S)b=t[S],b.index=S,typeof b.source!="object"&&(b.source=Il(I,b.source)),typeof b.target!="object"&&(b.target=Il(I,b.target)),c[b.source.index]=(c[b.source.index]||0)+1,c[b.target.index]=(c[b.target.index]||0)+1;for(S=0,f=new Array(k);S<k;++S)b=t[S],f[S]=c[b.source.index]/(c[b.source.index]+c[b.target.index]);i=new Array(k),v(),a=new Array(k),A()}}function v(){if(s)for(var S=0,w=t.length;S<w;++S)i[S]=+n(t[S],S,t)}function A(){if(s)for(var S=0,w=t.length;S<w;++S)a[S]=+r(t[S],S,t)}return g.initialize=function(S,w){s=S,u=w,m()},g.links=function(S){return arguments.length?(t=S,m(),g):t},g.id=function(S){return arguments.length?(e=S,g):e},g.iterations=function(S){return arguments.length?(d=+S,g):d},g.strength=function(S){return arguments.length?(n=typeof S=="function"?S:Le(+S),v(),g):n},g.distance=function(S){return arguments.length?(r=typeof S=="function"?S:Le(+S),A(),g):r},g}const Qm=1664525,t0=1013904223,Cl=4294967296;function e0(){let t=1;return()=>(t=(Qm*t+t0)%Cl)/Cl}function n0(t){return t.x}function i0(t){return t.y}var r0=10,o0=Math.PI*(3-Math.sqrt(5));function a0(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),a=0,s=.6,c=new Map,f=Oa(p),u=ti("tick","end"),d=e0();t==null&&(t=[]);function p(){g(),u.call("tick",e),n<i&&(f.stop(),u.call("end",e))}function g(A){var S,w=t.length,k;A===void 0&&(A=1);for(var I=0;I<A;++I)for(n+=(a-n)*r,c.forEach(function(b){b(n)}),S=0;S<w;++S)k=t[S],k.fx==null?k.x+=k.vx*=s:(k.x=k.fx,k.vx=0),k.fy==null?k.y+=k.vy*=s:(k.y=k.fy,k.vy=0);return e}function m(){for(var A=0,S=t.length,w;A<S;++A){if(w=t[A],w.index=A,w.fx!=null&&(w.x=w.fx),w.fy!=null&&(w.y=w.fy),isNaN(w.x)||isNaN(w.y)){var k=r0*Math.sqrt(.5+A),I=A*o0;w.x=k*Math.cos(I),w.y=k*Math.sin(I)}(isNaN(w.vx)||isNaN(w.vy))&&(w.vx=w.vy=0)}}function v(A){return A.initialize&&A.initialize(t,d),A}return m(),e={tick:g,restart:function(){return f.restart(p),e},stop:function(){return f.stop(),e},nodes:function(A){return arguments.length?(t=A,m(),c.forEach(v),e):t},alpha:function(A){return arguments.length?(n=+A,e):n},alphaMin:function(A){return arguments.length?(i=+A,e):i},alphaDecay:function(A){return arguments.length?(r=+A,e):+r},alphaTarget:function(A){return arguments.length?(a=+A,e):a},velocityDecay:function(A){return arguments.length?(s=1-A,e):1-s},randomSource:function(A){return arguments.length?(d=A,c.forEach(v),e):d},force:function(A,S){return arguments.length>1?(S==null?c.delete(A):c.set(A,v(S)),e):c.get(A)},find:function(A,S,w){var k=0,I=t.length,b,C,$,F,B;for(w==null?w=1/0:w*=w,k=0;k<I;++k)F=t[k],b=A-F.x,C=S-F.y,$=b*b+C*C,$<w&&(B=F,w=$);return B},on:function(A,S){return arguments.length>1?(u.on(A,S),e):u.on(A)}}}function s0(){var t,e,n,i,r=Le(-30),a,s=1,c=1/0,f=.81;function u(m){var v,A=t.length,S=$a(t,n0,i0).visitAfter(p);for(i=m,v=0;v<A;++v)e=t[v],S.visit(g)}function d(){if(t){var m,v=t.length,A;for(a=new Array(v),m=0;m<v;++m)A=t[m],a[A.index]=+r(A,m,t)}}function p(m){var v=0,A,S,w=0,k,I,b;if(m.length){for(k=I=b=0;b<4;++b)(A=m[b])&&(S=Math.abs(A.value))&&(v+=A.value,w+=S,k+=S*A.x,I+=S*A.y);m.x=k/w,m.y=I/w}else{A=m,A.x=A.data.x,A.y=A.data.y;do v+=a[A.data.index];while(A=A.next)}m.value=v}function g(m,v,A,S){if(!m.value)return!0;var w=m.x-e.x,k=m.y-e.y,I=S-v,b=w*w+k*k;if(I*I/f<b)return b<c&&(w===0&&(w=ge(n),b+=w*w),k===0&&(k=ge(n),b+=k*k),b<s&&(b=Math.sqrt(s*b)),e.vx+=w*m.value*i/b,e.vy+=k*m.value*i/b),!0;if(m.length||b>=c)return;(m.data!==e||m.next)&&(w===0&&(w=ge(n),b+=w*w),k===0&&(k=ge(n),b+=k*k),b<s&&(b=Math.sqrt(s*b)));do m.data!==e&&(I=a[m.data.index]*i/b,e.vx+=w*I,e.vy+=k*I);while(m=m.next)}return u.initialize=function(m,v){t=m,n=v,d()},u.strength=function(m){return arguments.length?(r=typeof m=="function"?m:Le(+m),d(),u):r},u.distanceMin=function(m){return arguments.length?(s=m*m,u):Math.sqrt(s)},u.distanceMax=function(m){return arguments.length?(c=m*m,u):Math.sqrt(c)},u.theta=function(m){return arguments.length?(f=m*m,u):Math.sqrt(f)},u}function l0(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function hr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function ln(t){return t=hr(Math.abs(t)),t?t[1]:NaN}function u0(t,e){return function(n,i){for(var r=n.length,a=[],s=0,c=t[0],f=0;r>0&&c>0&&(f+c+1>i&&(c=Math.max(1,i-f)),a.push(n.substring(r-=c,r+c)),!((f+=c+1)>i));)c=t[s=(s+1)%t.length];return a.reverse().join(e)}}function c0(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var f0=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pr(t){if(!(e=f0.exec(t)))throw new Error("invalid format: "+t);var e;return new Ba({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}pr.prototype=Ba.prototype;function Ba(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ba.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function d0(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var Ac;function h0(t,e){var n=hr(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(Ac=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return a===s?i:a>s?i+new Array(a-s+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+hr(t,Math.max(0,e+a-1))[0]}function Dl(t,e){var n=hr(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const Pl={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:l0,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Dl(t*100,e),r:Dl,s:h0,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ol(t){return t}var Rl=Array.prototype.map,zl=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function p0(t){var e=t.grouping===void 0||t.thousands===void 0?Ol:u0(Rl.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Ol:c0(Rl.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",c=t.minus===void 0?"−":t.minus+"",f=t.nan===void 0?"NaN":t.nan+"";function u(p){p=pr(p);var g=p.fill,m=p.align,v=p.sign,A=p.symbol,S=p.zero,w=p.width,k=p.comma,I=p.precision,b=p.trim,C=p.type;C==="n"?(k=!0,C="g"):Pl[C]||(I===void 0&&(I=12),b=!0,C="g"),(S||g==="0"&&m==="=")&&(S=!0,g="0",m="=");var $=A==="$"?n:A==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",F=A==="$"?i:/[%p]/.test(C)?s:"",B=Pl[C],U=/[defgprs%]/.test(C);I=I===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function G(O){var q=$,W=F,M,_,E;if(C==="c")W=B(O)+W,O="";else{O=+O;var N=O<0||1/O<0;if(O=isNaN(O)?f:B(Math.abs(O),I),b&&(O=d0(O)),N&&+O==0&&v!=="+"&&(N=!1),q=(N?v==="("?v:c:v==="-"||v==="("?"":v)+q,W=(C==="s"?zl[8+Ac/3]:"")+W+(N&&v==="("?")":""),U){for(M=-1,_=O.length;++M<_;)if(E=O.charCodeAt(M),48>E||E>57){W=(E===46?r+O.slice(M+1):O.slice(M))+W,O=O.slice(0,M);break}}}k&&!S&&(O=e(O,1/0));var P=q.length+O.length+W.length,L=P<w?new Array(w-P+1).join(g):"";switch(k&&S&&(O=e(L+O,L.length?w-W.length:1/0),L=""),m){case"<":O=q+O+W+L;break;case"=":O=q+L+O+W;break;case"^":O=L.slice(0,P=L.length>>1)+q+O+W+L.slice(P);break;default:O=L+q+O+W;break}return a(O)}return G.toString=function(){return p+""},G}function d(p,g){var m=u((p=pr(p),p.type="f",p)),v=Math.max(-8,Math.min(8,Math.floor(ln(g)/3)))*3,A=Math.pow(10,-v),S=zl[8+v/3];return function(w){return m(A*w)+S}}return{format:u,formatPrefix:d}}var $i,Ha,Mc;g0({thousands:",",grouping:[3],currency:["$",""]});function g0(t){return $i=p0(t),Ha=$i.format,Mc=$i.formatPrefix,$i}function v0(t){return Math.max(0,-ln(Math.abs(t)))}function m0(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ln(e)/3)))*3-ln(Math.abs(t)))}function y0(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ln(e)-ln(t))+1}var dt=1e-6,_0=1e-12,lt=Math.PI,Nt=lt/2,$l=lt/4,Pt=lt*2,Dt=180/lt,_t=lt/180,gt=Math.abs,Tc=Math.atan,Zn=Math.atan2,mt=Math.cos,x0=Math.exp,S0=Math.log,yt=Math.sin,w0=Math.sign||function(t){return t>0?1:t<0?-1:0},Oe=Math.sqrt,b0=Math.tan;function E0(t){return t>1?0:t<-1?lt:Math.acos(t)}function Jn(t){return t>1?Nt:t<-1?-Nt:Math.asin(t)}function $t(){}function gr(t,e){t&&Bl.hasOwnProperty(t.type)&&Bl[t.type](t,e)}var Fl={Feature:function(t,e){gr(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)gr(n[i].geometry,e)}},Bl={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){ua(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)ua(n[i],e,0)},Polygon:function(t,e){Hl(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Hl(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)gr(n[i],e)}};function ua(t,e,n){var i=-1,r=t.length-n,a;for(e.lineStart();++i<r;)a=t[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function Hl(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)ua(t[n],e,1);e.polygonEnd()}function Qe(t,e){t&&Fl.hasOwnProperty(t.type)?Fl[t.type](t,e):gr(t,e)}function ca(t){return[Zn(t[1],t[0]),Jn(t[2])]}function un(t){var e=t[0],n=t[1],i=mt(n);return[i*mt(e),i*yt(e),yt(n)]}function Fi(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function vr(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ho(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Bi(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function fa(t){var e=Oe(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function da(t,e){function n(i,r){return i=t(i,r),e(i[0],i[1])}return t.invert&&e.invert&&(n.invert=function(i,r){return i=e.invert(i,r),i&&t.invert(i[0],i[1])}),n}function ha(t,e){return gt(t)>lt&&(t-=Math.round(t/Pt)*Pt),[t,e]}ha.invert=ha;function Lc(t,e,n){return(t%=Pt)?e||n?da(Vl(t),jl(e,n)):Vl(t):e||n?jl(e,n):ha}function ql(t){return function(e,n){return e+=t,gt(e)>lt&&(e-=Math.round(e/Pt)*Pt),[e,n]}}function Vl(t){var e=ql(t);return e.invert=ql(-t),e}function jl(t,e){var n=mt(t),i=yt(t),r=mt(e),a=yt(e);function s(c,f){var u=mt(f),d=mt(c)*u,p=yt(c)*u,g=yt(f),m=g*n+d*i;return[Zn(p*r-m*a,d*n-g*i),Jn(m*r+p*a)]}return s.invert=function(c,f){var u=mt(f),d=mt(c)*u,p=yt(c)*u,g=yt(f),m=g*r-p*a;return[Zn(p*r+g*a,d*n+m*i),Jn(m*n-d*i)]},s}function A0(t){t=Lc(t[0]*_t,t[1]*_t,t.length>2?t[2]*_t:0);function e(n){return n=t(n[0]*_t,n[1]*_t),n[0]*=Dt,n[1]*=Dt,n}return e.invert=function(n){return n=t.invert(n[0]*_t,n[1]*_t),n[0]*=Dt,n[1]*=Dt,n},e}function M0(t,e,n,i,r,a){if(n){var s=mt(e),c=yt(e),f=i*n;r==null?(r=e+i*Pt,a=e-f/2):(r=Wl(s,r),a=Wl(s,a),(i>0?r<a:r>a)&&(r+=i*Pt));for(var u,d=r;i>0?d>a:d<a;d-=f)u=ca([s,-c*mt(d),-c*yt(d)]),t.point(u[0],u[1])}}function Wl(t,e){e=un(e),e[0]-=t,fa(e);var n=E0(-e[1]);return((-e[2]<0?-n:n)+Pt-dt)%Pt}function kc(){var t=[],e;return{point:function(n,i,r){e.push([n,i,r])},lineStart:function(){t.push(e=[])},lineEnd:$t,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function er(t,e){return gt(t[0]-e[0])<dt&&gt(t[1]-e[1])<dt}function Hi(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Nc(t,e,n,i,r){var a=[],s=[],c,f;if(t.forEach(function(v){if(!((A=v.length-1)<=0)){var A,S=v[0],w=v[A],k;if(er(S,w)){if(!S[2]&&!w[2]){for(r.lineStart(),c=0;c<A;++c)r.point((S=v[c])[0],S[1]);r.lineEnd();return}w[0]+=2*dt}a.push(k=new Hi(S,v,null,!0)),s.push(k.o=new Hi(S,null,k,!1)),a.push(k=new Hi(w,v,null,!1)),s.push(k.o=new Hi(w,null,k,!0))}}),!!a.length){for(s.sort(e),Ul(a),Ul(s),c=0,f=s.length;c<f;++c)s[c].e=n=!n;for(var u=a[0],d,p;;){for(var g=u,m=!0;g.v;)if((g=g.n)===u)return;d=g.z,r.lineStart();do{if(g.v=g.o.v=!0,g.e){if(m)for(c=0,f=d.length;c<f;++c)r.point((p=d[c])[0],p[1]);else i(g.x,g.n.x,1,r);g=g.n}else{if(m)for(d=g.p.z,c=d.length-1;c>=0;--c)r.point((p=d[c])[0],p[1]);else i(g.x,g.p.x,-1,r);g=g.p}g=g.o,d=g.z,m=!m}while(!g.v);r.lineEnd()}}}function Ul(t){if(e=t.length){for(var e,n=0,i=t[0],r;++n<e;)i.n=r=t[n],r.p=i,i=r;i.n=r=t[0],r.p=i}}function qo(t){return gt(t[0])<=lt?t[0]:w0(t[0])*((gt(t[0])+lt)%Pt-lt)}function T0(t,e){var n=qo(e),i=e[1],r=yt(i),a=[yt(n),-mt(n),0],s=0,c=0,f=new ke;r===1?i=Nt+dt:r===-1&&(i=-Nt-dt);for(var u=0,d=t.length;u<d;++u)if(g=(p=t[u]).length)for(var p,g,m=p[g-1],v=qo(m),A=m[1]/2+$l,S=yt(A),w=mt(A),k=0;k<g;++k,v=b,S=$,w=F,m=I){var I=p[k],b=qo(I),C=I[1]/2+$l,$=yt(C),F=mt(C),B=b-v,U=B>=0?1:-1,G=U*B,O=G>lt,q=S*$;if(f.add(Zn(q*U*yt(G),w*F+q*mt(G))),s+=O?B+U*Pt:B,O^v>=n^b>=n){var W=vr(un(m),un(I));fa(W);var M=vr(a,W);fa(M);var _=(O^B>=0?-1:1)*Jn(M[2]);(i>_||i===_&&(W[0]||W[1]))&&(c+=O^B>=0?1:-1)}}return(s<-dt||s<dt&&f<-_0)^c&1}function Ic(t,e,n,i){return function(r){var a=e(r),s=kc(),c=e(s),f=!1,u,d,p,g={point:m,lineStart:A,lineEnd:S,polygonStart:function(){g.point=w,g.lineStart=k,g.lineEnd=I,d=[],u=[]},polygonEnd:function(){g.point=m,g.lineStart=A,g.lineEnd=S,d=Hu(d);var b=T0(u,i);d.length?(f||(r.polygonStart(),f=!0),Nc(d,k0,b,n,r)):b&&(f||(r.polygonStart(),f=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),f&&(r.polygonEnd(),f=!1),d=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function m(b,C){t(b,C)&&r.point(b,C)}function v(b,C){a.point(b,C)}function A(){g.point=v,a.lineStart()}function S(){g.point=m,a.lineEnd()}function w(b,C){p.push([b,C]),c.point(b,C)}function k(){c.lineStart(),p=[]}function I(){w(p[0][0],p[0][1]),c.lineEnd();var b=c.clean(),C=s.result(),$,F=C.length,B,U,G;if(p.pop(),u.push(p),p=null,!!F){if(b&1){if(U=C[0],(B=U.length-1)>0){for(f||(r.polygonStart(),f=!0),r.lineStart(),$=0;$<B;++$)r.point((G=U[$])[0],G[1]);r.lineEnd()}return}F>1&&b&2&&C.push(C.pop().concat(C.shift())),d.push(C.filter(L0))}}return g}}function L0(t){return t.length>1}function k0(t,e){return((t=t.x)[0]<0?t[1]-Nt-dt:Nt-t[1])-((e=e.x)[0]<0?e[1]-Nt-dt:Nt-e[1])}const Gl=Ic(function(){return!0},N0,C0,[-lt,-Nt]);function N0(t){var e=NaN,n=NaN,i=NaN,r;return{lineStart:function(){t.lineStart(),r=1},point:function(a,s){var c=a>0?lt:-lt,f=gt(a-e);gt(f-lt)<dt?(t.point(e,n=(n+s)/2>0?Nt:-Nt),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(c,n),t.point(a,n),r=0):i!==c&&f>=lt&&(gt(e-i)<dt&&(e-=i*dt),gt(a-c)<dt&&(a-=c*dt),n=I0(e,n,a,s),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(c,n),r=0),t.point(e=a,n=s),i=c},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-r}}}function I0(t,e,n,i){var r,a,s=yt(t-n);return gt(s)>dt?Tc((yt(e)*(a=mt(i))*yt(n)-yt(i)*(r=mt(e))*yt(t))/(r*a*s)):(e+i)/2}function C0(t,e,n,i){var r;if(t==null)r=n*Nt,i.point(-lt,r),i.point(0,r),i.point(lt,r),i.point(lt,0),i.point(lt,-r),i.point(0,-r),i.point(-lt,-r),i.point(-lt,0),i.point(-lt,r);else if(gt(t[0]-e[0])>dt){var a=t[0]<e[0]?lt:-lt;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function D0(t){var e=mt(t),n=6*_t,i=e>0,r=gt(e)>dt;function a(d,p,g,m){M0(m,t,n,g,d,p)}function s(d,p){return mt(d)*mt(p)>e}function c(d){var p,g,m,v,A;return{lineStart:function(){v=m=!1,A=1},point:function(S,w){var k=[S,w],I,b=s(S,w),C=i?b?0:u(S,w):b?u(S+(S<0?lt:-lt),w):0;if(!p&&(v=m=b)&&d.lineStart(),b!==m&&(I=f(p,k),(!I||er(p,I)||er(k,I))&&(k[2]=1)),b!==m)A=0,b?(d.lineStart(),I=f(k,p),d.point(I[0],I[1])):(I=f(p,k),d.point(I[0],I[1],2),d.lineEnd()),p=I;else if(r&&p&&i^b){var $;!(C&g)&&($=f(k,p,!0))&&(A=0,i?(d.lineStart(),d.point($[0][0],$[0][1]),d.point($[1][0],$[1][1]),d.lineEnd()):(d.point($[1][0],$[1][1]),d.lineEnd(),d.lineStart(),d.point($[0][0],$[0][1],3)))}b&&(!p||!er(p,k))&&d.point(k[0],k[1]),p=k,m=b,g=C},lineEnd:function(){m&&d.lineEnd(),p=null},clean:function(){return A|(v&&m)<<1}}}function f(d,p,g){var m=un(d),v=un(p),A=[1,0,0],S=vr(m,v),w=Fi(S,S),k=S[0],I=w-k*k;if(!I)return!g&&d;var b=e*w/I,C=-e*k/I,$=vr(A,S),F=Bi(A,b),B=Bi(S,C);Ho(F,B);var U=$,G=Fi(F,U),O=Fi(U,U),q=G*G-O*(Fi(F,F)-1);if(!(q<0)){var W=Oe(q),M=Bi(U,(-G-W)/O);if(Ho(M,F),M=ca(M),!g)return M;var _=d[0],E=p[0],N=d[1],P=p[1],L;E<_&&(L=_,_=E,E=L);var H=E-_,Z=gt(H-lt)<dt,rt=Z||H<dt;if(!Z&&P<N&&(L=N,N=P,P=L),rt?Z?N+P>0^M[1]<(gt(M[0]-_)<dt?N:P):N<=M[1]&&M[1]<=P:H>lt^(_<=M[0]&&M[0]<=E)){var ot=Bi(U,(-G+W)/O);return Ho(ot,F),[M,ca(ot)]}}}function u(d,p){var g=i?t:lt-t,m=0;return d<-g?m|=1:d>g&&(m|=2),p<-g?m|=4:p>g&&(m|=8),m}return Ic(s,c,a,i?[0,-t]:[-lt,t-lt])}function P0(t,e,n,i,r,a){var s=t[0],c=t[1],f=e[0],u=e[1],d=0,p=1,g=f-s,m=u-c,v;if(v=n-s,!(!g&&v>0)){if(v/=g,g<0){if(v<d)return;v<p&&(p=v)}else if(g>0){if(v>p)return;v>d&&(d=v)}if(v=r-s,!(!g&&v<0)){if(v/=g,g<0){if(v>p)return;v>d&&(d=v)}else if(g>0){if(v<d)return;v<p&&(p=v)}if(v=i-c,!(!m&&v>0)){if(v/=m,m<0){if(v<d)return;v<p&&(p=v)}else if(m>0){if(v>p)return;v>d&&(d=v)}if(v=a-c,!(!m&&v<0)){if(v/=m,m<0){if(v>p)return;v>d&&(d=v)}else if(m>0){if(v<d)return;v<p&&(p=v)}return d>0&&(t[0]=s+d*g,t[1]=c+d*m),p<1&&(e[0]=s+p*g,e[1]=c+p*m),!0}}}}}var Fn=1e9,qi=-Fn;function O0(t,e,n,i){function r(u,d){return t<=u&&u<=n&&e<=d&&d<=i}function a(u,d,p,g){var m=0,v=0;if(u==null||(m=s(u,p))!==(v=s(d,p))||f(u,d)<0^p>0)do g.point(m===0||m===3?t:n,m>1?i:e);while((m=(m+p+4)%4)!==v);else g.point(d[0],d[1])}function s(u,d){return gt(u[0]-t)<dt?d>0?0:3:gt(u[0]-n)<dt?d>0?2:1:gt(u[1]-e)<dt?d>0?1:0:d>0?3:2}function c(u,d){return f(u.x,d.x)}function f(u,d){var p=s(u,1),g=s(d,1);return p!==g?p-g:p===0?d[1]-u[1]:p===1?u[0]-d[0]:p===2?u[1]-d[1]:d[0]-u[0]}return function(u){var d=u,p=kc(),g,m,v,A,S,w,k,I,b,C,$,F={point:B,lineStart:q,lineEnd:W,polygonStart:G,polygonEnd:O};function B(_,E){r(_,E)&&d.point(_,E)}function U(){for(var _=0,E=0,N=m.length;E<N;++E)for(var P=m[E],L=1,H=P.length,Z=P[0],rt,ot,at=Z[0],tt=Z[1];L<H;++L)rt=at,ot=tt,Z=P[L],at=Z[0],tt=Z[1],ot<=i?tt>i&&(at-rt)*(i-ot)>(tt-ot)*(t-rt)&&++_:tt<=i&&(at-rt)*(i-ot)<(tt-ot)*(t-rt)&&--_;return _}function G(){d=p,g=[],m=[],$=!0}function O(){var _=U(),E=$&&_,N=(g=Hu(g)).length;(E||N)&&(u.polygonStart(),E&&(u.lineStart(),a(null,null,1,u),u.lineEnd()),N&&Nc(g,c,_,a,u),u.polygonEnd()),d=u,g=m=v=null}function q(){F.point=M,m&&m.push(v=[]),C=!0,b=!1,k=I=NaN}function W(){g&&(M(A,S),w&&b&&p.rejoin(),g.push(p.result())),F.point=B,b&&d.lineEnd()}function M(_,E){var N=r(_,E);if(m&&v.push([_,E]),C)A=_,S=E,w=N,C=!1,N&&(d.lineStart(),d.point(_,E));else if(N&&b)d.point(_,E);else{var P=[k=Math.max(qi,Math.min(Fn,k)),I=Math.max(qi,Math.min(Fn,I))],L=[_=Math.max(qi,Math.min(Fn,_)),E=Math.max(qi,Math.min(Fn,E))];P0(P,L,t,e,n,i)?(b||(d.lineStart(),d.point(P[0],P[1])),d.point(L[0],L[1]),N||d.lineEnd(),$=!1):N&&(d.lineStart(),d.point(_,E),$=!1)}k=_,I=E,b=N}return F}}const pa=t=>t;var Vo=new ke,ga=new ke,Cc,Dc,va,ma,pe={point:$t,lineStart:$t,lineEnd:$t,polygonStart:function(){pe.lineStart=R0,pe.lineEnd=$0},polygonEnd:function(){pe.lineStart=pe.lineEnd=pe.point=$t,Vo.add(gt(ga)),ga=new ke},result:function(){var t=Vo/2;return Vo=new ke,t}};function R0(){pe.point=z0}function z0(t,e){pe.point=Pc,Cc=va=t,Dc=ma=e}function Pc(t,e){ga.add(ma*t-va*e),va=t,ma=e}function $0(){Pc(Cc,Dc)}const Yl=pe;var cn=1/0,mr=cn,Qn=-cn,yr=Qn,F0={point:B0,lineStart:$t,lineEnd:$t,polygonStart:$t,polygonEnd:$t,result:function(){var t=[[cn,mr],[Qn,yr]];return Qn=yr=-(mr=cn=1/0),t}};function B0(t,e){t<cn&&(cn=t),t>Qn&&(Qn=t),e<mr&&(mr=e),e>yr&&(yr=e)}const _r=F0;var ya=0,_a=0,Bn=0,xr=0,Sr=0,tn=0,xa=0,Sa=0,Hn=0,Oc,Rc,Jt,Qt,Wt={point:De,lineStart:Xl,lineEnd:Kl,polygonStart:function(){Wt.lineStart=V0,Wt.lineEnd=j0},polygonEnd:function(){Wt.point=De,Wt.lineStart=Xl,Wt.lineEnd=Kl},result:function(){var t=Hn?[xa/Hn,Sa/Hn]:tn?[xr/tn,Sr/tn]:Bn?[ya/Bn,_a/Bn]:[NaN,NaN];return ya=_a=Bn=xr=Sr=tn=xa=Sa=Hn=0,t}};function De(t,e){ya+=t,_a+=e,++Bn}function Xl(){Wt.point=H0}function H0(t,e){Wt.point=q0,De(Jt=t,Qt=e)}function q0(t,e){var n=t-Jt,i=e-Qt,r=Oe(n*n+i*i);xr+=r*(Jt+t)/2,Sr+=r*(Qt+e)/2,tn+=r,De(Jt=t,Qt=e)}function Kl(){Wt.point=De}function V0(){Wt.point=W0}function j0(){zc(Oc,Rc)}function W0(t,e){Wt.point=zc,De(Oc=Jt=t,Rc=Qt=e)}function zc(t,e){var n=t-Jt,i=e-Qt,r=Oe(n*n+i*i);xr+=r*(Jt+t)/2,Sr+=r*(Qt+e)/2,tn+=r,r=Qt*t-Jt*e,xa+=r*(Jt+t),Sa+=r*(Qt+e),Hn+=r*3,De(Jt=t,Qt=e)}const Zl=Wt;function $c(t){this._context=t}$c.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Pt);break}}},result:$t};var wa=new ke,jo,Fc,Bc,qn,Vn,wr={point:$t,lineStart:function(){wr.point=U0},lineEnd:function(){jo&&Hc(Fc,Bc),wr.point=$t},polygonStart:function(){jo=!0},polygonEnd:function(){jo=null},result:function(){var t=+wa;return wa=new ke,t}};function U0(t,e){wr.point=Hc,Fc=qn=t,Bc=Vn=e}function Hc(t,e){qn-=t,Vn-=e,wa.add(Oe(qn*qn+Vn*Vn)),qn=t,Vn=e}const Jl=wr;let Ql,br,tu,eu;class nu{constructor(e){this._append=e==null?qc:G0(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==tu||this._append!==br){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,tu=i,br=this._append,eu=this._,this._=r}this._+=eu;break}}}result(){const e=this._;return this._="",e.length?e:null}}function qc(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function G0(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return qc;if(e!==Ql){const n=10**e;Ql=e,br=function(r){let a=1;this._+=r[0];for(const s=r.length;a<s;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}return br}function iu(t,e){let n=3,i=4.5,r,a;function s(c){return c&&(typeof i=="function"&&a.pointRadius(+i.apply(this,arguments)),Qe(c,r(a))),a.result()}return s.area=function(c){return Qe(c,r(Yl)),Yl.result()},s.measure=function(c){return Qe(c,r(Jl)),Jl.result()},s.bounds=function(c){return Qe(c,r(_r)),_r.result()},s.centroid=function(c){return Qe(c,r(Zl)),Zl.result()},s.projection=function(c){return arguments.length?(r=c==null?(t=null,pa):(t=c).stream,s):t},s.context=function(c){return arguments.length?(a=c==null?(e=null,new nu(n)):new $c(e=c),typeof i!="function"&&a.pointRadius(i),s):e},s.pointRadius=function(c){return arguments.length?(i=typeof c=="function"?c:(a.pointRadius(+c),+c),s):i},s.digits=function(c){if(!arguments.length)return n;if(c==null)n=null;else{const f=Math.floor(c);if(!(f>=0))throw new RangeError(`invalid digits: ${c}`);n=f}return e===null&&(a=new nu(n)),s},s.projection(t).digits(n).context(e)}function qa(t){return function(e){var n=new ba;for(var i in t)n[i]=t[i];return n.stream=e,n}}function ba(){}ba.prototype={constructor:ba,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Va(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),i!=null&&t.clipExtent(null),Qe(n,t.stream(_r)),e(_r.result()),i!=null&&t.clipExtent(i),t}function Vc(t,e,n){return Va(t,function(i){var r=e[1][0]-e[0][0],a=e[1][1]-e[0][1],s=Math.min(r/(i[1][0]-i[0][0]),a/(i[1][1]-i[0][1])),c=+e[0][0]+(r-s*(i[1][0]+i[0][0]))/2,f=+e[0][1]+(a-s*(i[1][1]+i[0][1]))/2;t.scale(150*s).translate([c,f])},n)}function Y0(t,e,n){return Vc(t,[[0,0],e],n)}function X0(t,e,n){return Va(t,function(i){var r=+e,a=r/(i[1][0]-i[0][0]),s=(r-a*(i[1][0]+i[0][0]))/2,c=-a*i[0][1];t.scale(150*a).translate([s,c])},n)}function K0(t,e,n){return Va(t,function(i){var r=+e,a=r/(i[1][1]-i[0][1]),s=-a*i[0][0],c=(r-a*(i[1][1]+i[0][1]))/2;t.scale(150*a).translate([s,c])},n)}var ru=16,Z0=mt(30*_t);function ou(t,e){return+e?Q0(t,e):J0(t)}function J0(t){return qa({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function Q0(t,e){function n(i,r,a,s,c,f,u,d,p,g,m,v,A,S){var w=u-i,k=d-r,I=w*w+k*k;if(I>4*e&&A--){var b=s+g,C=c+m,$=f+v,F=Oe(b*b+C*C+$*$),B=Jn($/=F),U=gt(gt($)-1)<dt||gt(a-p)<dt?(a+p)/2:Zn(C,b),G=t(U,B),O=G[0],q=G[1],W=O-i,M=q-r,_=k*W-w*M;(_*_/I>e||gt((w*W+k*M)/I-.5)>.3||s*g+c*m+f*v<Z0)&&(n(i,r,a,s,c,f,O,q,U,b/=F,C/=F,$,A,S),S.point(O,q),n(O,q,U,b,C,$,u,d,p,g,m,v,A,S))}}return function(i){var r,a,s,c,f,u,d,p,g,m,v,A,S={point:w,lineStart:k,lineEnd:b,polygonStart:function(){i.polygonStart(),S.lineStart=C},polygonEnd:function(){i.polygonEnd(),S.lineStart=k}};function w(B,U){B=t(B,U),i.point(B[0],B[1])}function k(){p=NaN,S.point=I,i.lineStart()}function I(B,U){var G=un([B,U]),O=t(B,U);n(p,g,d,m,v,A,p=O[0],g=O[1],d=B,m=G[0],v=G[1],A=G[2],ru,i),i.point(p,g)}function b(){S.point=w,i.lineEnd()}function C(){k(),S.point=$,S.lineEnd=F}function $(B,U){I(r=B,U),a=p,s=g,c=m,f=v,u=A,S.point=I}function F(){n(p,g,d,m,v,A,a,s,r,c,f,u,ru,i),S.lineEnd=b,b()}return S}}var ty=qa({point:function(t,e){this.stream.point(t*_t,e*_t)}});function ey(t){return qa({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}function ny(t,e,n,i,r){function a(s,c){return s*=i,c*=r,[e+t*s,n-t*c]}return a.invert=function(s,c){return[(s-e)/t*i,(n-c)/t*r]},a}function au(t,e,n,i,r,a){if(!a)return ny(t,e,n,i,r);var s=mt(a),c=yt(a),f=s*t,u=c*t,d=s/t,p=c/t,g=(c*n-s*e)/t,m=(c*e+s*n)/t;function v(A,S){return A*=i,S*=r,[f*A-u*S+e,n-u*A-f*S]}return v.invert=function(A,S){return[i*(d*A-p*S+g),r*(m-p*A-d*S)]},v}function iy(t){return ry(function(){return t})()}function ry(t){var e,n=150,i=480,r=250,a=0,s=0,c=0,f=0,u=0,d,p=0,g=1,m=1,v=null,A=Gl,S=null,w,k,I,b=pa,C=.5,$,F,B,U,G;function O(_){return B(_[0]*_t,_[1]*_t)}function q(_){return _=B.invert(_[0],_[1]),_&&[_[0]*Dt,_[1]*Dt]}O.stream=function(_){return U&&G===_?U:U=ty(ey(d)(A($(b(G=_)))))},O.preclip=function(_){return arguments.length?(A=_,v=void 0,M()):A},O.postclip=function(_){return arguments.length?(b=_,S=w=k=I=null,M()):b},O.clipAngle=function(_){return arguments.length?(A=+_?D0(v=_*_t):(v=null,Gl),M()):v*Dt},O.clipExtent=function(_){return arguments.length?(b=_==null?(S=w=k=I=null,pa):O0(S=+_[0][0],w=+_[0][1],k=+_[1][0],I=+_[1][1]),M()):S==null?null:[[S,w],[k,I]]},O.scale=function(_){return arguments.length?(n=+_,W()):n},O.translate=function(_){return arguments.length?(i=+_[0],r=+_[1],W()):[i,r]},O.center=function(_){return arguments.length?(a=_[0]%360*_t,s=_[1]%360*_t,W()):[a*Dt,s*Dt]},O.rotate=function(_){return arguments.length?(c=_[0]%360*_t,f=_[1]%360*_t,u=_.length>2?_[2]%360*_t:0,W()):[c*Dt,f*Dt,u*Dt]},O.angle=function(_){return arguments.length?(p=_%360*_t,W()):p*Dt},O.reflectX=function(_){return arguments.length?(g=_?-1:1,W()):g<0},O.reflectY=function(_){return arguments.length?(m=_?-1:1,W()):m<0},O.precision=function(_){return arguments.length?($=ou(F,C=_*_),M()):Oe(C)},O.fitExtent=function(_,E){return Vc(O,_,E)},O.fitSize=function(_,E){return Y0(O,_,E)},O.fitWidth=function(_,E){return X0(O,_,E)},O.fitHeight=function(_,E){return K0(O,_,E)};function W(){var _=au(n,0,0,g,m,p).apply(null,e(a,s)),E=au(n,i-_[0],r-_[1],g,m,p);return d=Lc(c,f,u),F=da(e,E),B=da(d,F),$=ou(F,C),M()}function M(){return U=G=null,O}return function(){return e=t.apply(this,arguments),O.invert=e.invert&&q,W()}}function ja(t,e){return[t,S0(b0((Nt+e)/2))]}ja.invert=function(t,e){return[t,2*Tc(x0(e))-Nt]};function oy(){return ay(ja).scale(961/Pt)}function ay(t){var e=iy(t),n=e.center,i=e.scale,r=e.translate,a=e.clipExtent,s=null,c,f,u;e.scale=function(p){return arguments.length?(i(p),d()):i()},e.translate=function(p){return arguments.length?(r(p),d()):r()},e.center=function(p){return arguments.length?(n(p),d()):n()},e.clipExtent=function(p){return arguments.length?(p==null?s=c=f=u=null:(s=+p[0][0],c=+p[0][1],f=+p[1][0],u=+p[1][1]),d()):s==null?null:[[s,c],[f,u]]};function d(){var p=lt*i(),g=e(A0(e.rotate()).invert([0,0]));return a(s==null?[[g[0]-p,g[1]-p],[g[0]+p,g[1]+p]]:t===ja?[[Math.max(g[0]-p,s),c],[Math.min(g[0]+p,f),u]]:[[s,Math.max(g[1]-p,c)],[f,Math.min(g[1]+p,u)]])}return d()}function sy(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function ly(){return this.eachAfter(sy)}function uy(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this}function cy(t,e){for(var n=this,i=[n],r,a,s=-1;n=i.pop();)if(t.call(e,n,++s,this),r=n.children)for(a=r.length-1;a>=0;--a)i.push(r[a]);return this}function fy(t,e){for(var n=this,i=[n],r=[],a,s,c,f=-1;n=i.pop();)if(r.push(n),a=n.children)for(s=0,c=a.length;s<c;++s)i.push(a[s]);for(;n=r.pop();)t.call(e,n,++f,this);return this}function dy(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i}function hy(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})}function py(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function gy(t){for(var e=this,n=vy(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i}function vy(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function my(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function yy(){return Array.from(this)}function _y(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function xy(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Sy(){var t=this,e,n=[t],i,r,a;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,i=t.children)for(r=0,a=i.length;r<a;++r)n.push(i[r]);while(n.length)}function Wa(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=Ey)):e===void 0&&(e=by);for(var n=new Er(t),i,r=[n],a,s,c,f;i=r.pop();)if((s=e(i.data))&&(f=(s=Array.from(s)).length))for(i.children=s,c=f-1;c>=0;--c)r.push(a=s[c]=new Er(s[c])),a.parent=i,a.depth=i.depth+1;return n.eachBefore(My)}function wy(){return Wa(this).eachBefore(Ay)}function by(t){return t.children}function Ey(t){return Array.isArray(t)?t[1]:null}function Ay(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function My(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Er(t){this.data=t,this.depth=this.height=0,this.parent=null}Er.prototype=Wa.prototype={constructor:Er,count:ly,each:uy,eachAfter:fy,eachBefore:cy,find:dy,sum:hy,sort:py,path:gy,ancestors:my,descendants:yy,leaves:_y,links:xy,copy:wy,[Symbol.iterator]:Sy};function Ty(t){return t==null?null:Ly(t)}function Ly(t){if(typeof t!="function")throw new Error;return t}function su(){return 0}function ky(t){return function(){return t}}const Ny=1664525,Iy=1013904223,lu=4294967296;function Cy(){let t=1;return()=>(t=(Ny*t+Iy)%lu)/lu}function Dy(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Py(t,e){let n=t.length,i,r;for(;n;)r=e()*n--|0,i=t[n],t[n]=t[r],t[r]=i;return t}function Oy(t,e){for(var n=0,i=(t=Py(Array.from(t),e)).length,r=[],a,s;n<i;)a=t[n],s&&jc(s,a)?++n:(s=zy(r=Ry(r,a)),n=0);return s}function Ry(t,e){var n,i;if(Wo(e,t))return[e];for(n=0;n<t.length;++n)if(Vi(e,t[n])&&Wo(jn(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(Vi(jn(t[n],t[i]),e)&&Vi(jn(t[n],e),t[i])&&Vi(jn(t[i],e),t[n])&&Wo(Wc(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function Vi(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function jc(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function Wo(t,e){for(var n=0;n<e.length;++n)if(!jc(t,e[n]))return!1;return!0}function zy(t){switch(t.length){case 1:return $y(t[0]);case 2:return jn(t[0],t[1]);case 3:return Wc(t[0],t[1],t[2])}}function $y(t){return{x:t.x,y:t.y,r:t.r}}function jn(t,e){var n=t.x,i=t.y,r=t.r,a=e.x,s=e.y,c=e.r,f=a-n,u=s-i,d=c-r,p=Math.sqrt(f*f+u*u);return{x:(n+a+f/p*d)/2,y:(i+s+u/p*d)/2,r:(p+r+c)/2}}function Wc(t,e,n){var i=t.x,r=t.y,a=t.r,s=e.x,c=e.y,f=e.r,u=n.x,d=n.y,p=n.r,g=i-s,m=i-u,v=r-c,A=r-d,S=f-a,w=p-a,k=i*i+r*r-a*a,I=k-s*s-c*c+f*f,b=k-u*u-d*d+p*p,C=m*v-g*A,$=(v*b-A*I)/(C*2)-i,F=(A*S-v*w)/C,B=(m*I-g*b)/(C*2)-r,U=(g*w-m*S)/C,G=F*F+U*U-1,O=2*(a+$*F+B*U),q=$*$+B*B-a*a,W=-(Math.abs(G)>1e-6?(O+Math.sqrt(O*O-4*G*q))/(2*G):q/O);return{x:i+$+F*W,y:r+B+U*W,r:W}}function uu(t,e,n){var i=t.x-e.x,r,a,s=t.y-e.y,c,f,u=i*i+s*s;u?(a=e.r+n.r,a*=a,f=t.r+n.r,f*=f,a>f?(r=(u+f-a)/(2*u),c=Math.sqrt(Math.max(0,f/u-r*r)),n.x=t.x-r*i-c*s,n.y=t.y-r*s+c*i):(r=(u+a-f)/(2*u),c=Math.sqrt(Math.max(0,a/u-r*r)),n.x=e.x+r*i-c*s,n.y=e.y+r*s+c*i)):(n.x=e.x+n.r,n.y=e.y)}function cu(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function fu(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,a=(e.y*n.r+n.y*e.r)/i;return r*r+a*a}function ji(t){this._=t,this.next=null,this.previous=null}function Fy(t,e){if(!(a=(t=Dy(t)).length))return 0;var n,i,r,a,s,c,f,u,d,p,g;if(n=t[0],n.x=0,n.y=0,!(a>1))return n.r;if(i=t[1],n.x=-i.r,i.x=n.r,i.y=0,!(a>2))return n.r+i.r;uu(i,n,r=t[2]),n=new ji(n),i=new ji(i),r=new ji(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;t:for(f=3;f<a;++f){uu(n._,i._,r=t[f]),r=new ji(r),u=i.next,d=n.previous,p=i._.r,g=n._.r;do if(p<=g){if(cu(u._,r._)){i=u,n.next=i,i.previous=n,--f;continue t}p+=u._.r,u=u.next}else{if(cu(d._,r._)){n=d,n.next=i,i.previous=n,--f;continue t}g+=d._.r,d=d.previous}while(u!==d.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,s=fu(n);(r=r.next)!==i;)(c=fu(r))<s&&(n=r,s=c);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=Oy(n,e),f=0;f<a;++f)n=t[f],n.x-=r.x,n.y-=r.y;return r.r}function By(t){return Math.sqrt(t.value)}function Hy(){var t=null,e=1,n=1,i=su;function r(a){const s=Cy();return a.x=e/2,a.y=n/2,t?a.eachBefore(du(t)).eachAfter(Uo(i,.5,s)).eachBefore(hu(1)):a.eachBefore(du(By)).eachAfter(Uo(su,1,s)).eachAfter(Uo(i,a.r/Math.min(e,n),s)).eachBefore(hu(Math.min(e,n)/(2*a.r))),a}return r.radius=function(a){return arguments.length?(t=Ty(a),r):t},r.size=function(a){return arguments.length?(e=+a[0],n=+a[1],r):[e,n]},r.padding=function(a){return arguments.length?(i=typeof a=="function"?a:ky(+a),r):i},r}function du(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Uo(t,e,n){return function(i){if(r=i.children){var r,a,s=r.length,c=t(i)*e||0,f;if(c)for(a=0;a<s;++a)r[a].r+=c;if(f=Fy(r,n),c)for(a=0;a<s;++a)r[a].r-=c;i.r=f+c}}}function hu(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function Cr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function qy(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const pu=Symbol("implicit");function Uc(){var t=new dl,e=[],n=[],i=pu;function r(a){let s=t.get(a);if(s===void 0){if(i!==pu)return i;t.set(a,s=e.push(a)-1)}return n[s%n.length]}return r.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new dl;for(const s of a)t.has(s)||t.set(s,e.push(s)-1);return r},r.range=function(a){return arguments.length?(n=Array.from(a),r):n.slice()},r.unknown=function(a){return arguments.length?(i=a,r):i},r.copy=function(){return Uc(e,n).unknown(i)},Cr.apply(r,arguments),r}function Ua(){var t=Uc().unknown(void 0),e=t.domain,n=t.range,i=0,r=1,a,s,c=!1,f=0,u=0,d=.5;delete t.unknown;function p(){var g=e().length,m=r<i,v=m?r:i,A=m?i:r;a=(A-v)/Math.max(1,g-f+u*2),c&&(a=Math.floor(a)),v+=(A-v-a*(g-f))*d,s=a*(1-f),c&&(v=Math.round(v),s=Math.round(s));var S=Bh(g).map(function(w){return v+a*w});return n(m?S.reverse():S)}return t.domain=function(g){return arguments.length?(e(g),p()):e()},t.range=function(g){return arguments.length?([i,r]=g,i=+i,r=+r,p()):[i,r]},t.rangeRound=function(g){return[i,r]=g,i=+i,r=+r,c=!0,p()},t.bandwidth=function(){return s},t.step=function(){return a},t.round=function(g){return arguments.length?(c=!!g,p()):c},t.padding=function(g){return arguments.length?(f=Math.min(1,u=+g),p()):f},t.paddingInner=function(g){return arguments.length?(f=Math.min(1,g),p()):f},t.paddingOuter=function(g){return arguments.length?(u=+g,p()):u},t.align=function(g){return arguments.length?(d=Math.max(0,Math.min(1,g)),p()):d},t.copy=function(){return Ua(e(),[i,r]).round(c).paddingInner(f).paddingOuter(u).align(d)},Cr.apply(p(),arguments)}function Vy(t){return function(){return t}}function jy(t){return+t}var gu=[0,1];function Ft(t){return t}function Ea(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Vy(isNaN(e)?NaN:.5)}function Wy(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function Uy(t,e,n){var i=t[0],r=t[1],a=e[0],s=e[1];return r<i?(i=Ea(r,i),a=n(s,a)):(i=Ea(i,r),a=n(a,s)),function(c){return a(i(c))}}function Gy(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=Ea(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(c){var f=Nh(t,c,1,i)-1;return a[f](r[f](c))}}function Gc(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Yc(){var t=gu,e=gu,n=kr,i,r,a,s=Ft,c,f,u;function d(){var g=Math.min(t.length,e.length);return s!==Ft&&(s=Wy(t[0],t[g-1])),c=g>2?Gy:Uy,f=u=null,p}function p(g){return g==null||isNaN(g=+g)?a:(f||(f=c(t.map(i),e,n)))(i(s(g)))}return p.invert=function(g){return s(r((u||(u=c(e,t.map(i),Vt)))(g)))},p.domain=function(g){return arguments.length?(t=Array.from(g,jy),d()):t.slice()},p.range=function(g){return arguments.length?(e=Array.from(g),d()):e.slice()},p.rangeRound=function(g){return e=Array.from(g),n=pc,d()},p.clamp=function(g){return arguments.length?(s=g?!0:Ft,d()):s!==Ft},p.interpolate=function(g){return arguments.length?(n=g,d()):n},p.unknown=function(g){return arguments.length?(a=g,p):a},function(g,m){return i=g,r=m,d()}}function Yy(){return Yc()(Ft,Ft)}function Xy(t,e,n,i){var r=zh(t,e,n),a;switch(i=pr(i??",f"),i.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(a=m0(r,s))&&(i.precision=a),Mc(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(a=y0(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=a-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(a=v0(r))&&(i.precision=a-(i.type==="%")*2);break}}return Ha(i)}function Ga(t){var e=t.domain;return t.ticks=function(n){var i=e();return Rh(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return Xy(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,a=i.length-1,s=i[r],c=i[a],f,u,d=10;for(c<s&&(u=s,s=c,c=u,u=r,r=a,a=u);d-- >0;){if(u=ta(s,c,n),u===f)return i[r]=s,i[a]=c,e(i);if(u>0)s=Math.floor(s/u)*u,c=Math.ceil(c/u)*u;else if(u<0)s=Math.ceil(s*u)/u,c=Math.floor(c*u)/u;else break;f=u}return t},t}function zt(){var t=Yy();return t.copy=function(){return Gc(t,zt())},Cr.apply(t,arguments),Ga(t)}function vu(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Ky(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Zy(t){return t<0?-t*t:t*t}function Jy(t){var e=t(Ft,Ft),n=1;function i(){return n===1?t(Ft,Ft):n===.5?t(Ky,Zy):t(vu(n),vu(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,i()):n},Ga(e)}function Xc(){var t=Jy(Yc());return t.copy=function(){return Gc(t,Xc()).exponent(t.exponent())},Cr.apply(t,arguments),t}function Qy(){return Xc.apply(null,arguments).exponent(.5)}function t_(){var t=0,e=1,n,i,r,a,s=Ft,c=!1,f;function u(p){return p==null||isNaN(p=+p)?f:s(r===0?.5:(p=(a(p)-n)*r,c?Math.max(0,Math.min(1,p)):p))}u.domain=function(p){return arguments.length?([t,e]=p,n=a(t=+t),i=a(e=+e),r=n===i?0:1/(i-n),u):[t,e]},u.clamp=function(p){return arguments.length?(c=!!p,u):c},u.interpolator=function(p){return arguments.length?(s=p,u):s};function d(p){return function(g){var m,v;return arguments.length?([m,v]=g,s=p(m,v),u):[s(0),s(1)]}}return u.range=d(kr),u.rangeRound=d(pc),u.unknown=function(p){return arguments.length?(f=p,u):f},function(p){return a=p,n=p(t),i=p(e),r=n===i?0:1/(i-n),u}}function e_(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Kc(){var t=Ga(t_()(Ft));return t.copy=function(){return e_(t,Kc())},qy.apply(t,arguments)}function n_(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const i_=t=>iv(t[t.length-1]);var r_=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(n_);const o_=i_(r_),Wi=t=>()=>t;function a_(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function ce(t,e,n){this.k=t,this.x=e,this.y=n}ce.prototype={constructor:ce,scale:function(t){return t===1?this:new ce(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ce(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var on=new ce(1,0,0);ce.prototype;function Go(t){t.stopImmediatePropagation()}function Dn(t){t.preventDefault(),t.stopImmediatePropagation()}function s_(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function l_(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function mu(){return this.__zoom||on}function u_(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function c_(){return navigator.maxTouchPoints||"ontouchstart"in this}function f_(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s))}function Zc(){var t=s_,e=l_,n=f_,i=u_,r=c_,a=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],c=250,f=mc,u=ti("start","zoom","end"),d,p,g,m=500,v=150,A=0,S=10;function w(M){M.property("__zoom",mu).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",U).on("dblclick.zoom",G).filter(r).on("touchstart.zoom",O).on("touchmove.zoom",q).on("touchend.zoom touchcancel.zoom",W).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(M,_,E,N){var P=M.selection?M.selection():M;P.property("__zoom",mu),M!==P?C(M,_,E,N):P.interrupt().each(function(){$(this,arguments).event(N).start().zoom(null,typeof _=="function"?_.apply(this,arguments):_).end()})},w.scaleBy=function(M,_,E,N){w.scaleTo(M,function(){var P=this.__zoom.k,L=typeof _=="function"?_.apply(this,arguments):_;return P*L},E,N)},w.scaleTo=function(M,_,E,N){w.transform(M,function(){var P=e.apply(this,arguments),L=this.__zoom,H=E==null?b(P):typeof E=="function"?E.apply(this,arguments):E,Z=L.invert(H),rt=typeof _=="function"?_.apply(this,arguments):_;return n(I(k(L,rt),H,Z),P,s)},E,N)},w.translateBy=function(M,_,E,N){w.transform(M,function(){return n(this.__zoom.translate(typeof _=="function"?_.apply(this,arguments):_,typeof E=="function"?E.apply(this,arguments):E),e.apply(this,arguments),s)},null,N)},w.translateTo=function(M,_,E,N,P){w.transform(M,function(){var L=e.apply(this,arguments),H=this.__zoom,Z=N==null?b(L):typeof N=="function"?N.apply(this,arguments):N;return n(on.translate(Z[0],Z[1]).scale(H.k).translate(typeof _=="function"?-_.apply(this,arguments):-_,typeof E=="function"?-E.apply(this,arguments):-E),L,s)},N,P)};function k(M,_){return _=Math.max(a[0],Math.min(a[1],_)),_===M.k?M:new ce(_,M.x,M.y)}function I(M,_,E){var N=_[0]-E[0]*M.k,P=_[1]-E[1]*M.k;return N===M.x&&P===M.y?M:new ce(M.k,N,P)}function b(M){return[(+M[0][0]+ +M[1][0])/2,(+M[0][1]+ +M[1][1])/2]}function C(M,_,E,N){M.on("start.zoom",function(){$(this,arguments).event(N).start()}).on("interrupt.zoom end.zoom",function(){$(this,arguments).event(N).end()}).tween("zoom",function(){var P=this,L=arguments,H=$(P,L).event(N),Z=e.apply(P,L),rt=E==null?b(Z):typeof E=="function"?E.apply(P,L):E,ot=Math.max(Z[1][0]-Z[0][0],Z[1][1]-Z[0][1]),at=P.__zoom,tt=typeof _=="function"?_.apply(P,L):_,st=f(at.invert(rt).concat(ot/at.k),tt.invert(rt).concat(ot/tt.k));return function(ht){if(ht===1)ht=tt;else{var xt=st(ht),It=ot/xt[2];ht=new ce(It,rt[0]-xt[0]*It,rt[1]-xt[1]*It)}H.zoom(null,ht)}})}function $(M,_,E){return!E&&M.__zooming||new F(M,_)}function F(M,_){this.that=M,this.args=_,this.active=0,this.sourceEvent=null,this.extent=e.apply(M,_),this.taps=0}F.prototype={event:function(M){return M&&(this.sourceEvent=M),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(M,_){return this.mouse&&M!=="mouse"&&(this.mouse[1]=_.invert(this.mouse[0])),this.touch0&&M!=="touch"&&(this.touch0[1]=_.invert(this.touch0[0])),this.touch1&&M!=="touch"&&(this.touch1[1]=_.invert(this.touch1[0])),this.that.__zoom=_,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(M){var _=Q(this.that).datum();u.call(M,this.that,new a_(M,{sourceEvent:this.sourceEvent,target:w,type:M,transform:this.that.__zoom,dispatch:u}),_)}};function B(M,..._){if(!t.apply(this,arguments))return;var E=$(this,_).event(M),N=this.__zoom,P=Math.max(a[0],Math.min(a[1],N.k*Math.pow(2,i.apply(this,arguments)))),L=le(M);if(E.wheel)(E.mouse[0][0]!==L[0]||E.mouse[0][1]!==L[1])&&(E.mouse[1]=N.invert(E.mouse[0]=L)),clearTimeout(E.wheel);else{if(N.k===P)return;E.mouse=[L,N.invert(L)],tr(this),E.start()}Dn(M),E.wheel=setTimeout(H,v),E.zoom("mouse",n(I(k(N,P),E.mouse[0],E.mouse[1]),E.extent,s));function H(){E.wheel=null,E.end()}}function U(M,..._){if(g||!t.apply(this,arguments))return;var E=M.currentTarget,N=$(this,_,!0).event(M),P=Q(M.view).on("mousemove.zoom",rt,!0).on("mouseup.zoom",ot,!0),L=le(M,E),H=M.clientX,Z=M.clientY;ec(M.view),Go(M),N.mouse=[L,this.__zoom.invert(L)],tr(this),N.start();function rt(at){if(Dn(at),!N.moved){var tt=at.clientX-H,st=at.clientY-Z;N.moved=tt*tt+st*st>A}N.event(at).zoom("mouse",n(I(N.that.__zoom,N.mouse[0]=le(at,E),N.mouse[1]),N.extent,s))}function ot(at){P.on("mousemove.zoom mouseup.zoom",null),nc(at.view,N.moved),Dn(at),N.event(at).end()}}function G(M,..._){if(t.apply(this,arguments)){var E=this.__zoom,N=le(M.changedTouches?M.changedTouches[0]:M,this),P=E.invert(N),L=E.k*(M.shiftKey?.5:2),H=n(I(k(E,L),N,P),e.apply(this,_),s);Dn(M),c>0?Q(this).transition().duration(c).call(C,H,N,M):Q(this).call(w.transform,H,N,M)}}function O(M,..._){if(t.apply(this,arguments)){var E=M.touches,N=E.length,P=$(this,_,M.changedTouches.length===N).event(M),L,H,Z,rt;for(Go(M),H=0;H<N;++H)Z=E[H],rt=le(Z,this),rt=[rt,this.__zoom.invert(rt),Z.identifier],P.touch0?!P.touch1&&P.touch0[2]!==rt[2]&&(P.touch1=rt,P.taps=0):(P.touch0=rt,L=!0,P.taps=1+!!d);d&&(d=clearTimeout(d)),L&&(P.taps<2&&(p=rt[0],d=setTimeout(function(){d=null},m)),tr(this),P.start())}}function q(M,..._){if(this.__zooming){var E=$(this,_).event(M),N=M.changedTouches,P=N.length,L,H,Z,rt;for(Dn(M),L=0;L<P;++L)H=N[L],Z=le(H,this),E.touch0&&E.touch0[2]===H.identifier?E.touch0[0]=Z:E.touch1&&E.touch1[2]===H.identifier&&(E.touch1[0]=Z);if(H=E.that.__zoom,E.touch1){var ot=E.touch0[0],at=E.touch0[1],tt=E.touch1[0],st=E.touch1[1],ht=(ht=tt[0]-ot[0])*ht+(ht=tt[1]-ot[1])*ht,xt=(xt=st[0]-at[0])*xt+(xt=st[1]-at[1])*xt;H=k(H,Math.sqrt(ht/xt)),Z=[(ot[0]+tt[0])/2,(ot[1]+tt[1])/2],rt=[(at[0]+st[0])/2,(at[1]+st[1])/2]}else if(E.touch0)Z=E.touch0[0],rt=E.touch0[1];else return;E.zoom("touch",n(I(H,Z,rt),E.extent,s))}}function W(M,..._){if(this.__zooming){var E=$(this,_).event(M),N=M.changedTouches,P=N.length,L,H;for(Go(M),g&&clearTimeout(g),g=setTimeout(function(){g=null},m),L=0;L<P;++L)H=N[L],E.touch0&&E.touch0[2]===H.identifier?delete E.touch0:E.touch1&&E.touch1[2]===H.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&(H=le(H,this),Math.hypot(p[0]-H[0],p[1]-H[1])<S)){var Z=Q(this).on("dblclick.zoom");Z&&Z.apply(this,arguments)}}}return w.wheelDelta=function(M){return arguments.length?(i=typeof M=="function"?M:Wi(+M),w):i},w.filter=function(M){return arguments.length?(t=typeof M=="function"?M:Wi(!!M),w):t},w.touchable=function(M){return arguments.length?(r=typeof M=="function"?M:Wi(!!M),w):r},w.extent=function(M){return arguments.length?(e=typeof M=="function"?M:Wi([[+M[0][0],+M[0][1]],[+M[1][0],+M[1][1]]]),w):e},w.scaleExtent=function(M){return arguments.length?(a[0]=+M[0],a[1]=+M[1],w):[a[0],a[1]]},w.translateExtent=function(M){return arguments.length?(s[0][0]=+M[0][0],s[1][0]=+M[1][0],s[0][1]=+M[0][1],s[1][1]=+M[1][1],w):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},w.constrain=function(M){return arguments.length?(n=M,w):n},w.duration=function(M){return arguments.length?(c=+M,w):c},w.interpolate=function(M){return arguments.length?(f=M,w):f},w.on=function(){var M=u.on.apply(u,arguments);return M===u?w:M},w.clickDistance=function(M){return arguments.length?(A=(M=+M)*M,w):Math.sqrt(A)},w.tapDistance=function(M){return arguments.length?(S=+M,w):S},w}const d_="data/circle_packing_data.json",yu="circle-packing-plot",h_="circle-packing-title",p_="circle-packing-text",_u="#f4efda",g_="#9e2846",v_="#000000",m_=3,y_=5,__=100,x_={culture:"Culture",marterey:"Marterey",campagne:"Campagne",ouchy:"Ouchy",la_sallaz:"La Sallaz",chailly:"Chailly",grange_neuve:"Grange-Neuve",commerce:"Commerce",st_laurent:"St-Laurent",palud:"Palud",grand_st_jean:"Grand St-Jean",ale:"Ale",montee_de_st_laurent:"Montée de St-Laurent",centre:"Centre",rue_du_pont:"Rue du Pont",cheneau_de_bourg:"Cheneau de Bourg",montee_st_francois:"Montée St-François",affaires:"Affaires",bourg:"Bourg",place_st_francois:"Place St-François",cathedrale:"Cathédrale",barre:"Barre",cite_derriere:"Cité Derrière",cite_dessous:"Cité Dessous"},S_="",w_={culture:"Section Culture",marterey:"Division Marterey",campagne:"Section Campagne",ouchy:"Division Ouchy",la_sallaz:"Division La Sallaz",chailly:"Division Chailly",grange_neuve:"Division Grange-Neuve",commerce:"Section Commerce",st_laurent:"Division St-Laurent",palud:"Division Palud",grand_st_jean:"Division Grand St-Jean",ale:"Division Ale",montee_de_st_laurent:"Division Montée de St-Laurent",centre:"Section Centre",rue_du_pont:"Division Rue du Pont",cheneau_de_bourg:"Division Cheneau de Bourg",montee_st_francois:"Division Montée St-François",affaires:"Section Affaires",bourg:"Division Bourg",place_st_francois:"Division Place St-François",cathedrale:"Section Cathédrale",barre:"Division Barre",cite_derriere:"Division Cité Derrière",cite_dessous:"Division Cité Dessous"},b_="Pour vivre une expérience d'exploration historique immersive, nous vous invitons à découvrir les sections et divisions qui constituaient la ville. Pour ce faire, il suffit de cliquer sur les cercles correspondant à chaque section ou division.",E_={culture:"La division de Marterey était un véritable bastion culturel, se distinguant par son grand théâtre, construit entre 1803 et 1805, et de nombreux autres établissements culturels tels que des salons et des casinos. Ces lieux de divertissement étaient particulièrement attrayants pour les rentiers, faisant de Marterey leur deuxième choix de résidence après Ouchy. De plus, la profusion de ces établissements culturels offrait de nombreuses opportunités d'emploi, attirant ainsi une population travaillant principalement dans les services. L'effervescence culturelle de Marterey contribuait à façonner son identité unique au sein de la ville de Lausanne.",marterey:"La division de Marterey était un véritable bastion culturel, se distinguant par son grand théâtre, construit entre 1803 et 1805, et de nombreux autres établissements culturels tels que des salons et des casinos. Ces lieux de divertissement étaient particulièrement attrayants pour les rentiers, faisant de Marterey leur deuxième choix de résidence après Ouchy. De plus, la profusion de ces établissements culturels offrait de nombreuses opportunités d'emploi, attirant ainsi une population travaillant principalement dans les services. L'effervescence culturelle de Marterey contribuait à façonner son identité unique au sein de la ville de Lausanne.",campagne:"La section Campagne de Lausanne était caractérisée par une prédominance de l'agriculture, avec toutefois une variété de nuances en fonction des divisions. Ouchy, par exemple, se distinguait comme le havre des rentiers, offrant un refuge pittoresque et serein loin du tumulte urbain, tout en attirant aussi une part de la population impliquée dans l'agriculture grâce à ses champs et vignes. À l'inverse, les divisions dans les hauts de la ville étaient profondément marquées par l'agriculture, avec une économie locale fortement tributaire de cette activité. Toutefois, malgré la présence de structures importantes comme la ferme Rovéréaz à La Sallaz, les conditions de vie dans ces divisions semblaient modestes, voire précaires, illustrant la potentielle fragilité de la condition agricole à cette époque.",ouchy:"Ouchy émergeait comme le quartier de prédilection des rentiers, offrant une escapade loin de l'effervescence du centre urbain, tout en proposant des panoramas pittoresques du lac. Sa distance par rapport au centre-ville suggère qu'Ouchy aurait été parsemé de champs et de vignes, à l'image du Lavaux contemporain, attirant une population significative liée à l'agriculture. Il est envisageable que certains rentiers aient également été propriétaires de ces terres agricoles environnantes, unissant ainsi ces deux populations apparemment opposées. Cette cohabitation unique aurait pu contribuer à l'épanouissement de ces deux types de population dans cette division.",la_sallaz:`La division de La Sallaz se caractérisait par une dominante agricole. Il est fort probable que l'économie locale était largement tributaire de la ferme Rovéréaz, qui devait offrir des sources de revenus à une part importante de la population locale. Malgré cela, la population de La Sallaz vivait probablement dans des conditions modestes, voire précaires, ce qui est corroboré par l'établissement ultérieur en 1887 de l'asile pour "les vieillards pauvres et malheureux de Lausanne". Par conséquent, cette division pourrait illustrer la précarité de la condition agricole malgré une économie locale visiblement tournée vers cette activité.`,chailly:"Comme les divisions de La Sallaz et de Grange-Neuve, la division de Chailly se distinguait par une présence agricole très marquée. Cet aspect met en évidence l'importance et la prédominance de l'agriculture dans cette partie de Lausanne à cette époque.",grange_neuve:"À l'instar des divisions de La Sallaz et de Chailly, la division de Grange-Neuve était fortement marquée par l'agriculture, encore plus que dans les autres divisions. Cependant, l'absence totale de rentiers suggère que cette division pourrait avoir été moins aisée que ses homologues. Les raisons pourraient être diverses : la grande distance la séparant du centre urbain ou la nature même des cultures, moins prestigieuses peut-être, comme les pommes de terre par opposition au vin. Cette distinction souligne l'hétérogénéité possible des conditions de vie au sein des divisions agricoles de Lausanne à cette époque.",commerce:"Le dynamisme commercial de Lausanne était palpable dans plusieurs quartiers vibrants de la ville avec des centres actifs comme la place de la Palud. La place Chauderon, inaugurée en 1830, servait de point de transfert pour les marchandises, tandis que la place de la Palud, avec l'Hôtel de Ville et son marché de fromages, constituait un autre pôle d'activité.",st_laurent:"La division St-Laurent, située à la frontière entre le centre urbain et la campagne, accueillait une population diversifiée, composée d'artisans, de rentiers et de paysans. Cette mixité professionnelle pourrait être liée à la présence de la Halle aux blés, qui, en tant que centre d'activités agricoles, commerciales et éventuellement administratives, créait un point de convergence pour différents secteurs d'activité. Ainsi, St-Laurent illustre la diversité socio-économique possible au sein d'une même division, et l'influence des infrastructures locales sur la composition de la population.",palud:'La division de la Palud, tout comme la Place St-François, se distinguait par une espérance de vie élevée parmi ses habitants. Malgré le fait que la moitié de sa population exerçait des métiers dits "physiques", les conditions de vie devaient y être suffisamment bonnes pour permettre une telle longévité.',grand_st_jean:"Proche de l'Hôtel de Ville, la division du Grand St-Jean était particulièrement prisée par ceux travaillant dans l'administration. Son emplacement stratégique, à proximité des institutions municipales, en faisait un lieu de résidence privilégié pour ces professionnels, la plaçant juste après la division de la Cité Derrière en termes de concentration d'administrateurs.",ale:"Éloignée du centre urbain, la division d'Ale en 1832 offrait probablement un cadre idéal pour l'agriculture, comme le suggère la forte présence de travailleurs agricoles. Cependant, la faible présence de rentiers et d'autres catégories plus aisées indique que cette division était principalement peuplée par les classes populaires.",montee_de_st_laurent:"La division de la Montée St-Laurent, bien que très similaire démographiquement à la division voisine de St-Laurent, présentait une baisse notable du nombre d'artisans à cette époque. Il est plausible que ces derniers aient préféré s'installer dans le centre urbain, reflétant ainsi les préférences des artisans pour les zones plus densément peuplées et économiquement actives.",centre:"Le centre de Lausanne était marqué par des rues pittoresques et animées, comme la Montée St-François, le Cheneau de Bourg et la Rue du Pré. Toutefois, le paysage social était significativement influencé par la présence de la tannerie Mercier dans le quartier du Rôtillon. Malgré son importance économique, la tannerie était associée à des conditions sanitaires défavorables et des odeurs désagréables, ce qui a limité la présence de la bourgeoisie dans ce secteur.",cheneau_de_bourg:"La division Cheneau de Bourg de Lausanne était principalement peuplée par une population artisanale, tandis que le nombre de personnes aisées, comme les rentiers et le personnel d'administration, était relativement restreint. Cette répartition démographique pourrait être attribuée à la présence passée de la Louve et de la Venoge. Ces deux rivières, propices à de nombreux métiers manuels, avaient probablement aussi contribué à créer une ambiance moins attrayante pour ceux qui ne travaillaient pas dans ces métiers. Les odeurs et la mauvaise réputation associées à ces zones industrielles auraient dissuadé les personnes plus aisées de s'y installer, renforçant ainsi la caractéristique artisanale de cette division.",rue_du_pont:"La division de la Rue du Pont, tout comme la division de Marterey, était un lieu privilégié pour les artisans et les commerçants, jouant probablement un rôle clé dans le commerce de Lausanne. Toutefois, malgré son dynamisme économique, l'espérance de vie dans cette division était particulièrement basse, environ la moitié de celle de la Place St-François. Il est possible que les conditions de travail y étaient dangereuses, avec une exposition potentielle à des produits toxiques dans le cadre de leurs activités artisanales et commerciales.",montee_st_francois:"La montée St-François, dominée par les activités commerciales et artisanales, bénéficiait probablement d'une position favorable au commerce local et aux exportations. Cependant, à l'image de la division de la Place St-François, la montée St-François présentait une faible présence de rentiers, ce qui suggère que, malgré son dynamisme économique, les conditions de bien-être et sanitaires y étaient probablement moins favorables. L'absence de personnel administratif dans cette division indique également qu'elle n'était pas au cœur des priorités de la commune à cette époque, reflétant un focus plus orienté vers le commerce et l'artisanat que vers l'amélioration des conditions de vie.",affaires:"Le cœur économique de Lausanne se trouvait dans le quartier du Bourg. Ce dernier, vibrant d'activité, abritait l'Hôtel des postes, créé entre 1806 et 1808 suite à la transformation d'une partie de l'ancien manège. C'était ici que le courrier était centralisé et expédié. De plus, ce quartier jouait un rôle crucial dans le transport. En effet, la place Saint-François était le terminus des diligences en provenance ou à destination de Berne, Genève ou Paris. Le quartier du Bourg était donc un véritable pôle d'affaires, où se croisaient les flux de courriers et de voyageurs, symbolisant le dynamisme économique de Lausanne à cette époque.",bourg:`La Rue du Bourg et la Place St-François à proximité étaient des lieux prisés par les intellectuels dits "libéraux". Leur présence a contribué à l'arrivée de populations moins manuelles, diversifiant ainsi la composition démographique de la division. Par ailleurs, la présence de nombreuses familles patriciennes ajoutait une note de raffinement à cette division, qui était alors considérée comme l'une des plus chics et raffinées de la ville. Malgré la présence notable d'artisans et de travailleurs manuels, le Bourg se distinguait aussi par son attrait pour les intellectuels et son ambiance aristocratique.`,place_st_francois:`La Place St-François, à l'instar de la Rue du Bourg, était une enclave de libéralisme intellectuel. Ce havre intellectuel attire un nombre important d'individus dont l'occupation est loin d'être manuelle, ce qui pourrait en partie expliquer la longévité exceptionnelle de ses résidents - l'espérance de vie y était en effet de 48.5 ans en 1838, bien au-dessus de la moyenne lausannoise qui ne dépassait pas la trentaine. Bien que cette mesure ne soit pas directement liée au niveau de vie, elle suggère des conditions de vie probablement supérieures à la moyenne de Lausanne, ce qui est cohérent avec le fait que moins du quart de ses habitants exerçaient des métiers dits "physiques". La Place St-François, tout comme la Place de la Palud, était un foyer d'activité urbaine et économique, avec de nombreux travaux d'infrastructure, notamment la construction de routes et de ponts, entrepris pour favoriser le transit et stimuler la croissance.`,cathedrale:"La Cathédrale de Lausanne se dressait majestueusement comme un emblème du patrimoine de la ville. Implantée au cœur de la Cité Derrière, son architecture impressionnante dominait l'horizon, attirant l'attention et l'admiration des résidents et des visiteurs. Les quartiers pittoresques de la Cité Dessous et de la Barre enveloppaient la Cathédrale dans un tissu urbain dense. En outre, la présence de l'académie dans cette division renforçait le statut de la Cathédrale comme centre de l'enseignement et de l'érudition.",barre:"La division de la Barre, tout comme St-Laurent et la montée de St-Laurent, jouait un rôle particulier à cette période, se situant à mi-chemin entre la ville et la campagne et abritant donc une population mixte. Située au nord de la ville, cette division présentait probablement un terrain plus accidenté et boisé, ce qui aurait pu attirer des professions spécifiques, comme celle de la construction. Cette hypothèse est renforcée par la présence relativement élevée d'Allemands et de Suisses allemands dans la division, dont les métiers d'ouvriers étaient traditionnellement réservés, soulignant l'interrelation entre la géographie, l'immigration et l'emploi à cette époque.",cite_derriere:"Abritant des bâtiments importants tels que le Tribunal cantonal et la Maison cantonale, la division de la Cité Derrière était probablement un pôle majeur de l'administration de Lausanne, accueillant le plus grand nombre de personnes travaillant dans ce secteur. De plus, sa richesse culturelle, illustrée par la présence de l'Académie et de sa proximité avec la Cathédrale, en faisait un lieu d'intérêt pour les rentiers. Ce mélange d'activités administratives et d'attraits culturels a sans doute contribué à attirer une part significative de rentiers.",cite_dessous:`La division de la Cité Dessous abritait l'Hôpital, autrefois connu sous le nom d'"Hospice des aliénés", qui était le principal établissement de santé de Lausanne. La présence de cette institution attirait un nombre important de médecins du canton, rendant cette division particulièrement attrayante pour ceux travaillant dans le domaine des services médicaux.`};class A_{constructor(){it(this,"data");it(this,"width");it(this,"height");this.loadData().then(()=>{this.initDimensions(),this.initPacking()})}async loadData(){return new Promise(e=>{Te(d_).then(n=>{this.data=n,e()})})}initDimensions(){const e=document.getElementById(yu);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=n,this.height=n}}initPacking(){const n=(g=>Hy().size([this.width,this.height]).padding(m_)(Wa(g).sum(m=>m.value).sort((m,v)=>v.value-m.value)))(this.data);let i=n;const r=zt().domain([0,2]).range([_u,g_]),a=Qy().domain([$h(n.descendants(),g=>g.r),Na(n.descendants(),g=>g.r)]).range([y_,__]),s=Q(`#${yu}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",`-${this.width/2} -${this.height/2} ${this.width} ${this.height}`).style("display","block").style("background",r(0)).style("cursor","pointer").on("click",g=>p(g,n)),c=s.append("g").selectAll("circle").data(n.descendants().slice(1)).join("circle").attr("fill",g=>g.children?r(g.depth):_u).attr("pointer-events",g=>g.children?null:"none").on("mouseover",function(){Q(this).attr("stroke",v_)}).on("mouseout",function(){Q(this).attr("stroke",null)}).on("click",(g,m)=>i!==m&&(p(g,m),g.stopPropagation())),f=s.append("g").style("font-family","var(--default-font-family)").attr("pointer-events","none").attr("text-anchor","middle").selectAll("text").data(n.descendants()).join("text").attr("dy","0.3em").style("font-size",g=>`${a(g.r)}px`).style("fill-opacity",g=>g.parent===n?1:0).style("display",g=>g.parent===n?"inline":"none").text(g=>x_[g.data.name]??g.data.name);let u;const d=g=>{const m=this.width/g[2];u=g,f.attr("transform",v=>`translate(${(v.x-g[0])*m},${(v.y-g[1])*m})`),c.attr("transform",v=>`translate(${(v.x-g[0])*m},${(v.y-g[1])*m})`),c.attr("r",v=>v.r*m)};d([n.x,n.y,n.r*2]);function p(g,m){const v=document.getElementById(h_);if(v){const w=w_[m.data.name]||S_;v.innerHTML=w}const A=document.getElementById(p_);if(A){const w=E_[m.data.name]||b_;A.innerHTML=w}i=m;const S=s.transition().duration(g.altKey?7500:750).tween("zoom",()=>{const w=mc(u,[i.x,i.y,i.r*2]);return k=>d(w(k))});f.filter(function(w){return w.parent===i||this.style.display==="inline"}).transition(S).style("fill-opacity",w=>w.parent===i?1:0).on("start",function(w){w.parent===i&&(this.style.display="inline")}).on("end",function(w){w.parent!==i&&(this.style.display="none")})}}}const Yo="sankey-tooltip",Ui="#FFFFFF",M_="select_job",Xo="check_proportion",Jc="bar-jobs",T_="bar-origins",L_="bar_chart_title",k_="check_proportion_text",Pn=500,N_="Distribution des catégories de métiers",I_="Distribution des origines des habitants",ve=t=>({bourg:"Bourg",place_st_francois:"Place St-François",chailly:"Chailly","grange-neuve":"Grange-Neuve",grange_neuve:"Grange-Neuve",la_sallaz:"La Sallaz",ouchy:"Ouchy",barre:"Barre",cite_derriere:"Cité Derrière",cite_dessous:"Cité Dessous",cheneau_de_bourg:"Cheneau-de-Bourg",chenneau:"Cheneau-de-Bourg",montee_st_francois:"Montée St-François",rue_du_pont:"Rue du Pré",rue_du_pre:"Rue du Pré",ale:"Ale",grand_st_jean:"Grand St-Jean",montee_de_st_laurent:"Montée de St-Laurent",palud:"Palud",st_laurent:"St-Laurent",marterey:"Marterey",affaires_division:"Affaires",campagne_division:"Campagne",cathedrale_division:"Cathédrale",centre_division:"Centre",commerce_division:"Commerce",culture_division:"Culture",administration:"Administration",agricole:"Agricole",artisanat:"Artisanat",commerce:"Commerce",construction:"Construction",rente:"Rente",service:"Service",hors_lausanne:"Hors Lausanne",lausanne:"Lausanne",suisse_allemande:"Suisse Allemande",france:"France",grandson:"Grandson",aubonne:"Aubonne",morges:"Morges",nyon:"Nyon",pays_d_enhaut:"Pays d'Enhaut",vaud:"Vaud",angleterre:"Angleterre",italie:"Italie",rolle:"Rolle",geneve:"Genève",orbe:"Orbe",vevey:"Vevey",la_vallee:"La Vallée",cossonay:"Cossonay",aigle:"Aigle",neuchatel:"Neuchâtel",payerne:"Payerne",yverdon:"Yverdon",echallens:"Echallens",fribourg:"Fribourg",avenches:"Avenches",moudon:"Moudon",oron:"Oron",lavaux:"Lavaux",not_lausanne:"Hors Lausanne"})[t]??t,C_=t=>({administration:"#8068cb",agricole:"#62b257",artisanat:"#b84dcf",commerce:"#cf5288",construction:"#b19436",rente:"#598ad6",service:"#d1583d"})[t]||"#9e2846",nr=1e6,Gi={population:{max:504,color:"#531827",max_ratio:.020217088327393808*nr},no_selection:{min:0,max:1},administration:{min:1,max:17,color:"#8068cb",max_ratio:.08134},agricole:{min:3,max:122,color:"#62b257",max_ratio:.657143},artisanat:{min:2,max:93,color:"#b84dcf",max_ratio:.308081},commerce:{min:6,max:44,color:"#cf5288",max_ratio:.135},construction:{min:1,max:39,color:"#b19436",max_ratio:.135458},rente:{min:5,max:140,color:"#598ad6",max_ratio:.412979},service:{min:1,max:77,color:"#d1583d",max_ratio:.158103},not_lausanne:{max:288,color:"#9e2846",max_ratio:.6571428571428571},aigle:{max:8,color:"#9e2846",max_ratio:.032609},angleterre:{max:14,color:"#9e2846",max_ratio:.041298},aubonne:{max:10,color:"#9e2846",max_ratio:.030303},avenches:{max:3,color:"#9e2846",max_ratio:.014354},cossonay:{max:17,color:"#9e2846",max_ratio:.065217},echallens:{max:12,color:"#9e2846",max_ratio:.045455},france:{max:21,color:"#9e2846",max_ratio:.093264},fribourg:{max:6,color:"#9e2846",max_ratio:.085714},geneve:{max:6,color:"#9e2846",max_ratio:.017699},grandson:{max:2,color:"#9e2846",max_ratio:.01087},italie:{max:3,color:"#9e2846",max_ratio:.01005},la_vallee:{max:14,color:"#9e2846",max_ratio:.4},lausanne:{max:149,color:"#9e2846",max_ratio:.54023},lavaux:{max:53,color:"#9e2846",max_ratio:.106195},morges:{max:26,color:"#9e2846",max_ratio:.092527},moudon:{max:13,color:"#9e2846",max_ratio:.055276},neuchatel:{max:3,color:"#9e2846",max_ratio:.011858},nyon:{max:10,color:"#9e2846",max_ratio:.043478},orbe:{max:10,color:"#9e2846",max_ratio:.035587},oron:{max:15,color:"#9e2846",max_ratio:.059289},payerne:{max:4,color:"#9e2846",max_ratio:.021739},pays_d_enhaut:{max:11,color:"#9e2846",max_ratio:.038278},rolle:{max:8,color:"#9e2846",max_ratio:.020202},suisse_allemande:{max:36,color:"#9e2846",max_ratio:.100503},vaud:{max:6,color:"#9e2846",max_ratio:.085714},vevey:{max:15,color:"#9e2846",max_ratio:.045226},yverdon:{max:12,color:"#9e2846",max_ratio:.072464}},xu=.3;class D_{constructor(e,n,i=7e5,r=[6.635,46.525],a=100,s="rgba(128, 128, 128, 1)"){this.map_file=e,this.locations_file=n,this.mapBarPlotJobs=new Su(Jc,N_),this.mapBarPlotOrigins=new Su(T_,I_),this.scale=i,this.center=r,this.min_zoom_dimension=a,this.default_zone_color=s,this.is_zoomed=!1,this.clicked_zone=null,this.selectedJobsData=null,this.selectedOriginsData=null,this.initDimensions(),this.svg=this.init_svg(),this.layer_1=this.init_g(),this.layer_3=this.init_g(),this.layer_2=this.init_g(),this.legend=this.init_legend(),this.projection=this.init_projection(),this.zoom=this.init_zoom();let c="no_selection",f="no_origin",u=!1,d=!1,p=!1;document.getElementById(Xo).addEventListener("change",v=>{u=v.target.checked,d?(this.handleSelectJob(c,u),this.update_legend(c,u)):p?(this.handleSelectOrigin(f,u),this.update_legend(f,u)):(this.hadleNoSelection(u),this.update_legend("population",u))}),document.getElementById(M_).addEventListener("change",v=>{document.getElementById(Xo).getElementsByTagName("input")[0].disabled=!1,v.target.value==="no_selection"|v.target.value==="population"&&(d=!1,p=!1,this.hadleNoSelection(u));const A=v.target.selectedOptions[0].parentNode.id;A==="job_category_optgroup"?(d=!0,p=!1,c=v.target.value,this.handleSelectJob(v.target.value,u)):A==="origin_category_optgroup"&&(d=!1,p=!0,f=v.target.value,this.handleSelectOrigin(v.target.value,u)),this.update_legend(v.target.value,u),this.selectedJobsData!==null&&this.mapBarPlotJobs.drawBarPlot(this.selectedJobsData,v.target.value),this.selectedOriginsData!==null&&this.mapBarPlotOrigins.drawBarPlot(this.selectedOriginsData,v.target.value);const S=v.target.value,w=document.getElementById(k_);S==="population"?w.innerHTML="Densité par divisions":w.innerHTML="Proportions par divisions"})}handleSelectJob(e,n){const i=Gi[e],r=zt().domain([0,n?i.max_ratio:i.max]).interpolate(zi).range([qt(Ui),qt(i.color)]);this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",a=>!(e in a.properties.jobs)||e==="no_selection"?r(0):r(a.properties.jobs[e]/(n?a.properties.population:1))).attr("data-old-color",a=>!(e in a.properties.jobs)||e==="no_selection"?r(0):r(a.properties.jobs[e]/(n?a.properties.population:1)))}handleSelectOrigin(e,n){const i=Gi[e],r=zt().domain([0,n?i.max_ratio:i.max]).interpolate(zi).range([qt(Ui),qt(i.color)]);this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",a=>!(e in a.properties.origins)||e==="no_selection"?r(0):r(a.properties.origins[e]/(n?a.properties.population:1))).attr("data-old-color",a=>!(e in a.properties.origins)||e==="no_selection"?r(0):r(a.properties.origins[e]/(n?a.properties.population:1)))}hadleNoSelection(e){const i=document.getElementById("selection_option").value;if(i==="no_selection"){this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",s=>this.default_zone_color).attr("data-old-color",s=>this.default_zone_color),document.getElementById(Xo).getElementsByTagName("input")[0].disabled=!0;return}const r=Gi[i],a=zt().domain([0,e?r.max_ratio:r.max]).interpolate(zi).range([qt(Ui),qt(r.color)]);this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",s=>a(s.properties.population/(e?s.properties.area:1)*(e?nr:1))).attr("data-old-color",s=>a(s.properties.population/(e?s.properties.area:1)*(e?nr:1)))}initDimensions(){const e=document.getElementById("map-chart");e&&(this.width=e.clientWidth,this.height=e.clientHeight)}init_svg(){return Q("#map").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]).on("mouseover",function(){}).on("mouseout",function(){})}init_projection(){return oy().center(this.center).scale(this.scale).translate([this.svg_width/2,this.svg_height/2])}init_g(){return this.svg.append("g")}init_legend(){const e=this.svg.append("g").attr("class","legend").attr("transform","translate(20, "+(this.height-70)+")"),n=Kc(o_).domain([0,100]),r=this.svg.append("defs").append("linearGradient").attr("id","linear-gradient");r.append("stop").attr("id","gradient-start").attr("offset","0%").attr("stop-color",n.range()[0]),r.append("stop").attr("id","gradient-end").attr("offset","100%").attr("stop-color",n.range()[1]),e.append("rect").attr("id","legend-rect").attr("width",200).attr("height",20).style("fill","url(#linear-gradient)");const a=zt().domain(n.domain()).range([0,200]),s=Ne(a).ticks(5);return e.append("g").attr("id","legend-axis").attr("transform","translate(0, 20)").style("color","#fff").call(s),e.style("opacity",0),e.append("text").attr("id","legend-title").attr("x",0).attr("y",-10).style("fill","#fff").text("Nombre de personnes"),e}update_legend(e,n){if(e==="no_selection"){this.svg.select(".legend").transition().duration(500).style("opacity",0);return}n?e==="population"?this.svg.select("#legend-title").text("Densité de personnes [hab/km²]"):this.svg.select("#legend-title").text("Proportion de personnes [%]"):this.svg.select("#legend-title").text("Nombre de personnes"),this.svg.select(".legend").transition().duration(500).style("opacity",1);const i=Gi[e],r=i.max_ratio>1?i.max_ratio:i.max_ratio*100,a=zt().domain([0,n?r:i.max]).interpolate(zi).range([qt(Ui),qt(i.color)]),s=this.svg.select("#linear-gradient");s.select("#gradient-start").transition().duration(500).attr("stop-color",a(0)),s.select("#gradient-end").transition().duration(500).attr("stop-color",a(n?r:i.max)),this.svg.select("#legend-rect").transition().duration(500).style("fill","url(#linear-gradient)");const f=zt().domain(a.domain()).range([0,200]),u=Ne(f).ticks(5);this.svg.select("#legend-axis").transition().duration(500).style("color","#fff").call(u)}init_zoom(){let e=!1;const n=Zc().scaleExtent([1,8]).on("zoom",i=>{if(!e){if(i.sourceEvent instanceof WheelEvent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1){e=!0,n.transform(this.svg,on),e=!1;return}this.layer_1.attr("transform",i.transform),this.layer_2.attr("transform",i.transform),this.layer_3.attr("transform",i.transform)}});return this.svg.call(n),n}get svg_width(){return this.svg.node().getBoundingClientRect().width}get svg_height(){return this.svg.node().getBoundingClientRect().height}get path_generator(){return iu().projection(this.projection)}load_data(){Te(this.map_file).then(e=>{this.layer_1.selectAll("path").data(e.features).enter().append("path").attr("class","zone").attr("id",n=>n.properties.id).attr("fill",n=>this.default_zone_color).attr("data-old-color",n=>this.default_zone_color).attr("d",iu().projection(this.projection)).style("stroke","white").style("stroke-width",.2).on("mouseover",n=>{this.onMouseOverZone(n.target)}).on("mouseout",n=>{this.onMouseOutZone(n.target)}).on("mousemove",n=>{Q(`#${Yo}`).style("top",n.pageY+20+"px").style("left",n.pageX+10+"px")}).on("click",n=>{this.is_zoomed?this.zoomOut():this.zoomOnZone(n.target),this.is_zoomed=!this.is_zoomed,this.zoom.filter(()=>!this.is_zoomed),this.is_zoomed||this.resetZone(this.clicked_zone),this.clicked_zone=this.is_zoomed?n.target:null})}),this.load_locations(),this.load_buildings()}load_locations(){Te(this.locations_file).then(e=>{e=Object.entries(e),this.layer_2.selectAll("circle").data(e).enter().append("circle").attr("cx",n=>this.projection(n[1])[0]).attr("cy",n=>this.projection(n[1])[1]).attr("r",2).attr("fill","black").style("pointer-events","none"),this.layer_2.selectAll("text").data(e).enter().append("text").attr("x",n=>this.projection(n[1])[0]).attr("y",n=>this.projection(n[1])[1]).attr("dy",-3).text(n=>n[0]).style("font-size","6px").style("text-anchor","middle").style("pointer-events","none").style("font-family","sans-serif")})}load_buildings(){Te("data/buildings.geojson").then(e=>{this.layer_3.selectAll(".building").data(e.features).enter().append("path").attr("class","building").attr("d",this.path_generator).attr("fill",`rgba(0, 0, 0, ${xu})`).style("stroke",`rgba(0, 0, 0, ${xu})`).style("stroke-width",.2).style("pointer-events","none")})}onMouseOverZone(e){const n=e.__data__.properties.population,r=document.getElementById("selection_option").value;let a="";if(r!=="no_selection"){let d=e.__data__.properties.jobs,p=e.__data__.properties.origins;a="0",r in d?a=d[r]:r in p&&(a=p[r]),a=`<br>${ve(r)}: ${a}<br>Proportion: ${Math.round(a/n*100)}%`,r==="population"&&(a=`<br>Densité: ${Math.round(n/e.__data__.properties.area*nr)} [hab/km²]`)}const s=Q(`#${Yo}`);if(s.style("visibility","visible"),s.html(`<b>${ve(this.getZoneTitle(e))}</b><br>Population: ${n}${a}`),this.is_zoomed)return;const c=Q(e).attr("fill");Q(e).attr("data-old-color",c);const f=c.replace(/[^\d,]/g,"").split(","),u=`rgb(${f[0]*1.25}, ${f[1]*1.25}, ${f[2]*1.25})`;this.fadeToColor(e,u)}onMouseOutZone(e){if(Q(`#${Yo}`).style("visibility","hidden"),this.is_zoomed)return;const i=Q(e).attr("data-old-color");this.fadeToColor(e,i),this.removeZoneTitle()}fadeToColor(e,n){Q(e).attr("fill",n)}getZoneCenter(e,n,i){const a=Q(e).node().getBBox();let s=[a.x+a.width/2,a.y+a.height/2];return n||(s=this.projection.invert(s)),[s,i?this.getZoneBorders(e,n):null]}getZoneBorders(e,n){const r=Q(e).node().getBBox();let a=[r.x,r.y+r.height],s=[r.x+r.width,r.y+r.height],c=[r.x,r.y],f=[r.x+r.width,r.y];return n||(a=this.projection.invert(a),s=this.projection.invert(s),c=this.projection.invert(c),f=this.projection.invert(f)),[a,s,c,f]}getZoneTitle(e){let n=e;n.nodeName=="path"&&(n=Q(e).data()[0]);let i=n.properties.name;return(i==null||i==""||i=="nan")&&(i=n.properties.class),i=decodeURIComponent(escape(i)),i=i.split(" ")[0],i=i.replace(",",""),i}addZoneTitle(e,n,i){let r=this.getZoneTitle(e);this.layer_2.append("text").attr("x",this.projection([n,i])[0]).attr("y",this.projection([n,i])[1]).attr("text-anchor","middle").attr("id","zone_name").text(ve(r)).attr("font-family","sans-serif").attr("font-size","10px").attr("fill","black").style("pointer-events","none")}removeZoneTitle(){Q("#zone_name").remove()}zoomOnZone(e){this.selectedZone=e;const n=this.getZoneCenter(e,!0,!0),i=n[0],r=n[1][0],a=n[1][1],s=n[1][2];Q(`#${L_}`).transition().duration(500).text(`Distributions pour ${ve(this.getZoneTitle(e))}`);let c=Math.abs(a[0]-r[0]);c=Math.max(c,this.min_zoom_dimension);let f=Math.abs(s[1]-r[1]);f=Math.max(f,this.min_zoom_dimension);const u=Math.min(this.svg_width/c,this.svg_height/f)*.7,d=this.svg_width/2-i[0]*u,p=this.svg_height/2-i[1]*u,g=on.translate(d,p).scale(u);this.svg.transition().duration(750).call(this.zoom.transform,g);const m=document.getElementById("selection_option"),v=m.options[m.selectedIndex].value;let A=e.__data__.properties.jobs;this.selectedJobsData=Object.keys(A).map(function(w){return{id:w,value:A[w]}}),this.mapBarPlotJobs.drawBarPlot(this.selectedJobsData,v);let S=e.__data__.properties.origins;this.selectedOriginsData=Object.keys(S).map(function(w){return{id:w,value:S[w]}}),this.mapBarPlotOrigins.drawBarPlot(this.selectedOriginsData,v)}zoomOut(){this.svg.transition().duration(750).call(this.zoom.transform,on)}resetZone(e){const n=Q(e).attr("data-old-color");this.fadeToColor(e,n),this.removeZoneTitle()}}class Su{constructor(e,n){it(this,"width");it(this,"height");it(this,"barPlotElementId",Jc);it(this,"title","Jobs");it(this,"svg");this.barPlotElementId=e,this.title=n,this.initDimensions(),this.initColor()}initDimensions(){const e=document.getElementById(this.barPlotElementId);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=e.clientWidth,this.height=n}}initColor(){this.color=C_}drawBarPlot(e,n){const i={top:10,right:30,bottom:100,left:50},r=this.width-i.left-i.right,a=this.height-i.top-i.bottom;let s=Q(`#${this.barPlotElementId}`).select("svg"),c;s.empty()?(s=Q(`#${this.barPlotElementId}`).append("svg").attr("id",`${this.barPlotElementId}-svg`).attr("width",r+i.left+i.right).attr("height",a+i.top+i.bottom).append("g").attr("transform",`translate(${i.left},${i.top})`),c=s.append("g").attr("class","bars"),s.append("text").attr("x",r/2).attr("y",20).attr("text-anchor","middle").style("font-size","1em").attr("fill","#FAF4DD").text(this.title)):c=s.select(".bars"),e.sort((v,A)=>ka(v.value,A.value)),e=e.filter(v=>v.id!=="not_lausanne");const f=Ua().range([0,r]).domain(e.map(v=>ve(v.id))).padding(.2),u=zt().domain([0,Na(e,v=>v.value)]).range([a,0]);let d=s.select(".x-axis");d.empty()?d=s.append("g").attr("class","x-axis").attr("transform",`translate(0,${a})`).call(Ne(f).tickFormat(v=>v)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").style("font-weight","normal").style("text-decoration","none").filter(v=>v===n).style("font-weight","bold").style("text-decoration","underline"):d.transition().duration(Pn).call(Ne(f).tickFormat(v=>v)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").style("font-weight","normal").style("text-decoration","none").filter(v=>v===n).style("font-weight","bold").style("text-decoration","underline");let p=s.select(".y-axis");p.empty()?p=s.append("g").attr("class","y-axis").call(Un(u)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD"):p.transition().duration(Pn).call(Un(u)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD");const g=c.selectAll(`.${this.barPlotElementId}-bar`).data(e,v=>ve(v.id));g.exit().transition().duration(Pn).attr("height",0).attr("y",u(0)).remove(),g.transition().duration(Pn).attr("x",v=>f(ve(v.id))).attr("width",f.bandwidth()).attr("y",v=>u(v.value)).attr("height",v=>a-u(v.value)).attr("stroke",v=>v.id===n?"white":"none").attr("stroke-width",v=>v.id===n?"2px":"0px").attr("opacity",v=>n==="no_selection"||n==="not_lausanne"||v.id===n?1:.6),g.enter().append("rect").attr("class",`${this.barPlotElementId}-bar`).attr("x",v=>f(ve(v.id))).attr("width",f.bandwidth()).attr("y",u(0)).attr("height",0).attr("fill",v=>this.color(v.id)).transition().duration(Pn).attr("height",v=>a-u(v.value)).attr("y",v=>u(v.value)).attr("stroke",v=>v.id===n?"white":"none").attr("stroke-width",v=>v.id===n?"2px":"0px").attr("opacity",v=>n==="no_selection"||n==="not_lausanne"||v.id===n?1:.6)}}function wu(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function Qc(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function Ko(t,e){let n=0;if(e===void 0)for(let i of t)(i=+i)&&(n+=i);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&(n+=r)}return n}function P_(t){return t.target.depth}function O_(t){return t.depth}function R_(t,e){return e-1-t.height}function tf(t,e){return t.sourceLinks.length?t.depth:e-1}function z_(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?Qc(t.sourceLinks,P_)-1:0}function Yi(t){return function(){return t}}function bu(t,e){return Ar(t.source,e.source)||t.index-e.index}function Eu(t,e){return Ar(t.target,e.target)||t.index-e.index}function Ar(t,e){return t.y0-e.y0}function Zo(t){return t.value}function $_(t){return t.index}function F_(t){return t.nodes}function B_(t){return t.links}function Au(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function Mu({nodes:t}){for(const e of t){let n=e.y0,i=n;for(const r of e.sourceLinks)r.y0=n+r.width/2,n+=r.width;for(const r of e.targetLinks)r.y1=i+r.width/2,i+=r.width}}function H_(){let t=0,e=0,n=1,i=1,r=24,a=8,s,c=$_,f=tf,u,d,p=F_,g=B_,m=6;function v(){const _={nodes:p.apply(null,arguments),links:g.apply(null,arguments)};return A(_),S(_),w(_),k(_),C(_),Mu(_),_}v.update=function(_){return Mu(_),_},v.nodeId=function(_){return arguments.length?(c=typeof _=="function"?_:Yi(_),v):c},v.nodeAlign=function(_){return arguments.length?(f=typeof _=="function"?_:Yi(_),v):f},v.nodeSort=function(_){return arguments.length?(u=_,v):u},v.nodeWidth=function(_){return arguments.length?(r=+_,v):r},v.nodePadding=function(_){return arguments.length?(a=s=+_,v):a},v.nodes=function(_){return arguments.length?(p=typeof _=="function"?_:Yi(_),v):p},v.links=function(_){return arguments.length?(g=typeof _=="function"?_:Yi(_),v):g},v.linkSort=function(_){return arguments.length?(d=_,v):d},v.size=function(_){return arguments.length?(t=e=0,n=+_[0],i=+_[1],v):[n-t,i-e]},v.extent=function(_){return arguments.length?(t=+_[0][0],n=+_[1][0],e=+_[0][1],i=+_[1][1],v):[[t,e],[n,i]]},v.iterations=function(_){return arguments.length?(m=+_,v):m};function A({nodes:_,links:E}){for(const[P,L]of _.entries())L.index=P,L.sourceLinks=[],L.targetLinks=[];const N=new Map(_.map((P,L)=>[c(P,L,_),P]));for(const[P,L]of E.entries()){L.index=P;let{source:H,target:Z}=L;typeof H!="object"&&(H=L.source=Au(N,H)),typeof Z!="object"&&(Z=L.target=Au(N,Z)),H.sourceLinks.push(L),Z.targetLinks.push(L)}if(d!=null)for(const{sourceLinks:P,targetLinks:L}of _)P.sort(d),L.sort(d)}function S({nodes:_}){for(const E of _)E.value=E.fixedValue===void 0?Math.max(Ko(E.sourceLinks,Zo),Ko(E.targetLinks,Zo)):E.fixedValue}function w({nodes:_}){const E=_.length;let N=new Set(_),P=new Set,L=0;for(;N.size;){for(const H of N){H.depth=L;for(const{target:Z}of H.sourceLinks)P.add(Z)}if(++L>E)throw new Error("circular link");N=P,P=new Set}}function k({nodes:_}){const E=_.length;let N=new Set(_),P=new Set,L=0;for(;N.size;){for(const H of N){H.height=L;for(const{source:Z}of H.targetLinks)P.add(Z)}if(++L>E)throw new Error("circular link");N=P,P=new Set}}function I({nodes:_}){const E=wu(_,L=>L.depth)+1,N=(n-t-r)/(E-1),P=new Array(E);for(const L of _){const H=Math.max(0,Math.min(E-1,Math.floor(f.call(null,L,E))));L.layer=H,L.x0=t+H*N,L.x1=L.x0+r,P[H]?P[H].push(L):P[H]=[L]}if(u)for(const L of P)L.sort(u);return P}function b(_){const E=Qc(_,N=>(i-e-(N.length-1)*s)/Ko(N,Zo));for(const N of _){let P=e;for(const L of N){L.y0=P,L.y1=P+L.value*E,P=L.y1+s;for(const H of L.sourceLinks)H.width=H.value*E}P=(i-P+s)/(N.length+1);for(let L=0;L<N.length;++L){const H=N[L];H.y0+=P*(L+1),H.y1+=P*(L+1)}q(N)}}function C(_){const E=I(_);s=Math.min(a,(i-e)/(wu(E,N=>N.length)-1)),b(E);for(let N=0;N<m;++N){const P=Math.pow(.99,N),L=Math.max(1-P,(N+1)/m);F(E,P,L),$(E,P,L)}}function $(_,E,N){for(let P=1,L=_.length;P<L;++P){const H=_[P];for(const Z of H){let rt=0,ot=0;for(const{source:tt,value:st}of Z.targetLinks){let ht=st*(Z.layer-tt.layer);rt+=W(tt,Z)*ht,ot+=ht}if(!(ot>0))continue;let at=(rt/ot-Z.y0)*E;Z.y0+=at,Z.y1+=at,O(Z)}u===void 0&&H.sort(Ar),B(H,N)}}function F(_,E,N){for(let P=_.length,L=P-2;L>=0;--L){const H=_[L];for(const Z of H){let rt=0,ot=0;for(const{target:tt,value:st}of Z.sourceLinks){let ht=st*(tt.layer-Z.layer);rt+=M(Z,tt)*ht,ot+=ht}if(!(ot>0))continue;let at=(rt/ot-Z.y0)*E;Z.y0+=at,Z.y1+=at,O(Z)}u===void 0&&H.sort(Ar),B(H,N)}}function B(_,E){const N=_.length>>1,P=_[N];G(_,P.y0-s,N-1,E),U(_,P.y1+s,N+1,E),G(_,i,_.length-1,E),U(_,e,0,E)}function U(_,E,N,P){for(;N<_.length;++N){const L=_[N],H=(E-L.y0)*P;H>1e-6&&(L.y0+=H,L.y1+=H),E=L.y1+s}}function G(_,E,N,P){for(;N>=0;--N){const L=_[N],H=(L.y1-E)*P;H>1e-6&&(L.y0-=H,L.y1-=H),E=L.y0-s}}function O({sourceLinks:_,targetLinks:E}){if(d===void 0){for(const{source:{sourceLinks:N}}of E)N.sort(Eu);for(const{target:{targetLinks:N}}of _)N.sort(bu)}}function q(_){if(d===void 0)for(const{sourceLinks:E,targetLinks:N}of _)E.sort(Eu),N.sort(bu)}function W(_,E){let N=_.y0-(_.sourceLinks.length-1)*s/2;for(const{target:P,width:L}of _.sourceLinks){if(P===E)break;N+=L+s}for(const{source:P,width:L}of E.targetLinks){if(P===_)break;N-=L}return N}function M(_,E){let N=E.y0-(E.targetLinks.length-1)*s/2;for(const{source:P,width:L}of E.targetLinks){if(P===_)break;N+=L+s}for(const{target:P,width:L}of _.sourceLinks){if(P===E)break;N-=L}return N}return v}var Aa=Math.PI,Ma=2*Aa,Ee=1e-6,q_=Ma-Ee;function Ta(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ef(){return new Ta}Ta.prototype=ef.prototype={constructor:Ta,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,s=this._y1,c=n-t,f=i-e,u=a-t,d=s-e,p=u*u+d*d;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(p>Ee)if(!(Math.abs(d*c-f*u)>Ee)||!r)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var g=n-a,m=i-s,v=c*c+f*f,A=g*g+m*m,S=Math.sqrt(v),w=Math.sqrt(p),k=r*Math.tan((Aa-Math.acos((v+p-A)/(2*S*w)))/2),I=k/w,b=k/S;Math.abs(I-1)>Ee&&(this._+="L"+(t+I*u)+","+(e+I*d)),this._+="A"+r+","+r+",0,0,"+ +(d*g>u*m)+","+(this._x1=t+b*c)+","+(this._y1=e+b*f)}},arc:function(t,e,n,i,r,a){t=+t,e=+e,n=+n,a=!!a;var s=n*Math.cos(i),c=n*Math.sin(i),f=t+s,u=e+c,d=1^a,p=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+f+","+u:(Math.abs(this._x1-f)>Ee||Math.abs(this._y1-u)>Ee)&&(this._+="L"+f+","+u),n&&(p<0&&(p=p%Ma+Ma),p>q_?this._+="A"+n+","+n+",0,1,"+d+","+(t-s)+","+(e-c)+"A"+n+","+n+",0,1,"+d+","+(this._x1=f)+","+(this._y1=u):p>Ee&&(this._+="A"+n+","+n+",0,"+ +(p>=Aa)+","+d+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function Tu(t){return function(){return t}}function V_(t){return t[0]}function j_(t){return t[1]}var W_=Array.prototype.slice;function U_(t){return t.source}function G_(t){return t.target}function Y_(t){var e=U_,n=G_,i=V_,r=j_,a=null;function s(){var c,f=W_.call(arguments),u=e.apply(this,f),d=n.apply(this,f);if(a||(a=c=ef()),t(a,+i.apply(this,(f[0]=u,f)),+r.apply(this,f),+i.apply(this,(f[0]=d,f)),+r.apply(this,f)),c)return a=null,c+""||null}return s.source=function(c){return arguments.length?(e=c,s):e},s.target=function(c){return arguments.length?(n=c,s):n},s.x=function(c){return arguments.length?(i=typeof c=="function"?c:Tu(+c),s):i},s.y=function(c){return arguments.length?(r=typeof c=="function"?c:Tu(+c),s):r},s.context=function(c){return arguments.length?(a=c??null,s):a},s}function X_(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,r,i,r)}function K_(){return Y_(X_)}function Z_(t){return[t.source.x1,t.y0]}function J_(t){return[t.target.x0,t.y1]}function Q_(){return K_().source(Z_).target(J_)}const Lu="sankey",Je="sankey-tooltip",Jo="sankey-barplot",t1="sankey-barplot-svg",e1=.8,n1="center",i1=t=>t.id.split(/\W/)[0],r1=15,o1=10,a1=1,s1=1,l1=5,u1=5,c1=",",f1="currentColor",d1=.5,h1=1.5,p1="round",ku=.5,g1="multiply",v1=Q_(),Nu=6,Iu="#aaaaaa",On=500,nf=t=>({bourg:"#2081C3",place_st_francois:"#2081C3",chailly:"#289e61",grange_neuve:"#289e61",la_sallaz:"#289e61",ouchy:"#289e61",barre:"#725AC1",cite_derriere:"#725AC1",cite_dessous:"#725AC1",cheneau_de_bourg:"#F4743B",montee_st_francois:"#F4743B",rue_du_pont:"#F4743B",ale:"#F4B860",grand_st_jean:"#F4B860",montee_de_st_laurent:"#F4B860",palud:"#F4B860",st_laurent:"#F4B860",marterey:"#9E2846",affaires_division:"#2081C3",campagne_division:"#289e61",cathedrale_division:"#725AC1",centre_division:"#F4743B",commerce_division:"#F4B860",culture_division:"#9E2846",administration:"#cccccc",agricole:"#cccccc",artisanat:"#cccccc",commerce:"#cccccc",construction:"#cccccc",rente:"#cccccc",service:"#cccccc",hors_lausanne:"#333333",lausanne:"#cccccc"})[t]??"#aaaaaa",La=t=>({bourg:"Bourg",place_st_francois:"Place St-François",chailly:"Chailly",grange_neuve:"Grange-Neuve",la_sallaz:"La Sallaz",ouchy:"Ouchy",barre:"Barre",cite_derriere:"Cité Derrière",cite_dessous:"Cité Dessous",cheneau_de_bourg:"Cheneau-de-Bourg",montee_st_francois:"Montée St-François",rue_du_pont:"Rue du Pré",ale:"Ale",grand_st_jean:"Grand St-Jean",montee_de_st_laurent:"Montée de St-Laurent",palud:"Palud",st_laurent:"St-Laurent",marterey:"Marterey",affaires_division:"Affaires",campagne_division:"Campagne",cathedrale_division:"Cathédrale",centre_division:"Centre",commerce_division:"Commerce",culture_division:"Culture",administration:"Administration",agricole:"Agricole",artisanat:"Artisanat",commerce:"Commerce",construction:"Construction",rente:"Rente",service:"Service",hors_lausanne:"Hors Lausanne",lausanne:"Lausanne"})[t]??t;class m1{constructor(e,n){it(this,"dataPath");it(this,"uid");it(this,"width");it(this,"height");it(this,"data");it(this,"links");it(this,"nodes");it(this,"N");it(this,"G");it(this,"nodeAlign");it(this,"color");it(this,"format");it(this,"svg");it(this,"node");it(this,"link");this.dataPath=e,this.sankeyBarPlot=n,this.uid=`O-${Math.random().toString(16).slice(2)}`,this.loadData().then(()=>{this.initDimensions(),this.initNodeAlign(),this.initGraph(),this.initColor(),this.computeSankeyLayout(),this.initSvgElements()})}loadData(){return new Promise(e=>{Te(this.dataPath).then(n=>{this.data=n,e()})})}initDimensions(){const e=document.getElementById(Lu);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=n,this.height=n}}initNodeAlign(){this.nodeAlign={left:O_,right:R_,center:z_}[n1]??tf}initGraph(){const e=ae(this.data,({source:r})=>r),n=ae(this.data,({target:r})=>r),i=ae(this.data,({value:r})=>r);this.nodes=Array.from(Hh(e,n),r=>({id:r})),this.N=ae(this.nodes,r=>r.id),this.G=ae(this.nodes,i1),this.nodes=ae(this.nodes,(r,a)=>({id:this.N[a]})),this.links=ae(this.data,(r,a)=>({source:e[a],target:n[a],value:i[a]}))}initColor(){this.color=nf}computeSankeyLayout(){H_().nodeId(({index:e})=>this.N[e]).nodeAlign(this.nodeAlign).nodeWidth(r1).nodePadding(o1).extent([[a1,l1],[this.width-s1,this.height-u1]])({nodes:this.nodes,links:this.links})}initSvgElements(){this.format=Ha(c1);const e=this.N;ae(this.nodes,n=>`${n.id}
${this.format(n.value)}`),ae(this.links,n=>`${n.source.id} → ${n.target.id}
${this.format(n.value)}`),this.svg=Q(`#${Lu}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this.node=this.svg.append("g").attr("stroke",f1).attr("stroke-width",h1).attr("stroke-opacity",d1).attr("stroke-linejoin",p1).selectAll("rect").data(this.nodes).join("rect").attr("id",n=>n.id).attr("class",n=>"sankey-rect").attr("x",n=>n.x0).attr("y",n=>n.y0).attr("height",n=>n.y1-n.y0).attr("width",n=>n.x1-n.x0),this.node.on("mouseover",(n,i)=>{Ci(".sankey-rect").style("fill",Iu),Ci(".sankey-path").style("stroke",Iu),Q(`#${i.id}`).style("fill",a=>this.color(a.id)),i.sourceLinks.forEach(a=>Q(`#${a.target.id}`).style("fill",s=>this.color(s.id))),i.targetLinks.forEach(a=>Q(`#${a.source.id}`).style("fill",s=>this.color(s.id))),i.sourceLinks.forEach(a=>Q(`#${a.source.id}-${a.target.id}`).style("stroke",s=>this.color(s.source.id))),i.targetLinks.forEach(a=>Q(`#${a.source.id}-${a.target.id}`).style("stroke",s=>this.color(s.source.id)));const r=Q(`#${Je}`);r.style("visibility","visible"),r.html(`${i.value}`)}).on("mouseout",(n,i)=>{Ci(".sankey-rect").style("fill",a=>this.color(a.id)),Ci(".sankey-path").style("stroke",a=>this.color(a.source.id)),Q(`#${Je}`).style("visibility","hidden")}).on("mousemove",n=>{Q(`#${Je}`).style("top",n.pageY-10+"px").style("left",n.pageX+10+"px")}).on("click",(n,i)=>{this.updateBarChart(i)}),this.G&&this.node.attr("fill",({index:n})=>this.color(this.G[n])),this.link=this.svg.append("g").attr("fill","none").attr("stroke-opacity",ku).selectAll("g").data(this.links).join("g").style("mix-blend-mode",g1),this.link.append("path").attr("d",v1).attr("id",n=>`${n.source.id}-${n.target.id}`).attr("class",n=>"sankey-path").attr("stroke",({source:{index:n}})=>this.color(this.G[n])).attr("stroke-width",({width:n})=>Math.max(1,n)),this.link.on("mouseover",function(n,i){Q(this).style("stroke-opacity",e1);const r=Q(`#${Je}`);r.style("visibility","visible"),r.html(`${i.value}`)}).on("mouseout",n=>{this.link.style("stroke-opacity",ku),Q(`#${Je}`).style("visibility","hidden")}).on("mousemove",n=>{Q(`#${Je}`).style("top",n.pageY-10+"px").style("left",n.pageX+10+"px")}),e&&this.svg.append("g").attr("font-family","sans-serif").attr("font-size",10).selectAll("text").data(this.nodes).join("text").attr("x",n=>n.x0<this.width/2?n.x1+Nu:n.x0-Nu).attr("y",n=>(n.y1+n.y0)/2).attr("dy","0.35em").attr("text-anchor",n=>n.x0<this.width/2?"start":"end").attr("pointer-events","none").text(({index:n})=>La(e[n]))}updateBarChart(e){const n=e.targetLinks.map(i=>({id:i.source.id,value:i.value}));n.length!==0&&this.sankeyBarPlot.drawBarPlot(n)}}class y1{constructor(){it(this,"width");it(this,"height");it(this,"svg");this.initDimensions(),this.initColor()}initDimensions(){const e=document.getElementById(Jo);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=n,this.height=n}}initColor(){this.color=nf}drawBarPlot(e){const n={top:10,right:30,bottom:100,left:50},i=this.width-n.left-n.right,r=this.height-n.top-n.bottom;let a=Q(`#${Jo}`).select("svg"),s;if(a.empty()){a=Q(`#${Jo}`).append("svg").attr("id",t1).attr("width",this.width).attr("height",this.height);let m=(this.width-i)/2,v=(this.height-r)/2;s=a.append("g").attr("transform",`translate(${m},${v})`).append("g").attr("class","bars")}else s=a.select(".bars");e.sort((m,v)=>ka(m.value,v.value));const c=Ua().range([0,i]).domain(e.map(m=>m.id)).padding(.2),f=zt().domain([0,Na(e,m=>m.value)]).range([r,0]);let u=s.select(".x-axis");u.empty()?u=s.append("g").attr("class","x-axis").attr("transform",`translate(0,${r})`).call(Ne(c).tickFormat(m=>La(m))):u.transition().duration(On).call(Ne(c).tickFormat(m=>La(m)));let d=s.select(".y-axis");d.empty()?d=s.append("g").attr("class","y-axis").call(Un(f)):d.transition().duration(On).call(Un(f));const p=s.selectAll(".sankey-bar").data(e,m=>m.id);p.exit().transition().duration(On).attr("height",0).attr("y",f(0)).remove(),p.transition().duration(On).attr("x",m=>c(m.id)).attr("width",c.bandwidth()).attr("y",m=>f(m.value)).attr("height",m=>r-f(m.value)),p.enter().append("rect").attr("class","sankey-bar").attr("x",m=>c(m.id)).attr("width",c.bandwidth()).attr("y",f(0)).attr("height",0).attr("fill",m=>this.color(m.id)).transition().duration(On).attr("height",m=>r-f(m.value)).attr("y",m=>f(m.value))}}const Cu="stats-plot",_1="data/stats/",x1=".json",Et={top:20,right:20,bottom:50,left:60},S1=[],Xi=.5,Du="#777777",Pu="#9e2846";class w1{constructor(){it(this,"width");it(this,"height");it(this,"statsFeatures");it(this,"data");it(this,"svg");this.statsFeatures=S1,this.loadData().then(()=>{this.initDimensions(),this.initSvgElements(),this.drawPlot()})}updatePlot(e){this.statsFeatures=e,this.loadData().then(()=>{this.drawPlot()})}initDimensions(){const e=document.getElementById(Cu);e&&(this.width=e.clientWidth,this.height=e.clientHeight)}async loadData(){return new Promise(e=>{const n=this.statsFeatures.sort().join("_");Te(`${_1}stats_${n}${x1}`).then(i=>{this.data=i,e()})})}initSvgElements(){const e=Q(`#${Cu}`);this.svg=e.append("svg").attr("width",this.width).attr("height",this.height).append("g").attr("transform",`translate(${Et.left}, ${Et.top})`),this.svg.append("g").attr("class","x axis"),this.svg.append("g").attr("class","y axis")}drawPlot(){const e=zt().domain(Ih(this.data.xs)).range([0,this.width-Et.left-Et.right]),n=Math.max(...this.data.non_permuted_ys,...this.data.permuted_ys),i=zt().domain([0,n==0?1e3:n]).range([this.height-Et.top-Et.bottom,0]),r=Ne(e),a=Un(i);this.svg.select(".x.axis").attr("transform",`translate(0, ${this.height-Et.top-Et.bottom})`).call(r),this.svg.select(".y.axis").transition().duration(750).call(a);const s=[];this.data.xs.forEach((u,d)=>{s.push({x:u,y:this.data.non_permuted_ys[d],type:"non_permuted",key:`non_permuted-${d}`}),s.push({x:u,y:this.data.permuted_ys[d],type:"permuted",key:`permuted-${d}`})});const c=this.svg.selectAll(".bar").data(s,u=>u.key);c.exit().each(function(){Q(this).selectAll("rect").transition().duration(750).attr("y",i(0)).attr("height",0)}).transition().delay(750).remove(),c.select("rect.non_permuted").transition().duration(750).attr("y",u=>i(u.y)).attr("height",u=>this.height-Et.top-Et.bottom-i(u.y)).attr("fill",Pu).attr("opacity",Xi),c.select("rect.permuted").transition().duration(750).attr("y",u=>i(u.y)).attr("height",u=>this.height-Et.top-Et.bottom-i(u.y)).attr("fill",Du).attr("opacity",Xi);const f=c.enter().append("g").attr("class","bar");f.filter(u=>u.type==="non_permuted").append("rect").attr("class","non_permuted").attr("x",u=>e(u.x)).attr("width",(u,d)=>d<this.data.xs.length-1?e(this.data.xs[d+1])-e(u.x):e(this.data.xs[d])-e(this.data.xs[d-1])).attr("y",i(0)).attr("height",0).transition().duration(750).attr("y",u=>i(u.y)).attr("height",u=>this.height-Et.top-Et.bottom-i(u.y)).attr("fill",Pu).attr("opacity",Xi),f.filter(u=>u.type==="permuted").append("rect").attr("class","permuted").attr("x",u=>e(u.x)).attr("width",(u,d)=>d<this.data.xs.length-1?e(this.data.xs[d+1])-e(u.x):e(this.data.xs[d])-e(this.data.xs[d-1])).attr("y",i(0)).attr("height",0).transition().duration(750).attr("y",u=>i(u.y)).attr("height",u=>this.height-Et.top-Et.bottom-i(u.y)).attr("fill",Du).attr("opacity",Xi)}}var b1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function E1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rf={exports:{}};/*!
* fullPage 4.0.19
* https://github.com/alvarotrigo/fullPage.js
*
* @license GPLv3 for open source use only
* or Fullpage Commercial License for commercial use
* http://alvarotrigo.com/fullPage/pricing/
*
* Copyright (C) 2018 http://alvarotrigo.com/fullPage - A project by Alvaro Trigo
*/(function(t,e){(function(n,i){t.exports=i()})(b1,function(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(l){if(this==null)throw new TypeError('"this" is null or not defined');var h=Object(this),y=h.length>>>0;if(typeof l!="function")throw new TypeError("predicate must be a function");for(var T=arguments[1],D=0;D<y;){var R=h[D];if(l.call(T,R,D,h))return R;D++}}}),Array.from||(Array.from=function(){var o=Object.prototype.toString,l=function(R){return typeof R=="function"||o.call(R)==="[object Function]"},h=function(R){var V=Number(R);return isNaN(V)?0:V===0||!isFinite(V)?V:(V>0?1:-1)*Math.floor(Math.abs(V))},y=Math.pow(2,53)-1,T=function(R){var V=h(R);return Math.min(Math.max(V,0),y)};return function(R){var V=this,et=Object(R);if(R==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");var ut=arguments.length>1?arguments[1]:void 0,ct;if(typeof ut<"u"){if(!l(ut))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(ct=arguments[2])}for(var pt=T(et.length),Mt=l(V)?Object(new V(pt)):new Array(pt),Bt=0,Rt;Bt<pt;)Rt=et[Bt],ut?Mt[Bt]=typeof ct>"u"?ut(Rt,Bt):ut.call(ct,Rt,Bt):Mt[Bt]=Rt,Bt+=1;return Mt.length=pt,Mt}}());var n=window,i=document,r=navigator.userAgent.match(/(iPhone|iPod|iPad|Android|playbook|silk|BlackBerry|BB10|Windows Phone|Tizen|Bada|webOS|IEMobile|Opera Mini)/),a=/(Mac|iPhone|iPod|iPad)/i.test(n.navigator.userAgent),s="ontouchstart"in n||navigator.msMaxTouchPoints>0||navigator.maxTouchPoints,c=!!window.MSInputMethodContext&&!!document.documentMode,f='a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]',u={test:{},shared:{}},d=["parallax","scrollOverflowReset","dragAndMove","offsetSections","fadingEffect","responsiveSlides","continuousHorizontal","interlockedSlides","scrollHorizontally","resetSliders","cards","dropEffect","waterEffect"];n.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(o,l){l=l||window;for(var h=0;h<this.length;h++)o.call(l,this[h],h,this)}),typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(l,h){if(l==null)throw new TypeError("Cannot convert undefined or null to object");for(var y=Object(l),T=1;T<arguments.length;T++){var D=arguments[T];if(D!=null)for(var R in D)Object.prototype.hasOwnProperty.call(D,R)&&(y[R]=D[R])}return y},writable:!0,configurable:!0}),String.prototype.padStart||(String.prototype.padStart=function(l,h){return l=l>>0,h=String(typeof h<"u"?h:" "),this.length>l?String(this):(l=l-this.length,l>h.length&&(h+=Array.apply(null,Array(l)).map(function(){return h}).join("")),h.slice(0,l)+String(this))});function p(o,l){n.console&&n.console[o]&&n.console[o]("fullPage: "+l)}function g(o){var l=n.getComputedStyle(o);return l.display!=="none"}function m(o){return Array.from(o).filter(function(l){return g(l)})}function v(o,l){return l=arguments.length>1?l:document,l?l.querySelectorAll(o):null}function A(o){o=o||{};for(var l=1,h=arguments.length;l<h;++l){var y=arguments[l];if(y){for(var T in y)if(!(!y.hasOwnProperty(T)||T=="__proto__"||T=="constructor")){if(Object.prototype.toString.call(y[T])==="[object Object]"){o[T]=A(o[T],y[T]);continue}o[T]=y[T]}}}return o}function S(o,l){return o==null?!1:o.classList.contains(l)}function w(){return"innerHeight"in n?n.innerHeight:i.documentElement.offsetHeight}function k(){return n.innerWidth}function I(o,l){o=B(o);var h;for(h in l)if(l.hasOwnProperty(h)&&h!==null)for(var y=0;y<o.length;y++){var T=o[y];T.style[h]=l[h]}return o}function b(o){return o.previousElementSibling}function C(o){return o.nextElementSibling}function $(o){return o[o.length-1]}function F(o,l){o=O(o)?o[0]:o;for(var h=l!=null?v(l,o.parentNode):o.parentNode.childNodes,y=0,T=0;T<h.length;T++){if(h[T]==o)return y;h[T].nodeType==1&&y++}return-1}function B(o){return O(o)?o:[o]}function U(o){o=B(o);for(var l=0;l<o.length;l++)o[l].style.display="none";return o}function G(o){o=B(o);for(var l=0;l<o.length;l++)o[l].style.display="block";return o}function O(o){return Object.prototype.toString.call(o)==="[object Array]"||Object.prototype.toString.call(o)==="[object NodeList]"}function q(o,l){o=B(o);for(var h=0;h<o.length;h++){var y=o[h];y.classList.add(l)}return o}function W(o,l){o=B(o);for(var h=l.split(" "),y=0;y<h.length;y++){l=h[y];for(var T=0;T<o.length;T++){var D=o[T];D.classList.remove(l)}}return o}function M(o,l){l.appendChild(o)}function _(o,l,h){var y;l=l||i.createElement("div");for(var T=0;T<o.length;T++){var D=o[T];(h&&!T||!h)&&(y=l.cloneNode(!0),D.parentNode.insertBefore(y,D)),y.appendChild(D)}return o}function E(o,l){_(o,l,!0)}function N(o,l){for(o.appendChild(l);o.firstChild!==l;)l.appendChild(o.firstChild)}function P(o){for(var l=i.createDocumentFragment();o.firstChild;)l.appendChild(o.firstChild);o.parentNode.replaceChild(l,o)}function L(o,l){return o&&o.nodeType===1?wt(o,l)?o:L(o.parentNode,l):null}function H(o,l){rt(o,o.nextSibling,l)}function Z(o,l){rt(o,o,l)}function rt(o,l,h){O(h)||(typeof h=="string"&&(h=me(h)),h=[h]);for(var y=0;y<h.length;y++)o.parentNode.insertBefore(h[y],l)}function ot(){var o=i.documentElement;return(n.pageYOffset||o.scrollTop)-(o.clientTop||0)}function at(o){return Array.prototype.filter.call(o.parentNode.children,function(l){return l!==o})}function tt(o){o.preventDefault()}function st(o,l){return o.getAttribute(l)}function ht(o,l,h){i.addEventListener(o,l,h==="undefined"?null:h)}function xt(o,l,h){n.addEventListener(o,l,h==="undefined"?null:h)}function It(o,l,h){i.removeEventListener(o,l,h==="undefined"?null:h)}function Re(o,l,h){n.removeEventListener(o,l,h==="undefined"?null:h)}function St(o){if(typeof o=="function")return!0;var l=Object.prototype.toString.call(o);return l==="[object Function]"||l==="[object GeneratorFunction]"}function fn(o,l,h){var y;h=typeof h>"u"?{}:h,typeof n.CustomEvent=="function"?y=new CustomEvent(l,{detail:h}):(y=i.createEvent("CustomEvent"),y.initCustomEvent(l,!0,!0,h)),o.dispatchEvent(y)}function wt(o,l){return(o.matches||o.matchesSelector||o.msMatchesSelector||o.mozMatchesSelector||o.webkitMatchesSelector||o.oMatchesSelector).call(o,l)}function ii(o,l){if(typeof l=="boolean")for(var h=0;h<o.length;h++)o[h].style.display=l?"block":"none";return o}function me(o){var l=i.createElement("div");return l.innerHTML=o.trim(),l.firstChild}function ye(o){o=B(o);for(var l=0;l<o.length;l++){var h=o[l];h&&h.parentElement&&h.parentNode.removeChild(h)}}function ri(o,l,h){for(var y=o[h],T=[];y;)(wt(y,l)||l==null)&&T.push(y),y=y[h];return T}function Dr(o,l){return ri(o,l,"nextElementSibling")}function Pr(o,l){return ri(o,l,"previousElementSibling")}function Ya(o){return Object.keys(o).map(function(l){return o[l]})}function Gt(o){return o[o.length-1]}function dn(o,l){for(var h=0,y=o.slice(Math.max(o.length-l,1)),T=0;T<y.length;T++)h=h+y[T];return Math.ceil(h/l)}function oi(o,l){o.setAttribute(l,st(o,"data-"+l)),o.removeAttribute("data-"+l)}function Xa(o,l){var h=[o];do o=o.parentNode,h.push(o);while(!wt(o,l));return h}function Or(){var o=i.activeElement;return wt(o,"textarea")||wt(o,"input")||wt(o,"select")||st(o,"contentEditable")=="true"||st(o,"contentEditable")==""}window.fp_utils={$:v,deepExtend:A,hasClass:S,getWindowHeight:w,css:I,prev:b,next:C,last:$,index:F,getList:B,hide:U,show:G,isArrayOrList:O,addClass:q,removeClass:W,appendTo:M,wrap:_,wrapAll:E,unwrap:P,closest:L,after:H,before:Z,insertBefore:rt,getScrollTop:ot,siblings:at,preventDefault:tt,isFunction:St,trigger:fn,matches:wt,toggle:ii,createElementFromHTML:me,remove:ye,untilAll:ri,nextAll:Dr,prevAll:Pr,showError:p};var Ka=Object.freeze({__proto__:null,showError:p,isVisible:g,getVisible:m,$:v,deepExtend:A,hasClass:S,getWindowHeight:w,getWindowWidth:k,css:I,prev:b,next:C,last:$,index:F,getList:B,hide:U,show:G,isArrayOrList:O,addClass:q,removeClass:W,appendTo:M,wrap:_,wrapAll:E,wrapInner:N,unwrap:P,closest:L,after:H,before:Z,insertBefore:rt,getScrollTop:ot,siblings:at,preventDefault:tt,getAttr:st,docAddEvent:ht,windowAddEvent:xt,docRemoveEvent:It,windowRemoveEvent:Re,isFunction:St,trigger:fn,matches:wt,toggle:ii,createElementFromHTML:me,remove:ye,untilAll:ri,nextAll:Dr,prevAll:Pr,toArray:Ya,getLast:Gt,getAverage:dn,setSrc:oi,getParentsUntil:Xa,isInsideInput:Or});function ze(o){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ze=function(l){return typeof l}:ze=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},ze(o)}var Y={events:{},on:function(l,h){var y=this;return ze(this.events[l])!=="object"&&(this.events[l]=[]),this.events[l].push(h),function(){return y.removeListener(l,h)}},removeListener:function(l,h){if(ze(this.events[l])==="object"){var y=this.events[l].indexOf(h);y>-1&&this.events[l].splice(y,1)}},emit:function(l){for(var h=this,y=arguments.length,T=new Array(y>1?y-1:0),D=1;D<y;D++)T[D-1]=arguments[D];ze(this.events[l])==="object"&&this.events[l].forEach(function(R){return R.apply(h,T)})},once:function(l,h){var y=this,T=this.on(l,function(){T();for(var D=arguments.length,R=new Array(D),V=0;V<D;V++)R[V]=arguments[V];h.apply(y,R)})}},z={numSections:0,numSlides:0,slides:[],sections:[],activeSection:null,scrollTrigger:null,isBeyondFullpage:!1,aboutToScrollToFullPage:!1,slideMoving:!1,isResizing:!1,isScrolling:!1,lastScrolledDestiny:void 0,lastScrolledSlide:void 0,activeAnimation:!1,canScroll:!0,touchDirection:"none",wheelDirection:"none",isGrabbing:!1,isUsingWheel:!1,isWindowFocused:!0,previousDestTop:0,windowsHeight:w(),isDoingContinousVertical:!1,timeouts:{},scrollY:0,scrollX:0};n.state=z;function K(o){Object.assign(z,o)}function j(){return z}function of(){return z.activeSection&&z.activeSection.activeSlide?z.activeSection.activeSlide:z.activeSection}var X={onAfterRenderNoAnchor:"onAfterRenderNoAnchor",onClickOrTouch:"onClickOrTouch",moveSlideLeft:"moveSlideLeft",moveSlideRight:"moveSlideRight",onInitialise:"onInitialise",beforeInit:"beforeInit",bindEvents:"bindEvents",onDestroy:"onDestroy",contentChanged:"contentChanged",onScrollOverflowScrolled:"onScrollOverflowScrolled",onScrollPageAndSlide:"onScrollPageAndSlide",onKeyDown:"onKeyDown",onMenuClick:"onMenuClick",scrollPage:"scrollPage",landscapeScroll:"landscapeScroll",scrollBeyondFullpage:"scrollBeyondFullpage",onPerformMovement:"onPerformMovement",onSlideLeave:"onSlideLeave",onLeave:"onLeave",afterSectionLoads:"afterSectionLoads",afterSlideLoads:"afterSlideLoads"};Y.on(X.bindEvents,af);function af(){["click","touchstart"].forEach(function(o){ht(o,Za)}),xt("focus",uf),sf()}function sf(){Y.on(X.onDestroy,lf)}function Za(o){Y.emit(X.onClickOrTouch,{e:o,target:o.target})}function lf(){["click","touchstart"].forEach(function(o){It(o,Za)})}function uf(){K({isWindowFocused:!0})}var Ja="fullpage-wrapper",_e="."+Ja,ai="fp-responsive",Rr="fp-notransition",zr="fp-destroyed",si="fp-enabled",$r="fp-viewing",ft="active",$e="."+ft,de="fp-completely",cf="."+de,ff=".section",li="fp-section",Ct="."+li,Qa=Ct+$e,df="fp-tableCell",hf="."+df,ts="fp-auto-height",pf="."+ts,es="fp-auto-height-responsive",gf="."+es,vf="fp-normal-scroll",ns="fp-nav",Yt="#"+ns,is="fp-tooltip",mf="."+is,yf="fp-show-active",_f=".slide",Fr="fp-slide",ui="."+Fr,hn=ui+$e,pn="fp-slides",ie="."+pn,Br="fp-slidesContainer",ci="."+Br,Hr="fp-table",Fe="fp-overflow",gn="."+Fe,fi="fp-is-overflow",rs="fp-slidesNav",vn="."+rs,os=vn+" a",as="fp-arrow",ss="fp-controlArrow",Be="."+ss,qr="fp-prev",xf="."+qr,Vr=Be+xf,ls="fp-next",Sf="."+ls,us=Be+Sf,di={menu:!1,anchors:[],lockAnchors:!1,navigation:!1,navigationPosition:"right",navigationTooltips:[],showActiveTooltip:!1,slidesNavigation:!1,slidesNavPosition:"bottom",scrollBar:!1,hybrid:!1,licenseKey:"",credits:{enabled:!0,label:"Made with fullPage.js",position:"right"},css3:!0,scrollingSpeed:700,autoScrolling:!0,fitToSection:!0,fitToSectionDelay:600,easing:"easeInOutCubic",easingcss3:"ease",loopBottom:!1,loopTop:!1,loopHorizontal:!0,continuousVertical:!1,continuousHorizontal:!1,scrollHorizontally:!1,interlockedSlides:!1,dragAndMove:!1,offsetSections:!1,resetSliders:!1,fadingEffect:!1,normalScrollElements:null,scrollOverflow:!0,scrollOverflowReset:!1,touchSensitivity:5,touchWrapper:null,bigSectionsDestination:null,keyboardScrolling:!0,animateAnchor:!0,recordHistory:!0,allowCorrectDirection:!1,scrollOverflowMacStyle:!0,controlArrows:!0,controlArrowsHTML:['<div class="'+as+'"></div>','<div class="'+as+'"></div>'],controlArrowColor:"#fff",verticalCentered:!0,sectionsColor:[],paddingTop:0,paddingBottom:0,fixedElements:null,responsive:0,responsiveWidth:0,responsiveHeight:0,responsiveSlides:!1,parallax:!1,parallaxOptions:{type:"reveal",percentage:62,property:"translate"},cards:!1,cardsOptions:{perspective:100,fadeContent:!0,fadeBackground:!0},sectionSelector:ff,slideSelector:_f,afterLoad:null,beforeLeave:null,onLeave:null,afterRender:null,afterResize:null,afterReBuild:null,afterSlideLoad:null,onSlideLeave:null,afterResponsive:null,onScrollOverflow:null,lazyLoading:!0,observer:!0},mn=null,cs=!1,jr=A({},di),hi=null;function wf(){return cs}function bf(o){mn=o}function nt(o){return mn}function x(){return hi||di}function Ef(o){hi=A({},di,o),jr=Object.assign({},hi)}function He(){return jr}function Af(o,l){di[o]=l}function pi(o,l,h){hi[o]=l,h!=="internal"&&(jr[o]=l)}function fs(){if(!x().anchors.length){var o="[data-anchor]",l=v(x().sectionSelector.split(",").join(o+",")+o,mn);l.length&&l.length===v(x().sectionSelector,mn).length&&(cs=!0,l.forEach(function(T){x().anchors.push(st(T,"data-anchor").toString())}))}if(!x().navigationTooltips.length){var h="[data-tooltip]",y=v(x().sectionSelector.split(",").join(h+",")+h,mn);y.length&&y.forEach(function(T){x().navigationTooltips.push(st(T,"data-tooltip").toString())})}}var ds=function(l){this.anchor=l.anchor,this.item=l.item,this.index=l.index(),this.isLast=this.index===l.item.parentElement.querySelectorAll(l.selector).length-1,this.isFirst=!this.index,this.isActive=l.isActive},Xt=function(l,h){this.parent=this.parent||null,this.selector=h,this.anchor=st(l,"data-anchor")||x().anchors[F(l,x().sectionSelector)],this.item=l,this.isVisible=g(l),this.isActive=S(l,ft),this.hasScroll=S(l,Fe)||v(gn,l)[0]!=null,this.isSection=h===x().sectionSelector,this.container=L(l,ci)||L(l,_e),this.index=function(){return this.siblings().indexOf(this)}};Xt.prototype.siblings=function(){return this.isSection?this.isVisible?z.sections:z.sectionsIncludingHidden:this.parent?this.parent.slides:0},Xt.prototype.prev=function(){var o=this.siblings(),l=this.isSection?o.indexOf(this):this.parent.slides.indexOf(this),h=l-1;return h>=0?o[h]:null},Xt.prototype.next=function(){var o=this.siblings(),l=this.isSection?o.indexOf(this):this.parent.slides.indexOf(this),h=l+1;return h<o.length?o[h]:null},Xt.prototype.prevPanel=function(){return this.prev()||(this.parent?this.parent.prev():null)},Xt.prototype.nextPanel=function(){return this.next()||(this.parent?this.parent.next():null)},Xt.prototype.getSiblings=function(){return this.isSection?z.sections:z.panels};function Wr(o){return o.map(function(l){return l.item})}function Ur(o,l){return o.find(function(h){return h.item===l})}var hs=function(l){ds.call(this,l)},Mf=function(l){ds.call(this,l)};function xe(o){var l=v(hn,o);return l.length&&(o=l[0]),o}function ps(o){return o?o.activeSlide?o.activeSlide:o:null}function Tf(){return nt().getBoundingClientRect().bottom>=0}function qe(o){var l=x(),h,y;return l.autoScrolling&&!l.scrollBar?(h=-o,y=v(_e)[0]):(h=o,y=window),{options:h,element:y}}function gs(o,l){!x().autoScrolling||x().scrollBar||o.self!=window&&S(o,pn)?o.self!=window&&S(o,pn)?o.scrollLeft=l:o.scrollTo(0,l):o.style.top=l+"px"}function vs(o){var l="transform "+x().scrollingSpeed+"ms "+x().easingcss3;return W(o,Rr),I(o,{"-webkit-transition":l,transition:l})}function Gr(o,l){var h=o.index(),y=F(l,Ct);return h==y?"none":h>y?"up":"down"}function ms(o){return q(o,Rr)}function ys(o){return{"-webkit-transform":o,"-moz-transform":o,"-ms-transform":o,transform:o}}var _s;function xs(o,l){l?vs(nt()):ms(nt()),clearTimeout(_s),I(nt(),ys(o)),u.test.translate3d=o,_s=setTimeout(function(){W(nt(),Rr)},10)}function Ve(o){var l=Math.round(o);if(x().css3&&x().autoScrolling&&!x().scrollBar){var h="translate3d(0px, -"+l+"px, 0px)";xs(h,!1)}else if(x().autoScrolling&&!x().scrollBar)I(nt(),{top:-l+"px"}),u.test.top=-l+"px";else{var y=qe(l);gs(y.element,y.options)}}u.setScrollingSpeed=yn;function yn(o,l){pi("scrollingSpeed",o,l)}var vt=null,_n=null,gi=null;function Lf(){vt=v("body")[0],_n=v("html")[0],gi=v("html, body")}var xn;function vi(o,l,h,y){var T=kf(o),D=l-T,R=!1,V,et=z.activeAnimation;K({activeAnimation:!0}),xn&&window.cancelAnimationFrame(xn),xn=function(ct){V||(V=ct);var pt=Math.floor(ct-V);if(z.activeAnimation){var Mt=l;h&&(Mt=n.fp_easings[x().easing](pt,T,D,h)),pt<=h&&gs(o,Mt),pt<h?window.requestAnimationFrame(xn):typeof y<"u"&&!R&&(y(),K({activeAnimation:!1}),R=!0)}else!R&&!et&&(y(),K({activeAnimation:!1}),R=!0)},window.requestAnimationFrame(xn)}function kf(o){var l;return o.self!=n&&S(o,pn)?l=o.scrollLeft:!x().autoScrolling||x().scrollBar?l=ot():l=o.offsetTop,l}function Se(o){return o&&!o.item?new hs(new Ge(o)):o?new hs(o):null}function Yr(o){return o?new Mf(o):null}function Kt(o,l){var h=Nf(o,l);return fn(nt(),o,h),x()[o].apply(h[Object.keys(h)[0]],Ya(h))!==!1}function Nf(o,l){var h={afterRender:function(){return{section:Se(j().activeSection),slide:Yr(j().activeSection.activeSlide)}},onLeave:function(){return{origin:Se(l.items.origin),destination:Se(l.items.destination),direction:l.direction,trigger:j().scrollTrigger}},afterLoad:function(){return h.onLeave()},afterSlideLoad:function(){return{section:Se(l.items.section),origin:Se(l.items.origin),destination:Se(l.items.destination),direction:l.direction,trigger:j().scrollTrigger}},onSlideLeave:function(){return h.afterSlideLoad()},beforeLeave:function(){return h.onLeave()},onScrollOverflow:function(){return{section:Se(j().activeSection),slide:Yr(j().activeSection.activeSlide),position:l.position,direction:l.direction}}};return h[o]()}function mi(o){var l=xe(o);v("video, audio",l).forEach(function(h){h.hasAttribute("data-autoplay")&&typeof h.play=="function"&&h.play()}),v('iframe[src*="youtube.com/embed/"]',l).forEach(function(h){h.hasAttribute("data-autoplay")&&Ss(h),h.onload=function(){h.hasAttribute("data-autoplay")&&Ss(h)}})}function Ss(o){o.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}function Xr(o){var l=xe(o);v("video, audio",l).forEach(function(h){!h.hasAttribute("data-keepplaying")&&typeof h.pause=="function"&&h.pause()}),v('iframe[src*="youtube.com/embed/"]',l).forEach(function(h){/youtube\.com\/embed\//.test(st(h,"src"))&&!h.hasAttribute("data-keepplaying")&&h.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})}function If(){v('iframe[src*="youtube.com/embed/"]',nt()).forEach(function(o){Cf(o,"enablejsapi=1")})}function Cf(o,l){var h=st(o,"src");o.setAttribute("src",h+Df(h)+l)}function Df(o){return/\?/.test(o)?"&":"?"}function Sn(o){if(x().lazyLoading){var l=xe(o);v("img[data-src], img[data-srcset], source[data-src], source[data-srcset], video[data-src], audio[data-src], iframe[data-src]",l).forEach(function(h){if(["src","srcset"].forEach(function(T){var D=st(h,"data-"+T);D!=null&&D&&(oi(h,T),h.addEventListener("load",function(){}))}),wt(h,"source")){var y=L(h,"video, audio");y&&(y.load(),y.onloadeddata=function(){})}})}}function ws(){var o=j().activeSection.item,l=j().activeSection.activeSlide,h=bs(o),y=String(h);if(l){var T=bs(l.item);y=y+"-"+T}y=y.replace("/","-").replace("#","");var D=new RegExp("\\b\\s?"+$r+"-[^\\s]+\\b","g");vt.className=vt.className.replace(D,""),q(vt,$r+"-"+y)}function bs(o){if(!o)return null;var l=st(o,"data-anchor"),h=F(o);return l==null&&(l=h),l}function Kr(o,l,h){var y="";x().anchors.length&&!x().lockAnchors&&(o?(h!=null&&(y=h),l==null&&(l=o),K({lastScrolledSlide:l}),Zr(y+"/"+l)):(o!=null&&K({lastScrolledSlide:l}),Zr(h))),ws()}function Zr(o){if(x().recordHistory)location.hash=o;else if(r||s)n.history.replaceState(void 0,void 0,"#"+o);else{var l=n.location.href.split("#")[0];n.location.replace(l+"#"+o)}}function Es(o,l,h){var y=l==="Section"?x().anchors[o]:st(h,"data-anchor");return encodeURI(x().navigationTooltips[o]||y||l+" "+(o+1))}function Pf(o){tt(o),K({scrollTrigger:"horizontalNav"});var l=L(this,Ct),h=v(ie,L(this,Ct))[0],y=Ur(j().sections,l),T=y.slides[F(L(this,"li"))];Y.emit(X.landscapeScroll,{slides:h,destination:T.item})}function Of(o,l){x().slidesNavigation&&o!=null&&(W(v($e,o),ft),q(v("a",v("li",o)[l]),ft))}function Rf(o){var l=o.item,h=o.slides.length;M(me('<div class="'+rs+'"><ul></ul></div>'),l);var y=v(vn,l)[0];q(y,"fp-"+x().slidesNavPosition);for(var T=0;T<h;T++){var D=v(ui,l)[T];M(me('<li><a href="#"><span class="fp-sr-only">'+Es(T,"Slide",D)+"</span><span></span></a></li>"),v("ul",y)[0])}I(y,{"margin-left":"-"+y.innerWidth/2+"px"});var R=o.activeSlide?o.activeSlide.index():0;q(v("a",v("li",y)[R]),ft)}var we={};we.m={up:!0,down:!0,left:!0,right:!0},we.k=A({},we.m);function yi(o,l,h){l!=="all"?we[h][l]=o:Object.keys(we[h]).forEach(function(y){we[h][y]=o})}function bt(){return we}Y.on(X.onClickOrTouch,zf);function zf(o){var l=o.target;(wt(l,Be)||L(l,Be))&&$f.call(l,o)}function $f(){var o=L(this,Ct);S(this,qr)?bt().m.left&&(K({scrollTrigger:"slideArrow"}),Y.emit(X.moveSlideLeft,{section:o})):bt().m.right&&(K({scrollTrigger:"slideArrow"}),Y.emit(X.moveSlideRight,{section:o}))}function Ff(o){var l=o.item,h=[me(x().controlArrowsHTML[0]),me(x().controlArrowsHTML[1])];H(v(ie,l)[0],h),q(h,ss),q(h[0],qr),q(h[1],ls),x().controlArrowColor!=="#fff"&&(I(v(us,l),{"border-color":"transparent transparent transparent "+x().controlArrowColor}),I(v(Vr,l),{"border-color":"transparent "+x().controlArrowColor+" transparent transparent"})),x().loopHorizontal||U(v(Vr,l))}function Bf(o){!x().loopHorizontal&&x().controlArrows&&(ii(v(Vr,o.section),o.slideIndex!==0),ii(v(us,o.section),C(o.destiny)!=null))}u.setRecordHistory=Jr;function Jr(o,l){pi("recordHistory",o,l)}u.setAutoScrolling=je,u.test.setAutoScrolling=je;function je(o,l){o||Ve(0),pi("autoScrolling",o,l);var h=j().activeSection.item;if(x().autoScrolling&&!x().scrollBar)I(gi,{overflow:"hidden",height:"100%"}),W(vt,"fp-scrollable"),Jr(He().recordHistory,"internal"),I(nt(),{"-ms-touch-action":"none","touch-action":"none"}),h!=null&&Ve(h.offsetTop);else{I(gi,{overflow:"visible",height:"initial"}),q(vt,"fp-scrollable");var y=x().autoScrolling?He().recordHistory:!1;if(Jr(y,"internal"),I(nt(),{"-ms-touch-action":"","touch-action":""}),h!=null){var T=qe(h.offsetTop);T.element.scrollTo(0,T.options)}}}function Hf(o){K({isDoingContinousVertical:!0});var l=j().activeSection.item;return o.isMovementUp?Z(l,Dr(l,Ct)):H(l,Pr(l,Ct).reverse()),Ve(j().activeSection.item.offsetTop),qf(),o.wrapAroundElements=l,o.dtop=o.element.offsetTop,o.yMovement=Gr(j().activeSection,o.element),o}function qf(){for(var o=v(hn),l=0;l<o.length;l++)wi(o[l],"internal")}function Vf(){for(var o=v(hn),l=0;l<o.length;l++)wi(o[l],"internal")}function jf(o){o.wrapAroundElements!=null&&(o.isMovementUp?Z(v(Ct)[0],o.wrapAroundElements):H(v(Ct)[j().sections.length-1],o.wrapAroundElements),Ve(j().activeSection.item.offsetTop),Vf(),K({isDoingContinousVertical:!1}))}function As(){var o=v(pf)[0]||no()&&v(gf)[0];!x().lazyLoading||!o||v(Ct+":not("+$e+")").forEach(function(l){Wf(l)&&Sn(l)})}function Wf(o){var l=o.getBoundingClientRect(),h=l.top,y=l.bottom,T=2,D=h+T<z.windowsHeight&&h>0,R=y>T&&y<z.windowsHeight;return D||R}function Uf(){fn(b(this),"click")}function Gf(o,l){var h=v(Yt)[0];x().navigation&&h!=null&&h.style.display!=="none"&&(W(v($e,h),ft),q(o?v('a[href="#'+o+'"]',h):v("a",v("li",h)[l]),ft))}function Ms(){ye(v(Yt));var o=i.createElement("div");o.setAttribute("id",ns);var l=i.createElement("ul");o.appendChild(l),M(o,vt);var h=v(Yt)[0];q(h,"fp-"+x().navigationPosition),x().showActiveTooltip&&q(h,yf);for(var y="",T=0;T<j().sections.length;T++){var D=j().sections[T],R="";x().anchors.length&&(R=D.anchor),y+='<li><a href="#'+encodeURI(R)+'"><span class="fp-sr-only">'+Es(D.index(),"Section")+"</span><span></span></a>";var V=x().navigationTooltips[D.index()];typeof V<"u"&&V!==""&&(y+='<div class="'+is+" fp-"+x().navigationPosition+'">'+V+"</div>"),y+="</li>"}v("ul",h)[0].innerHTML=y;var et=v("li",v(Yt)[0])[j().activeSection.index()];q(v("a",et),ft)}function Yf(o){o.preventDefault&&tt(o),K({scrollTrigger:"verticalNav"});var l=F(L(this,Yt+" li"));Y.emit(X.scrollPage,{destination:j().sections[l]})}function Qr(o,l){Xf(o),Gf(o,l)}function Xf(o){x().menu&&x().menu.length&&v(x().menu).forEach(function(l){l!=null&&(W(v($e,l),ft),q(v('[data-menuanchor="'+o+'"]',l),ft))})}new Date().getTime();var Kf=function(){var o=!0,l=new Date().getTime(),h,y=!n.fullpage_api;return function(T,D){var R=new Date().getTime(),V=T==="wheel"?x().scrollingSpeed:100;return o=y||R-l>=V,y=!n.fullpage_api,o&&(h=D(),l=R),typeof h<"u"?h:!0}}();function Ts(o,l){if(St(x().beforeLeave)){var h=Kf(j().scrollTrigger,function(){return Kt(o,l)});return h}}u.moveTo=moveTo,u.getScrollY=function(){return z.scrollY};var wn,to;Y.on(X.onDestroy,Zf);function We(o,l,h){var y=o.item;if(y!=null){var T=Jf(y),D,R,V={element:y,callback:l,isMovementUp:h,dtop:T,yMovement:Gr(j().activeSection,y),anchorLink:o.anchor,sectionIndex:o.index(),activeSlide:o.activeSlide?o.activeSlide.item:null,leavingSection:j().activeSection.index()+1,localIsResizing:z.isResizing,items:{origin:j().activeSection,destination:o},direction:null};if(!(j().activeSection.item==y&&!z.isResizing||x().scrollBar&&ot()===V.dtop&&!S(y,ts))){if(V.activeSlide!=null&&(D=st(V.activeSlide,"data-anchor"),R=F(V.activeSlide,null)),!V.localIsResizing){var et=V.yMovement;if(typeof h<"u"&&(et=h?"up":"down"),V.direction=et,St(x().beforeLeave)&&Ts("beforeLeave",V)===!1||St(x().onLeave)&&!Kt("onLeave",V))return}x().autoScrolling&&x().continuousVertical&&typeof V.isMovementUp<"u"&&(!V.isMovementUp&&V.yMovement=="up"||V.isMovementUp&&V.yMovement=="down")&&(V=Hf(V)),V.localIsResizing||Xr(j().activeSection.item),q(y,ft),W(at(y),ft),re(),Sn(y),K({canScroll:u.test.isTesting}),Kr(R,D,V.anchorLink),Y.emit(X.onLeave,V),Qf(V),K({lastScrolledDestiny:V.anchorLink}),Qr(V.anchorLink,V.sectionIndex)}}}function Zf(){clearTimeout(wn),clearTimeout(to)}function Jf(o){var l=o.offsetHeight,h=o.offsetTop,y=h,T=h>z.previousDestTop,D=y-w()+l,R=x().bigSectionsDestination;return l>w()?(!T&&!R||R==="bottom")&&(y=D):(T||z.isResizing&&C(o)==null)&&(y=D),K({previousDestTop:y}),y}function Qf(o){var l=x().scrollingSpeed<700,h=l?700:x().scrollingSpeed;if(K({touchDirection:"none",scrollY:Math.round(o.dtop)}),Y.emit(X.onPerformMovement),x().css3&&x().autoScrolling&&!x().scrollBar){var y="translate3d(0px, -"+Math.round(o.dtop)+"px, 0px)";xs(y,!0),x().scrollingSpeed?(clearTimeout(wn),wn=setTimeout(function(){_i(o),K({canScroll:!l||u.test.isTesting})},x().scrollingSpeed)):_i(o)}else{var T=qe(o.dtop);u.test.top=-o.dtop+"px",clearTimeout(wn),vi(T.element,T.options,x().scrollingSpeed,function(){x().scrollBar?wn=setTimeout(function(){_i(o)},30):(_i(o),K({canScroll:!l||u.test.isTesting}))})}l&&(clearTimeout(to),to=setTimeout(function(){K({canScroll:!0})},h))}function _i(o){K({isBeyondFullpage:!1}),jf(o),St(x().afterLoad)&&!o.localIsResizing&&Kt("afterLoad",o),re(),o.localIsResizing||mi(o.element),q(o.element,de),W(at(o.element),de),As(),K({canScroll:!0}),Y.emit(X.afterSectionLoads,o),St(o.callback)&&o.callback()}u.setFitToSection=eo,u.fitToSection=Ls;function eo(o,l){pi("fitToSection",o,l)}function Ls(){z.canScroll&&(K({isResizing:!0}),We(z.activeSection),K({isResizing:!1}))}u.setResponsive=xi;function ks(){var o=x().responsive||x().responsiveWidth,l=x().responsiveHeight,h=o&&n.innerWidth<o,y=l&&n.innerHeight<l;o&&l?xi(h||y):o?xi(h):l&&xi(y)}function xi(o){var l=no();o?l||(je(!1,"internal"),eo(!1,"internal"),U(v(Yt)),q(vt,ai),St(x().afterResponsive)&&x().afterResponsive.call(nt(),o)):l&&(je(He().autoScrolling,"internal"),eo(He().autoScrolling,"internal"),G(v(Yt)),W(vt,ai),St(x().afterResponsive)&&x().afterResponsive.call(nt(),o))}function no(){return S(vt,ai)}function Ns(o){x().verticalCentered&&(!x().scrollOverflow&&J.shouldBeScrollable(o.item)||J.isScrollable(o)||S(o.item,Hr)||q(o.item,Hr))}var Is=null;u.getActiveSection=ed;function td(){return Is}function Cs(o){var l=o.item,h=o.allSlidesItems.length,y=o.index();!j().activeSection&&o.isVisible&&(q(l,ft),re(),Is=j().activeSection.item),x().paddingTop&&I(l,{"padding-top":x().paddingTop}),x().paddingBottom&&I(l,{"padding-bottom":x().paddingBottom}),typeof x().sectionsColor[y]<"u"&&I(l,{"background-color":x().sectionsColor[y]}),typeof x().anchors[y]<"u"&&l.setAttribute("data-anchor",o.anchor),h||Ns(o)}function ed(){return j().activeSection}function nd(o){return o.isSection?o:o.parent}var io;Y.on(X.bindEvents,id);function id(){Y.on(X.onAfterRenderNoAnchor,rd),Y.on(X.onLeave,J.onLeave),Y.on(X.onSlideLeave,J.onLeave),Y.on(X.afterSlideLoads,J.afterLoad),Y.on(X.afterSectionLoads,J.afterLoad),Y.on(X.onDestroy,od),ht("keyup",J.keyUpHandler)}function rd(){x().scrollOverflow&&!x().scrollBar&&(J.makeScrollable(),J.focusScrollable())}function od(){It("keyup",J.keyUpHandler)}var J={focusedElem:null,shouldFocusScrollable:!0,isInnerScrollAllowed:!0,timeBeforeReachingLimit:null,timeLastScroll:null,preventScrollWithMouseWheel:function(l){if(!z.canScroll)return tt(l),!1},preventScrollWithKeyboard:function(l){if(!Or()&&x().keyboardScrolling){var h=[38,33,32,40,34,36,35];if(h.indexOf(l.keyCode)>-1&&!J.isInnerScrollAllowed)return tt(l),!1}},keyUpHandler:function(){J.shouldFocusScrollable=z.canScroll},onLeave:function(){clearTimeout(io),J.isInnerScrollAllowed=!1},afterLoad:function(){J.isInnerScrollAllowed=!1,clearTimeout(io),io=setTimeout(function(){J.shouldFocusScrollable=z.canScroll},200)},unfocusScrollable:function(){i.activeElement===this.focusedElem&&(this.focusedElem.blur(),J.isInnerScrollAllowed=!1)},focusScrollable:function(){if(!(!x().scrollOverflow||!J.shouldFocusScrollable)){J.unfocusScrollable();var l=J.getScrollableItem(j().activeSection.item);l&&!r&&!s&&(this.focusedElem=l,requestAnimationFrame(function(){l.focus(),J.isInnerScrollAllowed=!0})),J.shouldFocusScrollable=!1}},makeScrollable:function(){x().scrollOverflowMacStyle&&!a&&q(vt,"fp-scroll-mac"),j().panels.forEach(function(l){if(!(l.slides&&l.slides.length)&&!(S(l.item,es)&&no())){var h=xe(l.item),y=J.shouldBeScrollable(l.item),T=nd(l);if(c){var D=y?"addClass":"removeClass";Ka[D](T.item,fi),Ka[D](l.item,fi)}else q(T.item,fi),q(l.item,fi);l.hasScroll||(J.createWrapper(h),J.bindEvents(h)),l.hasScroll=!0}})},bindEvents:function(l){J.getScrollableItem(l).addEventListener("scroll",J.onPanelScroll),l.addEventListener("wheel",J.preventScrollWithMouseWheel,{passive:!1}),l.addEventListener("keydown",J.preventScrollWithKeyboard,{passive:!1})},createWrapper:function(l){var h=document.createElement("div");h.className=Fe,N(l,h),h.setAttribute("tabindex","-1")},destroyWrapper:function(l){var h=v(gn,l)[0];h&&(P(h),l.removeAttribute("tabindex"))},getScrollableItem:function(l){var h=xe(l);return v(gn,h)[0]||h},hasScroll:function(l){return S(l,Fe)||v(gn,l)[0]!=null},isScrollable:function(l){return l.isSection&&l.activeSlide?l.activeSlide.hasScroll:l.hasScroll},shouldBeScrollable:function(l){var h=J.getScrollableItem(l);return h.scrollHeight>n.innerHeight},isScrolled:function(l,h){if(!z.canScroll)return!1;if(x().scrollBar)return!0;var y=J.getScrollableItem(h);if(!x().scrollOverflow||!S(y,Fe)||S(h,"fp-noscroll")||S(xe(h),"fp-noscroll"))return!0;var T=c?1:0,D=y.scrollTop,R=l==="up"&&D<=0,V=l==="down"&&y.scrollHeight<=Math.ceil(y.offsetHeight+D)+T,et=R||V;return et||(this.timeBeforeReachingLimit=new Date().getTime()),et},shouldMovePage:function(){this.timeLastScroll=new Date().getTime();var l=this.timeLastScroll-J.timeBeforeReachingLimit,h=r||s,y=h&&z.isGrabbing,T=z.isUsingWheel&&l>600;return y&&l>400||T},onPanelScroll:function(){var o=0;return function(l){var h=l.target.scrollTop,y=z.touchDirection!=="none"?z.touchDirection:o<h?"down":"up";o=h,St(x().onScrollOverflow)&&Kt("onScrollOverflow",{position:h,direction:y}),S(l.target,Fe)&&z.canScroll&&J.isScrolled(y,l.target)&&J.shouldMovePage()&&J.shouldBeScrollable(j().activeSection.item)&&Y.emit(X.onScrollOverflowScrolled,{direction:y})}}()},Si;u.landscapeScroll=Ue,Y.on(X.bindEvents,ad);function ad(){Y.on(X.onPerformMovement,sd)}function sd(){clearTimeout(Si),K({slideMoving:!1})}function Ue(o,l,h){var y=L(o,Ct),T=j().sections.filter(function(V){return V.item==y})[0],D=T.slides.filter(function(V){return V.item==l})[0],R={slides:o,destiny:l,direction:h,destinyPos:{left:l.offsetLeft},slideIndex:D.index(),section:y,sectionIndex:T.index(),anchorLink:T.anchor,slidesNav:v(vn,y)[0],slideAnchor:D.anchor,prevSlide:T.activeSlide.item,prevSlideIndex:T.activeSlide.index(),items:{section:T,origin:T.activeSlide,destination:D},localIsResizing:z.isResizing};if(R.xMovement=ud(R.prevSlideIndex,R.slideIndex),R.direction=R.direction?R.direction:R.xMovement,R.localIsResizing||K({canScroll:!1}),x().onSlideLeave&&!R.localIsResizing&&R.xMovement!=="none"&&St(x().onSlideLeave)&&Kt("onSlideLeave",R)===!1){K({slideMoving:!1});return}q(l,ft),W(at(l),ft),re(),R.localIsResizing||(Xr(R.prevSlide),Sn(l)),Bf(R),T.isActive&&!R.localIsResizing&&Kr(R.slideIndex,R.slideAnchor,R.anchorLink),Y.emit(X.onSlideLeave,R),ld(o,R,!0)}function ld(o,l,h){var y=l.destinyPos;if(Of(l.slidesNav,l.slideIndex),K({scrollX:Math.round(y.left)}),x().css3){var T="translate3d(-"+Math.round(y.left)+"px, 0px, 0px)";u.test.translate3dH[l.sectionIndex]=T,I(vs(v(ci,o)),ys(T)),clearTimeout(Si),Si=setTimeout(function(){h&&Ds(l)},x().scrollingSpeed)}else u.test.left[l.sectionIndex]=Math.round(y.left),vi(o,Math.round(y.left),x().scrollingSpeed,function(){h&&Ds(l)})}function ud(o,l){return o==l?"none":o>l?"left":"right"}function cd(){clearTimeout(Si)}function Ds(o){o.localIsResizing||(St(x().afterSlideLoad)&&Kt("afterSlideLoad",o),K({canScroll:!0}),mi(o.destiny),Y.emit(X.afterSlideLoads,o)),K({slideMoving:!1})}function wi(o,l){yn(0,"internal"),typeof l<"u"&&K({isResizing:!0}),Ue(L(o,ie),o),typeof l<"u"&&K({isResizing:!1}),yn(He().scrollingSpeed,"internal")}var ro=null,oo=null;function re(){z.activeSection=null,z.sections.map(function(o){var l=S(o.item,ft);o.isActive=l,o.hasScroll=J.hasScroll(o.item),l&&(z.activeSection=o),o.slides.length&&(o.activeSlide=null,o.slides.map(function(h){var y=S(h.item,ft);h.hasScroll=J.hasScroll(o.item),h.isActive=y,y&&(o.activeSlide=h)}))}),fd()}function ao(){var o=v(x().sectionSelector,nt()),l=m(o),h=Array.from(o).map(function(D){return new Ge(D)}),y=h.filter(function(D){return D.isVisible}),T=y.reduce(function(D,R){return D.concat(R.slides)},[]);ro=Ps(z.activeSection),oo=Ps(z.activeSection?z.activeSection.activeSlide:null),z.numSections=l.length,z.numSlides=y.reduce(function(D,R){return D+R.slides.length},0),z.sections=y,z.sectionsIncludingHidden=h,z.slides=T,z.panels=z.sections.concat(z.slides)}function Ps(o){if(!o)return null;var l=o?o.item:null,h=o.isSection?z.sectionsIncludingHidden:z.activeSection.slidesIncludingHidden;if(l){var y=Ur(h,l);return y?y.index():null}return null}function fd(){var o=z.activeSection,l=z.activeSection?z.activeSection.slides.length:!1,h=z.activeSection?z.activeSection.activeSlide:null;if(!o&&z.sections.length&&!j().isBeyondFullpage&&ro){var y=Os(ro,z.sections);y&&(z.activeSection=y,z.activeSection.isActive=!0,q(z.activeSection.item,ft)),z.activeSection&&Ve(z.activeSection.item.offsetTop)}if(l&&!h&&oo){var T=Os(oo,z.activeSection.slides);T&&(z.activeSection.activeSlide=T,z.activeSection.activeSlide.isActive=!0,q(z.activeSection.activeSlide.item,ft)),z.activeSection.activeSlide&&wi(z.activeSection.activeSlide.item,"internal")}}function Os(o,l){var h,y=o-1,T=o;do{if(h=l[y]||l[T],h)break;y=y-1,T=T+1}while(y>=0||T<l.length);return h}var Ge=function(l){var h=this;[].push.call(arguments,x().sectionSelector),Xt.apply(this,arguments),this.allSlidesItems=v(x().slideSelector,l),this.slidesIncludingHidden=Array.from(this.allSlidesItems).map(function(y){return new so(y,h)}),this.slides=this.slidesIncludingHidden.filter(function(y){return y.isVisible}),this.activeSlide=this.slides.length?this.slides.filter(function(y){return y.isActive})[0]||this.slides[0]:null};Ge.prototype=Xt.prototype,Ge.prototype.constructor=Ge;var so=function(l,h){this.parent=h,Xt.call(this,l,x().slideSelector)};so.prototype=Xt.prototype,so.prototype.constructor=Ge;function Rs(){q(v(x().sectionSelector,nt()),li),q(v(x().slideSelector,nt()),Fr)}function zs(o){var l=o.slides.length,h=o.allSlidesItems,y=o.slides,T=l*100,D=100/l;if(!v(ie,o.item)[0]){var R=i.createElement("div");R.className=pn,E(h,R);var V=i.createElement("div");V.className=Br,E(h,V)}I(v(ci,o.item),{width:T+"%"}),l>1&&(x().controlArrows&&Ff(o),x().slidesNavigation&&Rf(o)),y.forEach(function(ut){I(ut.item,{width:D+"%"}),x().verticalCentered&&Ns(ut)});var et=o.activeSlide||null;et!=null&&z.activeSection&&(z.activeSection.index()!==0||z.activeSection.index()===0&&et.index()!==0)?wi(et.item,"internal"):q(h[0],ft)}var bn,$s={attributes:!1,subtree:!0,childList:!0,characterData:!0};Y.on(X.bindEvents,dd),u.render=lo;function dd(){x().observer&&"MutationObserver"in window&&v(_e)[0]&&(bn=hd(v(_e)[0],lo,$s)),Y.on(X.contentChanged,lo)}function hd(o,l,h){var y=new MutationObserver(l);return y.observe(o,h),y}function Fs(){return m(v(x().slideSelector,nt())).length!==j().numSlides}function pd(){return m(v(x().sectionSelector,nt())).length!==j().numSections}function gd(){return Fs()||pd()}function lo(o){var l=Fs();gd()&&!z.isDoingContinousVertical&&(x().observer&&bn&&bn.disconnect(),ao(),re(),x().anchors=[],ye(v(Yt)),Rs(),fs(),x().navigation&&Ms(),l&&(ye(v(vn)),ye(v(Be))),j().sections.forEach(function(h){h.slides.length?l&&zs(h):Cs(h)})),x().observer&&bn&&v(_e)[0]&&bn.observe(v(_e)[0],$s)}var vd=function(){var o=!1;try{var l=Object.defineProperty({},"passive",{get:function(){o=!0}});xt("testPassive",null,l),Re("testPassive",null,l)}catch{}return function(){return o}}();function Bs(){return vd()?{passive:!1}:!1}var bi=function(){var o=new Date().getTime(),l=[],h,y;return{registerEvent:function(D){D=D||n.event;var R=D.wheelDelta||-D.deltaY||-D.detail,V=Math.max(-1,Math.min(1,R)),et=typeof D.wheelDeltaX<"u"||typeof D.deltaX<"u";h=Math.abs(D.wheelDeltaX)<Math.abs(D.wheelDelta)||Math.abs(D.deltaX)<Math.abs(D.deltaY)||!et;var ut=new Date().getTime();y=V<0?"down":"up",l.length>149&&l.shift(),l.push(Math.abs(R));var ct=ut-o;o=ut,ct>200&&(l=[])},isAccelerating:function(){var D=dn(l,10),R=dn(l,70),V=D>=R;return l.length?V&&h:!1},getDirection:function(){return y}}}();function md(){var o=_d(),l=qe(o);u.test.top=-o+"px",K({canScroll:!1}),vi(l.element,l.options,x().scrollingSpeed,function(){setTimeout(function(){K({isBeyondFullpage:!0}),K({canScroll:!0})},30)})}function yd(){if(Tf())Hs();else return}function Hs(){var o=qe(Gt(j().sections).item.offsetTop);K({canScroll:!1}),vi(o.element,o.options,x().scrollingSpeed,function(){K({canScroll:!0}),K({isBeyondFullpage:!1}),K({isAboutToScrollToFullPage:!1})})}function _d(){return x().css3?ot()+w():Gt(j().sections).item.offsetTop+Gt(j().sections).item.offsetHeight}function xd(o,l){new Date().getTime();var h=j().isBeyondFullpage&&o.getBoundingClientRect().bottom>=0&&bi.getDirection()==="up",y=j().isAboutToScrollToFullPage;if(y)return tt(l),!1;if(j().isBeyondFullpage){if(!h)qs("set","beyondFullpage",1e3);else{var T=!y&&(!qs("isNewKeyframe","beyondFullpage")||!bi.isAccelerating()),D;if(T)return D=qe(Gt(j().sections).item.offsetTop+Gt(j().sections).item.offsetHeight),D.element.scrollTo(0,D.options),K({isAboutToScrollToFullPage:!1}),tt(l),!1;if(bi.isAccelerating())return h=!1,K({isAboutToScrollToFullPage:!0}),K({scrollTrigger:"wheel"}),Hs(),tt(l),!1}if(!y&&!h)return!0}}var qs=function(){var o=!1,l={},h={};return function(y,T,D){switch(y){case"set":l[T]=new Date().getTime(),h[T]=D;break;case"isNewKeyframe":var R=new Date().getTime();o=R-l[T]>h[T];break}return o}}();u.moveSectionDown=En;function En(){var o=j().activeSection.next();!o&&(x().loopBottom||x().continuousVertical)&&(o=j().sections[0]),o!=null?We(o,null,!1):Sd()&&Y.emit(X.scrollBeyondFullpage)}function Sd(){return nt().scrollHeight<vt.scrollHeight}u.moveSectionUp=Ye;function Ye(){var o=j().activeSection.prev();!o&&(x().loopTop||x().continuousVertical)&&(o=Gt(j().sections)),o!=null&&We(o,null,!0)}var Ei=0;function Vs(o){x().autoScrolling&&(z.canScroll&&(o.pageY<Ei&&bt().m.up?Ye():o.pageY>Ei&&bt().m.down&&En()),Ei=o.pageY)}function wd(o){Ei=o}function uo(o){if(bt().m[o]){var l=o==="down"?En:Ye;x().scrollOverflow&&J.isScrollable(j().activeSection)?J.isScrolled(o,j().activeSection.item)&&J.shouldMovePage()&&l():l()}}var Ai=0,An=0,Mi=0,Mn=0,Ti=Ad(),Ot={touchmove:"ontouchmove"in window?"touchmove":Ti?Ti.move:null,touchstart:"ontouchstart"in window?"touchstart":Ti?Ti.down:null};function bd(){if(Ot.touchmove&&(r||s)){x().autoScrolling&&(vt.removeEventListener(Ot.touchmove,fo,{passive:!1}),vt.addEventListener(Ot.touchmove,fo,{passive:!1}));var o=x().touchWrapper;o.removeEventListener(Ot.touchstart,co),o.removeEventListener(Ot.touchmove,Li,{passive:!1}),o.addEventListener(Ot.touchstart,co),o.addEventListener(Ot.touchmove,Li,{passive:!1})}}function Ed(){if(Ot.touchmove&&(r||s)){x().autoScrolling&&(vt.removeEventListener(Ot.touchmove,Li,{passive:!1}),vt.removeEventListener(Ot.touchmove,fo,{passive:!1}));var o=x().touchWrapper;o.removeEventListener(Ot.touchstart,co),o.removeEventListener(Ot.touchmove,Li,{passive:!1})}}function Li(o){var l=L(o.target,Ct)||j().activeSection.item,h=J.isScrollable(j().activeSection);if(ki(o)){K({isGrabbing:!0,isUsingWheel:!1}),x().autoScrolling&&(h&&!z.canScroll||x().scrollBar)&&tt(o);var y=Ws(o);Mi=y.y,Mn=y.x;var T=Math.abs(Ai-Mi)>n.innerHeight/100*x().touchSensitivity,D=Math.abs(An-Mn)>k()/100*x().touchSensitivity,R=v(ie,l).length&&Math.abs(An-Mn)>Math.abs(Ai-Mi),V=An>Mn?"right":"left",et=Ai>Mi?"down":"up",ut=R?V:et;K({touchDirection:ut}),R?!z.slideMoving&&D&&(An>Mn?bt().m.right&&Y.emit(X.moveSlideRight,{section:l}):bt().m.left&&Y.emit(X.moveSlideLeft,{section:l})):x().autoScrolling&&z.canScroll&&T&&uo(et)}}function ki(o){return typeof o.pointerType>"u"||o.pointerType!="mouse"}function co(o){if(x().fitToSection&&K({activeAnimation:!1}),ki(o)){var l=Ws(o);Ai=l.y,An=l.x}xt("touchend",js)}function js(){Re("touchend",js),K({isGrabbing:!1})}function Ws(o){var l={};return l.y=typeof o.pageY<"u"&&(o.pageY||o.pageX)?o.pageY:o.touches[0].pageY,l.x=typeof o.pageX<"u"&&(o.pageY||o.pageX)?o.pageX:o.touches[0].pageX,s&&ki(o)&&x().scrollBar&&typeof o.touches<"u"&&(l.y=o.touches[0].pageY,l.x=o.touches[0].pageX),l}function Ad(){var o;return n.PointerEvent&&(o={down:"pointerdown",move:"pointermove"}),o}function fo(o){x().autoScrolling&&ki(o)&&bt().m.up&&(z.canScroll||tt(o))}u.moveSlideLeft=ho,u.moveSlideRight=po;function Us(o,l){var h=l??j().activeSection.item,y=Ur(z.sections,h),T=v(ie,h)[0];if(!(T==null||z.slideMoving||y.slides.length<2)){var D=y.activeSlide,R=o==="left"?D.prev():D.next();if(!R){if(!x().loopHorizontal)return;R=o==="left"?Gt(y.slides):y.slides[0]}K({slideMoving:!u.test.isTesting}),Ue(T,R.item,o)}}function ho(o){Us("left",o)}function po(o){Us("right",o)}function go(o){var l=j().sections.filter(function(y){return y.anchor===o})[0];if(!l){var h=typeof o<"u"?o-1:0;l=j().sections[h]}return l}function Gs(o){o!=null&&Ue(L(o,ie),o)}function vo(o,l){var h=go(o);if(h!=null){var y=Md(l,h);h.anchor!==z.lastScrolledDestiny&&!S(h.item,ft)?We(h,function(){Gs(y)}):Gs(y)}}function Md(o,l){var h=l.slides.filter(function(y){return y.anchor===o})[0];return h==null&&(o=typeof o<"u"?o:0,h=l.slides[o]),h?h.item:null}u.moveTo=Tn;function Tn(o,l){var h=go(o);typeof l<"u"?vo(o,l):h!=null&&We(h)}var Ni,mo,Xe;Y.on(X.bindEvents,Td);function Td(){xt("blur",Nd),ht("keydown",Ys),ht("keyup",Xs),Y.on(X.onDestroy,Ld),Y.on(X.afterSlideLoads,Cd),Y.on(X.afterSectionLoads,Dd)}function Ld(){clearTimeout(mo),It("keydown",Ys),It("keyup",Xs)}function Ys(o){clearTimeout(mo);var l=o.keyCode,h=[37,39].indexOf(l)>-1,y=x().autoScrolling||x().fitToSection||h;l===9?Id(o):!Or()&&x().keyboardScrolling&&y&&(Ni=o.ctrlKey,mo=setTimeout(function(){kd(o)},0))}function kd(o){var l=o.shiftKey,h=i.activeElement,y=wt(h,"video")||wt(h,"audio"),T={up:J.isScrolled("up",j().activeSection.item),down:J.isScrolled("down",j().activeSection.item)},D=[37,39].indexOf(o.keyCode)>-1;if(zd(o),!(!z.canScroll&&!D))switch(K({scrollTrigger:"keydown"}),o.keyCode){case 38:case 33:bt().k.up&&T.up?z.isBeyondFullpage?Y.emit(X.onKeyDown,{e:o}):Ye():J.focusScrollable();break;case 32:if(l&&bt().k.up&&!y&&T.up){Ye();break}case 40:case 34:if(bt().k.down&&T.down){if(z.isBeyondFullpage)return;(o.keyCode!==32||!y)&&En()}else J.focusScrollable();break;case 36:bt().k.up&&Tn(1);break;case 35:bt().k.down&&Tn(j().sections.length);break;case 37:bt().k.left&&ho();break;case 39:bt().k.right&&po();break;default:return}}function Xs(o){z.isWindowFocused&&(Ni=o.ctrlKey)}function Nd(){K({isWindowFocused:!1}),Ni=!1}function Id(o){var l=o.shiftKey,h=i.activeElement,y=yo(xe(j().activeSection.item));function T(Mt){return tt(Mt),y[0]?y[0].focus():null}if(!Od(o)){h?L(h,Qa+","+Qa+" "+hn)==null&&(h=T(o)):T(o);var D=h==y[0],R=h==y[y.length-1],V=!l&&R,et=l&&D;if(et||V){tt(o);var ut=Pd(et),ct=ut?ut.panel:null;if(ct){var pt=ct.isSection?ct:ct.parent;Y.emit(X.onScrollPageAndSlide,{sectionAnchor:pt.index()+1,slideAnchor:ct.isSection?0:ct.index()}),Xe=ut.itemToFocus,tt(o)}}}}function Cd(o){Ks()}function Dd(o){(!L(Xe,ui)||L(Xe,hn))&&Ks()}function Ks(){Xe&&(Xe.focus(),Xe=null)}function Pd(o){var l=o?"prevPanel":"nextPanel",h=[],y,T=ps(of()[l]());do h=yo(T.item),h.length&&(y={panel:T,itemToFocus:h[o?h.length-1:0]}),T=ps(T[l]());while(T&&h.length===0);return y}function yo(o){return[].slice.call(v(f,o)).filter(function(l){return st(l,"tabindex")!=="-1"&&l.offsetParent!==null})}function Od(o){var l=yo(i),h=l.indexOf(i.activeElement),y=o.shiftKey?h-1:h+1,T=l[y],D=L(T,ui),R=L(T,Ct);return!D&&!R}function Rd(o){var l=[40,38,32,33,34];return l.indexOf(o.keyCode)>-1&&!z.isBeyondFullpage}function zd(o){Rd(o)&&!L(o.target,gn)&&o.preventDefault()}function $d(){return Ni}var Zs=new Date().getTime(),Ke=[];u.setMouseWheelScrolling=_o;function _o(o){o?(Fd(),Bd()):(Hd(),qd())}function Fd(){var o="",l;n.addEventListener?l="addEventListener":(l="attachEvent",o="on");var h="onwheel"in i.createElement("div")?"wheel":i.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",y=Bs();h=="DOMMouseScroll"?i[l](o+"MozMousePixelScroll",Ze,y):i[l](o+h,Ze,y)}function Bd(){nt().addEventListener("mousedown",Js),nt().addEventListener("mouseup",Qs)}function Hd(){i.addEventListener?(It("mousewheel",Ze,!1),It("wheel",Ze,!1),It("MozMousePixelScroll",Ze,!1)):i.detachEvent("onmousewheel",Ze)}function qd(){nt().removeEventListener("mousedown",Js),nt().removeEventListener("mouseup",Qs)}function Ze(o){var l=new Date().getTime(),h=S(v(cf)[0],vf),y=xd(nt(),o);if(z.isUsingWheel||K({isGrabbing:!1,isUsingWheel:!0,touchDirection:"none"}),!bt().m.down&&!bt().m.up)return tt(o),!1;if(y)return!0;if(y===!1)return tt(o),!1;if(x().autoScrolling&&!$d()&&!h){o=o||n.event;var T=o.wheelDelta||-o.deltaY||-o.detail,D=Math.max(-1,Math.min(1,T)),R=typeof o.wheelDeltaX<"u"||typeof o.deltaX<"u",V=Math.abs(o.wheelDeltaX)<Math.abs(o.wheelDelta)||Math.abs(o.deltaX)<Math.abs(o.deltaY)||!R,et=D<0?"down":D>0?"up":"none";Ke.length>149&&Ke.shift(),Ke.push(Math.abs(T)),x().scrollBar&&tt(o);var ut=l-Zs;if(Zs=l,ut>200&&(Ke=[]),K({wheelDirection:et}),z.canScroll){var ct=dn(Ke,10),pt=dn(Ke,70),Mt=ct>=pt;Mt&&V&&(K({scrollTrigger:"wheel"}),D<0?uo("down"):uo("up"))}return!1}x().fitToSection&&K({activeAnimation:!1})}function Js(o){o.which==2&&(wd(o.pageY),nt().addEventListener("mousemove",Vs))}function Qs(o){o.which==2&&nt().removeEventListener("mousemove",Vs)}function Ln(o){o?(_o(!0),bd()):(_o(!1),Ed())}var xo=!0;Y.on(X.bindEvents,Vd);function Vd(){x().normalScrollElements&&(["mouseenter","touchstart"].forEach(function(o){tl(o,!1)}),["mouseleave","touchend"].forEach(function(o){tl(o,!0)})),Y.on(X.onDestroy,jd)}function jd(){["mouseenter","touchstart","mouseleave","touchend"].forEach(function(o){It(o,el,!0)})}function tl(o,l){document["fp_"+o]=l,ht(o,el,!0)}function el(o){var l=o.type,h=!1,y=l==="mouseleave"?o.toElement||o.relatedTarget:o.target;if(y==document||!y){Ln(!0);return}if(l==="touchend"&&(xo=!1,setTimeout(function(){xo=!0},800)),!(l==="mouseenter"&&!xo)){var T=x().normalScrollElements.split(",");T.forEach(function(D){if(!h){var R=wt(y,D),V=L(y,D);(R||V)&&(u.shared.isNormalScrollElement||Ln(!1),u.shared.isNormalScrollElement=!0,h=!0)}}),!h&&u.shared.isNormalScrollElement&&(Ln(!0),u.shared.isNormalScrollElement=!1)}}u.silentMoveTo=Ii;function Ii(o,l){yn(0,"internal"),Tn(o,l),yn(He().scrollingSpeed,"internal")}var So=w(),nl=k(),wo,bo=!1,il;u.reBuild=Ao,Y.on(X.bindEvents,Wd);function Wd(){Eo(),xt("resize",Eo),Y.on(X.onDestroy,Ud)}function Ud(){clearTimeout(wo),clearTimeout(il),Re("resize",Eo)}function Eo(){bo||(x().autoScrolling&&!x().scrollBar||!x().fitToSection)&&rl(w()),Gd(),bo=!0,clearTimeout(wo),wo=setTimeout(function(){Yd(),bo=!1},400)}function Gd(){if(r)for(var o=0;o<4;o++)il=setTimeout(function(){window.requestAnimationFrame(function(){x().autoScrolling&&!x().scrollBar&&(K({isResizing:!0}),Ii(z.activeSection.index()+1),K({isResizing:!1}))})},200*o)}function Yd(){if(K({isResizing:!0}),rl(""),!x().autoScrolling&&!z.isBeyondFullpage&&Kd(),Y.emit(X.contentChanged),re(),ks(),r){var o=i.activeElement;if(!wt(o,"textarea")&&!wt(o,"input")&&!wt(o,"select")){var l=w();Math.abs(l-So)>20*Math.max(So,l)/100&&(Ao(!0),So=l)}}else Xd();K({isResizing:!1})}function Ao(o){if(!S(nt(),zr)){K({isResizing:!0,windowsHeight:w(),windowsWidth:k()});for(var l=j().sections,h=0;h<l.length;++h){var y=l[h],T=v(ie,y.item)[0],D=y.slides;D.length>1&&Ue(T,y.activeSlide.item)}x().scrollOverflow&&J.makeScrollable();var R=j().activeSection.index();z.isBeyondFullpage||R&&Ii(R+1),K({isResizing:!1}),St(x().afterResize)&&o&&x().afterResize.call(nt(),n.innerWidth,n.innerHeight),St(x().afterReBuild)&&!o&&x().afterReBuild.call(nt()),fn(nt(),"afterRebuild")}}function Xd(){var o=w(),l=k();(z.windowsHeight!==o||nl!==l)&&(K({windowsHeight:o}),nl=l,Ao(!0))}function rl(o){var l=o===""?"":o+"px";j().sections.forEach(function(h){I(h.item,{height:l})})}function Kd(){if(!x().autoScrolling||x().scrollBar){var o=n.innerHeight*.01;i.documentElement.style.setProperty("--vh","".concat(o,"px"))}}function Mo(){var o,l,h=n.location.hash;if(h.length){var y=h.replace("#","").split("/"),T=h.indexOf("#/")>-1;o=T?"/"+y[1]:decodeURIComponent(y[0]);var D=T?y[2]:y[1];D&&D.length&&(l=decodeURIComponent(D))}return{section:o,slide:l}}u.setLockAnchors=Qd,Y.on(X.bindEvents,Zd);function Zd(){xt("hashchange",ol),Y.on(X.onDestroy,Jd)}function Jd(){Re("hashchange",ol)}function Qd(o){x().lockAnchors=o}function ol(){if(!z.isScrolling&&!x().lockAnchors){var o=Mo(),l=o.section,h=o.slide,y=typeof z.lastScrolledDestiny>"u",T=typeof z.lastScrolledDestiny>"u"&&typeof h>"u"&&!z.slideMoving;l&&l.length&&(l&&l!==z.lastScrolledDestiny&&!y||T||!z.slideMoving&&z.lastScrolledSlide!=h)&&Y.emit(X.onScrollPageAndSlide,{sectionAnchor:l,slideAnchor:h})}}Y.on(X.bindEvents,th);function th(){ht("wheel",bi.registerEvent,Bs()),Y.on(X.scrollBeyondFullpage,md),Y.on(X.onKeyDown,yd)}Y.on(X.bindEvents,eh);function eh(){Y.on(X.onClickOrTouch,nh)}function nh(o){var l=o.target;L(l,x().menu+" [data-menuanchor]")&&ih.call(l,o)}function ih(o){K({scrollTrigger:"menu"}),v(x().menu)[0]&&(x().lockAnchors||!x().anchors.length)&&(tt(o),Y.emit(X.onMenuClick,{anchor:st(this,"data-menuanchor")}))}Y.on(X.bindEvents,rh);function rh(){Y.on(X.onClickOrTouch,oh)}function oh(o){var l=o.target;l&&L(l,Yt+" a")?Yf.call(l,o.e):wt(l,mf)?Uf.call(l):(wt(l,os)||L(l,os)!=null)&&Pf.call(l,o.e)}var al=0,To,Lo;Y.on(X.onDestroy,ah);function ko(o){var l,h;if(!(z.isResizing||!j().activeSection)&&(Gt(j().sections),!(j().isBeyondFullpage||j().isAboutToScrollToFullPage)&&(!x().autoScrolling||x().scrollBar))){var y=ot(),T=sh(y),D=0,R=y+w()/2,V=vt.scrollHeight-w()===y,et=j().sections;if(K({scrollY:y}),V)D=et.length-1;else if(!y)D=0;else for(var ut=0;ut<et.length;++ut){var ct=et[ut].item;ct.offsetTop<=R&&(D=ut)}if(lh(T)&&(S(j().activeSection.item,de)||(q(j().activeSection.item,de),W(at(j().activeSection.item),de))),l=et[D],h=l.item,!l.isActive){K({isScrolling:!0});var pt=j().activeSection.item,Mt=j().activeSection.index()+1,Bt=Gr(j().activeSection,h),Rt=l.anchor,kn=l.index()+1,be=l.activeSlide,he,Zt,oe={activeSection:pt,sectionIndex:kn-1,anchorLink:Rt,element:h,leavingSection:Mt,direction:Bt,items:{origin:j().activeSection,destination:l}};be&&(Zt=be.anchor,he=be.index()),z.canScroll&&(q(h,ft),W(at(h),ft),St(x().beforeLeave)&&Ts("beforeLeave",oe),St(x().onLeave)&&Kt("onLeave",oe),St(x().afterLoad)&&Kt("afterLoad",oe),Xr(pt),Sn(h),mi(h),Qr(Rt,kn-1),x().anchors.length&&K({lastScrolledDestiny:Rt}),re(),Kr(he,Zt,Rt)),clearTimeout(To),To=setTimeout(function(){K({isScrolling:!1})},100)}x().fitToSection&&z.canScroll&&(clearTimeout(Lo),Lo=setTimeout(function(){var Ht=z.sections.filter(function(Nn){var In=Nn.item.getBoundingClientRect();return Math.round(In.bottom)===Math.round(w())||Math.round(In.top)===0});Ht.length||Ls()},x().fitToSectionDelay))}}function ah(){clearTimeout(To),clearTimeout(Lo)}function sh(o){var l=o>al?"down":"up";return al=o,K({previousDestTop:o}),l}function lh(o){var l=j().activeSection.item.offsetTop,h=l+w();return o=="up"?h>=ot()+w():l<=ot()}Y.on(X.bindEvents,ch),Y.on(X.onDestroy,uh);function uh(){Re("scroll",ko)}function ch(){xt("scroll",ko),i.body.addEventListener("scroll",ko),Y.on(X.onScrollPageAndSlide,function(o){vo(o.sectionAnchor,o.slideAnchor)}),Y.on(X.onMenuClick,function(o){Tn(o.anchor,void 0)}),Y.on(X.onScrollOverflowScrolled,function(o){var l=o.direction==="down"?En:Ye;l()}),Y.on(X.scrollPage,function(o){We(o.destination)})}u.getActiveSlide=dh,u.getScrollX=function(){return z.scrollX},Y.on(X.bindEvents,fh);function fh(){Y.on(X.onDestroy,cd),Y.on(X.landscapeScroll,function(o){Ue(o.slides,o.destination)}),Y.on(X.moveSlideRight,function(o){po(o.section)}),Y.on(X.moveSlideLeft,function(o){ho(o.section)})}function dh(){return Yr(j().activeSection.activeSlide)}Y.on(X.bindEvents,hh);function hh(){var o=x().credits.position||"right",l=["left","right"].indexOf(o)>-1?"".concat(o,": 0;"):"",h=`
        <div class="fp-watermark" style="`.concat(l,`">
            <a href="https://alvarotrigo.com/fullPage/" 
                rel="nofollow noopener" 
                target="_blank" 
                style="text-decoration:none; color: #000;">
                    `).concat(x().credits.label||"Made with fullPage.js",`
            </a>
        </div>
    `),y=Gt(z.sections),T=!z.isValid||x().credits.enabled;y&&y.item&&T&&y.item.insertAdjacentHTML("beforeend",h)}(function(){Y.on(X.onInitialise,function(){var V,et,ut;K({isValid:(x().licenseKey,V=x().licenseKey,et=function(ct){var pt=parseInt("514").toString(16);if(!ct||ct.length<29||ct.split(o[0]).length===4)return null;var Mt=["Each","for"][T()]().join(""),Bt=ct[["split"]]("-"),Rt=[];Bt[Mt](function(he,Zt){if(Zt<4){var oe=function(In){var Io=In[In.length-1],wh=["NaN","is"][T()]().join("");return window[wh](Io)?D(Io):function(bh){return bh-ft.length}(Io)}(he);Rt.push(oe);var Ht=D(he[oe]);if(Zt===1){var Nn=["pa","dS","t","art"].join("");Ht=Ht.toString()[Nn](2,"0")}pt+=Ht,Zt!==0&&Zt!==1||(pt+="-")}});var kn=0,be="";return ct.split("-").forEach(function(he,Zt){if(Zt<4){for(var oe=0,Ht=0;Ht<4;Ht++)Ht!==Rt[Zt]&&(oe+=Math.abs(D(he[Ht])),isNaN(he[Ht])||kn++);var Nn=R(oe);be+=Nn}}),be+=R(kn),{v:new Date(pt+"T00:00"),o:pt.split("-")[2]===8*(ft.length-2)+"",l:be}}(V),ut=function(ct){var pt=y[T()]().join("");return ct&&pt.indexOf(ct)===0&&ct.length===pt.length}(V),(et||ut)&&(et&&h<=et.v&&et.l===V.split(o[0])[4]||ut||et.o)||!1)})});var o=["-"],l="2023-2-10".split("-"),h=new Date(l[0],l[1],l[2]),y=["se","licen","-","v3","l","gp"];function T(){return[["re","verse"].join("")][0]}function D(V){return V?isNaN(V)?V.charCodeAt(0)-72:V:""}function R(V){var et=72+V;return et>90&&et<97&&(et+=15),String.fromCharCode(et).toUpperCase()}})(),u.setKeyboardScrolling=sl;function sl(o,l){typeof l<"u"?(l=l.replace(/ /g,"").split(","),l.forEach(function(h){yi(o,h,"k")})):(yi(o,"all","k"),x().keyboardScrolling=o)}function ph(o){var l=o.index();typeof x().anchors[l]<"u"&&o.isActive&&Qr(x().anchors[l],l),x().menu&&x().css3&&L(v(x().menu)[0],_e)!=null&&v(x().menu).forEach(function(h){vt.appendChild(h)})}function gh(){I(Xa(nt(),"body"),{height:"100%",position:"relative"}),q(nt(),Ja),q(_n,si),K({windowsHeight:w()}),W(nt(),zr),Rs();for(var o=j().sectionsIncludingHidden,l=0;l<o.length;l++){var h=o[l],y=h.allSlidesItems;h.item.setAttribute("data-fp-styles",st(h.item,"style")),Cs(h),ph(h),y.length>0&&zs(h)}x().fixedElements&&x().css3&&v(x().fixedElements).forEach(function(T){vt.appendChild(T)}),x().navigation&&Ms(),If(),x().scrollOverflow&&J.makeScrollable()}u.shared.afterRenderActions=ll;function ll(){var o=j().activeSection,l=j().activeSection.item;q(l,de),Sn(l),As(),mi(l),vh()&&St(x().afterLoad)&&Kt("afterLoad",{activeSection:l,element:l,direction:null,anchorLink:o.anchor,sectionIndex:o.index(),items:{origin:j().activeSection,destination:j().activeSection}}),St(x().afterRender)&&Kt("afterRender")}function vh(){var o=Mo(),l=go(o.section);return!o.section||!l||typeof l<"u"&&l.index()===F(td())}u.setAllowScrolling=No;function No(o,l){typeof l<"u"?(l=l.replace(/ /g,"").split(","),l.forEach(function(h){yi(o,h,"m")})):yi(o,"all","m")}function ul(){var o=Mo(),l=o.section,h=o.slide;l?x().animateAnchor?vo(l,h):Ii(l,h):Y.emit(X.onAfterRenderNoAnchor,null)}function mh(){Ve(0),v("img[data-src], source[data-src], audio[data-src], iframe[data-src]",nt()).forEach(function(l){oi(l,"src")}),v("img[data-srcset]").forEach(function(l){oi(l,"srcset")}),ye(v(Yt+", "+vn+", "+Be)),I(Wr(j().sections),{height:"","background-color":"",padding:""}),I(Wr(j().slides),{width:""}),I(nt(),{height:"",position:"","-ms-touch-action":"","touch-action":""}),I(gi,{overflow:"",height:""}),W(_n,si),W(vt,ai),vt.className.split(/\s+/).forEach(function(l){l.indexOf($r)===0&&W(vt,l)}),Wr(j().panels).forEach(function(l){x().scrollOverflow&&J.destroyWrapper(l),W(l,Hr+" "+ft+" "+de);var h=st(l,"data-fp-styles");h&&l.setAttribute("style",st(l,"data-fp-styles")),S(l,li)&&!wf()&&l.removeAttribute("data-anchor")}),ms(nt()),[hf,ci,ie].forEach(function(l){v(l,nt()).forEach(function(h){P(h)})}),I(nt(),{"-webkit-transition":"none",transition:"none"}),n.scrollTo(0,0);var o=[li,Fr,Br];o.forEach(function(l){W(v("."+l),l)})}u.destroy=_h;function yh(){ao(),re(),x().scrollBar=x().scrollBar||x().hybrid,fs(),gh(),No(!0),Ln(!0),je(x().autoScrolling,"internal"),ks(),ws(),i.readyState==="complete"&&ul(),xt("load",ul),ll(),ao(),re()}function _h(o){je(!1,"internal"),No(!0),Ln(!1),sl(!1),q(nt(),zr),Y.emit(X.onDestroy),o&&mh()}var xh=function(){return x()&&z.isValid||i.domain.indexOf("alvarotrigo.com")>-1};function cl(){var o=x()["licenseKey"],l="font-size: 15px;background:yellow;";if(x().licenseKey.trim()===""?(p("error","Fullpage.js requires a `licenseKey` option. Read about it on the following URL:"),p("error","https://github.com/alvarotrigo/fullPage.js#options")):xh()?o&&o.length<20&&(console.warn("%c This website was made using fullPage.js slider. More info on the following website:",l),console.warn("%c https://alvarotrigo.com/fullPage/",l)):(p("error","Incorrect `licenseKey`. Get one for fullPage.js version 4 here:"),p("error","https://alvarotrigo.com/fullPage/pricing")),S(_n,si)){p("error","Fullpage.js can only be initialized once and you are doing it multiple times!");return}x().continuousVertical&&(x().loopTop||x().loopBottom)&&(x().continuousVertical=!1,p("warn","Option `loopTop/loopBottom` is mutually exclusive with `continuousVertical`; `continuousVertical` disabled")),x().scrollOverflow&&(x().scrollBar||!x().autoScrolling)&&p("warn","Options scrollBar:true and autoScrolling:false are mutually exclusive with scrollOverflow:true. Sections with scrollOverflow might not work well in Firefox"),x().continuousVertical&&(x().scrollBar||!x().autoScrolling)&&(x().continuousVertical=!1,p("warn","Scroll bars (`scrollBar:true` or `autoScrolling:false`) are mutually exclusive with `continuousVertical`; `continuousVertical` disabled")),d.forEach(function(h){x()[h]&&p("warn","fullpage.js extensions require fullpage.extensions.min.js file instead of the usual fullpage.js. Requested: "+h)}),x().anchors.forEach(function(h){var y=[].slice.call(v("[name]")).filter(function(R){return st(R,"name")&&st(R,"name").toLowerCase()==h.toLowerCase()}),T=[].slice.call(v("[id]")).filter(function(R){return st(R,"id")&&st(R,"id").toLowerCase()==h.toLowerCase()});if(T.length||y.length){p("error","data-anchor tags can not have the same value as any `id` element on the site (or `name` element for IE).");var D=T.length?"id":"name";(T.length||y.length)&&p("error",'"'+h+'" is is being used by another element `'+D+"` property")}})}function fl(o,l){if(Lf(),S(_n,si)){cl();return}return Af("touchWrapper",typeof o=="string"?v(o)[0]:o),Ef(l),bf(typeof o=="string"?v(o)[0]:o),Y.emit(X.onInitialise),cl(),Sh(),nt()&&(Y.emit(X.beforeInit),yh(),Y.emit(X.bindEvents)),n.fullpage_api}function Sh(){u.getFullpageData=function(){return{options:x()}},u.version="4.0.19",u.test=Object.assign(u.test,{top:"0px",translate3d:"translate3d(0px, 0px, 0px)",translate3dH:function(){for(var o=[],l=0;l<v(x().sectionSelector,nt()).length;l++)o.push("translate3d(0px, 0px, 0px)");return o}(),left:function(){for(var o=[],l=0;l<v(x().sectionSelector,nt()).length;l++)o.push(0);return o}(),options:x(),setAutoScrolling:null}),u.shared=Object.assign(u.shared,{afterRenderActions:null,isNormalScrollElement:!1}),n.fullpage_api=u}return n.fp_easings=A(n.fp_easings,{easeInOutCubic:function(l,h,y,T){return(l/=T/2)<1?y/2*l*l*l+h:y/2*((l-=2)*l*l+2)+h}}),n.jQuery&&function(o,l){if(!o||!l){p("error","jQuery is required to use the jQuery fullpage adapter!");return}o.fn.fullpage=function(h){h=o.extend({},h,{$:o}),new l(this[0],h),Object.keys(u).forEach(function(y){x().$.fn.fullpage[y]=u[y]})}}(n.jQuery,fl),fl})})(rf);var A1=rf.exports;const M1=E1(A1);document.addEventListener("DOMContentLoaded",()=>{new A_,new D_("data/berney_divisions.geojson","data/locations.json").load_data();const e=new y1;new m1("data/sankey_sdoj.json",e);const n=new w1,i="stats-checkboxes",a=document.querySelector(`#${i}`).querySelectorAll("input");a.forEach(c=>{c.addEventListener("change",()=>{const u=Array.from(a).filter(d=>d.checked).map(d=>d.value);u.sort().reverse(),n.updatePlot(u),a.forEach(d=>{d.disabled=!0}),setTimeout(()=>{a.forEach(d=>{d.disabled=!1})},800)})});const s=1e3;new M1("#fullpage",{navigation:!0,navigationTooltips:["Title","Introduction","Concentrique & Historique","Sankey & Société","Cartographie Interactive","Carte","Réseaux Interactifs","Réseaux","Analyse K-Moyennes","Conclusion","Crédits"],slidesNavigation:!1,controlArrows:!1,verticalCentered:!1,scrollingSpeed:s,scrollOverflow:!0})});const Ou=100;document.addEventListener("DOMContentLoaded",()=>{let t;function e(c){const f=c.getBoundingClientRect(),u=window.innerHeight||document.documentElement.clientHeight,d=window.innerWidth||document.documentElement.clientWidth;return f.top>=0&&f.left>=0&&f.bottom<=u+1&&f.right<=d+1}function n(c,f){const u=window.pageYOffset,d=c.getBoundingClientRect().top,p=performance.now();function g(m){const v=m-p,A=Math.min(v/f,1);window.scrollTo({top:u+d*i(A)}),v<f&&window.requestAnimationFrame(g)}window.requestAnimationFrame(g)}function i(c){return c<.5?2*c*c:-1+(4-2*c)*c}function r(c){return c.deltaY>0?"down":"up"}function a(c){c.preventDefault();const f=["title-container","p1-container","p2-container","p3-container","p4-container","p5-container","p6-container","p7-container","p8-container","p9-container","final-container"];let u=null;c.type==="wheel"&&(u=r(c)),c.type==="touchmove"&&(u=c.touches[0].pageY>t?"up":"down");for(let d=0;d<f.length;d++){const p=d>=1?document.getElementById(f[d-1]):null,g=document.getElementById(f[d]),m=d<f.length-1?document.getElementById(f[d+1]):null;p&&e(g)&&u==="up"&&n(p,Ou),m&&e(g)&&u==="down"&&n(m,Ou)}}document.addEventListener("wheel",a,{passive:!1}),document.addEventListener("touchmove",a,{passive:!1});const s=document.getElementById("title-container");n(s,0)});const T1="data/networks",L1="road_vocation_data",k1="vocation",N1="#network-graph",I1="network-chart",C1="#network-title",D1="#network-text",P1="#979487",Ru="#aaaaaa",O1=t=>({bourg:"Bourg",place_st_francois:"Place St-François",chailly:"Chailly","grange-neuve":"Grange-Neuve",grange_neuve:"Grange-Neuve",la_sallaz:"La Sallaz",ouchy:"Ouchy",barre:"Barre",cite_derriere:"Cité Derrière",cite_dessous:"Cité Dessous",cheneau_de_bourg:"Cheneau-de-Bourg",chenneau:"Cheneau-de-Bourg",montee_st_francois:"Montée St-François",rue_du_pont:"Rue du Pré",rue_du_pre:"Rue du Pré",ale:"Ale",grand_st_jean:"Grand St-Jean",montee_de_st_laurent:"Montée de St-Laurent",palud:"Palud",st_laurent:"St-Laurent",marterey:"Marterey",affaires_division:"Affaires",campagne_division:"Campagne",cathedrale_division:"Cathédrale",centre_division:"Centre",commerce_division:"Commerce",culture_division:"Culture",administration:"Administration",agricole:"Agricole",artisanat:"Artisanat",commerce:"Commerce",construction:"Construction",rente:"Rente",service:"Service",hors_lausanne:"Hors Lausanne",lausanne:"Lausanne",suisse_allemande:"Suisse Allemande",france:"France",grandson:"Grandson",aubonne:"Aubonne",morges:"Morges",nyon:"Nyon",pays_d_enhaut:"Pays d'Enhaut",vaud:"Vaud",angleterre:"Angleterre",italie:"Italie",rolle:"Rolle",geneve:"Genève",orbe:"Orbe",vevey:"Vevey",la_vallee:"La Vallée",cossonay:"Cossonay",aigle:"Aigle",neuchatel:"Neuchâtel",payerne:"Payerne",yverdon:"Yverdon",echallens:"Echallens",fribourg:"Fribourg",avenches:"Avenches",moudon:"Moudon",oron:"Oron",lavaux:"Lavaux"})[t]??t,R1={road_vocation_data:{street:"#289e61",job:"#9e2846"},bipartite_division_type_metiers:{division:"#289e61",job_category:"#9e2846"},bipartite_origine_category_type_metiers:{origine_category:"#289e61",job_category:"#9e2846"},bipartite_street_type_metiers:{street:"#289e61",job_category:"#9e2846"},bipartite_rue_origines:{street:"#289e61",origine_category:"#9e2846"},bipartite_divisions_origines:{division:"#289e61",origine_category:"#9e2846"}},z1={road_vocation_data:{title:"Rues & Professions",text:"Ce premier graphe tisse un lien entre les vocations et les rues, mettant en évidence les interactions entre elles. Chaque métier est associé à une rue, représentée par la taille des nœuds correspondants qui reflètent le nombre de personnes impliquées. Les connexions entre les rues et les métiers révèlent des proximités intéressantes : par exemple, les métiers liés à l'agriculture se trouvent à la périphérie du réseau, connectés à leurs habitants vivant à la campagne. Il est également remarquable que les propriétaires se situent également à la périphérie du réseau, indiquant que les rentiers ont souvent tendance à résider en dehors de la ville. De plus, des rues qui ont une proximité géographique, comme la <i>Rue du Pré</i>, <i>Marterey</i> et la <i>Rue de l'Hôpital</i> se retrouvent aussi proche dans le réseau, révélant une similarité dans la composition professionnelle de leurs résidents. Les métiers de marchands, tailleurs et cordonniers, étroitement liés au commerce et à l'artisanat, s'entrelacent dans la même section du réseau, aux côtés de places renommées telles que <i>la Palud</i> et <i>Saint-Laurent</i>, réputées pour leur dynamisme économique."},bipartite_division_type_metiers:{title:"Répartition Professionnelle",text:"Ce graphe met en lumière les liens entre les divisions de la ville de Lausanne et les classes de métiers. Il offre une vue claire sur la répartition des professions à travers la ville. Par exemple, il est évident que la majorité des rentiers proviennent des divisions d'<i>Ouchy</i> et de <i>Marterey</i>."},bipartite_origine_category_type_metiers:{title:"Origines & Vocations",text:"Cette visualisation dévoile les interactions entre les classes d'origine et les classes de vocations. On peut remarquer qu'<i>Yverdon</i> se distingue par une plus grande concentration de constructeurs et d'artisans. <i>Le Lavaux</i>, région connue pour son paysage viticole et agricole, présente une majorité de personnes engagées dans l'agriculture."},bipartite_street_type_metiers:{title:"Rues d'Expertise",text:"Ce graphe lie les classes de métiers aux rues, offrant une perspective encore plus granulaire de la vie à Lausanne au XIX<sup>ème</sup> siècle. Certaines petites rues présentent une faible diversité de vocations, comme <i>Vidy</i>, <i>Paleyres</i>, et <i>Petit Ouchy</i>, où prédominent l'agriculture en périphérie de la ville. Les métiers liés à l'agriculture et à la rente sont connectés par des petits hameaux de campagne, tandis que les métiers du commerce et de l'artisanat se placent à l'opposé dans le réseau, se concentrant en ville."},bipartite_rue_origines:{title:"Rues Multiculturelles",text:"Cette nouvelle visualisation lie les rues de Lausanne à leurs classes d'origine, offrant une compréhension encore plus nuancée des dynamiques sociales de la ville. Chaque rue se voit attribuer un spectre d'origines, révélant la diversité et la complexité de la composition démographique de la ville. De cette manière, on peut mieux apprécier l'histoire multiculturelle de Lausanne, où chaque rue porte en elle les traces de nombreuses origines différentes, formant un patchwork unique de cultures et de traditions."},bipartite_divisions_origines:{title:"Origines Divisionnaires",text:"Cette dernière visualisation établit un lien direct entre les divisions de la ville et les origines de ses habitants. Elle offre une vue panoramique de la diversité culturelle, illustrant comment les différentes origines ont contribué à la formation de chaque division. À travers ce graphe, nous pouvons voir comment Lausanne, même à cette époque, était un creuset de cultures, où chaque division a été façonnée par une mosaïque d'origines différentes, contribuant à l'identité unique de la ville."}},$1=.1,F1=10;class B1{constructor(e=.7,n=.7,i=.1,r=7,a=40,s=1,c=8,f=5,u=5,d=5,p=-700,g=2,m=200){it(this,"svg");it(this,"gnodes");it(this,"glinks");it(this,"simulation");it(this,"data");it(this,"container");it(this,"dragActive",!1);it(this,"networkName",k1);it(this,"linkedById");this.expNodeSizeScale=e,this.expLinkWeightScale=n,this.transparency=i,this.minNodeSize=r,this.maxNodeSize=a,this.minLinkWeight=s,this.maxLinkWeight=c,this.labelSizeAdd=f,this.nodeSizeInc=u,this.labelSizeInc=d,this.chargeStrength=p,this.collideSizeAdd=g,this.transitionDuration=m,this.initDimensions(),this.initStaticElements(),this.initEvents(),this.updatePlot(L1)}async loadData(e){const n=`${T1}/${e}.json`;return new Promise(i=>{Te(n).then(r=>{i(r)})})}initDimensions(){this.container=Q(N1);const e=document.getElementById(I1);e&&(this.width=e.clientWidth,this.height=e.clientHeight)}initStaticElements(){this.svg=this.container.append("svg").attr("width",this.width).attr("height",this.height),this.glinks=this.svg.append("g").attr("class","links"),this.gnodes=this.svg.append("g").attr("class","nodes")}initEvents(){const e=document.getElementById("graph-selector");e&&e.addEventListener("change",n=>{const i=n.target.value;this.updatePlot(i)})}get_scaled_size(e,n,i,r,a){return i-n==0?(r+a)/2:r+(e-n)*(a-r)/(i-n)}isConnected(e,n){return this.linkedById[e].indexOf(n)>-1||this.linkedById[n].indexOf(e)>-1||e==n}drag(e){const n=a=>{this.dragActive=!0,a.active||e.alphaTarget(.3).restart(),a.subject.fx=a.subject.x,a.subject.fy=a.subject.y},i=a=>{a.subject.fx=a.x,a.subject.fy=a.y},r=a=>{this.dragActive=!1,a.active||e.alphaTarget(0),a.subject.fx=null,a.subject.fy=null};return Pg().on("start",n).on("drag",i).on("end",r)}initData(){let e=this.data.nodes.reduce((a,s)=>Math.max(a,s.size),0),n=this.data.nodes.reduce((a,s)=>Math.min(a,s.size),1/0);e=Math.pow(e,this.expNodeSizeScale),n=Math.pow(n,this.expNodeSizeScale),this.data.nodes.forEach(a=>a.size=this.get_scaled_size(Math.pow(a.size,this.expNodeSizeScale),n,e,this.minNodeSize,this.maxNodeSize));let i=this.data.links.reduce((a,s)=>Math.max(a,s.weight),0),r=this.data.links.reduce((a,s)=>Math.min(a,s.weight),1/0);i=Math.pow(i,this.expLinkWeightScale),r=Math.pow(r,this.expLinkWeightScale),this.data.links.forEach(a=>a.weight=this.get_scaled_size(Math.pow(a.weight,this.expLinkWeightScale),r,i,this.minLinkWeight,this.maxLinkWeight)),this.linkedById={},this.data.links.forEach(a=>{this.linkedById[a.source]=[],this.linkedById[a.target]=[]}),this.data.links.forEach(a=>{this.linkedById[a.source].push(a.target),this.linkedById[a.target].push(a.source)})}createLinks(){this.glinks.attr("stroke",P1).attr("stroke-opacity",1).selectAll("line").data(this.data.links).enter().append("line").attr("stroke-width",function(e){return e.weight})}createNodes(){const e=this.gnodes.selectAll(".node").data(this.data.nodes).enter().append("g").attr("class","node");e.append("circle").attr("class","node-circle").attr("r",function(n){return n.size}).attr("fill",n=>{const i=R1[this.networkName],r=i?i[n.type]:Ru;return r||Ru}).call(this.drag(this.simulation)).on("mouseover",(n,i)=>{if(this.dragActive)return;const r=i.id;this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",a=>this.isConnected(r,a.id)||a.id==r?1:this.transparency).attr("r",a=>{if(a.id==r)return a.size+this.nodeSizeInc;if(this.isConnected(r,a.id)){let s=this.data.links.find(p=>p.source.id==a.id&&p.target.id==r||p.source.id==r&&p.target.id==a.id).weight;this.linkedById[r];const c=this.data.links.filter(p=>p.source.id==r||p.target.id==r),f=c.reduce((p,g)=>Math.min(p,g.weight),1/0),u=c.reduce((p,g)=>Math.max(p,g.weight),-1/0);return this.get_scaled_size(s,f,u,this.minNodeSize,this.maxNodeSize)}return a.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",a=>a.source.id==r||a.target.id==r?1:this.transparency),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",a=>this.isConnected(r,a.id)||a.id==r?1:this.transparency).attr("font-size",a=>{if(a.id==r)return a.size+this.labelSizeInc+this.labelSizeAdd;if(this.isConnected(r,a.id)){let s=this.data.links.find(p=>p.source.id==a.id&&p.target.id==r||p.source.id==r&&p.target.id==a.id).weight;this.linkedById[r];const c=this.data.links.filter(p=>p.source.id==r||p.target.id==r),f=c.reduce((p,g)=>Math.min(p,g.weight),1/0),u=c.reduce((p,g)=>Math.max(p,g.weight),-1/0);return this.get_scaled_size(s,f,u,this.minNodeSize,this.maxNodeSize)+this.labelSizeAdd}return a.size+this.labelSizeAdd})}).on("mouseout",n=>{this.dragActive||(this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("r",function(i){return i.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",1),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("font-size",i=>i.size+this.labelSizeAdd))}),e.append("text").attr("class","node-text").text(function(n){return O1(n.label)}).attr("font-size",n=>n.size+this.labelSizeAdd).attr("font-family","sans-serif").attr("font-weight","bold").attr("text-anchor","middle").attr("alignment-baseline","middle").style("pointer-events","none")}initZoom(){let e=!1;const n=Zc().scaleExtent([$1,F1]).on("zoom",i=>{if(e)return;if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&i.sourceEvent instanceof WheelEvent){e=!0,n.transform(this.svg,on),e=!1;return}this.gnodes.attr("transform",i.transform),this.glinks.attr("transform",i.transform)});this.svg.call(n)}initSimulation(){this.simulation=a0().force("link",Jm().id(function(n){return n.id})).force("charge",s0().strength(this.chargeStrength)).force("center",Im(this.width/2,this.height/2)).force("collide",Km().radius(n=>n.size+this.collideSizeAdd));const e=()=>{this.glinks.selectAll("line").attr("x1",n=>n.source.x).attr("y1",n=>n.source.y).attr("x2",n=>n.target.x).attr("y2",n=>n.target.y),this.gnodes.selectAll(".node-circle").attr("cx",n=>n.x).attr("cy",n=>n.y),this.gnodes.selectAll(".node-text").attr("x",n=>n.x+10).attr("y",n=>n.y+4).attr("dx",-9).attr("dy",".1em")};this.simulation.nodes(this.data.nodes).on("tick",e),this.simulation.force("link").links(this.data.links)}async updatePlot(e){return new Promise(n=>{this.loadData(e).then(i=>{this.networkName=e,this.deletePlot(),this.data=i,this.initData(),this.initSimulation(),this.createLinks(),this.createNodes(),this.initZoom();const r=document.querySelector(C1),a=document.querySelector(D1),s=z1[e];r&&a&&(r.innerHTML=s.title,a.innerHTML=s.text)}),n()})}deletePlot(){this.gnodes.selectAll("*").remove(),this.glinks.selectAll("*").remove()}}document.addEventListener("DOMContentLoaded",()=>{console.log("Loading networks..."),new B1,console.log("Networks loaded.")});

var aa=Object.defineProperty;var sa=(t,e,n)=>e in t?aa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var O=(t,e,n)=>(sa(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function Ne(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ii(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Yr(t){let e,n,i;t.length!==2?(e=Ne,n=(s,l)=>Ne(t(s),l),i=(s,l)=>t(s)-l):(e=t===Ne||t===ii?t:ua,n=t,i=t);function r(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(s[h],l)<0?u=h+1:c=h}while(u<c)}return u}function o(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;n(s[h],l)<=0?u=h+1:c=h}while(u<c)}return u}function a(s,l,u=0,c=s.length){const h=r(s,l,u,c-1);return h>u&&i(s[h-1],l)>-i(s[h],l)?h-1:h}return{left:r,center:a,right:o}}function ua(){return 0}function la(t){return t===null?NaN:+t}const ca=Yr(Ne),fa=ca.right;Yr(la).center;const ha=fa;class Nt{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],a=e+o,s=Math.abs(e)<Math.abs(o)?e-(a-o):o-(a-e);s&&(n[i++]=s),e=a}return n[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let n=this._n,i,r,o,a=0;if(n>0){for(a=e[--n];n>0&&(i=a,r=e[--n],a=i+r,o=r-(a-i),!o););n>0&&(o<0&&e[n-1]<0||o>0&&e[n-1]>0)&&(r=o*2,i=a+r,r==i-a&&(a=i))}return a}}class Mi extends Map{constructor(e,n=Zr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,r]of e)this.set(i,r)}get(e){return super.get(An(this,e))}has(e){return super.has(An(this,e))}set(e,n){return super.set(Ur(this,e),n)}delete(e){return super.delete(Vr(this,e))}}class da extends Set{constructor(e,n=Zr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const i of e)this.add(i)}has(e){return super.has(An(this,e))}add(e){return super.add(Ur(this,e))}delete(e){return super.delete(Vr(this,e))}}function An({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function Ur({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function Vr({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function Zr(t){return t!==null&&typeof t=="object"?t.valueOf():t}const pa=Math.sqrt(50),ga=Math.sqrt(10),ma=Math.sqrt(2);function $e(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),a=o>=pa?10:o>=ga?5:o>=ma?2:1;let s,l,u;return r<0?(u=Math.pow(10,-r)/a,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,r)*a,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?$e(t,e,n*2):[s,l,u]}function ya(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,o,a]=i?$e(e,t,n):$e(t,e,n);if(!(o>=r))return[];const s=o-r+1,l=new Array(s);if(i)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(r+u)/-a;else for(let u=0;u<s;++u)l[u]=(r+u)*a;return l}function Nn(t,e,n){return e=+e,t=+t,n=+n,$e(t,e,n)[2]}function va(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?Nn(e,t,n):Nn(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function ri(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function _a(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function*xa(t){for(const e of t)yield*e}function Wr(t){return Array.from(xa(t))}function wa(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(r);++i<r;)o[i]=t+i*n;return o}function mt(t,e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof e!="function")throw new TypeError("mapper is not a function");return Array.from(t,(n,i)=>e(n,i,t))}function ba(...t){const e=new da;for(const n of t)for(const i of n)e.add(i);return e}function Ea(t){return t}var fn=1,hn=2,Ln=3,Zt=4,Si=1e-6;function Ma(t){return"translate("+t+",0)"}function Sa(t){return"translate(0,"+t+")"}function ka(t){return e=>+t(e)}function Aa(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Na(){return!this.__axis}function Kr(t,e){var n=[],i=null,r=null,o=6,a=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===fn||t===Zt?-1:1,c=t===Zt||t===hn?"x":"y",h=t===fn||t===Ln?Ma:Sa;function f(d){var p=i??(e.ticks?e.ticks.apply(e,n):e.domain()),x=r??(e.tickFormat?e.tickFormat.apply(e,n):Ea),v=Math.max(o,0)+s,m=e.range(),E=+m[0]+l,A=+m[m.length-1]+l,y=(e.bandwidth?Aa:ka)(e.copy(),l),S=d.selection?d.selection():d,L=S.selectAll(".domain").data([null]),T=S.selectAll(".tick").data(p,e).order(),D=T.exit(),z=T.enter().append("g").attr("class","tick"),$=T.select("line"),N=T.select("text");L=L.merge(L.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),T=T.merge(z),$=$.merge(z.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),N=N.merge(z.append("text").attr("fill","currentColor").attr(c,u*v).attr("dy",t===fn?"0em":t===Ln?"0.71em":"0.32em")),d!==S&&(L=L.transition(d),T=T.transition(d),$=$.transition(d),N=N.transition(d),D=D.transition(d).attr("opacity",Si).attr("transform",function(q){return isFinite(q=y(q))?h(q+l):this.getAttribute("transform")}),z.attr("opacity",Si).attr("transform",function(q){var P=this.parentNode.__axis;return h((P&&isFinite(P=P(q))?P:y(q))+l)})),D.remove(),L.attr("d",t===Zt||t===hn?a?"M"+u*a+","+E+"H"+l+"V"+A+"H"+u*a:"M"+l+","+E+"V"+A:a?"M"+E+","+u*a+"V"+l+"H"+A+"V"+u*a:"M"+E+","+l+"H"+A),T.attr("opacity",1).attr("transform",function(q){return h(y(q)+l)}),$.attr(c+"2",u*o),N.attr(c,u*v).text(x),S.filter(Na).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===hn?"start":t===Zt?"end":"middle"),S.each(function(){this.__axis=y})}return f.scale=function(d){return arguments.length?(e=d,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(n=d==null?[]:Array.from(d),f):n.slice()},f.tickValues=function(d){return arguments.length?(i=d==null?null:Array.from(d),f):i&&i.slice()},f.tickFormat=function(d){return arguments.length?(r=d,f):r},f.tickSize=function(d){return arguments.length?(o=a=+d,f):o},f.tickSizeInner=function(d){return arguments.length?(o=+d,f):o},f.tickSizeOuter=function(d){return arguments.length?(a=+d,f):a},f.tickPadding=function(d){return arguments.length?(s=+d,f):s},f.offset=function(d){return arguments.length?(l=+d,f):l},f}function Ot(t){return Kr(Ln,t)}function Ie(t){return Kr(Zt,t)}var La={value:()=>{}};function fe(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Le(n)}function Le(t){this._=t}function Ta(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Le.prototype=fe.prototype={constructor:Le,on:function(t,e){var n=this._,i=Ta(t+"",n),r,o=-1,a=i.length;if(arguments.length<2){for(;++o<a;)if((r=(t=i[o]).type)&&(r=Ca(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(r=(t=i[o]).type)n[r]=ki(n[r],t.name,e);else if(e==null)for(r in n)n[r]=ki(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Le(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};function Ca(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function ki(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=La,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var Tn="http://www.w3.org/1999/xhtml";const Ai={svg:"http://www.w3.org/2000/svg",xhtml:Tn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function on(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Ai.hasOwnProperty(e)?{space:Ai[e],local:t}:t}function Da(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Tn&&e.documentElement.namespaceURI===Tn?e.createElement(t):e.createElementNS(n,t)}}function za(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Jr(t){var e=on(t);return(e.local?za:Da)(e)}function $a(){}function oi(t){return t==null?$a:function(){return this.querySelector(t)}}function Ia(t){typeof t!="function"&&(t=oi(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],a=o.length,s=i[r]=new Array(a),l,u,c=0;c<a;++c)(l=o[c])&&(u=t.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new J(i,this._parents)}function Qr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Pa(){return[]}function to(t){return t==null?Pa:function(){return this.querySelectorAll(t)}}function qa(t){return function(){return Qr(t.apply(this,arguments))}}function Ra(t){typeof t=="function"?t=qa(t):t=to(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var a=e[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(i.push(t.call(l,l.__data__,u,a)),r.push(l));return new J(i,r)}function eo(t){return function(){return this.matches(t)}}function no(t){return function(e){return e.matches(t)}}var Oa=Array.prototype.find;function Fa(t){return function(){return Oa.call(this.children,t)}}function Ba(){return this.firstElementChild}function Ha(t){return this.select(t==null?Ba:Fa(typeof t=="function"?t:no(t)))}var Ga=Array.prototype.filter;function Xa(){return Array.from(this.children)}function ja(t){return function(){return Ga.call(this.children,t)}}function Ya(t){return this.selectAll(t==null?Xa:ja(typeof t=="function"?t:no(t)))}function Ua(t){typeof t!="function"&&(t=eo(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],a=o.length,s=i[r]=[],l,u=0;u<a;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&s.push(l);return new J(i,this._parents)}function io(t){return new Array(t.length)}function Va(){return new J(this._enter||this._groups.map(io),this._parents)}function Pe(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Pe.prototype={constructor:Pe,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Za(t){return function(){return t}}function Wa(t,e,n,i,r,o){for(var a=0,s,l=e.length,u=o.length;a<u;++a)(s=e[a])?(s.__data__=o[a],i[a]=s):n[a]=new Pe(t,o[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function Ka(t,e,n,i,r,o,a){var s,l,u=new Map,c=e.length,h=o.length,f=new Array(c),d;for(s=0;s<c;++s)(l=e[s])&&(f[s]=d=a.call(l,l.__data__,s,e)+"",u.has(d)?r[s]=l:u.set(d,l));for(s=0;s<h;++s)d=a.call(t,o[s],s,o)+"",(l=u.get(d))?(i[s]=l,l.__data__=o[s],u.delete(d)):n[s]=new Pe(t,o[s]);for(s=0;s<c;++s)(l=e[s])&&u.get(f[s])===l&&(r[s]=l)}function Ja(t){return t.__data__}function Qa(t,e){if(!arguments.length)return Array.from(this,Ja);var n=e?Ka:Wa,i=this._parents,r=this._groups;typeof t!="function"&&(t=Za(t));for(var o=r.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=i[u],h=r[u],f=h.length,d=ts(t.call(c,c&&c.__data__,u,i)),p=d.length,x=s[u]=new Array(p),v=a[u]=new Array(p),m=l[u]=new Array(f);n(c,h,x,v,m,d,e);for(var E=0,A=0,y,S;E<p;++E)if(y=x[E]){for(E>=A&&(A=E+1);!(S=v[A])&&++A<p;);y._next=S||null}}return a=new J(a,i),a._enter=s,a._exit=l,a}function ts(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function es(){return new J(this._exit||this._groups.map(io),this._parents)}function ns(t,e,n){var i=this.enter(),r=this,o=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function is(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,o=i.length,a=Math.min(r,o),s=new Array(r),l=0;l<a;++l)for(var u=n[l],c=i[l],h=u.length,f=s[l]=new Array(h),d,p=0;p<h;++p)(d=u[p]||c[p])&&(f[p]=d);for(;l<r;++l)s[l]=n[l];return new J(s,this._parents)}function rs(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,o=i[r],a;--r>=0;)(a=i[r])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function os(t){t||(t=as);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a=n[o],s=a.length,l=r[o]=new Array(s),u,c=0;c<s;++c)(u=a[c])&&(l[c]=u);l.sort(e)}return new J(r,this._parents).order()}function as(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ss(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function us(){return Array.from(this)}function ls(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null}function cs(){let t=0;for(const e of this)++t;return t}function fs(){return!this.node()}function hs(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],o=0,a=r.length,s;o<a;++o)(s=r[o])&&t.call(s,s.__data__,o,r);return this}function ds(t){return function(){this.removeAttribute(t)}}function ps(t){return function(){this.removeAttributeNS(t.space,t.local)}}function gs(t,e){return function(){this.setAttribute(t,e)}}function ms(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ys(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function vs(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function _s(t,e){var n=on(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?ps:ds:typeof e=="function"?n.local?vs:ys:n.local?ms:gs)(n,e))}function ro(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function xs(t){return function(){this.style.removeProperty(t)}}function ws(t,e,n){return function(){this.style.setProperty(t,e,n)}}function bs(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Es(t,e,n){return arguments.length>1?this.each((e==null?xs:typeof e=="function"?bs:ws)(t,e,n??"")):Ft(this.node(),t)}function Ft(t,e){return t.style.getPropertyValue(e)||ro(t).getComputedStyle(t,null).getPropertyValue(e)}function Ms(t){return function(){delete this[t]}}function Ss(t,e){return function(){this[t]=e}}function ks(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function As(t,e){return arguments.length>1?this.each((e==null?Ms:typeof e=="function"?ks:Ss)(t,e)):this.node()[t]}function oo(t){return t.trim().split(/^|\s+/)}function ai(t){return t.classList||new ao(t)}function ao(t){this._node=t,this._names=oo(t.getAttribute("class")||"")}ao.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function so(t,e){for(var n=ai(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function uo(t,e){for(var n=ai(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Ns(t){return function(){so(this,t)}}function Ls(t){return function(){uo(this,t)}}function Ts(t,e){return function(){(e.apply(this,arguments)?so:uo)(this,t)}}function Cs(t,e){var n=oo(t+"");if(arguments.length<2){for(var i=ai(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Ts:e?Ns:Ls)(n,e))}function Ds(){this.textContent=""}function zs(t){return function(){this.textContent=t}}function $s(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Is(t){return arguments.length?this.each(t==null?Ds:(typeof t=="function"?$s:zs)(t)):this.node().textContent}function Ps(){this.innerHTML=""}function qs(t){return function(){this.innerHTML=t}}function Rs(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Os(t){return arguments.length?this.each(t==null?Ps:(typeof t=="function"?Rs:qs)(t)):this.node().innerHTML}function Fs(){this.nextSibling&&this.parentNode.appendChild(this)}function Bs(){return this.each(Fs)}function Hs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Gs(){return this.each(Hs)}function Xs(t){var e=typeof t=="function"?t:Jr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function js(){return null}function Ys(t,e){var n=typeof t=="function"?t:Jr(t),i=e==null?js:typeof e=="function"?e:oi(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Us(){var t=this.parentNode;t&&t.removeChild(this)}function Vs(){return this.each(Us)}function Zs(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ws(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ks(t){return this.select(t?Ws:Zs)}function Js(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Qs(t){return function(e){t.call(this,e,this.__data__)}}function tu(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function eu(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,o;n<r;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++i]=o;++i?e.length=i:delete this.__on}}}function nu(t,e,n){return function(){var i=this.__on,r,o=Qs(e);if(i){for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=e;return}}this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function iu(t,e,n){var i=tu(t+""),r,o=i.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(r=0,c=s[l];r<o;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value}return}for(s=e?nu:eu,r=0;r<o;++r)this.each(s(i[r],e,n));return this}function lo(t,e,n){var i=ro(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ru(t,e){return function(){return lo(this,t,e)}}function ou(t,e){return function(){return lo(this,t,e.apply(this,arguments))}}function au(t,e){return this.each((typeof e=="function"?ou:ru)(t,e))}function*su(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length,a;r<o;++r)(a=i[r])&&(yield a)}var si=[null];function J(t,e){this._groups=t,this._parents=e}function he(){return new J([[document.documentElement]],si)}function uu(){return this}J.prototype=he.prototype={constructor:J,select:Ia,selectAll:Ra,selectChild:Ha,selectChildren:Ya,filter:Ua,data:Qa,enter:Va,exit:es,join:ns,merge:is,selection:uu,order:rs,sort:os,call:ss,nodes:us,node:ls,size:cs,empty:fs,each:hs,attr:_s,style:Es,property:As,classed:Cs,text:Is,html:Os,raise:Bs,lower:Gs,append:Xs,insert:Ys,remove:Vs,clone:Ks,datum:Js,on:iu,dispatch:au,[Symbol.iterator]:su};function R(t){return typeof t=="string"?new J([[document.querySelector(t)]],[document.documentElement]):new J([[t]],si)}function lu(t){let e;for(;e=t.sourceEvent;)t=e;return t}function vt(t,e){if(t=lu(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}function pe(t){return typeof t=="string"?new J([document.querySelectorAll(t)],[document.documentElement]):new J([Qr(t)],si)}const cu={passive:!1},re={capture:!0,passive:!1};function dn(t){t.stopImmediatePropagation()}function Pt(t){t.preventDefault(),t.stopImmediatePropagation()}function co(t){var e=t.document.documentElement,n=R(t).on("dragstart.drag",Pt,re);"onselectstart"in e?n.on("selectstart.drag",Pt,re):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function fo(t,e){var n=t.document.documentElement,i=R(t).on("dragstart.drag",null);e&&(i.on("click.drag",Pt,re),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ge=t=>()=>t;function Cn(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:o,x:a,y:s,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}Cn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function fu(t){return!t.ctrlKey&&!t.button}function hu(){return this.parentNode}function du(t,e){return e??{x:t.x,y:t.y}}function pu(){return navigator.maxTouchPoints||"ontouchstart"in this}function gu(){var t=fu,e=hu,n=du,i=pu,r={},o=fe("start","drag","end"),a=0,s,l,u,c,h=0;function f(y){y.on("mousedown.drag",d).filter(i).on("touchstart.drag",v).on("touchmove.drag",m,cu).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(y,S){if(!(c||!t.call(this,y,S))){var L=A(this,e.call(this,y,S),y,S,"mouse");L&&(R(y.view).on("mousemove.drag",p,re).on("mouseup.drag",x,re),co(y.view),dn(y),u=!1,s=y.clientX,l=y.clientY,L("start",y))}}function p(y){if(Pt(y),!u){var S=y.clientX-s,L=y.clientY-l;u=S*S+L*L>h}r.mouse("drag",y)}function x(y){R(y.view).on("mousemove.drag mouseup.drag",null),fo(y.view,u),Pt(y),r.mouse("end",y)}function v(y,S){if(t.call(this,y,S)){var L=y.changedTouches,T=e.call(this,y,S),D=L.length,z,$;for(z=0;z<D;++z)($=A(this,T,y,S,L[z].identifier,L[z]))&&(dn(y),$("start",y,L[z]))}}function m(y){var S=y.changedTouches,L=S.length,T,D;for(T=0;T<L;++T)(D=r[S[T].identifier])&&(Pt(y),D("drag",y,S[T]))}function E(y){var S=y.changedTouches,L=S.length,T,D;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),T=0;T<L;++T)(D=r[S[T].identifier])&&(dn(y),D("end",y,S[T]))}function A(y,S,L,T,D,z){var $=o.copy(),N=vt(z||L,S),q,P,w;if((w=n.call(y,new Cn("beforestart",{sourceEvent:L,target:f,identifier:D,active:a,x:N[0],y:N[1],dx:0,dy:0,dispatch:$}),T))!=null)return q=w.x-N[0]||0,P=w.y-N[1]||0,function g(_,b,k){var M=N,C;switch(_){case"start":r[D]=g,C=a++;break;case"end":delete r[D],--a;case"drag":N=vt(k||b,S),C=a;break}$.call(_,y,new Cn(_,{sourceEvent:b,subject:w,target:f,identifier:D,active:C,x:N[0]+q,y:N[1]+P,dx:N[0]-M[0],dy:N[1]-M[1],dispatch:$}),T)}}return f.filter=function(y){return arguments.length?(t=typeof y=="function"?y:ge(!!y),f):t},f.container=function(y){return arguments.length?(e=typeof y=="function"?y:ge(y),f):e},f.subject=function(y){return arguments.length?(n=typeof y=="function"?y:ge(y),f):n},f.touchable=function(y){return arguments.length?(i=typeof y=="function"?y:ge(!!y),f):i},f.on=function(){var y=o.on.apply(o,arguments);return y===o?f:y},f.clickDistance=function(y){return arguments.length?(h=(y=+y)*y,f):Math.sqrt(h)},f}function ui(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ho(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function de(){}var oe=.7,qe=1/oe,qt="\\s*([+-]?\\d+)\\s*",ae="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mu=/^#([0-9a-f]{3,8})$/,yu=new RegExp(`^rgb\\(${qt},${qt},${qt}\\)$`),vu=new RegExp(`^rgb\\(${dt},${dt},${dt}\\)$`),_u=new RegExp(`^rgba\\(${qt},${qt},${qt},${ae}\\)$`),xu=new RegExp(`^rgba\\(${dt},${dt},${dt},${ae}\\)$`),wu=new RegExp(`^hsl\\(${ae},${dt},${dt}\\)$`),bu=new RegExp(`^hsla\\(${ae},${dt},${dt},${ae}\\)$`),Ni={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ui(de,Lt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Li,formatHex:Li,formatHex8:Eu,formatHsl:Mu,formatRgb:Ti,toString:Ti});function Li(){return this.rgb().formatHex()}function Eu(){return this.rgb().formatHex8()}function Mu(){return po(this).formatHsl()}function Ti(){return this.rgb().formatRgb()}function Lt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=mu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Ci(e):n===3?new tt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?me(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?me(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=yu.exec(t))?new tt(e[1],e[2],e[3],1):(e=vu.exec(t))?new tt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=_u.exec(t))?me(e[1],e[2],e[3],e[4]):(e=xu.exec(t))?me(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=wu.exec(t))?$i(e[1],e[2]/100,e[3]/100,1):(e=bu.exec(t))?$i(e[1],e[2]/100,e[3]/100,e[4]):Ni.hasOwnProperty(t)?Ci(Ni[t]):t==="transparent"?new tt(NaN,NaN,NaN,0):null}function Ci(t){return new tt(t>>16&255,t>>8&255,t&255,1)}function me(t,e,n,i){return i<=0&&(t=e=n=NaN),new tt(t,e,n,i)}function Su(t){return t instanceof de||(t=Lt(t)),t?(t=t.rgb(),new tt(t.r,t.g,t.b,t.opacity)):new tt}function Re(t,e,n,i){return arguments.length===1?Su(t):new tt(t,e,n,i??1)}function tt(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}ui(tt,Re,ho(de,{brighter(t){return t=t==null?qe:Math.pow(qe,t),new tt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?oe:Math.pow(oe,t),new tt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new tt(kt(this.r),kt(this.g),kt(this.b),Oe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Di,formatHex:Di,formatHex8:ku,formatRgb:zi,toString:zi}));function Di(){return`#${St(this.r)}${St(this.g)}${St(this.b)}`}function ku(){return`#${St(this.r)}${St(this.g)}${St(this.b)}${St((isNaN(this.opacity)?1:this.opacity)*255)}`}function zi(){const t=Oe(this.opacity);return`${t===1?"rgb(":"rgba("}${kt(this.r)}, ${kt(this.g)}, ${kt(this.b)}${t===1?")":`, ${t})`}`}function Oe(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function kt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function St(t){return t=kt(t),(t<16?"0":"")+t.toString(16)}function $i(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ut(t,e,n,i)}function po(t){if(t instanceof ut)return new ut(t.h,t.s,t.l,t.opacity);if(t instanceof de||(t=Lt(t)),!t)return new ut;if(t instanceof ut)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,l=(o+r)/2;return s?(e===o?a=(n-i)/s+(n<i)*6:n===o?a=(i-e)/s+2:a=(e-n)/s+4,s/=l<.5?o+r:2-o-r,a*=60):s=l>0&&l<1?0:a,new ut(a,s,l,t.opacity)}function Au(t,e,n,i){return arguments.length===1?po(t):new ut(t,e,n,i??1)}function ut(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}ui(ut,Au,ho(de,{brighter(t){return t=t==null?qe:Math.pow(qe,t),new ut(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?oe:Math.pow(oe,t),new ut(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new tt(pn(t>=240?t-240:t+120,r,i),pn(t,r,i),pn(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new ut(Ii(this.h),ye(this.s),ye(this.l),Oe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Oe(this.opacity);return`${t===1?"hsl(":"hsla("}${Ii(this.h)}, ${ye(this.s)*100}%, ${ye(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ii(t){return t=(t||0)%360,t<0?t+360:t}function ye(t){return Math.max(0,Math.min(1,t||0))}function pn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Nu(t,e,n,i,r){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*i+a*r)/6}function Lu(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],a=i>0?t[i-1]:2*r-o,s=i<e-1?t[i+2]:2*o-r;return Nu((n-i/e)*e,a,r,o,s)}}const li=t=>()=>t;function Tu(t,e){return function(n){return t+n*e}}function Cu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Du(t){return(t=+t)==1?go:function(e,n){return n-e?Cu(e,n,t):li(isNaN(e)?n:e)}}function go(t,e){var n=e-t;return n?Tu(t,n):li(isNaN(t)?e:t)}const Fe=function t(e){var n=Du(e);function i(r,o){var a=n((r=Re(r)).r,(o=Re(o)).r),s=n(r.g,o.g),l=n(r.b,o.b),u=go(r.opacity,o.opacity);return function(c){return r.r=a(c),r.g=s(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=t,i}(1);function zu(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Re(e[a]),i[a]=s.r||0,r[a]=s.g||0,o[a]=s.b||0;return i=t(i),r=t(r),o=t(o),s.opacity=1,function(l){return s.r=i(l),s.g=r(l),s.b=o(l),s+""}}}var $u=zu(Lu);function Iu(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function Pu(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function qu(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),o=new Array(n),a;for(a=0;a<i;++a)r[a]=an(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<i;++a)o[a]=r[a](s);return o}}function Ru(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function st(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ou(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=an(t[r],e[r]):i[r]=e[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var Dn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gn=new RegExp(Dn.source,"g");function Fu(t){return function(){return t}}function Bu(t){return function(e){return t(e)+""}}function mo(t,e){var n=Dn.lastIndex=gn.lastIndex=0,i,r,o,a=-1,s=[],l=[];for(t=t+"",e=e+"";(i=Dn.exec(t))&&(r=gn.exec(e));)(o=r.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(i=i[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:st(i,r)})),n=gn.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?Bu(l[0].x):Fu(e):(e=l.length,function(u){for(var c=0,h;c<e;++c)s[(h=l[c]).i]=h.x(u);return s.join("")})}function an(t,e){var n=typeof e,i;return e==null||n==="boolean"?li(e):(n==="number"?st:n==="string"?(i=Lt(e))?(e=i,Fe):mo:e instanceof Lt?Fe:e instanceof Date?Ru:Pu(e)?Iu:Array.isArray(e)?qu:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Ou:st)(t,e)}function yo(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Pi=180/Math.PI,zn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function vo(t,e,n,i,r,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*Pi,skewX:Math.atan(l)*Pi,scaleX:a,scaleY:s}}var ve;function Hu(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?zn:vo(e.a,e.b,e.c,e.d,e.e,e.f)}function Gu(t){return t==null||(ve||(ve=document.createElementNS("http://www.w3.org/2000/svg","g")),ve.setAttribute("transform",t),!(t=ve.transform.baseVal.consolidate()))?zn:(t=t.matrix,vo(t.a,t.b,t.c,t.d,t.e,t.f))}function _o(t,e,n,i){function r(u){return u.length?u.pop()+" ":""}function o(u,c,h,f,d,p){if(u!==h||c!==f){var x=d.push("translate(",null,e,null,n);p.push({i:x-4,x:st(u,h)},{i:x-2,x:st(c,f)})}else(h||f)&&d.push("translate("+h+e+f+n)}function a(u,c,h,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:h.push(r(h)+"rotate(",null,i)-2,x:st(u,c)})):c&&h.push(r(h)+"rotate("+c+i)}function s(u,c,h,f){u!==c?f.push({i:h.push(r(h)+"skewX(",null,i)-2,x:st(u,c)}):c&&h.push(r(h)+"skewX("+c+i)}function l(u,c,h,f,d,p){if(u!==h||c!==f){var x=d.push(r(d)+"scale(",null,",",null,")");p.push({i:x-4,x:st(u,h)},{i:x-2,x:st(c,f)})}else(h!==1||f!==1)&&d.push(r(d)+"scale("+h+","+f+")")}return function(u,c){var h=[],f=[];return u=t(u),c=t(c),o(u.translateX,u.translateY,c.translateX,c.translateY,h,f),a(u.rotate,c.rotate,h,f),s(u.skewX,c.skewX,h,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,h,f),u=c=null,function(d){for(var p=-1,x=f.length,v;++p<x;)h[(v=f[p]).i]=v.x(d);return h.join("")}}}var Xu=_o(Hu,"px, ","px)","deg)"),ju=_o(Gu,", ",")",")"),Yu=1e-12;function qi(t){return((t=Math.exp(t))+1/t)/2}function Uu(t){return((t=Math.exp(t))-1/t)/2}function Vu(t){return((t=Math.exp(2*t))-1)/(t+1)}const xo=function t(e,n,i){function r(o,a){var s=o[0],l=o[1],u=o[2],c=a[0],h=a[1],f=a[2],d=c-s,p=h-l,x=d*d+p*p,v,m;if(x<Yu)m=Math.log(f/u)/e,v=function(T){return[s+T*d,l+T*p,u*Math.exp(e*T*m)]};else{var E=Math.sqrt(x),A=(f*f-u*u+i*x)/(2*u*n*E),y=(f*f-u*u-i*x)/(2*f*n*E),S=Math.log(Math.sqrt(A*A+1)-A),L=Math.log(Math.sqrt(y*y+1)-y);m=(L-S)/e,v=function(T){var D=T*m,z=qi(S),$=u/(n*E)*(z*Vu(e*D+S)-Uu(S));return[s+$*d,l+$*p,u*z/qi(e*D+S)]}}return v.duration=m*1e3*e/Math.SQRT2,v}return r.rho=function(o){var a=Math.max(.001,+o),s=a*a,l=s*s;return t(a,s,l)},r}(Math.SQRT2,2,4);var Bt=0,Wt=0,jt=0,wo=1e3,Be,Kt,He=0,Tt=0,sn=0,se=typeof performance=="object"&&performance.now?performance:Date,bo=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ci(){return Tt||(bo(Zu),Tt=se.now()+sn)}function Zu(){Tt=0}function Ge(){this._call=this._time=this._next=null}Ge.prototype=fi.prototype={constructor:Ge,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?ci():+n)+(e==null?0:+e),!this._next&&Kt!==this&&(Kt?Kt._next=this:Be=this,Kt=this),this._call=t,this._time=n,$n()},stop:function(){this._call&&(this._call=null,this._time=1/0,$n())}};function fi(t,e,n){var i=new Ge;return i.restart(t,e,n),i}function Wu(){ci(),++Bt;for(var t=Be,e;t;)(e=Tt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Bt}function Ri(){Tt=(He=se.now())+sn,Bt=Wt=0;try{Wu()}finally{Bt=0,Ju(),Tt=0}}function Ku(){var t=se.now(),e=t-He;e>wo&&(sn-=e,He=t)}function Ju(){for(var t,e=Be,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Be=n);Kt=t,$n(i)}function $n(t){if(!Bt){Wt&&(Wt=clearTimeout(Wt));var e=t-Tt;e>24?(t<1/0&&(Wt=setTimeout(Ri,t-se.now()-sn)),jt&&(jt=clearInterval(jt))):(jt||(He=se.now(),jt=setInterval(Ku,wo)),Bt=1,bo(Ri))}}function Oi(t,e,n){var i=new Ge;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var Qu=fe("start","end","cancel","interrupt"),tl=[],Eo=0,Fi=1,In=2,Te=3,Bi=4,Pn=5,Ce=6;function un(t,e,n,i,r,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;el(t,n,{name:e,index:i,group:r,on:Qu,tween:tl,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Eo})}function hi(t,e){var n=ct(t,e);if(n.state>Eo)throw new Error("too late; already scheduled");return n}function pt(t,e){var n=ct(t,e);if(n.state>Te)throw new Error("too late; already running");return n}function ct(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function el(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=fi(o,0,n.time);function o(u){n.state=Fi,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var c,h,f,d;if(n.state!==Fi)return l();for(c in i)if(d=i[c],d.name===n.name){if(d.state===Te)return Oi(a);d.state===Bi?(d.state=Ce,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[c]):+c<e&&(d.state=Ce,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[c])}if(Oi(function(){n.state===Te&&(n.state=Bi,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=In,n.on.call("start",t,t.__data__,n.index,n.group),n.state===In){for(n.state=Te,r=new Array(f=n.tween.length),c=0,h=-1;c<f;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++h]=d);r.length=h+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=Pn,1),h=-1,f=r.length;++h<f;)r[h].call(t,c);n.state===Pn&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Ce,n.timer.stop(),delete i[e];for(var u in i)return;delete t.__transition}}function De(t,e){var n=t.__transition,i,r,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((i=n[a]).name!==e){o=!1;continue}r=i.state>In&&i.state<Pn,i.state=Ce,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[a]}o&&delete t.__transition}}function nl(t){return this.each(function(){De(this,t)})}function il(t,e){var n,i;return function(){var r=pt(this,t),o=r.tween;if(o!==n){i=n=o;for(var a=0,s=i.length;a<s;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}r.tween=i}}function rl(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=pt(this,t),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:e,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===e){r[l]=s;break}l===u&&r.push(s)}o.tween=r}}function ol(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=ct(this.node(),n).tween,r=0,o=i.length,a;r<o;++r)if((a=i[r]).name===t)return a.value;return null}return this.each((e==null?il:rl)(n,t,e))}function di(t,e,n){var i=t._id;return t.each(function(){var r=pt(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return ct(r,i).value[e]}}function Mo(t,e){var n;return(typeof e=="number"?st:e instanceof Lt?Fe:(n=Lt(e))?(e=n,Fe):mo)(t,e)}function al(t){return function(){this.removeAttribute(t)}}function sl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ul(t,e,n){var i,r=n+"",o;return function(){var a=this.getAttribute(t);return a===r?null:a===i?o:o=e(i=a,n)}}function ll(t,e,n){var i,r=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===r?null:a===i?o:o=e(i=a,n)}}function cl(t,e,n){var i,r,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=s+"",a===l?null:a===i&&l===r?o:(r=l,o=e(i=a,s)))}}function fl(t,e,n){var i,r,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=s+"",a===l?null:a===i&&l===r?o:(r=l,o=e(i=a,s)))}}function hl(t,e){var n=on(t),i=n==="transform"?ju:Mo;return this.attrTween(t,typeof e=="function"?(n.local?fl:cl)(n,i,di(this,"attr."+t,e)):e==null?(n.local?sl:al)(n):(n.local?ll:ul)(n,i,e))}function dl(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function pl(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function gl(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&pl(t,o)),n}return r._value=e,r}function ml(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&dl(t,o)),n}return r._value=e,r}function yl(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=on(t);return this.tween(n,(i.local?gl:ml)(i,e))}function vl(t,e){return function(){hi(this,t).delay=+e.apply(this,arguments)}}function _l(t,e){return e=+e,function(){hi(this,t).delay=e}}function xl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?vl:_l)(e,t)):ct(this.node(),e).delay}function wl(t,e){return function(){pt(this,t).duration=+e.apply(this,arguments)}}function bl(t,e){return e=+e,function(){pt(this,t).duration=e}}function El(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?wl:bl)(e,t)):ct(this.node(),e).duration}function Ml(t,e){if(typeof e!="function")throw new Error;return function(){pt(this,t).ease=e}}function Sl(t){var e=this._id;return arguments.length?this.each(Ml(e,t)):ct(this.node(),e).ease}function kl(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;pt(this,t).ease=n}}function Al(t){if(typeof t!="function")throw new Error;return this.each(kl(this._id,t))}function Nl(t){typeof t!="function"&&(t=eo(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],a=o.length,s=i[r]=[],l,u=0;u<a;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&s.push(l);return new wt(i,this._parents,this._name,this._id)}function Ll(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var l=e[s],u=n[s],c=l.length,h=a[s]=new Array(c),f,d=0;d<c;++d)(f=l[d]||u[d])&&(h[d]=f);for(;s<i;++s)a[s]=e[s];return new wt(a,this._parents,this._name,this._id)}function Tl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Cl(t,e,n){var i,r,o=Tl(e)?hi:pt;return function(){var a=o(this,t),s=a.on;s!==i&&(r=(i=s).copy()).on(e,n),a.on=r}}function Dl(t,e){var n=this._id;return arguments.length<2?ct(this.node(),n).on.on(t):this.each(Cl(n,t,e))}function zl(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function $l(){return this.on("end.remove",zl(this._id))}function Il(t){var e=this._name,n=this._id;typeof t!="function"&&(t=oi(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s=i[a],l=s.length,u=o[a]=new Array(l),c,h,f=0;f<l;++f)(c=s[f])&&(h=t.call(c,c.__data__,f,s))&&("__data__"in c&&(h.__data__=c.__data__),u[f]=h,un(u[f],e,n,f,u,ct(c,n)));return new wt(o,this._parents,e,n)}function Pl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=to(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var l=i[s],u=l.length,c,h=0;h<u;++h)if(c=l[h]){for(var f=t.call(c,c.__data__,h,l),d,p=ct(c,n),x=0,v=f.length;x<v;++x)(d=f[x])&&un(d,e,n,x,f,p);o.push(f),a.push(c)}return new wt(o,a,e,n)}var ql=he.prototype.constructor;function Rl(){return new ql(this._groups,this._parents)}function Ol(t,e){var n,i,r;return function(){var o=Ft(this,t),a=(this.style.removeProperty(t),Ft(this,t));return o===a?null:o===n&&a===i?r:r=e(n=o,i=a)}}function So(t){return function(){this.style.removeProperty(t)}}function Fl(t,e,n){var i,r=n+"",o;return function(){var a=Ft(this,t);return a===r?null:a===i?o:o=e(i=a,n)}}function Bl(t,e,n){var i,r,o;return function(){var a=Ft(this,t),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),Ft(this,t))),a===l?null:a===i&&l===r?o:(r=l,o=e(i=a,s))}}function Hl(t,e){var n,i,r,o="style."+e,a="end."+o,s;return function(){var l=pt(this,t),u=l.on,c=l.value[o]==null?s||(s=So(e)):void 0;(u!==n||r!==c)&&(i=(n=u).copy()).on(a,r=c),l.on=i}}function Gl(t,e,n){var i=(t+="")=="transform"?Xu:Mo;return e==null?this.styleTween(t,Ol(t,i)).on("end.style."+t,So(t)):typeof e=="function"?this.styleTween(t,Bl(t,i,di(this,"style."+t,e))).each(Hl(this._id,t)):this.styleTween(t,Fl(t,i,e),n).on("end.style."+t,null)}function Xl(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function jl(t,e,n){var i,r;function o(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&Xl(t,a,n)),i}return o._value=e,o}function Yl(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,jl(t,e,n??""))}function Ul(t){return function(){this.textContent=t}}function Vl(t){return function(){var e=t(this);this.textContent=e??""}}function Zl(t){return this.tween("text",typeof t=="function"?Vl(di(this,"text",t)):Ul(t==null?"":t+""))}function Wl(t){return function(e){this.textContent=t.call(this,e)}}function Kl(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Wl(r)),e}return i._value=t,i}function Jl(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Kl(t))}function Ql(){for(var t=this._name,e=this._id,n=ko(),i=this._groups,r=i.length,o=0;o<r;++o)for(var a=i[o],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var c=ct(l,e);un(l,t,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new wt(i,this._parents,t,n)}function tc(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){--r===0&&o()}};n.each(function(){var u=pt(this,i),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),u.on=e}),r===0&&o()})}var ec=0;function wt(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function ko(){return++ec}var yt=he.prototype;wt.prototype={constructor:wt,select:Il,selectAll:Pl,selectChild:yt.selectChild,selectChildren:yt.selectChildren,filter:Nl,merge:Ll,selection:Rl,transition:Ql,call:yt.call,nodes:yt.nodes,node:yt.node,size:yt.size,empty:yt.empty,each:yt.each,on:Dl,attr:hl,attrTween:yl,style:Gl,styleTween:Yl,text:Zl,textTween:Jl,remove:$l,tween:ol,delay:xl,duration:El,ease:Sl,easeVarying:Al,end:tc,[Symbol.iterator]:yt[Symbol.iterator]};function nc(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var ic={time:null,delay:0,duration:250,ease:nc};function rc(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function oc(t){var e,n;t instanceof wt?(e=t._id,t=t._name):(e=ko(),(n=ic).time=ci(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a=i[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&un(l,t,e,u,a,n||rc(l,e));return new wt(i,this._parents,t,e)}he.prototype.interrupt=nl;he.prototype.transition=oc;function ac(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function Rt(t,e){return fetch(t,e).then(ac)}function sc(t,e){var n,i=1;t==null&&(t=0),e==null&&(e=0);function r(){var o,a=n.length,s,l=0,u=0;for(o=0;o<a;++o)s=n[o],l+=s.x,u+=s.y;for(l=(l/a-t)*i,u=(u/a-e)*i,o=0;o<a;++o)s=n[o],s.x-=l,s.y-=u}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(t=+o,r):t},r.y=function(o){return arguments.length?(e=+o,r):e},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function uc(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Ao(this.cover(e,n),e,n,t)}function Ao(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o=t._root,a={data:i},s=t._x0,l=t._y0,u=t._x1,c=t._y1,h,f,d,p,x,v,m,E;if(!o)return t._root=a,t;for(;o.length;)if((x=e>=(h=(s+u)/2))?s=h:u=h,(v=n>=(f=(l+c)/2))?l=f:c=f,r=o,!(o=o[m=v<<1|x]))return r[m]=a,t;if(d=+t._x.call(null,o.data),p=+t._y.call(null,o.data),e===d&&n===p)return a.next=o,r?r[m]=a:t._root=a,t;do r=r?r[m]=new Array(4):t._root=new Array(4),(x=e>=(h=(s+u)/2))?s=h:u=h,(v=n>=(f=(l+c)/2))?l=f:c=f;while((m=v<<1|x)===(E=(p>=f)<<1|d>=h));return r[E]=o,r[m]=a,t}function lc(t){var e,n,i=t.length,r,o,a=new Array(i),s=new Array(i),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(a[n]=r,s[n]=o,r<l&&(l=r),r>c&&(c=r),o<u&&(u=o),o>h&&(h=o));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<i;++n)Ao(this,a[n],s[n],t[n]);return this}function cc(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{for(var a=r-n||1,s=this._root,l,u;n>t||t>=r||i>e||e>=o;)switch(u=(e<i)<<1|t<n,l=new Array(4),l[u]=s,s=l,a*=2,u){case 0:r=n+a,o=i+a;break;case 1:n=r-a,o=i+a;break;case 2:r=n+a,i=o-a;break;case 3:n=r-a,i=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function fc(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function hc(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function K(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function dc(t,e,n){var i,r=this._x0,o=this._y0,a,s,l,u,c=this._x1,h=this._y1,f=[],d=this._root,p,x;for(d&&f.push(new K(d,r,o,c,h)),n==null?n=1/0:(r=t-n,o=e-n,c=t+n,h=e+n,n*=n);p=f.pop();)if(!(!(d=p.node)||(a=p.x0)>c||(s=p.y0)>h||(l=p.x1)<r||(u=p.y1)<o))if(d.length){var v=(a+l)/2,m=(s+u)/2;f.push(new K(d[3],v,m,l,u),new K(d[2],a,m,v,u),new K(d[1],v,s,l,m),new K(d[0],a,s,v,m)),(x=(e>=m)<<1|t>=v)&&(p=f[f.length-1],f[f.length-1]=f[f.length-1-x],f[f.length-1-x]=p)}else{var E=t-+this._x.call(null,d.data),A=e-+this._y.call(null,d.data),y=E*E+A*A;if(y<n){var S=Math.sqrt(n=y);r=t-S,o=e-S,c=t+S,h=e+S,i=d.data}}return i}function pc(t){if(isNaN(c=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,n=this._root,i,r,o,a=this._x0,s=this._y0,l=this._x1,u=this._y1,c,h,f,d,p,x,v,m;if(!n)return this;if(n.length)for(;;){if((p=c>=(f=(a+l)/2))?a=f:l=f,(x=h>=(d=(s+u)/2))?s=d:u=d,e=n,!(n=n[v=x<<1|p]))return this;if(!n.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(i=e,m=v)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):e?(o?e[v]=o:delete e[v],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[m]=n:this._root=n),this):(this._root=o,this)}function gc(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function mc(){return this._root}function yc(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function vc(t){var e=[],n,i=this._root,r,o,a,s,l;for(i&&e.push(new K(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,o=n.x0,a=n.y0,s=n.x1,l=n.y1)&&i.length){var u=(o+s)/2,c=(a+l)/2;(r=i[3])&&e.push(new K(r,u,c,s,l)),(r=i[2])&&e.push(new K(r,o,c,u,l)),(r=i[1])&&e.push(new K(r,u,a,s,c)),(r=i[0])&&e.push(new K(r,o,a,u,c))}return this}function _c(t){var e=[],n=[],i;for(this._root&&e.push(new K(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var o,a=i.x0,s=i.y0,l=i.x1,u=i.y1,c=(a+l)/2,h=(s+u)/2;(o=r[0])&&e.push(new K(o,a,s,c,h)),(o=r[1])&&e.push(new K(o,c,s,l,h)),(o=r[2])&&e.push(new K(o,a,h,c,u)),(o=r[3])&&e.push(new K(o,c,h,l,u))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function xc(t){return t[0]}function wc(t){return arguments.length?(this._x=t,this):this._x}function bc(t){return t[1]}function Ec(t){return arguments.length?(this._y=t,this):this._y}function pi(t,e,n){var i=new gi(e??xc,n??bc,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function gi(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Hi(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Q=pi.prototype=gi.prototype;Q.copy=function(){var t=new gi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=Hi(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=Hi(i));return t};Q.add=uc;Q.addAll=lc;Q.cover=cc;Q.data=fc;Q.extent=hc;Q.find=dc;Q.remove=pc;Q.removeAll=gc;Q.root=mc;Q.size=yc;Q.visit=vc;Q.visitAfter=_c;Q.x=wc;Q.y=Ec;function At(t){return function(){return t}}function Et(t){return(t()-.5)*1e-6}function Mc(t){return t.x+t.vx}function Sc(t){return t.y+t.vy}function kc(t){var e,n,i,r=1,o=1;typeof t!="function"&&(t=At(t==null?1:+t));function a(){for(var u,c=e.length,h,f,d,p,x,v,m=0;m<o;++m)for(h=pi(e,Mc,Sc).visitAfter(s),u=0;u<c;++u)f=e[u],x=n[f.index],v=x*x,d=f.x+f.vx,p=f.y+f.vy,h.visit(E);function E(A,y,S,L,T){var D=A.data,z=A.r,$=x+z;if(D){if(D.index>f.index){var N=d-D.x-D.vx,q=p-D.y-D.vy,P=N*N+q*q;P<$*$&&(N===0&&(N=Et(i),P+=N*N),q===0&&(q=Et(i),P+=q*q),P=($-(P=Math.sqrt(P)))/P*r,f.vx+=(N*=P)*($=(z*=z)/(v+z)),f.vy+=(q*=P)*$,D.vx-=N*($=1-$),D.vy-=q*$)}return}return y>d+$||L<d-$||S>p+$||T<p-$}}function s(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(e){var u,c=e.length,h;for(n=new Array(c),u=0;u<c;++u)h=e[u],n[h.index]=+t(h,u,e)}}return a.initialize=function(u,c){e=u,i=c,l()},a.iterations=function(u){return arguments.length?(o=+u,a):o},a.strength=function(u){return arguments.length?(r=+u,a):r},a.radius=function(u){return arguments.length?(t=typeof u=="function"?u:At(+u),l(),a):t},a}function Ac(t){return t.index}function Gi(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function Nc(t){var e=Ac,n=h,i,r=At(30),o,a,s,l,u,c=1;t==null&&(t=[]);function h(v){return 1/Math.min(s[v.source.index],s[v.target.index])}function f(v){for(var m=0,E=t.length;m<c;++m)for(var A=0,y,S,L,T,D,z,$;A<E;++A)y=t[A],S=y.source,L=y.target,T=L.x+L.vx-S.x-S.vx||Et(u),D=L.y+L.vy-S.y-S.vy||Et(u),z=Math.sqrt(T*T+D*D),z=(z-o[A])/z*v*i[A],T*=z,D*=z,L.vx-=T*($=l[A]),L.vy-=D*$,S.vx+=T*($=1-$),S.vy+=D*$}function d(){if(a){var v,m=a.length,E=t.length,A=new Map(a.map((S,L)=>[e(S,L,a),S])),y;for(v=0,s=new Array(m);v<E;++v)y=t[v],y.index=v,typeof y.source!="object"&&(y.source=Gi(A,y.source)),typeof y.target!="object"&&(y.target=Gi(A,y.target)),s[y.source.index]=(s[y.source.index]||0)+1,s[y.target.index]=(s[y.target.index]||0)+1;for(v=0,l=new Array(E);v<E;++v)y=t[v],l[v]=s[y.source.index]/(s[y.source.index]+s[y.target.index]);i=new Array(E),p(),o=new Array(E),x()}}function p(){if(a)for(var v=0,m=t.length;v<m;++v)i[v]=+n(t[v],v,t)}function x(){if(a)for(var v=0,m=t.length;v<m;++v)o[v]=+r(t[v],v,t)}return f.initialize=function(v,m){a=v,u=m,d()},f.links=function(v){return arguments.length?(t=v,d(),f):t},f.id=function(v){return arguments.length?(e=v,f):e},f.iterations=function(v){return arguments.length?(c=+v,f):c},f.strength=function(v){return arguments.length?(n=typeof v=="function"?v:At(+v),p(),f):n},f.distance=function(v){return arguments.length?(r=typeof v=="function"?v:At(+v),x(),f):r},f}const Lc=1664525,Tc=1013904223,Xi=4294967296;function Cc(){let t=1;return()=>(t=(Lc*t+Tc)%Xi)/Xi}function Dc(t){return t.x}function zc(t){return t.y}var $c=10,Ic=Math.PI*(3-Math.sqrt(5));function Pc(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=new Map,l=fi(h),u=fe("tick","end"),c=Cc();t==null&&(t=[]);function h(){f(),u.call("tick",e),n<i&&(l.stop(),u.call("end",e))}function f(x){var v,m=t.length,E;x===void 0&&(x=1);for(var A=0;A<x;++A)for(n+=(o-n)*r,s.forEach(function(y){y(n)}),v=0;v<m;++v)E=t[v],E.fx==null?E.x+=E.vx*=a:(E.x=E.fx,E.vx=0),E.fy==null?E.y+=E.vy*=a:(E.y=E.fy,E.vy=0);return e}function d(){for(var x=0,v=t.length,m;x<v;++x){if(m=t[x],m.index=x,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var E=$c*Math.sqrt(.5+x),A=x*Ic;m.x=E*Math.cos(A),m.y=E*Math.sin(A)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function p(x){return x.initialize&&x.initialize(t,c),x}return d(),e={tick:f,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(x){return arguments.length?(t=x,d(),s.forEach(p),e):t},alpha:function(x){return arguments.length?(n=+x,e):n},alphaMin:function(x){return arguments.length?(i=+x,e):i},alphaDecay:function(x){return arguments.length?(r=+x,e):+r},alphaTarget:function(x){return arguments.length?(o=+x,e):o},velocityDecay:function(x){return arguments.length?(a=1-x,e):1-a},randomSource:function(x){return arguments.length?(c=x,s.forEach(p),e):c},force:function(x,v){return arguments.length>1?(v==null?s.delete(x):s.set(x,p(v)),e):s.get(x)},find:function(x,v,m){var E=0,A=t.length,y,S,L,T,D;for(m==null?m=1/0:m*=m,E=0;E<A;++E)T=t[E],y=x-T.x,S=v-T.y,L=y*y+S*S,L<m&&(D=T,m=L);return D},on:function(x,v){return arguments.length>1?(u.on(x,v),e):u.on(x)}}}function qc(){var t,e,n,i,r=At(-30),o,a=1,s=1/0,l=.81;function u(d){var p,x=t.length,v=pi(t,Dc,zc).visitAfter(h);for(i=d,p=0;p<x;++p)e=t[p],v.visit(f)}function c(){if(t){var d,p=t.length,x;for(o=new Array(p),d=0;d<p;++d)x=t[d],o[x.index]=+r(x,d,t)}}function h(d){var p=0,x,v,m=0,E,A,y;if(d.length){for(E=A=y=0;y<4;++y)(x=d[y])&&(v=Math.abs(x.value))&&(p+=x.value,m+=v,E+=v*x.x,A+=v*x.y);d.x=E/m,d.y=A/m}else{x=d,x.x=x.data.x,x.y=x.data.y;do p+=o[x.data.index];while(x=x.next)}d.value=p}function f(d,p,x,v){if(!d.value)return!0;var m=d.x-e.x,E=d.y-e.y,A=v-p,y=m*m+E*E;if(A*A/l<y)return y<s&&(m===0&&(m=Et(n),y+=m*m),E===0&&(E=Et(n),y+=E*E),y<a&&(y=Math.sqrt(a*y)),e.vx+=m*d.value*i/y,e.vy+=E*d.value*i/y),!0;if(d.length||y>=s)return;(d.data!==e||d.next)&&(m===0&&(m=Et(n),y+=m*m),E===0&&(E=Et(n),y+=E*E),y<a&&(y=Math.sqrt(a*y)));do d.data!==e&&(A=o[d.data.index]*i/y,e.vx+=m*A,e.vy+=E*A);while(d=d.next)}return u.initialize=function(d,p){t=d,n=p,c()},u.strength=function(d){return arguments.length?(r=typeof d=="function"?d:At(+d),c(),u):r},u.distanceMin=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.distanceMax=function(d){return arguments.length?(s=d*d,u):Math.sqrt(s)},u.theta=function(d){return arguments.length?(l=d*d,u):Math.sqrt(l)},u}function Rc(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Xe(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Ht(t){return t=Xe(Math.abs(t)),t?t[1]:NaN}function Oc(t,e){return function(n,i){for(var r=n.length,o=[],a=0,s=t[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),o.push(n.substring(r-=s,r+s)),!((l+=s+1)>i));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Fc(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Bc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function je(t){if(!(e=Bc.exec(t)))throw new Error("invalid format: "+t);var e;return new mi({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}je.prototype=mi.prototype;function mi(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}mi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Hc(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var No;function Gc(t,e){var n=Xe(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(No=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Xe(t,Math.max(0,e+o-1))[0]}function ji(t,e){var n=Xe(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const Yi={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Rc,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ji(t*100,e),r:ji,s:Gc,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ui(t){return t}var Vi=Array.prototype.map,Zi=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Xc(t){var e=t.grouping===void 0||t.thousands===void 0?Ui:Oc(Vi.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Ui:Fc(Vi.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(h){h=je(h);var f=h.fill,d=h.align,p=h.sign,x=h.symbol,v=h.zero,m=h.width,E=h.comma,A=h.precision,y=h.trim,S=h.type;S==="n"?(E=!0,S="g"):Yi[S]||(A===void 0&&(A=12),y=!0,S="g"),(v||f==="0"&&d==="=")&&(v=!0,f="0",d="=");var L=x==="$"?n:x==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",T=x==="$"?i:/[%p]/.test(S)?a:"",D=Yi[S],z=/[defgprs%]/.test(S);A=A===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function $(N){var q=L,P=T,w,g,_;if(S==="c")P=D(N)+P,N="";else{N=+N;var b=N<0||1/N<0;if(N=isNaN(N)?l:D(Math.abs(N),A),y&&(N=Hc(N)),b&&+N==0&&p!=="+"&&(b=!1),q=(b?p==="("?p:s:p==="-"||p==="("?"":p)+q,P=(S==="s"?Zi[8+No/3]:"")+P+(b&&p==="("?")":""),z){for(w=-1,g=N.length;++w<g;)if(_=N.charCodeAt(w),48>_||_>57){P=(_===46?r+N.slice(w+1):N.slice(w))+P,N=N.slice(0,w);break}}}E&&!v&&(N=e(N,1/0));var k=q.length+N.length+P.length,M=k<m?new Array(m-k+1).join(f):"";switch(E&&v&&(N=e(M+N,M.length?m-P.length:1/0),M=""),d){case"<":N=q+N+P+M;break;case"=":N=q+M+N+P;break;case"^":N=M.slice(0,k=M.length>>1)+q+N+P+M.slice(k);break;default:N=M+q+N+P;break}return o(N)}return $.toString=function(){return h+""},$}function c(h,f){var d=u((h=je(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Ht(f)/3)))*3,x=Math.pow(10,-p),v=Zi[8+p/3];return function(m){return d(x*m)+v}}return{format:u,formatPrefix:c}}var _e,yi,Lo;jc({thousands:",",grouping:[3],currency:["$",""]});function jc(t){return _e=Xc(t),yi=_e.format,Lo=_e.formatPrefix,_e}function Yc(t){return Math.max(0,-Ht(Math.abs(t)))}function Uc(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ht(e)/3)))*3-Ht(Math.abs(t)))}function Vc(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ht(e)-Ht(t))+1}var X=1e-6,Zc=1e-12,B=Math.PI,et=B/2,Wi=B/4,rt=B*2,it=180/B,Z=B/180,Y=Math.abs,To=Math.atan,ue=Math.atan2,U=Math.cos,Wc=Math.exp,Kc=Math.log,V=Math.sin,Jc=Math.sign||function(t){return t>0?1:t<0?-1:0},Dt=Math.sqrt,Qc=Math.tan;function tf(t){return t>1?0:t<-1?B:Math.acos(t)}function le(t){return t>1?et:t<-1?-et:Math.asin(t)}function ot(){}function Ye(t,e){t&&Ji.hasOwnProperty(t.type)&&Ji[t.type](t,e)}var Ki={Feature:function(t,e){Ye(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Ye(n[i].geometry,e)}},Ji={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){qn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)qn(n[i],e,0)},Polygon:function(t,e){Qi(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Qi(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Ye(n[i],e)}};function qn(t,e,n){var i=-1,r=t.length-n,o;for(e.lineStart();++i<r;)o=t[i],e.point(o[0],o[1],o[2]);e.lineEnd()}function Qi(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)qn(t[n],e,1);e.polygonEnd()}function $t(t,e){t&&Ki.hasOwnProperty(t.type)?Ki[t.type](t,e):Ye(t,e)}function Rn(t){return[ue(t[1],t[0]),le(t[2])]}function Gt(t){var e=t[0],n=t[1],i=U(n);return[i*U(e),i*V(e),V(n)]}function xe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ue(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function mn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function we(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function On(t){var e=Dt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Fn(t,e){function n(i,r){return i=t(i,r),e(i[0],i[1])}return t.invert&&e.invert&&(n.invert=function(i,r){return i=e.invert(i,r),i&&t.invert(i[0],i[1])}),n}function Bn(t,e){return Y(t)>B&&(t-=Math.round(t/rt)*rt),[t,e]}Bn.invert=Bn;function Co(t,e,n){return(t%=rt)?e||n?Fn(er(t),nr(e,n)):er(t):e||n?nr(e,n):Bn}function tr(t){return function(e,n){return e+=t,Y(e)>B&&(e-=Math.round(e/rt)*rt),[e,n]}}function er(t){var e=tr(t);return e.invert=tr(-t),e}function nr(t,e){var n=U(t),i=V(t),r=U(e),o=V(e);function a(s,l){var u=U(l),c=U(s)*u,h=V(s)*u,f=V(l),d=f*n+c*i;return[ue(h*r-d*o,c*n-f*i),le(d*r+h*o)]}return a.invert=function(s,l){var u=U(l),c=U(s)*u,h=V(s)*u,f=V(l),d=f*r-h*o;return[ue(h*r+f*o,c*n+d*i),le(d*n-c*i)]},a}function ef(t){t=Co(t[0]*Z,t[1]*Z,t.length>2?t[2]*Z:0);function e(n){return n=t(n[0]*Z,n[1]*Z),n[0]*=it,n[1]*=it,n}return e.invert=function(n){return n=t.invert(n[0]*Z,n[1]*Z),n[0]*=it,n[1]*=it,n},e}function nf(t,e,n,i,r,o){if(n){var a=U(e),s=V(e),l=i*n;r==null?(r=e+i*rt,o=e-l/2):(r=ir(a,r),o=ir(a,o),(i>0?r<o:r>o)&&(r+=i*rt));for(var u,c=r;i>0?c>o:c<o;c-=l)u=Rn([a,-s*U(c),-s*V(c)]),t.point(u[0],u[1])}}function ir(t,e){e=Gt(e),e[0]-=t,On(e);var n=tf(-e[1]);return((-e[2]<0?-n:n)+rt-X)%rt}function Do(){var t=[],e;return{point:function(n,i,r){e.push([n,i,r])},lineStart:function(){t.push(e=[])},lineEnd:ot,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function ze(t,e){return Y(t[0]-e[0])<X&&Y(t[1]-e[1])<X}function be(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function zo(t,e,n,i,r){var o=[],a=[],s,l;if(t.forEach(function(p){if(!((x=p.length-1)<=0)){var x,v=p[0],m=p[x],E;if(ze(v,m)){if(!v[2]&&!m[2]){for(r.lineStart(),s=0;s<x;++s)r.point((v=p[s])[0],v[1]);r.lineEnd();return}m[0]+=2*X}o.push(E=new be(v,p,null,!0)),a.push(E.o=new be(v,null,E,!1)),o.push(E=new be(m,p,null,!1)),a.push(E.o=new be(m,null,E,!0))}}),!!o.length){for(a.sort(e),rr(o),rr(a),s=0,l=a.length;s<l;++s)a[s].e=n=!n;for(var u=o[0],c,h;;){for(var f=u,d=!0;f.v;)if((f=f.n)===u)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(s=0,l=c.length;s<l;++s)r.point((h=c[s])[0],h[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(d)for(c=f.p.z,s=c.length-1;s>=0;--s)r.point((h=c[s])[0],h[1]);else i(f.x,f.p.x,-1,r);f=f.p}f=f.o,c=f.z,d=!d}while(!f.v);r.lineEnd()}}}function rr(t){if(e=t.length){for(var e,n=0,i=t[0],r;++n<e;)i.n=r=t[n],r.p=i,i=r;i.n=r=t[0],r.p=i}}function yn(t){return Y(t[0])<=B?t[0]:Jc(t[0])*((Y(t[0])+B)%rt-B)}function rf(t,e){var n=yn(e),i=e[1],r=V(i),o=[V(n),-U(n),0],a=0,s=0,l=new Nt;r===1?i=et+X:r===-1&&(i=-et-X);for(var u=0,c=t.length;u<c;++u)if(f=(h=t[u]).length)for(var h,f,d=h[f-1],p=yn(d),x=d[1]/2+Wi,v=V(x),m=U(x),E=0;E<f;++E,p=y,v=L,m=T,d=A){var A=h[E],y=yn(A),S=A[1]/2+Wi,L=V(S),T=U(S),D=y-p,z=D>=0?1:-1,$=z*D,N=$>B,q=v*L;if(l.add(ue(q*z*V($),m*T+q*U($))),a+=N?D+z*rt:D,N^p>=n^y>=n){var P=Ue(Gt(d),Gt(A));On(P);var w=Ue(o,P);On(w);var g=(N^D>=0?-1:1)*le(w[2]);(i>g||i===g&&(P[0]||P[1]))&&(s+=N^D>=0?1:-1)}}return(a<-X||a<X&&l<-Zc)^s&1}function $o(t,e,n,i){return function(r){var o=e(r),a=Do(),s=e(a),l=!1,u,c,h,f={point:d,lineStart:x,lineEnd:v,polygonStart:function(){f.point=m,f.lineStart=E,f.lineEnd=A,c=[],u=[]},polygonEnd:function(){f.point=d,f.lineStart=x,f.lineEnd=v,c=Wr(c);var y=rf(u,i);c.length?(l||(r.polygonStart(),l=!0),zo(c,af,y,n,r)):y&&(l||(r.polygonStart(),l=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(y,S){t(y,S)&&r.point(y,S)}function p(y,S){o.point(y,S)}function x(){f.point=p,o.lineStart()}function v(){f.point=d,o.lineEnd()}function m(y,S){h.push([y,S]),s.point(y,S)}function E(){s.lineStart(),h=[]}function A(){m(h[0][0],h[0][1]),s.lineEnd();var y=s.clean(),S=a.result(),L,T=S.length,D,z,$;if(h.pop(),u.push(h),h=null,!!T){if(y&1){if(z=S[0],(D=z.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),L=0;L<D;++L)r.point(($=z[L])[0],$[1]);r.lineEnd()}return}T>1&&y&2&&S.push(S.pop().concat(S.shift())),c.push(S.filter(of))}}return f}}function of(t){return t.length>1}function af(t,e){return((t=t.x)[0]<0?t[1]-et-X:et-t[1])-((e=e.x)[0]<0?e[1]-et-X:et-e[1])}const or=$o(function(){return!0},sf,lf,[-B,-et]);function sf(t){var e=NaN,n=NaN,i=NaN,r;return{lineStart:function(){t.lineStart(),r=1},point:function(o,a){var s=o>0?B:-B,l=Y(o-e);Y(l-B)<X?(t.point(e,n=(n+a)/2>0?et:-et),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(o,n),r=0):i!==s&&l>=B&&(Y(e-i)<X&&(e-=i*X),Y(o-s)<X&&(o-=s*X),n=uf(e,n,o,a),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(s,n),r=0),t.point(e=o,n=a),i=s},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-r}}}function uf(t,e,n,i){var r,o,a=V(t-n);return Y(a)>X?To((V(e)*(o=U(i))*V(n)-V(i)*(r=U(e))*V(t))/(r*o*a)):(e+i)/2}function lf(t,e,n,i){var r;if(t==null)r=n*et,i.point(-B,r),i.point(0,r),i.point(B,r),i.point(B,0),i.point(B,-r),i.point(0,-r),i.point(-B,-r),i.point(-B,0),i.point(-B,r);else if(Y(t[0]-e[0])>X){var o=t[0]<e[0]?B:-B;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}function cf(t){var e=U(t),n=6*Z,i=e>0,r=Y(e)>X;function o(c,h,f,d){nf(d,t,n,f,c,h)}function a(c,h){return U(c)*U(h)>e}function s(c){var h,f,d,p,x;return{lineStart:function(){p=d=!1,x=1},point:function(v,m){var E=[v,m],A,y=a(v,m),S=i?y?0:u(v,m):y?u(v+(v<0?B:-B),m):0;if(!h&&(p=d=y)&&c.lineStart(),y!==d&&(A=l(h,E),(!A||ze(h,A)||ze(E,A))&&(E[2]=1)),y!==d)x=0,y?(c.lineStart(),A=l(E,h),c.point(A[0],A[1])):(A=l(h,E),c.point(A[0],A[1],2),c.lineEnd()),h=A;else if(r&&h&&i^y){var L;!(S&f)&&(L=l(E,h,!0))&&(x=0,i?(c.lineStart(),c.point(L[0][0],L[0][1]),c.point(L[1][0],L[1][1]),c.lineEnd()):(c.point(L[1][0],L[1][1]),c.lineEnd(),c.lineStart(),c.point(L[0][0],L[0][1],3)))}y&&(!h||!ze(h,E))&&c.point(E[0],E[1]),h=E,d=y,f=S},lineEnd:function(){d&&c.lineEnd(),h=null},clean:function(){return x|(p&&d)<<1}}}function l(c,h,f){var d=Gt(c),p=Gt(h),x=[1,0,0],v=Ue(d,p),m=xe(v,v),E=v[0],A=m-E*E;if(!A)return!f&&c;var y=e*m/A,S=-e*E/A,L=Ue(x,v),T=we(x,y),D=we(v,S);mn(T,D);var z=L,$=xe(T,z),N=xe(z,z),q=$*$-N*(xe(T,T)-1);if(!(q<0)){var P=Dt(q),w=we(z,(-$-P)/N);if(mn(w,T),w=Rn(w),!f)return w;var g=c[0],_=h[0],b=c[1],k=h[1],M;_<g&&(M=g,g=_,_=M);var C=_-g,I=Y(C-B)<X,F=I||C<X;if(!I&&k<b&&(M=b,b=k,k=M),F?I?b+k>0^w[1]<(Y(w[0]-g)<X?b:k):b<=w[1]&&w[1]<=k:C>B^(g<=w[0]&&w[0]<=_)){var H=we(z,(-$+P)/N);return mn(H,T),[w,Rn(H)]}}}function u(c,h){var f=i?t:B-t,d=0;return c<-f?d|=1:c>f&&(d|=2),h<-f?d|=4:h>f&&(d|=8),d}return $o(a,s,o,i?[0,-t]:[-B,t-B])}function ff(t,e,n,i,r,o){var a=t[0],s=t[1],l=e[0],u=e[1],c=0,h=1,f=l-a,d=u-s,p;if(p=n-a,!(!f&&p>0)){if(p/=f,f<0){if(p<c)return;p<h&&(h=p)}else if(f>0){if(p>h)return;p>c&&(c=p)}if(p=r-a,!(!f&&p<0)){if(p/=f,f<0){if(p>h)return;p>c&&(c=p)}else if(f>0){if(p<c)return;p<h&&(h=p)}if(p=i-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<h&&(h=p)}else if(d>0){if(p>h)return;p>c&&(c=p)}if(p=o-s,!(!d&&p<0)){if(p/=d,d<0){if(p>h)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<h&&(h=p)}return c>0&&(t[0]=a+c*f,t[1]=s+c*d),h<1&&(e[0]=a+h*f,e[1]=s+h*d),!0}}}}}var Jt=1e9,Ee=-Jt;function hf(t,e,n,i){function r(u,c){return t<=u&&u<=n&&e<=c&&c<=i}function o(u,c,h,f){var d=0,p=0;if(u==null||(d=a(u,h))!==(p=a(c,h))||l(u,c)<0^h>0)do f.point(d===0||d===3?t:n,d>1?i:e);while((d=(d+h+4)%4)!==p);else f.point(c[0],c[1])}function a(u,c){return Y(u[0]-t)<X?c>0?0:3:Y(u[0]-n)<X?c>0?2:1:Y(u[1]-e)<X?c>0?1:0:c>0?3:2}function s(u,c){return l(u.x,c.x)}function l(u,c){var h=a(u,1),f=a(c,1);return h!==f?h-f:h===0?c[1]-u[1]:h===1?u[0]-c[0]:h===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,h=Do(),f,d,p,x,v,m,E,A,y,S,L,T={point:D,lineStart:q,lineEnd:P,polygonStart:$,polygonEnd:N};function D(g,_){r(g,_)&&c.point(g,_)}function z(){for(var g=0,_=0,b=d.length;_<b;++_)for(var k=d[_],M=1,C=k.length,I=k[0],F,H,G=I[0],j=I[1];M<C;++M)F=G,H=j,I=k[M],G=I[0],j=I[1],H<=i?j>i&&(G-F)*(i-H)>(j-H)*(t-F)&&++g:j<=i&&(G-F)*(i-H)<(j-H)*(t-F)&&--g;return g}function $(){c=h,f=[],d=[],L=!0}function N(){var g=z(),_=L&&g,b=(f=Wr(f)).length;(_||b)&&(u.polygonStart(),_&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),b&&zo(f,s,g,o,u),u.polygonEnd()),c=u,f=d=p=null}function q(){T.point=w,d&&d.push(p=[]),S=!0,y=!1,E=A=NaN}function P(){f&&(w(x,v),m&&y&&h.rejoin(),f.push(h.result())),T.point=D,y&&c.lineEnd()}function w(g,_){var b=r(g,_);if(d&&p.push([g,_]),S)x=g,v=_,m=b,S=!1,b&&(c.lineStart(),c.point(g,_));else if(b&&y)c.point(g,_);else{var k=[E=Math.max(Ee,Math.min(Jt,E)),A=Math.max(Ee,Math.min(Jt,A))],M=[g=Math.max(Ee,Math.min(Jt,g)),_=Math.max(Ee,Math.min(Jt,_))];ff(k,M,t,e,n,i)?(y||(c.lineStart(),c.point(k[0],k[1])),c.point(M[0],M[1]),b||c.lineEnd(),L=!1):b&&(c.lineStart(),c.point(g,_),L=!1)}E=g,A=_,y=b}return T}}const Hn=t=>t;var vn=new Nt,Gn=new Nt,Io,Po,Xn,jn,bt={point:ot,lineStart:ot,lineEnd:ot,polygonStart:function(){bt.lineStart=df,bt.lineEnd=gf},polygonEnd:function(){bt.lineStart=bt.lineEnd=bt.point=ot,vn.add(Y(Gn)),Gn=new Nt},result:function(){var t=vn/2;return vn=new Nt,t}};function df(){bt.point=pf}function pf(t,e){bt.point=qo,Io=Xn=t,Po=jn=e}function qo(t,e){Gn.add(jn*t-Xn*e),Xn=t,jn=e}function gf(){qo(Io,Po)}const ar=bt;var Xt=1/0,Ve=Xt,ce=-Xt,Ze=ce,mf={point:yf,lineStart:ot,lineEnd:ot,polygonStart:ot,polygonEnd:ot,result:function(){var t=[[Xt,Ve],[ce,Ze]];return ce=Ze=-(Ve=Xt=1/0),t}};function yf(t,e){t<Xt&&(Xt=t),t>ce&&(ce=t),e<Ve&&(Ve=e),e>Ze&&(Ze=e)}const We=mf;var Yn=0,Un=0,Qt=0,Ke=0,Je=0,It=0,Vn=0,Zn=0,te=0,Ro,Oo,ft,ht,lt={point:Ct,lineStart:sr,lineEnd:ur,polygonStart:function(){lt.lineStart=xf,lt.lineEnd=wf},polygonEnd:function(){lt.point=Ct,lt.lineStart=sr,lt.lineEnd=ur},result:function(){var t=te?[Vn/te,Zn/te]:It?[Ke/It,Je/It]:Qt?[Yn/Qt,Un/Qt]:[NaN,NaN];return Yn=Un=Qt=Ke=Je=It=Vn=Zn=te=0,t}};function Ct(t,e){Yn+=t,Un+=e,++Qt}function sr(){lt.point=vf}function vf(t,e){lt.point=_f,Ct(ft=t,ht=e)}function _f(t,e){var n=t-ft,i=e-ht,r=Dt(n*n+i*i);Ke+=r*(ft+t)/2,Je+=r*(ht+e)/2,It+=r,Ct(ft=t,ht=e)}function ur(){lt.point=Ct}function xf(){lt.point=bf}function wf(){Fo(Ro,Oo)}function bf(t,e){lt.point=Fo,Ct(Ro=ft=t,Oo=ht=e)}function Fo(t,e){var n=t-ft,i=e-ht,r=Dt(n*n+i*i);Ke+=r*(ft+t)/2,Je+=r*(ht+e)/2,It+=r,r=ht*t-ft*e,Vn+=r*(ft+t),Zn+=r*(ht+e),te+=r*3,Ct(ft=t,ht=e)}const lr=lt;function Bo(t){this._context=t}Bo.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,rt);break}}},result:ot};var Wn=new Nt,_n,Ho,Go,ee,ne,Qe={point:ot,lineStart:function(){Qe.point=Ef},lineEnd:function(){_n&&Xo(Ho,Go),Qe.point=ot},polygonStart:function(){_n=!0},polygonEnd:function(){_n=null},result:function(){var t=+Wn;return Wn=new Nt,t}};function Ef(t,e){Qe.point=Xo,Ho=ee=t,Go=ne=e}function Xo(t,e){ee-=t,ne-=e,Wn.add(Dt(ee*ee+ne*ne)),ee=t,ne=e}const cr=Qe;let fr,tn,hr,dr;class pr{constructor(e){this._append=e==null?jo:Mf(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==hr||this._append!==tn){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,hr=i,tn=this._append,dr=this._,this._=r}this._+=dr;break}}}result(){const e=this._;return this._="",e.length?e:null}}function jo(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Mf(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return jo;if(e!==fr){const n=10**e;fr=e,tn=function(r){let o=1;this._+=r[0];for(const a=r.length;o<a;++o)this._+=Math.round(arguments[o]*n)/n+r[o]}}return tn}function gr(t,e){let n=3,i=4.5,r,o;function a(s){return s&&(typeof i=="function"&&o.pointRadius(+i.apply(this,arguments)),$t(s,r(o))),o.result()}return a.area=function(s){return $t(s,r(ar)),ar.result()},a.measure=function(s){return $t(s,r(cr)),cr.result()},a.bounds=function(s){return $t(s,r(We)),We.result()},a.centroid=function(s){return $t(s,r(lr)),lr.result()},a.projection=function(s){return arguments.length?(r=s==null?(t=null,Hn):(t=s).stream,a):t},a.context=function(s){return arguments.length?(o=s==null?(e=null,new pr(n)):new Bo(e=s),typeof i!="function"&&o.pointRadius(i),a):e},a.pointRadius=function(s){return arguments.length?(i=typeof s=="function"?s:(o.pointRadius(+s),+s),a):i},a.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{const l=Math.floor(s);if(!(l>=0))throw new RangeError(`invalid digits: ${s}`);n=l}return e===null&&(o=new pr(n)),a},a.projection(t).digits(n).context(e)}function vi(t){return function(e){var n=new Kn;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Kn(){}Kn.prototype={constructor:Kn,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _i(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),i!=null&&t.clipExtent(null),$t(n,t.stream(We)),e(We.result()),i!=null&&t.clipExtent(i),t}function Yo(t,e,n){return _i(t,function(i){var r=e[1][0]-e[0][0],o=e[1][1]-e[0][1],a=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),s=+e[0][0]+(r-a*(i[1][0]+i[0][0]))/2,l=+e[0][1]+(o-a*(i[1][1]+i[0][1]))/2;t.scale(150*a).translate([s,l])},n)}function Sf(t,e,n){return Yo(t,[[0,0],e],n)}function kf(t,e,n){return _i(t,function(i){var r=+e,o=r/(i[1][0]-i[0][0]),a=(r-o*(i[1][0]+i[0][0]))/2,s=-o*i[0][1];t.scale(150*o).translate([a,s])},n)}function Af(t,e,n){return _i(t,function(i){var r=+e,o=r/(i[1][1]-i[0][1]),a=-o*i[0][0],s=(r-o*(i[1][1]+i[0][1]))/2;t.scale(150*o).translate([a,s])},n)}var mr=16,Nf=U(30*Z);function yr(t,e){return+e?Tf(t,e):Lf(t)}function Lf(t){return vi({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function Tf(t,e){function n(i,r,o,a,s,l,u,c,h,f,d,p,x,v){var m=u-i,E=c-r,A=m*m+E*E;if(A>4*e&&x--){var y=a+f,S=s+d,L=l+p,T=Dt(y*y+S*S+L*L),D=le(L/=T),z=Y(Y(L)-1)<X||Y(o-h)<X?(o+h)/2:ue(S,y),$=t(z,D),N=$[0],q=$[1],P=N-i,w=q-r,g=E*P-m*w;(g*g/A>e||Y((m*P+E*w)/A-.5)>.3||a*f+s*d+l*p<Nf)&&(n(i,r,o,a,s,l,N,q,z,y/=T,S/=T,L,x,v),v.point(N,q),n(N,q,z,y,S,L,u,c,h,f,d,p,x,v))}}return function(i){var r,o,a,s,l,u,c,h,f,d,p,x,v={point:m,lineStart:E,lineEnd:y,polygonStart:function(){i.polygonStart(),v.lineStart=S},polygonEnd:function(){i.polygonEnd(),v.lineStart=E}};function m(D,z){D=t(D,z),i.point(D[0],D[1])}function E(){h=NaN,v.point=A,i.lineStart()}function A(D,z){var $=Gt([D,z]),N=t(D,z);n(h,f,c,d,p,x,h=N[0],f=N[1],c=D,d=$[0],p=$[1],x=$[2],mr,i),i.point(h,f)}function y(){v.point=m,i.lineEnd()}function S(){E(),v.point=L,v.lineEnd=T}function L(D,z){A(r=D,z),o=h,a=f,s=d,l=p,u=x,v.point=A}function T(){n(h,f,c,d,p,x,o,a,r,s,l,u,mr,i),v.lineEnd=y,y()}return v}}var Cf=vi({point:function(t,e){this.stream.point(t*Z,e*Z)}});function Df(t){return vi({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}function zf(t,e,n,i,r){function o(a,s){return a*=i,s*=r,[e+t*a,n-t*s]}return o.invert=function(a,s){return[(a-e)/t*i,(n-s)/t*r]},o}function vr(t,e,n,i,r,o){if(!o)return zf(t,e,n,i,r);var a=U(o),s=V(o),l=a*t,u=s*t,c=a/t,h=s/t,f=(s*n-a*e)/t,d=(s*e+a*n)/t;function p(x,v){return x*=i,v*=r,[l*x-u*v+e,n-u*x-l*v]}return p.invert=function(x,v){return[i*(c*x-h*v+f),r*(d-h*x-c*v)]},p}function $f(t){return If(function(){return t})()}function If(t){var e,n=150,i=480,r=250,o=0,a=0,s=0,l=0,u=0,c,h=0,f=1,d=1,p=null,x=or,v=null,m,E,A,y=Hn,S=.5,L,T,D,z,$;function N(g){return D(g[0]*Z,g[1]*Z)}function q(g){return g=D.invert(g[0],g[1]),g&&[g[0]*it,g[1]*it]}N.stream=function(g){return z&&$===g?z:z=Cf(Df(c)(x(L(y($=g)))))},N.preclip=function(g){return arguments.length?(x=g,p=void 0,w()):x},N.postclip=function(g){return arguments.length?(y=g,v=m=E=A=null,w()):y},N.clipAngle=function(g){return arguments.length?(x=+g?cf(p=g*Z):(p=null,or),w()):p*it},N.clipExtent=function(g){return arguments.length?(y=g==null?(v=m=E=A=null,Hn):hf(v=+g[0][0],m=+g[0][1],E=+g[1][0],A=+g[1][1]),w()):v==null?null:[[v,m],[E,A]]},N.scale=function(g){return arguments.length?(n=+g,P()):n},N.translate=function(g){return arguments.length?(i=+g[0],r=+g[1],P()):[i,r]},N.center=function(g){return arguments.length?(o=g[0]%360*Z,a=g[1]%360*Z,P()):[o*it,a*it]},N.rotate=function(g){return arguments.length?(s=g[0]%360*Z,l=g[1]%360*Z,u=g.length>2?g[2]%360*Z:0,P()):[s*it,l*it,u*it]},N.angle=function(g){return arguments.length?(h=g%360*Z,P()):h*it},N.reflectX=function(g){return arguments.length?(f=g?-1:1,P()):f<0},N.reflectY=function(g){return arguments.length?(d=g?-1:1,P()):d<0},N.precision=function(g){return arguments.length?(L=yr(T,S=g*g),w()):Dt(S)},N.fitExtent=function(g,_){return Yo(N,g,_)},N.fitSize=function(g,_){return Sf(N,g,_)},N.fitWidth=function(g,_){return kf(N,g,_)},N.fitHeight=function(g,_){return Af(N,g,_)};function P(){var g=vr(n,0,0,f,d,h).apply(null,e(o,a)),_=vr(n,i-g[0],r-g[1],f,d,h);return c=Co(s,l,u),T=Fn(e,_),D=Fn(c,T),L=yr(T,S),w()}function w(){return z=$=null,N}return function(){return e=t.apply(this,arguments),N.invert=e.invert&&q,P()}}function xi(t,e){return[t,Kc(Qc((et+e)/2))]}xi.invert=function(t,e){return[t,2*To(Wc(e))-et]};function Pf(){return qf(xi).scale(961/rt)}function qf(t){var e=$f(t),n=e.center,i=e.scale,r=e.translate,o=e.clipExtent,a=null,s,l,u;e.scale=function(h){return arguments.length?(i(h),c()):i()},e.translate=function(h){return arguments.length?(r(h),c()):r()},e.center=function(h){return arguments.length?(n(h),c()):n()},e.clipExtent=function(h){return arguments.length?(h==null?a=s=l=u=null:(a=+h[0][0],s=+h[0][1],l=+h[1][0],u=+h[1][1]),c()):a==null?null:[[a,s],[l,u]]};function c(){var h=B*i(),f=e(ef(e.rotate()).invert([0,0]));return o(a==null?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:t===xi?[[Math.max(f[0]-h,a),s],[Math.min(f[0]+h,l),u]]:[[a,Math.max(f[1]-h,s)],[l,Math.min(f[1]+h,u)]])}return c()}function Rf(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function Of(){return this.eachAfter(Rf)}function Ff(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this}function Bf(t,e){for(var n=this,i=[n],r,o,a=-1;n=i.pop();)if(t.call(e,n,++a,this),r=n.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function Hf(t,e){for(var n=this,i=[n],r=[],o,a,s,l=-1;n=i.pop();)if(r.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)i.push(o[a]);for(;n=r.pop();)t.call(e,n,++l,this);return this}function Gf(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i}function Xf(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})}function jf(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Yf(t){for(var e=this,n=Uf(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i}function Uf(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function Vf(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Zf(){return Array.from(this)}function Wf(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Kf(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Jf(){var t=this,e,n=[t],i,r,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,i=t.children)for(r=0,o=i.length;r<o;++r)n.push(i[r]);while(n.length)}function wi(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=eh)):e===void 0&&(e=th);for(var n=new en(t),i,r=[n],o,a,s,l;i=r.pop();)if((a=e(i.data))&&(l=(a=Array.from(a)).length))for(i.children=a,s=l-1;s>=0;--s)r.push(o=a[s]=new en(a[s])),o.parent=i,o.depth=i.depth+1;return n.eachBefore(ih)}function Qf(){return wi(this).eachBefore(nh)}function th(t){return t.children}function eh(t){return Array.isArray(t)?t[1]:null}function nh(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function ih(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function en(t){this.data=t,this.depth=this.height=0,this.parent=null}en.prototype=wi.prototype={constructor:en,count:Of,each:Ff,eachAfter:Hf,eachBefore:Bf,find:Gf,sum:Xf,sort:jf,path:Yf,ancestors:Vf,descendants:Zf,leaves:Wf,links:Kf,copy:Qf,[Symbol.iterator]:Jf};function rh(t){return t==null?null:oh(t)}function oh(t){if(typeof t!="function")throw new Error;return t}function _r(){return 0}function ah(t){return function(){return t}}const sh=1664525,uh=1013904223,xr=4294967296;function lh(){let t=1;return()=>(t=(sh*t+uh)%xr)/xr}function ch(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function fh(t,e){let n=t.length,i,r;for(;n;)r=e()*n--|0,i=t[n],t[n]=t[r],t[r]=i;return t}function hh(t,e){for(var n=0,i=(t=fh(Array.from(t),e)).length,r=[],o,a;n<i;)o=t[n],a&&Uo(a,o)?++n:(a=ph(r=dh(r,o)),n=0);return a}function dh(t,e){var n,i;if(xn(e,t))return[e];for(n=0;n<t.length;++n)if(Me(e,t[n])&&xn(ie(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(Me(ie(t[n],t[i]),e)&&Me(ie(t[n],e),t[i])&&Me(ie(t[i],e),t[n])&&xn(Vo(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function Me(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function Uo(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function xn(t,e){for(var n=0;n<e.length;++n)if(!Uo(t,e[n]))return!1;return!0}function ph(t){switch(t.length){case 1:return gh(t[0]);case 2:return ie(t[0],t[1]);case 3:return Vo(t[0],t[1],t[2])}}function gh(t){return{x:t.x,y:t.y,r:t.r}}function ie(t,e){var n=t.x,i=t.y,r=t.r,o=e.x,a=e.y,s=e.r,l=o-n,u=a-i,c=s-r,h=Math.sqrt(l*l+u*u);return{x:(n+o+l/h*c)/2,y:(i+a+u/h*c)/2,r:(h+r+s)/2}}function Vo(t,e,n){var i=t.x,r=t.y,o=t.r,a=e.x,s=e.y,l=e.r,u=n.x,c=n.y,h=n.r,f=i-a,d=i-u,p=r-s,x=r-c,v=l-o,m=h-o,E=i*i+r*r-o*o,A=E-a*a-s*s+l*l,y=E-u*u-c*c+h*h,S=d*p-f*x,L=(p*y-x*A)/(S*2)-i,T=(x*v-p*m)/S,D=(d*A-f*y)/(S*2)-r,z=(f*m-d*v)/S,$=T*T+z*z-1,N=2*(o+L*T+D*z),q=L*L+D*D-o*o,P=-(Math.abs($)>1e-6?(N+Math.sqrt(N*N-4*$*q))/(2*$):q/N);return{x:i+L+T*P,y:r+D+z*P,r:P}}function wr(t,e,n){var i=t.x-e.x,r,o,a=t.y-e.y,s,l,u=i*i+a*a;u?(o=e.r+n.r,o*=o,l=t.r+n.r,l*=l,o>l?(r=(u+l-o)/(2*u),s=Math.sqrt(Math.max(0,l/u-r*r)),n.x=t.x-r*i-s*a,n.y=t.y-r*a+s*i):(r=(u+o-l)/(2*u),s=Math.sqrt(Math.max(0,o/u-r*r)),n.x=e.x+r*i-s*a,n.y=e.y+r*a+s*i)):(n.x=e.x+n.r,n.y=e.y)}function br(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function Er(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,o=(e.y*n.r+n.y*e.r)/i;return r*r+o*o}function Se(t){this._=t,this.next=null,this.previous=null}function mh(t,e){if(!(o=(t=ch(t)).length))return 0;var n,i,r,o,a,s,l,u,c,h,f;if(n=t[0],n.x=0,n.y=0,!(o>1))return n.r;if(i=t[1],n.x=-i.r,i.x=n.r,i.y=0,!(o>2))return n.r+i.r;wr(i,n,r=t[2]),n=new Se(n),i=new Se(i),r=new Se(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;t:for(l=3;l<o;++l){wr(n._,i._,r=t[l]),r=new Se(r),u=i.next,c=n.previous,h=i._.r,f=n._.r;do if(h<=f){if(br(u._,r._)){i=u,n.next=i,i.previous=n,--l;continue t}h+=u._.r,u=u.next}else{if(br(c._,r._)){n=c,n.next=i,i.previous=n,--l;continue t}f+=c._.r,c=c.previous}while(u!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,a=Er(n);(r=r.next)!==i;)(s=Er(r))<a&&(n=r,a=s);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=hh(n,e),l=0;l<o;++l)n=t[l],n.x-=r.x,n.y-=r.y;return r.r}function yh(t){return Math.sqrt(t.value)}function vh(){var t=null,e=1,n=1,i=_r;function r(o){const a=lh();return o.x=e/2,o.y=n/2,t?o.eachBefore(Mr(t)).eachAfter(wn(i,.5,a)).eachBefore(Sr(1)):o.eachBefore(Mr(yh)).eachAfter(wn(_r,1,a)).eachAfter(wn(i,o.r/Math.min(e,n),a)).eachBefore(Sr(Math.min(e,n)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(t=rh(o),r):t},r.size=function(o){return arguments.length?(e=+o[0],n=+o[1],r):[e,n]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:ah(+o),r):i},r}function Mr(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function wn(t,e,n){return function(i){if(r=i.children){var r,o,a=r.length,s=t(i)*e||0,l;if(s)for(o=0;o<a;++o)r[o].r+=s;if(l=mh(r,n),s)for(o=0;o<a;++o)r[o].r-=s;i.r=l+s}}}function Sr(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function ln(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function _h(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const kr=Symbol("implicit");function Zo(){var t=new Mi,e=[],n=[],i=kr;function r(o){let a=t.get(o);if(a===void 0){if(i!==kr)return i;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return r.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Mi;for(const a of o)t.has(a)||t.set(a,e.push(a)-1);return r},r.range=function(o){return arguments.length?(n=Array.from(o),r):n.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return Zo(e,n).unknown(i)},ln.apply(r,arguments),r}function bi(){var t=Zo().unknown(void 0),e=t.domain,n=t.range,i=0,r=1,o,a,s=!1,l=0,u=0,c=.5;delete t.unknown;function h(){var f=e().length,d=r<i,p=d?r:i,x=d?i:r;o=(x-p)/Math.max(1,f-l+u*2),s&&(o=Math.floor(o)),p+=(x-p-o*(f-l))*c,a=o*(1-l),s&&(p=Math.round(p),a=Math.round(a));var v=wa(f).map(function(m){return p+o*m});return n(d?v.reverse():v)}return t.domain=function(f){return arguments.length?(e(f),h()):e()},t.range=function(f){return arguments.length?([i,r]=f,i=+i,r=+r,h()):[i,r]},t.rangeRound=function(f){return[i,r]=f,i=+i,r=+r,s=!0,h()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(f){return arguments.length?(s=!!f,h()):s},t.padding=function(f){return arguments.length?(l=Math.min(1,u=+f),h()):l},t.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),h()):l},t.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),h()):c},t.copy=function(){return bi(e(),[i,r]).round(s).paddingInner(l).paddingOuter(u).align(c)},ln.apply(h(),arguments)}function xh(t){return function(){return t}}function wh(t){return+t}var Ar=[0,1];function at(t){return t}function Jn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:xh(isNaN(e)?NaN:.5)}function bh(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function Eh(t,e,n){var i=t[0],r=t[1],o=e[0],a=e[1];return r<i?(i=Jn(r,i),o=n(a,o)):(i=Jn(i,r),o=n(o,a)),function(s){return o(i(s))}}function Mh(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<i;)r[a]=Jn(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(s){var l=ha(t,s,1,i)-1;return o[l](r[l](s))}}function Wo(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ko(){var t=Ar,e=Ar,n=an,i,r,o,a=at,s,l,u;function c(){var f=Math.min(t.length,e.length);return a!==at&&(a=bh(t[0],t[f-1])),s=f>2?Mh:Eh,l=u=null,h}function h(f){return f==null||isNaN(f=+f)?o:(l||(l=s(t.map(i),e,n)))(i(a(f)))}return h.invert=function(f){return a(r((u||(u=s(e,t.map(i),st)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,wh),c()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),c()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),n=yo,c()},h.clamp=function(f){return arguments.length?(a=f?!0:at,c()):a!==at},h.interpolate=function(f){return arguments.length?(n=f,c()):n},h.unknown=function(f){return arguments.length?(o=f,h):o},function(f,d){return i=f,r=d,c()}}function Sh(){return Ko()(at,at)}function kh(t,e,n,i){var r=va(t,e,n),o;switch(i=je(i??",f"),i.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(o=Uc(r,a))&&(i.precision=o),Lo(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=Vc(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=Yc(r))&&(i.precision=o-(i.type==="%")*2);break}}return yi(i)}function Ei(t){var e=t.domain;return t.ticks=function(n){var i=e();return ya(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return kh(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,o=i.length-1,a=i[r],s=i[o],l,u,c=10;for(s<a&&(u=a,a=s,s=u,u=r,r=o,o=u);c-- >0;){if(u=Nn(a,s,n),u===l)return i[r]=a,i[o]=s,e(i);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function _t(){var t=Sh();return t.copy=function(){return Wo(t,_t())},ln.apply(t,arguments),Ei(t)}function Nr(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Ah(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Nh(t){return t<0?-t*t:t*t}function Lh(t){var e=t(at,at),n=1;function i(){return n===1?t(at,at):n===.5?t(Ah,Nh):t(Nr(n),Nr(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,i()):n},Ei(e)}function Jo(){var t=Lh(Ko());return t.copy=function(){return Wo(t,Jo()).exponent(t.exponent())},ln.apply(t,arguments),t}function Th(){return Jo.apply(null,arguments).exponent(.5)}function Ch(){var t=0,e=1,n,i,r,o,a=at,s=!1,l;function u(h){return h==null||isNaN(h=+h)?l:a(r===0?.5:(h=(o(h)-n)*r,s?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([t,e]=h,n=o(t=+t),i=o(e=+e),r=n===i?0:1/(i-n),u):[t,e]},u.clamp=function(h){return arguments.length?(s=!!h,u):s},u.interpolator=function(h){return arguments.length?(a=h,u):a};function c(h){return function(f){var d,p;return arguments.length?([d,p]=f,a=h(d,p),u):[a(0),a(1)]}}return u.range=c(an),u.rangeRound=c(yo),u.unknown=function(h){return arguments.length?(l=h,u):l},function(h){return o=h,n=h(t),i=h(e),r=n===i?0:1/(i-n),u}}function Dh(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Qo(){var t=Ei(Ch()(at));return t.copy=function(){return Dh(t,Qo())},_h.apply(t,arguments)}function zh(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const $h=t=>$u(t[t.length-1]);var Ih=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(zh);const Ph=$h(Ih),ke=t=>()=>t;function qh(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function xt(t,e,n){this.k=t,this.x=e,this.y=n}xt.prototype={constructor:xt,scale:function(t){return t===1?this:new xt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new xt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var nn=new xt(1,0,0);xt.prototype;function bn(t){t.stopImmediatePropagation()}function Yt(t){t.preventDefault(),t.stopImmediatePropagation()}function Rh(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Oh(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Lr(){return this.__zoom||nn}function Fh(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Bh(){return navigator.maxTouchPoints||"ontouchstart"in this}function Hh(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function ta(){var t=Rh,e=Oh,n=Hh,i=Fh,r=Bh,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,l=xo,u=fe("start","zoom","end"),c,h,f,d=500,p=150,x=0,v=10;function m(w){w.property("__zoom",Lr).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",z).on("dblclick.zoom",$).filter(r).on("touchstart.zoom",N).on("touchmove.zoom",q).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(w,g,_,b){var k=w.selection?w.selection():w;k.property("__zoom",Lr),w!==k?S(w,g,_,b):k.interrupt().each(function(){L(this,arguments).event(b).start().zoom(null,typeof g=="function"?g.apply(this,arguments):g).end()})},m.scaleBy=function(w,g,_,b){m.scaleTo(w,function(){var k=this.__zoom.k,M=typeof g=="function"?g.apply(this,arguments):g;return k*M},_,b)},m.scaleTo=function(w,g,_,b){m.transform(w,function(){var k=e.apply(this,arguments),M=this.__zoom,C=_==null?y(k):typeof _=="function"?_.apply(this,arguments):_,I=M.invert(C),F=typeof g=="function"?g.apply(this,arguments):g;return n(A(E(M,F),C,I),k,a)},_,b)},m.translateBy=function(w,g,_,b){m.transform(w,function(){return n(this.__zoom.translate(typeof g=="function"?g.apply(this,arguments):g,typeof _=="function"?_.apply(this,arguments):_),e.apply(this,arguments),a)},null,b)},m.translateTo=function(w,g,_,b,k){m.transform(w,function(){var M=e.apply(this,arguments),C=this.__zoom,I=b==null?y(M):typeof b=="function"?b.apply(this,arguments):b;return n(nn.translate(I[0],I[1]).scale(C.k).translate(typeof g=="function"?-g.apply(this,arguments):-g,typeof _=="function"?-_.apply(this,arguments):-_),M,a)},b,k)};function E(w,g){return g=Math.max(o[0],Math.min(o[1],g)),g===w.k?w:new xt(g,w.x,w.y)}function A(w,g,_){var b=g[0]-_[0]*w.k,k=g[1]-_[1]*w.k;return b===w.x&&k===w.y?w:new xt(w.k,b,k)}function y(w){return[(+w[0][0]+ +w[1][0])/2,(+w[0][1]+ +w[1][1])/2]}function S(w,g,_,b){w.on("start.zoom",function(){L(this,arguments).event(b).start()}).on("interrupt.zoom end.zoom",function(){L(this,arguments).event(b).end()}).tween("zoom",function(){var k=this,M=arguments,C=L(k,M).event(b),I=e.apply(k,M),F=_==null?y(I):typeof _=="function"?_.apply(k,M):_,H=Math.max(I[1][0]-I[0][0],I[1][1]-I[0][1]),G=k.__zoom,j=typeof g=="function"?g.apply(k,M):g,nt=l(G.invert(F).concat(H/G.k),j.invert(F).concat(H/j.k));return function(W){if(W===1)W=j;else{var gt=nt(W),cn=H/gt[2];W=new xt(cn,F[0]-gt[0]*cn,F[1]-gt[1]*cn)}C.zoom(null,W)}})}function L(w,g,_){return!_&&w.__zooming||new T(w,g)}function T(w,g){this.that=w,this.args=g,this.active=0,this.sourceEvent=null,this.extent=e.apply(w,g),this.taps=0}T.prototype={event:function(w){return w&&(this.sourceEvent=w),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(w,g){return this.mouse&&w!=="mouse"&&(this.mouse[1]=g.invert(this.mouse[0])),this.touch0&&w!=="touch"&&(this.touch0[1]=g.invert(this.touch0[0])),this.touch1&&w!=="touch"&&(this.touch1[1]=g.invert(this.touch1[0])),this.that.__zoom=g,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(w){var g=R(this.that).datum();u.call(w,this.that,new qh(w,{sourceEvent:this.sourceEvent,target:m,type:w,transform:this.that.__zoom,dispatch:u}),g)}};function D(w,...g){if(!t.apply(this,arguments))return;var _=L(this,g).event(w),b=this.__zoom,k=Math.max(o[0],Math.min(o[1],b.k*Math.pow(2,i.apply(this,arguments)))),M=vt(w);if(_.wheel)(_.mouse[0][0]!==M[0]||_.mouse[0][1]!==M[1])&&(_.mouse[1]=b.invert(_.mouse[0]=M)),clearTimeout(_.wheel);else{if(b.k===k)return;_.mouse=[M,b.invert(M)],De(this),_.start()}Yt(w),_.wheel=setTimeout(C,p),_.zoom("mouse",n(A(E(b,k),_.mouse[0],_.mouse[1]),_.extent,a));function C(){_.wheel=null,_.end()}}function z(w,...g){if(f||!t.apply(this,arguments))return;var _=w.currentTarget,b=L(this,g,!0).event(w),k=R(w.view).on("mousemove.zoom",F,!0).on("mouseup.zoom",H,!0),M=vt(w,_),C=w.clientX,I=w.clientY;co(w.view),bn(w),b.mouse=[M,this.__zoom.invert(M)],De(this),b.start();function F(G){if(Yt(G),!b.moved){var j=G.clientX-C,nt=G.clientY-I;b.moved=j*j+nt*nt>x}b.event(G).zoom("mouse",n(A(b.that.__zoom,b.mouse[0]=vt(G,_),b.mouse[1]),b.extent,a))}function H(G){k.on("mousemove.zoom mouseup.zoom",null),fo(G.view,b.moved),Yt(G),b.event(G).end()}}function $(w,...g){if(t.apply(this,arguments)){var _=this.__zoom,b=vt(w.changedTouches?w.changedTouches[0]:w,this),k=_.invert(b),M=_.k*(w.shiftKey?.5:2),C=n(A(E(_,M),b,k),e.apply(this,g),a);Yt(w),s>0?R(this).transition().duration(s).call(S,C,b,w):R(this).call(m.transform,C,b,w)}}function N(w,...g){if(t.apply(this,arguments)){var _=w.touches,b=_.length,k=L(this,g,w.changedTouches.length===b).event(w),M,C,I,F;for(bn(w),C=0;C<b;++C)I=_[C],F=vt(I,this),F=[F,this.__zoom.invert(F),I.identifier],k.touch0?!k.touch1&&k.touch0[2]!==F[2]&&(k.touch1=F,k.taps=0):(k.touch0=F,M=!0,k.taps=1+!!c);c&&(c=clearTimeout(c)),M&&(k.taps<2&&(h=F[0],c=setTimeout(function(){c=null},d)),De(this),k.start())}}function q(w,...g){if(this.__zooming){var _=L(this,g).event(w),b=w.changedTouches,k=b.length,M,C,I,F;for(Yt(w),M=0;M<k;++M)C=b[M],I=vt(C,this),_.touch0&&_.touch0[2]===C.identifier?_.touch0[0]=I:_.touch1&&_.touch1[2]===C.identifier&&(_.touch1[0]=I);if(C=_.that.__zoom,_.touch1){var H=_.touch0[0],G=_.touch0[1],j=_.touch1[0],nt=_.touch1[1],W=(W=j[0]-H[0])*W+(W=j[1]-H[1])*W,gt=(gt=nt[0]-G[0])*gt+(gt=nt[1]-G[1])*gt;C=E(C,Math.sqrt(W/gt)),I=[(H[0]+j[0])/2,(H[1]+j[1])/2],F=[(G[0]+nt[0])/2,(G[1]+nt[1])/2]}else if(_.touch0)I=_.touch0[0],F=_.touch0[1];else return;_.zoom("touch",n(A(C,I,F),_.extent,a))}}function P(w,...g){if(this.__zooming){var _=L(this,g).event(w),b=w.changedTouches,k=b.length,M,C;for(bn(w),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),M=0;M<k;++M)C=b[M],_.touch0&&_.touch0[2]===C.identifier?delete _.touch0:_.touch1&&_.touch1[2]===C.identifier&&delete _.touch1;if(_.touch1&&!_.touch0&&(_.touch0=_.touch1,delete _.touch1),_.touch0)_.touch0[1]=this.__zoom.invert(_.touch0[0]);else if(_.end(),_.taps===2&&(C=vt(C,this),Math.hypot(h[0]-C[0],h[1]-C[1])<v)){var I=R(this).on("dblclick.zoom");I&&I.apply(this,arguments)}}}return m.wheelDelta=function(w){return arguments.length?(i=typeof w=="function"?w:ke(+w),m):i},m.filter=function(w){return arguments.length?(t=typeof w=="function"?w:ke(!!w),m):t},m.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:ke(!!w),m):r},m.extent=function(w){return arguments.length?(e=typeof w=="function"?w:ke([[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]]),m):e},m.scaleExtent=function(w){return arguments.length?(o[0]=+w[0],o[1]=+w[1],m):[o[0],o[1]]},m.translateExtent=function(w){return arguments.length?(a[0][0]=+w[0][0],a[1][0]=+w[1][0],a[0][1]=+w[0][1],a[1][1]=+w[1][1],m):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},m.constrain=function(w){return arguments.length?(n=w,m):n},m.duration=function(w){return arguments.length?(s=+w,m):s},m.interpolate=function(w){return arguments.length?(l=w,m):l},m.on=function(){var w=u.on.apply(u,arguments);return w===u?m:w},m.clickDistance=function(w){return arguments.length?(x=(w=+w)*w,m):Math.sqrt(x)},m.tapDistance=function(w){return arguments.length?(v=+w,m):v},m}const Gh="data/circle_packing_data.json",Tr="circle-packing-plot",Xh="circle-packing-title",jh="circle-packing-text",Cr="#f4efda",Yh="#9e2846",Uh="#000000",Vh=3,Zh=5,Wh=100,Kh={culture:"Culture",marterey:"Marterey",campagne:"Campagne",ouchy:"Ouchy",la_sallaz:"La Sallaz",chailly:"Chailly",grange_neuve:"Grange-Neuve",commerce:"Commerce",st_laurent:"St-Laurent",palud:"Palud",grand_st_jean:"Grand St-Jean",ale:"Ale",montee_de_st_laurent:"Monte de St-Laurent",centre:"Centre",rue_du_pont:"Rue du Pont",cheneau_de_bourg:"Cheneau de Bourg",montee_st_francois:"Monte St-Franois",affaires:"Affaires",bourg:"Bourg",place_st_francois:"Place St-Franois",cathedrale:"Cathdrale",barre:"Barre",cite_derriere:"Cit Derrire",cite_dessous:"Cit Dessous"},Jh="",Qh={culture:"Section Culture",marterey:"Division Marterey",campagne:"Section Campagne",ouchy:"Division Ouchy",la_sallaz:"Division La Sallaz",chailly:"Division Chailly",grange_neuve:"Division Grange-Neuve",commerce:"Section Commerce",st_laurent:"",palud:"Division Palud",grand_st_jean:"Division Grand St-Jean",ale:"Division Ale",montee_de_st_laurent:"",centre:"Section Centre",rue_du_pont:"Division Rue du Pont",cheneau_de_bourg:"Division Cheneau de Bourg",montee_st_francois:"Division Monte St-Franois",affaires:"Section Affaires",bourg:"Division Bourg",place_st_francois:"Division Place St-Franois",cathedrale:"Section Cathdrale",barre:"",cite_derriere:"Division Cit Derrire",cite_dessous:"Division Cit Dessous"},td="Pour vivre une exprience d'exploration historique immersive, nous vous invitons  dcouvrir les sections et divisions qui constituaient la ville. Pour ce faire, il suffit de cliquer sur les cercles correspondant  chaque section ou division.",ed={culture:"La division de Marterey tait un vritable bastion culturel, se distinguant par son grand thtre, construit entre 1803 et 1805, et de nombreux autres tablissements culturels tels que des salons et des casinos. Ces lieux de divertissement taient particulirement attrayants pour les rentiers, faisant de Marterey leur deuxime choix de rsidence aprs Ouchy. De plus, la profusion de ces tablissements culturels offrait de nombreuses opportunits d'emploi, attirant ainsi une population travaillant principalement dans les services. L'effervescence culturelle de Marterey contribuait  faonner son identit unique au sein de la ville de Lausanne.",marterey:"La division de Marterey tait un vritable bastion culturel, se distinguant par son grand thtre, construit entre 1803 et 1805, et de nombreux autres tablissements culturels tels que des salons et des casinos. Ces lieux de divertissement taient particulirement attrayants pour les rentiers, faisant de Marterey leur deuxime choix de rsidence aprs Ouchy. De plus, la profusion de ces tablissements culturels offrait de nombreuses opportunits d'emploi, attirant ainsi une population travaillant principalement dans les services. L'effervescence culturelle de Marterey contribuait  faonner son identit unique au sein de la ville de Lausanne.",campagne:"La section Campagne de Lausanne au dbut du XIX<sup>me</sup> tait caractrise par une prdominance de l'agriculture, avec toutefois une varit de nuances en fonction des divisions. Ouchy, par exemple, se distinguait comme le havre des rentiers, offrant un refuge pittoresque et serein loin du tumulte urbain, tout en attirant aussi une part de la population implique dans l'agriculture grce  ses champs et vignes.  l'inverse, les divisions dans les hauts de la ville taient profondment marques par l'agriculture, avec une conomie locale fortement tributaire de cette activit. Toutefois, malgr la prsence de structures importantes comme la ferme Rovraz  La Sallaz, les conditions de vie dans ces divisions semblaient modestes, voire prcaires, illustrant la potentielle fragilit de la condition agricole  cette poque.",ouchy:"Ouchy mergeait comme le quartier de prdilection des rentiers, offrant une escapade loin de l'effervescence du centre urbain, tout en proposant des panoramas pittoresques du lac. Sa distance par rapport au centre-ville suggre qu'Ouchy aurait t parsem de champs et de vignes,  l'image du Lavaux contemporain, attirant une population significative lie  l'agriculture. Il est envisageable que certains rentiers aient galement t propritaires de ces terres agricoles environnantes, unissant ainsi ces deux populations apparemment opposes. Cette cohabitation unique aurait pu contribuer  l'panouissement de ces deux types de population dans cette division.",la_sallaz:`La division de La Sallaz se caractrisait par une dominante agricole. Il est fort probable que l'conomie locale tait largement tributaire de la ferme Rovraz, qui devait offrir des sources de revenus  une part importante de la population locale. Malgr cela, la population de La Sallaz vivait probablement dans des conditions modestes, voire prcaires, ce qui est corrobor par l'tablissement ultrieur en 1887 de l'asile pour "les vieillards pauvres et malheureux de Lausanne". Par consquent, cette division pourrait illustrer la prcarit de la condition agricole malgr une conomie locale visiblement tourne vers cette activit.`,chailly:"Comme les divisions de La Sallaz et de Grange-Neuve, la division de Chailly se distinguait par une prsence agricole trs marque. Cet aspect met en vidence l'importance et la prdominance de l'agriculture dans cette partie de Lausanne  cette poque.",grange_neuve:" l'instar des divisions de La Sallaz et de Chailly, la division de Grange-Neuve tait fortement marque par l'agriculture, encore plus que dans les autres divisions. Cependant, l'absence totale de rentiers suggre que cette division pourrait avoir t moins aise que ses homologues. Les raisons pourraient tre diverses : la grande distance la sparant du centre urbain ou la nature mme des cultures, moins prestigieuses peut-tre, comme les pommes de terre par opposition au vin. Cette distinction souligne l'htrognit possible des conditions de vie au sein des divisions agricoles de Lausanne  cette poque.",commerce:"Le dynamisme commercial de Lausanne tait palpable dans plusieurs quartiers vibrants de la ville avec des centres actifs comme la place de la Palud. La place Chauderon, inaugure en 1830, servait de point de transfert pour les marchandises, tandis que la place de la Palud, avec l'Htel de Ville et son march de fromages, constituait un autre ple d'activit.",st_laurent:"",palud:'La division de la Palud, tout comme la Place St-Franois, se distinguait par une esprance de vie leve parmi ses habitants. Malgr le fait que la moiti de sa population exerait des mtiers dits "physiques", les conditions de vie devaient y tre suffisamment bonnes pour permettre une telle longvit.',grand_st_jean:"Proche de l'Htel de Ville, la division du Grand St-Jean tait particulirement prise par ceux travaillant dans l'administration. Son emplacement stratgique,  proximit des institutions municipales, en faisait un lieu de rsidence privilgi pour ces professionnels, la plaant juste aprs la division de la Cit Derrire en termes de concentration d'administrateurs.",ale:"loigne du centre urbain, la division d'Ale en 1832 offrait probablement un cadre idal pour l'agriculture, comme le suggre la forte prsence de travailleurs agricoles. Cependant, la faible prsence de rentiers et d'autres catgories plus aises indique que cette division tait principalement peuple par les classes populaires.",montee_de_st_laurent:"",centre:"Le centre de Lausanne tait marqu par des rues pittoresques et animes, comme la Monte St-Franois, le Cheneau de Bourg et la Rue du Pr. Toutefois, le paysage social tait significativement influenc par la prsence de la tannerie Mercier dans le quartier du Rtillon. Malgr son importance conomique, la tannerie tait associe  des conditions sanitaires dfavorables et des odeurs dsagrables, ce qui a limit la prsence de la bourgeoisie dans ce secteur.",cheneau_de_bourg:"La division Cheneau de Bourg de Lausanne tait principalement peuple par une population artisanale, tandis que le nombre de personnes aises, comme les rentiers et le personnel d'administration, tait relativement restreint. Cette rpartition dmographique pourrait tre attribue  la prsence passe de la Louve et de la Venoge. Ces deux rivires, propices  de nombreux mtiers manuels, avaient probablement aussi contribu  crer une ambiance moins attrayante pour ceux qui ne travaillaient pas dans ces mtiers. Les odeurs et la mauvaise rputation associes  ces zones industrielles auraient dissuad les personnes plus aises de s'y installer, renforant ainsi la caractristique artisanale de cette division.",rue_du_pont:"La division de la Rue du Pont, tout comme la division de Marterey, tait un lieu privilgi pour les artisans et les commerants, jouant probablement un rle cl dans le commerce de Lausanne. Toutefois, malgr son dynamisme conomique, l'esprance de vie dans cette division tait particulirement basse, environ la moiti de celle de la Place St-Franois. Il est possible que les conditions de travail y taient dangereuses, avec une exposition potentielle  des produits toxiques dans le cadre de leurs activits artisanales et commerciales.",montee_st_francois:"La monte St-Franois, domine par les activits commerciales et artisanales, bnficiait probablement d'une position favorable au commerce local et aux exportations. Cependant,  l'image de la division de la Place St-Franois, la monte St-Franois prsentait une faible prsence de rentiers, ce qui suggre que, malgr son dynamisme conomique, les conditions de bien-tre et sanitaires y taient probablement moins favorables. L'absence de personnel administratif dans cette division indique galement qu'elle n'tait pas au cur des priorits de la commune  cette poque, refltant un focus plus orient vers le commerce et l'artisanat que vers l'amlioration des conditions de vie.",affaires:"Le cur conomique de Lausanne se trouvait dans le quartier du Bourg. Ce dernier, vibrant d'activit, abritait l'Htel des postes, cr entre 1806 et 1808 suite  la transformation d'une partie de l'ancien mange. C'tait ici que le courrier tait centralis et expdi. De plus, ce quartier jouait un rle crucial dans le transport. En effet, la place Saint-Franois tait le terminus des diligences en provenance ou  destination de Berne, Genve ou Paris. Le quartier du Bourg tait donc un vritable ple d'affaires, o se croisaient les flux de courriers et de voyageurs, symbolisant le dynamisme conomique de Lausanne  cette poque.",bourg:`La Rue du Bourg et la Place St-Franois  proximit taient des lieux priss par les intellectuels dits "libraux". Leur prsence a contribu  l'arrive de populations moins manuelles, diversifiant ainsi la composition dmographique de la division. Par ailleurs, la prsence de nombreuses familles patriciennes ajoutait une note de raffinement  cette division, qui tait alors considre comme l'une des plus chics et raffines de la ville. Malgr la prsence notable d'artisans et de travailleurs manuels, le Bourg se distinguait aussi par son attrait pour les intellectuels et son ambiance aristocratique.`,place_st_francois:`La Place St-Franois,  l'instar de la Rue du Bourg, tait une enclave de libralisme intellectuel. Ce havre intellectuel attire un nombre important d'individus dont l'occupation est loin d'tre manuelle, ce qui pourrait en partie expliquer la longvit exceptionnelle de ses rsidents - l'esprance de vie y tait en effet de 48.5 ans en 1838, bien au-dessus de la moyenne lausannoise qui ne dpassait pas la trentaine. Bien que cette mesure ne soit pas directement lie au niveau de vie, elle suggre des conditions de vie probablement suprieures  la moyenne de Lausanne, ce qui est cohrent avec le fait que moins du quart de ses habitants exeraient des mtiers dits "physiques". La Place St-Franois, tout comme la Place de la Palud, tait un foyer d'activit urbaine et conomique, avec de nombreux travaux d'infrastructure, notamment la construction de routes et de ponts, entrepris pour favoriser le transit et stimuler la croissance.`,cathedrale:"La cathdrale de Lausanne se dressait majestueusement comme un emblme du patrimoine de la ville. Implante au cur de la Cit Derrire, son architecture impressionnante dominait l'horizon, attirant l'attention et l'admiration des rsidents et des visiteurs. Les quartiers pittoresques de la Cit Dessous et de la Barre enveloppaient la cathdrale dans un tissu urbain dense. En outre, la prsence de l'acadmie dans cette division renforait le statut de la cathdrale comme centre de l'enseignement et de l'rudition.",barre:"",cite_derriere:"Abritant des btiments importants tels que le Tribunal cantonal et la Maison cantonale, la division de la Cit Derrire tait probablement un ple majeur de l'administration de Lausanne, accueillant le plus grand nombre de personnes travaillant dans ce secteur. De plus, sa richesse culturelle, illustre par la prsence de l'Acadmie et de sa proximit avec la Cathdrale, en faisait un lieu d'intrt pour les rentiers. Ce mlange d'activits administratives et d'attraits culturels a sans doute contribu  attirer une part significative de rentiers.",cite_dessous:`La division de la Cit Dessous abritait l'Hpital, autrefois connu sous le nom d'"Hospice des alins", qui tait le principal tablissement de sant de Lausanne. La prsence de cette institution attirait un nombre important de mdecins du canton, rendant cette division particulirement attrayante pour ceux travaillant dans le domaine des services mdicaux.`};class nd{constructor(){O(this,"data");O(this,"width");O(this,"height");this.loadData().then(()=>{this.initDimensions(),this.initPacking()})}async loadData(){return new Promise(e=>{Rt(Gh).then(n=>{this.data=n,e()})})}initDimensions(){const e=document.getElementById(Tr);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=n,this.height=n}}initPacking(){const n=(f=>vh().size([this.width,this.height]).padding(Vh)(wi(f).sum(d=>d.value).sort((d,p)=>p.value-d.value)))(this.data);let i=n;const r=_t().domain([0,2]).range([Cr,Yh]),o=Th().domain([_a(n.descendants(),f=>f.r),ri(n.descendants(),f=>f.r)]).range([Zh,Wh]),a=R(`#${Tr}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",`-${this.width/2} -${this.height/2} ${this.width} ${this.height}`).style("display","block").style("background",r(0)).style("cursor","pointer").on("click",f=>h(f,n)),s=a.append("g").selectAll("circle").data(n.descendants().slice(1)).join("circle").attr("fill",f=>f.children?r(f.depth):Cr).attr("pointer-events",f=>f.children?null:"none").on("mouseover",function(){R(this).attr("stroke",Uh)}).on("mouseout",function(){R(this).attr("stroke",null)}).on("click",(f,d)=>i!==d&&(h(f,d),f.stopPropagation())),l=a.append("g").style("font-family","var(--default-font-family)").attr("pointer-events","none").attr("text-anchor","middle").selectAll("text").data(n.descendants()).join("text").attr("dy","0.3em").style("font-size",f=>`${o(f.r)}px`).style("fill-opacity",f=>f.parent===n?1:0).style("display",f=>f.parent===n?"inline":"none").text(f=>Kh[f.data.name]??f.data.name);let u;const c=f=>{const d=this.width/f[2];u=f,l.attr("transform",p=>`translate(${(p.x-f[0])*d},${(p.y-f[1])*d})`),s.attr("transform",p=>`translate(${(p.x-f[0])*d},${(p.y-f[1])*d})`),s.attr("r",p=>p.r*d)};c([n.x,n.y,n.r*2]);function h(f,d){const p=document.getElementById(Xh);if(p){const m=Qh[d.data.name]||Jh;p.innerHTML=m}const x=document.getElementById(jh);if(x){const m=ed[d.data.name]||td;x.innerHTML=m}i=d;const v=a.transition().duration(f.altKey?7500:750).tween("zoom",()=>{const m=xo(u,[i.x,i.y,i.r*2]);return E=>c(m(E))});l.filter(function(m){return m.parent===i||this.style.display==="inline"}).transition(v).style("fill-opacity",m=>m.parent===i?1:0).on("start",function(m){m.parent===i&&(this.style.display="inline")}).on("end",function(m){m.parent!==i&&(this.style.display="none")})}}}const id="select_job",rd="check_proportion",ea="bar-jobs",od="bar-origins",Ut=500,ad="Distribution des catgories de mtiers",sd="Distribution des origines des habitants",ud=t=>({bourg:"Bourg",place_st_francois:"Place St-Franois",chailly:"Chailly","grange-neuve":"Grange-Neuve",la_sallaz:"La Sallaz",ouchy:"Ouchy",barre:"Barre",cite_derriere:"Cit Derrire",cite_dessous:"Cit Dessous",cheneau_de_bourg:"Cheneau-de-Bourg",chenneau:"Cheneau-de-Bourg",montee_st_francois:"Monte St-Franois",rue_du_pont:"Rue du Pr",rue_du_pre:"Rue du Pr",ale:"Ale",grand_st_jean:"Grand St-Jean",montee_de_st_laurent:"Monte de St-Laurent",palud:"Palud",st_laurent:"St-Laurent",marterey:"Marterey",affaires_division:"Affaires",campagne_division:"Campagne",cathedrale_division:"Cathdrale",centre_division:"Centre",commerce_division:"Commerce",culture_division:"Culture",administration:"Administration",agricole:"Agricole",artisanat:"Artisanat",commerce:"Commerce",construction:"Construction",rente:"Rente",service:"Service",hors_lausanne:"Hors Lausanne",lausanne:"Lausanne"})[t]??t,ld=t=>({administration:"blue",agricole:"#00A59B",artisanat:"#6F2282",commerce:"#E84E10",construction:"#FCBB00",rente:"#143A85",service:"#00973B"})[t]||"turquoise",En={no_selection:{min:0,max:1},administration:{min:1,max:17,color:"blue",max_ratio:.08134},agricole:{min:3,max:122,color:"#00A59B",max_ratio:.657143},artisanat:{min:2,max:93,color:"#6F2282",max_ratio:.308081},commerce:{min:6,max:44,color:"#E84E10",max_ratio:.135},construction:{min:1,max:39,color:"#FCBB00",max_ratio:.135458},rente:{min:5,max:140,color:"#143A85",max_ratio:.412979},service:{min:1,max:77,color:"#00973B",max_ratio:.158103},not_lausanne:{max:370,color:"turquoise",max_ratio:.8},aigle:{max:8,color:"turquoise",max_ratio:.032609},angleterre:{max:14,color:"turquoise",max_ratio:.041298},aubonne:{max:10,color:"turquoise",max_ratio:.030303},avenches:{max:3,color:"turquoise",max_ratio:.014354},cossonay:{max:17,color:"turquoise",max_ratio:.065217},echallens:{max:12,color:"turquoise",max_ratio:.045455},france:{max:21,color:"turquoise",max_ratio:.093264},fribourg:{max:6,color:"turquoise",max_ratio:.085714},geneve:{max:6,color:"turquoise",max_ratio:.017699},grandson:{max:2,color:"turquoise",max_ratio:.01087},italie:{max:3,color:"turquoise",max_ratio:.01005},la_vallee:{max:14,color:"turquoise",max_ratio:.4},lausanne:{max:149,color:"turquoise",max_ratio:.54023},lavaux:{max:53,color:"turquoise",max_ratio:.106195},morges:{max:26,color:"turquoise",max_ratio:.092527},moudon:{max:13,color:"turquoise",max_ratio:.055276},neuchatel:{max:3,color:"turquoise",max_ratio:.011858},nyon:{max:10,color:"turquoise",max_ratio:.043478},orbe:{max:10,color:"turquoise",max_ratio:.035587},oron:{max:15,color:"turquoise",max_ratio:.059289},payerne:{max:4,color:"turquoise",max_ratio:.021739},pays_d_enhaut:{max:11,color:"turquoise",max_ratio:.038278},rolle:{max:8,color:"turquoise",max_ratio:.020202},suisse_allemande:{max:36,color:"turquoise",max_ratio:.100503},vaud:{max:6,color:"turquoise",max_ratio:.085714},vevey:{max:15,color:"turquoise",max_ratio:.045226},yverdon:{max:12,color:"turquoise",max_ratio:.072464}},Dr=.3;class cd{constructor(e,n,i=7e5,r=[6.635,46.525],o=100,a="rgba(128, 128, 128, 1)"){this.map_file=e,this.locations_file=n,this.mapBarPlotJobs=new zr(ea,ad),this.mapBarPlotOrigins=new zr(od,sd),this.scale=i,this.center=r,this.min_zoom_dimension=o,this.default_zone_color=a,this.is_zoomed=!1,this.clicked_zone=null,this.selectedJobsData=null,this.selectedOriginsData=null,this.initDimensions(),this.svg=this.init_svg(),this.layer_1=this.init_g(),this.layer_3=this.init_g(),this.layer_2=this.init_g(),this.legend=this.init_legend(),this.projection=this.init_projection(),this.zoom=this.init_zoom();let s="no_selection",l="no_origin",u=!1,c=!1,h=!1;document.getElementById(rd).addEventListener("change",p=>{console.log(c,h,s,l,u),u=p.target.checked,c?(this.handleSelectJob(s,u),this.update_legend(s,u)):h?(this.handleSelectOrigin(l,u),this.update_legend(l,u)):this.hadleNoSelection()}),document.getElementById(id).addEventListener("change",p=>{p.target.value==="no_selection"&&(c=!1,h=!1,this.hadleNoSelection());const x=p.target.selectedOptions[0].parentNode.id;x==="job_category_optgroup"?(c=!0,h=!1,s=p.target.value,this.handleSelectJob(p.target.value,u)):x==="origin_category_optgroup"&&(c=!1,h=!0,l=p.target.value,this.handleSelectOrigin(p.target.value,u)),this.update_legend(p.target.value,u),this.selectedJobsData!==null&&this.mapBarPlotJobs.drawBarPlot(this.selectedJobsData,p.target.value),this.selectedOriginsData!==null&&this.mapBarPlotOrigins.drawBarPlot(this.selectedOriginsData,p.target.value)})}handleSelectJob(e,n){const i=En[e],r=_t().domain([0,n?i.max_ratio:i.max]).range(["#FAF4DD",i.color]);this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",o=>!(e in o.properties.jobs)||e==="no_selection"?r(0):r(o.properties.jobs[e]/(n?o.properties.population:1))).attr("data-old-color",o=>!(e in o.properties.jobs)||e==="no_selection"?r(0):r(o.properties.jobs[e]/(n?o.properties.population:1)))}handleSelectOrigin(e,n){const i=En[e],r=_t().domain([0,n?i.max_ratio:i.max]).range(["#FAF4DD",i.color]);this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",o=>!(e in o.properties.origins)||e==="no_selection"?r(0):r(o.properties.origins[e]/(n?o.properties.population:1))).attr("data-old-color",o=>!(e in o.properties.origins)||e==="no_selection"?r(0):r(o.properties.origins[e]/(n?o.properties.population:1)))}hadleNoSelection(){this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",e=>this.default_zone_color).attr("data-old-color",e=>this.default_zone_color)}initDimensions(){const e=document.getElementById("map-chart");e&&(this.width=e.clientWidth,this.height=e.clientHeight)}init_svg(){return R("#map").append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]).on("mouseover",function(){}).on("mouseout",function(){})}init_projection(){return Pf().center(this.center).scale(this.scale).translate([this.svg_width/2,this.svg_height/2])}init_g(){return this.svg.append("g")}init_legend(){const e=this.svg.append("g").attr("class","legend").attr("transform","translate(20, "+(this.height-70)+")"),n=Qo(Ph).domain([0,100]),r=this.svg.append("defs").append("linearGradient").attr("id","linear-gradient");r.append("stop").attr("id","gradient-start").attr("offset","0%").attr("stop-color",n.range()[0]),r.append("stop").attr("id","gradient-end").attr("offset","100%").attr("stop-color",n.range()[1]),e.append("rect").attr("id","legend-rect").attr("width",200).attr("height",20).style("fill","url(#linear-gradient)");const o=_t().domain(n.domain()).range([0,200]),a=Ot(o).ticks(5);return e.append("g").attr("id","legend-axis").attr("transform","translate(0, 20)").style("color","#fff").call(a),e.style("opacity",0),e.append("text").attr("id","legend-title").attr("x",0).attr("y",-10).style("fill","#fff").text("Nombre de personnes"),e}update_legend(e,n){if(e==="no_selection"){this.svg.select(".legend").transition().duration(500).style("opacity",0);return}n?this.svg.select("#legend-title").text("Proportion de personnes [%]"):this.svg.select("#legend-title").text("Nombre de personnes"),this.svg.select(".legend").transition().duration(500).style("opacity",1);const i=En[e],r=_t().domain([0,n?i.max_ratio*100:i.max]).range(["#FAF4DD",i.color]),o=this.svg.select("#linear-gradient");o.select("#gradient-start").transition().duration(500).attr("stop-color",r.range()[0]),o.select("#gradient-end").transition().duration(500).attr("stop-color",r.range()[1]),this.svg.select("#legend-rect").transition().duration(500).style("fill","url(#linear-gradient)");const s=_t().domain(r.domain()).range([0,200]),l=Ot(s).ticks(5);this.svg.select("#legend-axis").transition().duration(500).style("color","#fff").call(l)}init_zoom(){const e=ta().scaleExtent([1,8]).on("zoom",({transform:n})=>{this.layer_1.attr("transform",n),this.layer_2.attr("transform",n),this.layer_3.attr("transform",n)});return this.svg.call(e),e}get svg_width(){return this.svg.node().getBoundingClientRect().width}get svg_height(){return this.svg.node().getBoundingClientRect().height}get path_generator(){return gr().projection(this.projection)}load_data(){Rt(this.map_file).then(e=>{this.layer_1.selectAll("path").data(e.features).enter().append("path").attr("class","zone").attr("id",n=>n.properties.id).attr("fill",n=>this.default_zone_color).attr("data-old-color",n=>this.default_zone_color).attr("d",gr().projection(this.projection)).style("stroke","white").style("stroke-width",.2).on("mouseover",n=>{this.onMouseOverZone(n.target)}).on("mouseout",n=>{this.onMouseOutZone(n.target)}).on("click",n=>{this.is_zoomed?this.zoomOut():this.zoomOnZone(n.target),this.is_zoomed=!this.is_zoomed,this.zoom.filter(()=>!this.is_zoomed),this.is_zoomed||this.resetZone(this.clicked_zone),this.clicked_zone=this.is_zoomed?n.target:null})}),this.load_locations(),this.load_buildings()}load_locations(){Rt(this.locations_file).then(e=>{e=Object.entries(e),this.layer_2.selectAll("circle").data(e).enter().append("circle").attr("cx",n=>this.projection(n[1])[0]).attr("cy",n=>this.projection(n[1])[1]).attr("r",2).attr("fill","black").style("pointer-events","none"),this.layer_2.selectAll("text").data(e).enter().append("text").attr("x",n=>this.projection(n[1])[0]).attr("y",n=>this.projection(n[1])[1]).attr("dy",-3).text(n=>n[0]).style("font-size","6px").style("text-anchor","middle").style("pointer-events","none").style("font-family","sans-serif")})}load_buildings(){Rt("data/buildings.geojson").then(e=>{this.layer_3.selectAll(".building").data(e.features).enter().append("path").attr("class","building").attr("d",this.path_generator).attr("fill",`rgba(0, 0, 0, ${Dr})`).style("stroke",`rgba(0, 0, 0, ${Dr})`).style("stroke-width",.2).style("pointer-events","none")})}onMouseOverZone(e){if(this.is_zoomed)return;const n=R(e).attr("fill");R(e).attr("data-old-color",n);const i=n.replace(/[^\d,]/g,"").split(","),r=`rgb(${i[0]*1.25}, ${i[1]*1.25}, ${i[2]*1.25})`;this.fadeToColor(e,r);const a=this.getZoneCenter(e)[0];this.addZoneTitle(e,a[0],a[1])}onMouseOutZone(e){if(this.is_zoomed)return;const n=R(e).attr("data-old-color");this.fadeToColor(e,n),this.removeZoneTitle()}fadeToColor(e,n){this.is_zoomed||R(e).attr("fill",n)}getZoneCenter(e,n,i){const o=R(e).node().getBBox();let a=[o.x+o.width/2,o.y+o.height/2];return n||(a=this.projection.invert(a)),[a,i?this.getZoneBorders(e,n):null]}getZoneBorders(e,n){const r=R(e).node().getBBox();let o=[r.x,r.y+r.height],a=[r.x+r.width,r.y+r.height],s=[r.x,r.y],l=[r.x+r.width,r.y];return n||(o=this.projection.invert(o),a=this.projection.invert(a),s=this.projection.invert(s),l=this.projection.invert(l)),[o,a,s,l]}getZoneTitle(e){let n=e;n.nodeName=="path"&&(n=R(e).data()[0]);let i=n.properties.name;return(i==null||i==""||i=="nan")&&(i=n.properties.class),i=decodeURIComponent(escape(i)),i=i.split(" ")[0],i=i.replace(",",""),i}addZoneTitle(e,n,i){let r=this.getZoneTitle(e);this.layer_2.append("text").attr("x",this.projection([n,i])[0]).attr("y",this.projection([n,i])[1]).attr("text-anchor","middle").attr("id","zone_name").text(ud(r)).attr("font-family","sans-serif").attr("font-size","10px").attr("fill","black").style("pointer-events","none")}removeZoneTitle(){R("#zone_name").remove()}zoomOnZone(e){this.selectedZone=e;const n=this.getZoneCenter(e,!0,!0),i=n[0],r=n[1][0],o=n[1][1],a=n[1][2];let s=Math.abs(o[0]-r[0]);s=Math.max(s,this.min_zoom_dimension);let l=Math.abs(a[1]-r[1]);l=Math.max(l,this.min_zoom_dimension);const u=Math.min(this.svg_width/s,this.svg_height/l)*.7,c=this.svg_width/2-i[0]*u,h=this.svg_height/2-i[1]*u,f=nn.translate(c,h).scale(u);this.svg.transition().duration(750).call(this.zoom.transform,f);const d=document.getElementById("selection_option"),p=d.options[d.selectedIndex].value;let x=e.__data__.properties.jobs;this.selectedJobsData=Object.keys(x).map(function(m){return{id:m,value:x[m]}}),this.mapBarPlotJobs.drawBarPlot(this.selectedJobsData,p);let v=e.__data__.properties.origins;this.selectedOriginsData=Object.keys(v).map(function(m){return{id:m,value:v[m]}}),this.mapBarPlotOrigins.drawBarPlot(this.selectedOriginsData,p)}zoomOut(){this.svg.transition().duration(750).call(this.zoom.transform,nn)}resetZone(e){const n=R(e).attr("data-old-color");this.fadeToColor(e,n),this.removeZoneTitle()}}class zr{constructor(e,n){O(this,"width");O(this,"height");O(this,"barPlotElementId",ea);O(this,"title","Jobs");O(this,"svg");this.barPlotElementId=e,this.title=n,this.initDimensions(),this.initColor()}initDimensions(){const e=document.getElementById(this.barPlotElementId);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=e.clientWidth,this.height=n}}initColor(){this.color=ld}drawBarPlot(e,n){console.log(e);const i={top:10,right:30,bottom:100,left:50},r=this.width-i.left-i.right,o=this.height-i.top-i.bottom;let a=R(`#${this.barPlotElementId}`).select("svg"),s;a.empty()?(a=R(`#${this.barPlotElementId}`).append("svg").attr("id",`${this.barPlotElementId}-svg`).attr("width",r+i.left+i.right).attr("height",o+i.top+i.bottom).append("g").attr("transform",`translate(${i.left},${i.top})`),s=a.append("g").attr("class","bars"),a.append("text").attr("x",r/2).attr("y",20).attr("text-anchor","middle").style("font-size","1em").attr("fill","#FAF4DD").text(this.title)):s=a.select(".bars"),e.sort((p,x)=>ii(p.value,x.value)),e=e.filter(p=>p.id!=="not_lausanne");const l=bi().range([0,r]).domain(e.map(p=>p.id)).padding(.2),u=_t().domain([0,ri(e,p=>p.value)]).range([o,0]);let c=a.select(".x-axis");c.empty()?c=a.append("g").attr("class","x-axis").attr("transform",`translate(0,${o})`).call(Ot(l).tickFormat(p=>p)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").style("font-weight","normal").style("text-decoration","none").filter(p=>p===n).style("font-weight","bold").style("text-decoration","underline"):c.transition().duration(Ut).call(Ot(l).tickFormat(p=>p)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").style("font-weight","normal").style("text-decoration","none").filter(p=>p===n).style("font-weight","bold").style("text-decoration","underline");let h=a.select(".y-axis");h.empty()?h=a.append("g").attr("class","y-axis").call(Ie(u)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD"):h.transition().duration(Ut).call(Ie(u)).attr("color","#FAF4DD").selectAll("text").style("fill","#FAF4DD");const f=s.selectAll(`.${this.barPlotElementId}-bar`).data(e,p=>p.id);f.exit().transition().duration(Ut).attr("height",0).attr("y",u(0)).remove(),f.transition().duration(Ut).attr("x",p=>l(p.id)).attr("width",l.bandwidth()).attr("y",p=>u(p.value)).attr("height",p=>o-u(p.value)).attr("stroke",p=>p.id===n?"white":"none").attr("stroke-width",p=>p.id===n?"2px":"0px").attr("opacity",p=>n==="no_selection"||n==="not_lausanne"||p.id===n?1:.6),f.enter().append("rect").attr("class",`${this.barPlotElementId}-bar`).attr("x",p=>l(p.id)).attr("width",l.bandwidth()).attr("y",u(0)).attr("height",0).attr("fill",p=>this.color(p.id)).transition().duration(Ut).attr("height",p=>o-u(p.value)).attr("y",p=>u(p.value)).attr("stroke",p=>p.id===n?"white":"none").attr("stroke-width",p=>p.id===n?"2px":"0px").attr("opacity",p=>n==="no_selection"||n==="not_lausanne"||p.id===n?1:.6)}}function $r(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function na(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function Mn(t,e){let n=0;if(e===void 0)for(let i of t)(i=+i)&&(n+=i);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&(n+=r)}return n}function fd(t){return t.target.depth}function hd(t){return t.depth}function dd(t,e){return e-1-t.height}function ia(t,e){return t.sourceLinks.length?t.depth:e-1}function pd(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?na(t.sourceLinks,fd)-1:0}function Ae(t){return function(){return t}}function Ir(t,e){return rn(t.source,e.source)||t.index-e.index}function Pr(t,e){return rn(t.target,e.target)||t.index-e.index}function rn(t,e){return t.y0-e.y0}function Sn(t){return t.value}function gd(t){return t.index}function md(t){return t.nodes}function yd(t){return t.links}function qr(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function Rr({nodes:t}){for(const e of t){let n=e.y0,i=n;for(const r of e.sourceLinks)r.y0=n+r.width/2,n+=r.width;for(const r of e.targetLinks)r.y1=i+r.width/2,i+=r.width}}function vd(){let t=0,e=0,n=1,i=1,r=24,o=8,a,s=gd,l=ia,u,c,h=md,f=yd,d=6;function p(){const g={nodes:h.apply(null,arguments),links:f.apply(null,arguments)};return x(g),v(g),m(g),E(g),S(g),Rr(g),g}p.update=function(g){return Rr(g),g},p.nodeId=function(g){return arguments.length?(s=typeof g=="function"?g:Ae(g),p):s},p.nodeAlign=function(g){return arguments.length?(l=typeof g=="function"?g:Ae(g),p):l},p.nodeSort=function(g){return arguments.length?(u=g,p):u},p.nodeWidth=function(g){return arguments.length?(r=+g,p):r},p.nodePadding=function(g){return arguments.length?(o=a=+g,p):o},p.nodes=function(g){return arguments.length?(h=typeof g=="function"?g:Ae(g),p):h},p.links=function(g){return arguments.length?(f=typeof g=="function"?g:Ae(g),p):f},p.linkSort=function(g){return arguments.length?(c=g,p):c},p.size=function(g){return arguments.length?(t=e=0,n=+g[0],i=+g[1],p):[n-t,i-e]},p.extent=function(g){return arguments.length?(t=+g[0][0],n=+g[1][0],e=+g[0][1],i=+g[1][1],p):[[t,e],[n,i]]},p.iterations=function(g){return arguments.length?(d=+g,p):d};function x({nodes:g,links:_}){for(const[k,M]of g.entries())M.index=k,M.sourceLinks=[],M.targetLinks=[];const b=new Map(g.map((k,M)=>[s(k,M,g),k]));for(const[k,M]of _.entries()){M.index=k;let{source:C,target:I}=M;typeof C!="object"&&(C=M.source=qr(b,C)),typeof I!="object"&&(I=M.target=qr(b,I)),C.sourceLinks.push(M),I.targetLinks.push(M)}if(c!=null)for(const{sourceLinks:k,targetLinks:M}of g)k.sort(c),M.sort(c)}function v({nodes:g}){for(const _ of g)_.value=_.fixedValue===void 0?Math.max(Mn(_.sourceLinks,Sn),Mn(_.targetLinks,Sn)):_.fixedValue}function m({nodes:g}){const _=g.length;let b=new Set(g),k=new Set,M=0;for(;b.size;){for(const C of b){C.depth=M;for(const{target:I}of C.sourceLinks)k.add(I)}if(++M>_)throw new Error("circular link");b=k,k=new Set}}function E({nodes:g}){const _=g.length;let b=new Set(g),k=new Set,M=0;for(;b.size;){for(const C of b){C.height=M;for(const{source:I}of C.targetLinks)k.add(I)}if(++M>_)throw new Error("circular link");b=k,k=new Set}}function A({nodes:g}){const _=$r(g,M=>M.depth)+1,b=(n-t-r)/(_-1),k=new Array(_);for(const M of g){const C=Math.max(0,Math.min(_-1,Math.floor(l.call(null,M,_))));M.layer=C,M.x0=t+C*b,M.x1=M.x0+r,k[C]?k[C].push(M):k[C]=[M]}if(u)for(const M of k)M.sort(u);return k}function y(g){const _=na(g,b=>(i-e-(b.length-1)*a)/Mn(b,Sn));for(const b of g){let k=e;for(const M of b){M.y0=k,M.y1=k+M.value*_,k=M.y1+a;for(const C of M.sourceLinks)C.width=C.value*_}k=(i-k+a)/(b.length+1);for(let M=0;M<b.length;++M){const C=b[M];C.y0+=k*(M+1),C.y1+=k*(M+1)}q(b)}}function S(g){const _=A(g);a=Math.min(o,(i-e)/($r(_,b=>b.length)-1)),y(_);for(let b=0;b<d;++b){const k=Math.pow(.99,b),M=Math.max(1-k,(b+1)/d);T(_,k,M),L(_,k,M)}}function L(g,_,b){for(let k=1,M=g.length;k<M;++k){const C=g[k];for(const I of C){let F=0,H=0;for(const{source:j,value:nt}of I.targetLinks){let W=nt*(I.layer-j.layer);F+=P(j,I)*W,H+=W}if(!(H>0))continue;let G=(F/H-I.y0)*_;I.y0+=G,I.y1+=G,N(I)}u===void 0&&C.sort(rn),D(C,b)}}function T(g,_,b){for(let k=g.length,M=k-2;M>=0;--M){const C=g[M];for(const I of C){let F=0,H=0;for(const{target:j,value:nt}of I.sourceLinks){let W=nt*(j.layer-I.layer);F+=w(I,j)*W,H+=W}if(!(H>0))continue;let G=(F/H-I.y0)*_;I.y0+=G,I.y1+=G,N(I)}u===void 0&&C.sort(rn),D(C,b)}}function D(g,_){const b=g.length>>1,k=g[b];$(g,k.y0-a,b-1,_),z(g,k.y1+a,b+1,_),$(g,i,g.length-1,_),z(g,e,0,_)}function z(g,_,b,k){for(;b<g.length;++b){const M=g[b],C=(_-M.y0)*k;C>1e-6&&(M.y0+=C,M.y1+=C),_=M.y1+a}}function $(g,_,b,k){for(;b>=0;--b){const M=g[b],C=(M.y1-_)*k;C>1e-6&&(M.y0-=C,M.y1-=C),_=M.y0-a}}function N({sourceLinks:g,targetLinks:_}){if(c===void 0){for(const{source:{sourceLinks:b}}of _)b.sort(Pr);for(const{target:{targetLinks:b}}of g)b.sort(Ir)}}function q(g){if(c===void 0)for(const{sourceLinks:_,targetLinks:b}of g)_.sort(Pr),b.sort(Ir)}function P(g,_){let b=g.y0-(g.sourceLinks.length-1)*a/2;for(const{target:k,width:M}of g.sourceLinks){if(k===_)break;b+=M+a}for(const{source:k,width:M}of _.targetLinks){if(k===g)break;b-=M}return b}function w(g,_){let b=_.y0-(_.targetLinks.length-1)*a/2;for(const{source:k,width:M}of _.targetLinks){if(k===g)break;b+=M+a}for(const{target:k,width:M}of g.sourceLinks){if(k===_)break;b-=M}return b}return p}var Qn=Math.PI,ti=2*Qn,Mt=1e-6,_d=ti-Mt;function ei(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ra(){return new ei}ei.prototype=ra.prototype={constructor:ei,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-t,l=i-e,u=o-t,c=a-e,h=u*u+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>Mt)if(!(Math.abs(c*s-l*u)>Mt)||!r)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var f=n-o,d=i-a,p=s*s+l*l,x=f*f+d*d,v=Math.sqrt(p),m=Math.sqrt(h),E=r*Math.tan((Qn-Math.acos((p+h-x)/(2*v*m)))/2),A=E/m,y=E/v;Math.abs(A-1)>Mt&&(this._+="L"+(t+A*u)+","+(e+A*c)),this._+="A"+r+","+r+",0,0,"+ +(c*f>u*d)+","+(this._x1=t+y*s)+","+(this._y1=e+y*l)}},arc:function(t,e,n,i,r,o){t=+t,e=+e,n=+n,o=!!o;var a=n*Math.cos(i),s=n*Math.sin(i),l=t+a,u=e+s,c=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Mt||Math.abs(this._y1-u)>Mt)&&(this._+="L"+l+","+u),n&&(h<0&&(h=h%ti+ti),h>_d?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>Mt&&(this._+="A"+n+","+n+",0,"+ +(h>=Qn)+","+c+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function Or(t){return function(){return t}}function xd(t){return t[0]}function wd(t){return t[1]}var bd=Array.prototype.slice;function Ed(t){return t.source}function Md(t){return t.target}function Sd(t){var e=Ed,n=Md,i=xd,r=wd,o=null;function a(){var s,l=bd.call(arguments),u=e.apply(this,l),c=n.apply(this,l);if(o||(o=s=ra()),t(o,+i.apply(this,(l[0]=u,l)),+r.apply(this,l),+i.apply(this,(l[0]=c,l)),+r.apply(this,l)),s)return o=null,s+""||null}return a.source=function(s){return arguments.length?(e=s,a):e},a.target=function(s){return arguments.length?(n=s,a):n},a.x=function(s){return arguments.length?(i=typeof s=="function"?s:Or(+s),a):i},a.y=function(s){return arguments.length?(r=typeof s=="function"?s:Or(+s),a):r},a.context=function(s){return arguments.length?(o=s??null,a):o},a}function kd(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,r,i,r)}function Ad(){return Sd(kd)}function Nd(t){return[t.source.x1,t.y0]}function Ld(t){return[t.target.x0,t.y1]}function Td(){return Ad().source(Nd).target(Ld)}const Fr="sankey",zt="sankey-tooltip",kn="sankey-barplot",Cd="sankey-barplot-svg",Dd=.8,zd="center",$d=t=>t.id.split(/\W/)[0],Id=15,Pd=10,qd=1,Rd=1,Od=5,Fd=5,Bd=",",Hd="currentColor",Gd=.5,Xd=1.5,jd="round",Br=.5,Yd="multiply",Ud=Td(),Hr=6,Gr="#aaaaaa",Vt=500,oa=t=>({bourg:"#2081C3",place_st_francois:"#2081C3",chailly:"#289e61",grange_neuve:"#289e61",la_sallaz:"#289e61",ouchy:"#289e61",barre:"#725AC1",cite_derriere:"#725AC1",cite_dessous:"#725AC1",cheneau_de_bourg:"#F4743B",montee_st_francois:"#F4743B",rue_du_pont:"#F4743B",ale:"#F4B860",grand_st_jean:"#F4B860",montee_de_st_laurent:"#F4B860",palud:"#F4B860",st_laurent:"#F4B860",marterey:"#9E2846",affaires_division:"#2081C3",campagne_division:"#289e61",cathedrale_division:"#725AC1",centre_division:"#F4743B",commerce_division:"#F4B860",culture_division:"#9E2846",administration:"#cccccc",agricole:"#cccccc",artisanat:"#cccccc",commerce:"#cccccc",construction:"#cccccc",rente:"#cccccc",service:"#cccccc",hors_lausanne:"#333333",lausanne:"#cccccc"})[t]??"#aaaaaa",ni=t=>({bourg:"Bourg",place_st_francois:"Place St-Franois",chailly:"Chailly",grange_neuve:"Grange-Neuve",la_sallaz:"La Sallaz",ouchy:"Ouchy",barre:"Barre",cite_derriere:"Cit Derrire",cite_dessous:"Cit Dessous",cheneau_de_bourg:"Cheneau-de-Bourg",montee_st_francois:"Monte St-Franois",rue_du_pont:"Rue du Pr",ale:"Ale",grand_st_jean:"Grand St-Jean",montee_de_st_laurent:"Monte de St-Laurent",palud:"Palud",st_laurent:"St-Laurent",marterey:"Marterey",affaires_division:"Affaires",campagne_division:"Campagne",cathedrale_division:"Cathdrale",centre_division:"Centre",commerce_division:"Commerce",culture_division:"Culture",administration:"Administration",agricole:"Agricole",artisanat:"Artisanat",commerce:"Commerce",construction:"Construction",rente:"Rente",service:"Service",hors_lausanne:"Hors Lausanne",lausanne:"Lausanne"})[t]??t;class Vd{constructor(e,n){O(this,"dataPath");O(this,"uid");O(this,"width");O(this,"height");O(this,"data");O(this,"links");O(this,"nodes");O(this,"N");O(this,"G");O(this,"nodeAlign");O(this,"color");O(this,"format");O(this,"svg");O(this,"node");O(this,"link");this.dataPath=e,this.sankeyBarPlot=n,this.uid=`O-${Math.random().toString(16).slice(2)}`,this.loadData().then(()=>{this.initDimensions(),this.initNodeAlign(),this.initGraph(),this.initColor(),this.computeSankeyLayout(),this.initSvgElements()})}loadData(){return new Promise(e=>{Rt(this.dataPath).then(n=>{this.data=n,e()})})}initDimensions(){const e=document.getElementById(Fr);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=n,this.height=n}}initNodeAlign(){this.nodeAlign={left:hd,right:dd,center:pd}[zd]??ia}initGraph(){const e=mt(this.data,({source:r})=>r),n=mt(this.data,({target:r})=>r),i=mt(this.data,({value:r})=>r);this.nodes=Array.from(ba(e,n),r=>({id:r})),this.N=mt(this.nodes,r=>r.id),this.G=mt(this.nodes,$d),this.nodes=mt(this.nodes,(r,o)=>({id:this.N[o]})),this.links=mt(this.data,(r,o)=>({source:e[o],target:n[o],value:i[o]}))}initColor(){this.color=oa}computeSankeyLayout(){vd().nodeId(({index:e})=>this.N[e]).nodeAlign(this.nodeAlign).nodeWidth(Id).nodePadding(Pd).extent([[qd,Od],[this.width-Rd,this.height-Fd]])({nodes:this.nodes,links:this.links})}initSvgElements(){this.format=yi(Bd);const e=this.N;mt(this.nodes,n=>`${n.id}
${this.format(n.value)}`),mt(this.links,n=>`${n.source.id}  ${n.target.id}
${this.format(n.value)}`),this.svg=R(`#${Fr}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this.node=this.svg.append("g").attr("stroke",Hd).attr("stroke-width",Xd).attr("stroke-opacity",Gd).attr("stroke-linejoin",jd).selectAll("rect").data(this.nodes).join("rect").attr("id",n=>n.id).attr("class",n=>"sankey-rect").attr("x",n=>n.x0).attr("y",n=>n.y0).attr("height",n=>n.y1-n.y0).attr("width",n=>n.x1-n.x0),this.node.on("mouseover",(n,i)=>{pe(".sankey-rect").style("fill",Gr),pe(".sankey-path").style("stroke",Gr),R(`#${i.id}`).style("fill",o=>this.color(o.id)),i.sourceLinks.forEach(o=>R(`#${o.target.id}`).style("fill",a=>this.color(a.id))),i.targetLinks.forEach(o=>R(`#${o.source.id}`).style("fill",a=>this.color(a.id))),i.sourceLinks.forEach(o=>R(`#${o.source.id}-${o.target.id}`).style("stroke",a=>this.color(a.source.id))),i.targetLinks.forEach(o=>R(`#${o.source.id}-${o.target.id}`).style("stroke",a=>this.color(a.source.id)));const r=R(`#${zt}`);r.style("visibility","visible"),r.html(`${i.value}`)}).on("mouseout",(n,i)=>{pe(".sankey-rect").style("fill",o=>this.color(o.id)),pe(".sankey-path").style("stroke",o=>this.color(o.source.id)),R(`#${zt}`).style("visibility","hidden")}).on("mousemove",n=>{R(`#${zt}`).style("top",n.pageY-10+"px").style("left",n.pageX+10+"px")}).on("click",(n,i)=>{this.updateBarChart(i)}),this.G&&this.node.attr("fill",({index:n})=>this.color(this.G[n])),this.link=this.svg.append("g").attr("fill","none").attr("stroke-opacity",Br).selectAll("g").data(this.links).join("g").style("mix-blend-mode",Yd),this.link.append("path").attr("d",Ud).attr("id",n=>`${n.source.id}-${n.target.id}`).attr("class",n=>"sankey-path").attr("stroke",({source:{index:n}})=>this.color(this.G[n])).attr("stroke-width",({width:n})=>Math.max(1,n)),this.link.on("mouseover",function(n,i){R(this).style("stroke-opacity",Dd);const r=R(`#${zt}`);r.style("visibility","visible"),r.html(`${i.value}`)}).on("mouseout",n=>{this.link.style("stroke-opacity",Br),R(`#${zt}`).style("visibility","hidden")}).on("mousemove",n=>{R(`#${zt}`).style("top",n.pageY-10+"px").style("left",n.pageX+10+"px")}),e&&this.svg.append("g").attr("font-family","sans-serif").attr("font-size",10).selectAll("text").data(this.nodes).join("text").attr("x",n=>n.x0<this.width/2?n.x1+Hr:n.x0-Hr).attr("y",n=>(n.y1+n.y0)/2).attr("dy","0.35em").attr("text-anchor",n=>n.x0<this.width/2?"start":"end").attr("pointer-events","none").text(({index:n})=>ni(e[n]))}updateBarChart(e){const n=e.targetLinks.map(i=>({id:i.source.id,value:i.value}));n.length!==0&&this.sankeyBarPlot.drawBarPlot(n)}}class Zd{constructor(){O(this,"width");O(this,"height");O(this,"svg");this.initDimensions(),this.initColor()}initDimensions(){const e=document.getElementById(kn);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=n,this.height=n}}initColor(){this.color=oa}drawBarPlot(e){const n={top:10,right:30,bottom:100,left:50},i=this.width-n.left-n.right,r=this.height-n.top-n.bottom;let o=R(`#${kn}`).select("svg"),a;if(o.empty()){o=R(`#${kn}`).append("svg").attr("id",Cd).attr("width",this.width).attr("height",this.height);let d=(this.width-i)/2,p=(this.height-r)/2;a=o.append("g").attr("transform",`translate(${d},${p})`).append("g").attr("class","bars")}else a=o.select(".bars");e.sort((d,p)=>ii(d.value,p.value));const s=bi().range([0,i]).domain(e.map(d=>d.id)).padding(.2),l=_t().domain([0,ri(e,d=>d.value)]).range([r,0]);let u=a.select(".x-axis");u.empty()?u=a.append("g").attr("class","x-axis").attr("transform",`translate(0,${r})`).call(Ot(s).tickFormat(d=>ni(d))):u.transition().duration(Vt).call(Ot(s).tickFormat(d=>ni(d)));let c=a.select(".y-axis");c.empty()?c=a.append("g").attr("class","y-axis").call(Ie(l)):c.transition().duration(Vt).call(Ie(l));const h=a.selectAll(".sankey-bar").data(e,d=>d.id);h.exit().transition().duration(Vt).attr("height",0).attr("y",l(0)).remove(),h.transition().duration(Vt).attr("x",d=>s(d.id)).attr("width",s.bandwidth()).attr("y",d=>l(d.value)).attr("height",d=>r-l(d.value)),h.enter().append("rect").attr("class","sankey-bar").attr("x",d=>s(d.id)).attr("width",s.bandwidth()).attr("y",l(0)).attr("height",0).attr("fill",d=>this.color(d.id)).transition().duration(Vt).attr("height",d=>r-l(d.value)).attr("y",d=>l(d.value))}}document.addEventListener("DOMContentLoaded",()=>{new nd,new cd("data/berney_divisions.geojson","data/locations.json").load_data();const e=new Zd;new Vd("data/sankey_sdoj.json",e)});const Xr=100;document.addEventListener("DOMContentLoaded",()=>{let t;function e(s){const l=s.getBoundingClientRect(),u=window.innerHeight||document.documentElement.clientHeight,c=window.innerWidth||document.documentElement.clientWidth;return l.top>=0&&l.left>=0&&l.bottom<=u+1&&l.right<=c+1}function n(s,l){const u=window.pageYOffset,c=s.getBoundingClientRect().top,h=performance.now();function f(d){const p=d-h,x=Math.min(p/l,1);window.scrollTo({top:u+c*i(x)}),p<l&&window.requestAnimationFrame(f)}window.requestAnimationFrame(f)}function i(s){return s<.5?2*s*s:-1+(4-2*s)*s}function r(s){return s.deltaY>0?"down":"up"}function o(s){s.preventDefault();const l=["title-container","p1-container","p2-container","p3-container","p4-container","p5-container","p6-container","p7-container","final-container"];let u=null;s.type==="wheel"&&(u=r(s)),s.type==="touchmove"&&(u=s.touches[0].pageY>t?"up":"down");for(let c=0;c<l.length;c++){const h=c>=1?document.getElementById(l[c-1]):null,f=document.getElementById(l[c]),d=c<l.length-1?document.getElementById(l[c+1]):null;h&&e(f)&&u==="up"&&n(h,Xr),d&&e(f)&&u==="down"&&n(d,Xr)}}document.addEventListener("wheel",o,{passive:!1}),document.addEventListener("touchmove",o,{passive:!1});const a=document.getElementById("title-container");n(a,0)});const Wd="data/networks",Kd="road_vocation_data",Jd="vocation",Qd="#network-graph",tp="network-chart",ep="#network-title",np="#network-text",ip="#979487",jr="#aaaaaa",rp={road_vocation_data:{road:"#289e61",vocation:"#9e2846"},bipartite_division_type_metiers:{division:"#289e61",job_category:"#9e2846"},bipartite_origine_category_type_metiers:{origine_category:"#289e61",job_category:"#9e2846"},bipartite_street_type_metiers:{street:"#289e61",job_category:"#9e2846"},bipartite_rue_origines:{street:"#289e61",origine_category:"#9e2846"},bipartite_divisions_origines:{division:"#289e61",origine_category:"#9e2846"}},op={road_vocation_data:{title:"Vocations Voisines",text:"Ce premier graphe tisse un lien entre les vocations et les rues. Chaque mtier est connect  une rue, la taille de chaque nud refltant le nombre de personnes concernes. Les liens entre les rues et les mtiers mettent en lumire des proximits intressantes : par exemple, les rues de <i>Chavannes</i> et de <i>La Sallaz</i> se retrouvent proches dans notre graphe, illustrant la forte prsence de paysans parmi leurs habitants, comme l'indiquent les liens avec les nuds 'laboureur' et 'fermier'. De plus, des rues gographiquement voisines comme <i>Rue Saint Franois</i> et <i>Place Saint Franois</i> se retrouvent galement proches dans notre rseau, rvlant une similarit dans la composition professionnelle de leurs rsidents."},bipartite_division_type_metiers:{title:"Mtiers Mapps",text:"Ce graphe met en lumire les liens entre les divisions de la ville de Lausanne et les classes de mtiers. Il offre une vue claire sur la rpartition des professions  travers la ville. Par exemple, il est vident que la majorit des rentiers proviennent des divisions 17 et 1-2, qui correspondent respectivement  la campagne vers le sud de Lausanne et au quartier de Marterey et ses environs."},bipartite_origine_category_type_metiers:{title:"Origines Occupes",text:"Cete visualization dvoile les interactions entre les classes d'origine et les classes de vocations On observe une distribution plutt homogne des mtiers pour chaque origine. Par ailleurs, Yverdon se distingue par une plus grande concentration de constructeurs et d'artisans. Le Lavaux, rgion connue pour son paysage viticole et agricole, prsente une majorit de personnes engages dans l'agriculture."},bipartite_street_type_metiers:{title:"Rues Rvles",text:"Ce graphe lie les classes de mtiers aux rues, offrant une perspective encore plus granulaire de la vie  Lausanne au XIX<sup>me</sup> sicle. Certaines petites rues prsentent une faible diversit de vocations, comme Vidy, Paleyres, et Petit Ouchy, o prdomine l'agriculture en priphrie de la ville."},bipartite_rue_origines:{title:"Rues Racines",text:"Cette nouvelle visualisation lie les rues de Lausanne  leurs classes d'origine, offrant une comprhension encore plus nuance des dynamiques sociales de la ville. Chaque rue se voit attribuer un spectre d'origines, rvlant la diversit et la complexit de la composition dmographique de la ville. De cette manire, on peut mieux apprcier l'histoire multiculturelle de Lausanne, o chaque rue porte en elle les traces de nombreuses origines diffrentes, formant un patchwork unique de cultures et de traditions."},bipartite_divisions_origines:{title:"Origines Organises",text:"Cette dernire visualisation tablit un lien direct entre les divisions de la ville et les origines de ses habitants. Elle offre une vue panoramique de la diversit culturelle, illustrant comment les diffrentes origines ont contribu  la formation de chaque division.  travers ce graphe, nous pouvons voir comment Lausanne, mme  cette poque, tait un creuset de cultures, o chaque division a t faonne par une mosaque d'origines diffrentes, contribuant  l'identit unique de la ville."}},ap=.1,sp=10;class up{constructor(e=.7,n=.7,i=.1,r=7,o=40,a=1,s=8,l=5,u=5,c=5,h=-700,f=2,d=200){O(this,"svg");O(this,"gnodes");O(this,"glinks");O(this,"simulation");O(this,"data");O(this,"container");O(this,"dragActive",!1);O(this,"networkName",Jd);O(this,"linkedById");this.expNodeSizeScale=e,this.expLinkWeightScale=n,this.transparency=i,this.minNodeSize=r,this.maxNodeSize=o,this.minLinkWeight=a,this.maxLinkWeight=s,this.labelSizeAdd=l,this.nodeSizeInc=u,this.labelSizeInc=c,this.chargeStrength=h,this.collideSizeAdd=f,this.transitionDuration=d,this.initDimensions(),this.initStaticElements(),this.initEvents(),this.updatePlot(Kd)}async loadData(e){const n=`${Wd}/${e}.json`;return new Promise(i=>{Rt(n).then(r=>{i(r)})})}initDimensions(){this.container=R(Qd);const e=document.getElementById(tp);e&&(this.width=e.clientWidth,this.height=e.clientHeight)}initStaticElements(){this.svg=this.container.append("svg").attr("width",this.width).attr("height",this.height),this.glinks=this.svg.append("g").attr("class","links"),this.gnodes=this.svg.append("g").attr("class","nodes")}initEvents(){const e=document.getElementById("graph-selector");e&&e.addEventListener("change",n=>{const i=n.target.value;this.updatePlot(i)})}get_scaled_size(e,n,i,r,o){return i-n==0?(r+o)/2:r+(e-n)*(o-r)/(i-n)}isConnected(e,n){return this.linkedById[e].indexOf(n)>-1||this.linkedById[n].indexOf(e)>-1||e==n}drag(e){const n=o=>{this.dragActive=!0,o.active||e.alphaTarget(.3).restart(),o.subject.fx=o.subject.x,o.subject.fy=o.subject.y},i=o=>{o.subject.fx=o.x,o.subject.fy=o.y},r=o=>{this.dragActive=!1,o.active||e.alphaTarget(0),o.subject.fx=null,o.subject.fy=null};return gu().on("start",n).on("drag",i).on("end",r)}initData(){let e=this.data.nodes.reduce((o,a)=>Math.max(o,a.size),0),n=this.data.nodes.reduce((o,a)=>Math.min(o,a.size),1/0);e=Math.pow(e,this.expNodeSizeScale),n=Math.pow(n,this.expNodeSizeScale),this.data.nodes.forEach(o=>o.size=this.get_scaled_size(Math.pow(o.size,this.expNodeSizeScale),n,e,this.minNodeSize,this.maxNodeSize));let i=this.data.links.reduce((o,a)=>Math.max(o,a.weight),0),r=this.data.links.reduce((o,a)=>Math.min(o,a.weight),1/0);i=Math.pow(i,this.expLinkWeightScale),r=Math.pow(r,this.expLinkWeightScale),this.data.links.forEach(o=>o.weight=this.get_scaled_size(Math.pow(o.weight,this.expLinkWeightScale),r,i,this.minLinkWeight,this.maxLinkWeight)),this.linkedById={},this.data.links.forEach(o=>{this.linkedById[o.source]=[],this.linkedById[o.target]=[]}),this.data.links.forEach(o=>{this.linkedById[o.source].push(o.target),this.linkedById[o.target].push(o.source)})}createLinks(){this.glinks.attr("stroke",ip).attr("stroke-opacity",1).selectAll("line").data(this.data.links).enter().append("line").attr("stroke-width",function(e){return e.weight})}createNodes(){const e=this.gnodes.selectAll(".node").data(this.data.nodes).enter().append("g").attr("class","node");e.append("circle").attr("class","node-circle").attr("r",function(n){return n.size}).attr("fill",n=>{const i=rp[this.networkName],r=i?i[n.type]:jr;return r||jr}).call(this.drag(this.simulation)).on("mouseover",(n,i)=>{if(this.dragActive)return;const r=i.id;this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("r",o=>{if(o.id==r)return o.size+this.nodeSizeInc;if(this.isConnected(r,o.id)){let a=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const s=this.data.links.filter(h=>h.source.id==r||h.target.id==r),l=s.reduce((h,f)=>Math.min(h,f.weight),1/0),u=s.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(a,l,u,this.minNodeSize,this.maxNodeSize)}return o.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",o=>o.source.id==r||o.target.id==r?1:this.transparency),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("font-size",o=>{if(o.id==r)return o.size+this.labelSizeInc+this.labelSizeAdd;if(this.isConnected(r,o.id)){let a=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const s=this.data.links.filter(h=>h.source.id==r||h.target.id==r),l=s.reduce((h,f)=>Math.min(h,f.weight),1/0),u=s.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(a,l,u,this.minNodeSize,this.maxNodeSize)+this.labelSizeAdd}return o.size+this.labelSizeAdd})}).on("mouseout",n=>{this.dragActive||(this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("r",function(i){return i.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",1),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("font-size",i=>i.size+this.labelSizeAdd))}),e.append("text").attr("class","node-text").text(function(n){return n.label}).attr("font-size",n=>n.size+this.labelSizeAdd).attr("font-family","sans-serif").attr("font-weight","bold").attr("text-anchor","middle").attr("alignment-baseline","middle").style("pointer-events","none")}initZoom(){const e=ta().scaleExtent([ap,sp]).on("zoom",({transform:n})=>{this.gnodes.attr("transform",n),this.glinks.attr("transform",n)});this.svg.call(e)}initSimulation(){this.simulation=Pc().force("link",Nc().id(function(n){return n.id})).force("charge",qc().strength(this.chargeStrength)).force("center",sc(this.width/2,this.height/2)).force("collide",kc().radius(n=>n.size+this.collideSizeAdd));const e=()=>{this.glinks.selectAll("line").attr("x1",n=>n.source.x).attr("y1",n=>n.source.y).attr("x2",n=>n.target.x).attr("y2",n=>n.target.y),this.gnodes.selectAll(".node-circle").attr("cx",n=>n.x).attr("cy",n=>n.y),this.gnodes.selectAll(".node-text").attr("x",n=>n.x+10).attr("y",n=>n.y+4).attr("dx",-9).attr("dy",".1em")};this.simulation.nodes(this.data.nodes).on("tick",e),this.simulation.force("link").links(this.data.links)}async updatePlot(e){return new Promise(n=>{this.loadData(e).then(i=>{this.networkName=e,this.deletePlot(),this.data=i,this.initData(),this.initSimulation(),this.createLinks(),this.createNodes(),this.initZoom();const r=document.querySelector(ep),o=document.querySelector(np),a=op[e];r&&o&&(r.innerHTML=a.title,o.innerHTML=a.text)}),n()})}deletePlot(){this.gnodes.selectAll("*").remove(),this.glinks.selectAll("*").remove()}}document.addEventListener("DOMContentLoaded",()=>{console.log("Loading networks..."),new up,console.log("Networks loaded.")});

var na=Object.defineProperty;var ea=(t,n,e)=>n in t?na(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var F=(t,n,e)=>(ea(t,typeof n!="symbol"?n+"":n,e),e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();function bn(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function ei(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function Xr(t){let n,e,i;t.length!==2?(n=bn,e=(s,l)=>bn(t(s),l),i=(s,l)=>t(s)-l):(n=t===bn||t===ei?t:ia,e=t,i=t);function r(s,l,u=0,c=s.length){if(u<c){if(n(l,l)!==0)return c;do{const h=u+c>>>1;e(s[h],l)<0?u=h+1:c=h}while(u<c)}return u}function o(s,l,u=0,c=s.length){if(u<c){if(n(l,l)!==0)return c;do{const h=u+c>>>1;e(s[h],l)<=0?u=h+1:c=h}while(u<c)}return u}function a(s,l,u=0,c=s.length){const h=r(s,l,u,c-1);return h>u&&i(s[h-1],l)>-i(s[h],l)?h-1:h}return{left:r,center:a,right:o}}function ia(){return 0}function ra(t){return t===null?NaN:+t}const oa=Xr(bn),aa=oa.right;Xr(ra).center;const sa=aa;class Nt{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const e=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=e[r],a=n+o,s=Math.abs(n)<Math.abs(o)?n-(a-o):o-(a-n);s&&(e[i++]=s),n=a}return e[i]=n,this._n=i+1,this}valueOf(){const n=this._partials;let e=this._n,i,r,o,a=0;if(e>0){for(a=n[--e];e>0&&(i=a,r=n[--e],a=i+r,o=r-(a-i),!o););e>0&&(o<0&&n[e-1]<0||o>0&&n[e-1]>0)&&(r=o*2,i=a+r,r==i-a&&(a=i))}return a}}class Mi extends Map{constructor(n,e=Yr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),n!=null)for(const[i,r]of n)this.set(i,r)}get(n){return super.get(Ae(this,n))}has(n){return super.has(Ae(this,n))}set(n,e){return super.set(Gr(this,n),e)}delete(n){return super.delete(Ur(this,n))}}class ua extends Set{constructor(n,e=Yr){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),n!=null)for(const i of n)this.add(i)}has(n){return super.has(Ae(this,n))}add(n){return super.add(Gr(this,n))}delete(n){return super.delete(Ur(this,n))}}function Ae({_intern:t,_key:n},e){const i=n(e);return t.has(i)?t.get(i):e}function Gr({_intern:t,_key:n},e){const i=n(e);return t.has(i)?t.get(i):(t.set(i,e),e)}function Ur({_intern:t,_key:n},e){const i=n(e);return t.has(i)&&(e=t.get(i),t.delete(i)),e}function Yr(t){return t!==null&&typeof t=="object"?t.valueOf():t}const la=Math.sqrt(50),ca=Math.sqrt(10),fa=Math.sqrt(2);function In(t,n,e){const i=(n-t)/Math.max(0,e),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),a=o>=la?10:o>=ca?5:o>=fa?2:1;let s,l,u;return r<0?(u=Math.pow(10,-r)/a,s=Math.round(t*u),l=Math.round(n*u),s/u<t&&++s,l/u>n&&--l,u=-u):(u=Math.pow(10,r)*a,s=Math.round(t/u),l=Math.round(n/u),s*u<t&&++s,l*u>n&&--l),l<s&&.5<=e&&e<2?In(t,n,e*2):[s,l,u]}function ha(t,n,e){if(n=+n,t=+t,e=+e,!(e>0))return[];if(t===n)return[t];const i=n<t,[r,o,a]=i?In(n,t,e):In(t,n,e);if(!(o>=r))return[];const s=o-r+1,l=new Array(s);if(i)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(r+u)/-a;else for(let u=0;u<s;++u)l[u]=(r+u)*a;return l}function Se(t,n,e){return n=+n,t=+t,e=+e,In(t,n,e)[2]}function da(t,n,e){n=+n,t=+t,e=+e;const i=n<t,r=i?Se(n,t,e):Se(t,n,e);return(i?-1:1)*(r<0?1/-r:r)}function ii(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e<i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e<r||e===void 0&&r>=r)&&(e=r)}return e}function ga(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e>i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e>r||e===void 0&&r>=r)&&(e=r)}return e}function*pa(t){for(const n of t)yield*n}function Vr(t){return Array.from(pa(t))}function ma(t,n,e){t=+t,n=+n,e=(r=arguments.length)<2?(n=t,t=0,1):r<3?1:+e;for(var i=-1,r=Math.max(0,Math.ceil((n-t)/e))|0,o=new Array(r);++i<r;)o[i]=t+i*e;return o}function mt(t,n){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof n!="function")throw new TypeError("mapper is not a function");return Array.from(t,(e,i)=>n(e,i,t))}function ya(...t){const n=new ua;for(const e of t)for(const i of e)n.add(i);return n}function va(t){return t}var le=1,ce=2,Ne=3,Yt=4,ki=1e-6;function _a(t){return"translate("+t+",0)"}function xa(t){return"translate(0,"+t+")"}function wa(t){return n=>+t(n)}function Ea(t,n){return n=Math.max(0,t.bandwidth()-n*2)/2,t.round()&&(n=Math.round(n)),e=>+t(e)+n}function Ma(){return!this.__axis}function Zr(t,n){var e=[],i=null,r=null,o=6,a=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===le||t===Yt?-1:1,c=t===Yt||t===ce?"x":"y",h=t===le||t===Ne?_a:xa;function f(d){var p=i??(n.ticks?n.ticks.apply(n,e):n.domain()),x=r??(n.tickFormat?n.tickFormat.apply(n,e):va),v=Math.max(o,0)+s,y=n.range(),M=+y[0]+l,N=+y[y.length-1]+l,m=(n.bandwidth?Ea:wa)(n.copy(),l),A=d.selection?d.selection():d,T=A.selectAll(".domain").data([null]),L=A.selectAll(".tick").data(p,n).order(),z=L.exit(),C=L.enter().append("g").attr("class","tick"),I=L.select("line"),b=L.select("text");T=T.merge(T.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge(C),I=I.merge(C.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),b=b.merge(C.append("text").attr("fill","currentColor").attr(c,u*v).attr("dy",t===le?"0em":t===Ne?"0.71em":"0.32em")),d!==A&&(T=T.transition(d),L=L.transition(d),I=I.transition(d),b=b.transition(d),z=z.transition(d).attr("opacity",ki).attr("transform",function(R){return isFinite(R=m(R))?h(R+l):this.getAttribute("transform")}),C.attr("opacity",ki).attr("transform",function(R){var P=this.parentNode.__axis;return h((P&&isFinite(P=P(R))?P:m(R))+l)})),z.remove(),T.attr("d",t===Yt||t===ce?a?"M"+u*a+","+M+"H"+l+"V"+N+"H"+u*a:"M"+l+","+M+"V"+N:a?"M"+M+","+u*a+"V"+l+"H"+N+"V"+u*a:"M"+M+","+l+"H"+N),L.attr("opacity",1).attr("transform",function(R){return h(m(R)+l)}),I.attr(c+"2",u*o),b.attr(c,u*v).text(x),A.filter(Ma).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===ce?"start":t===Yt?"end":"middle"),A.each(function(){this.__axis=m})}return f.scale=function(d){return arguments.length?(n=d,f):n},f.ticks=function(){return e=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(e=d==null?[]:Array.from(d),f):e.slice()},f.tickValues=function(d){return arguments.length?(i=d==null?null:Array.from(d),f):i&&i.slice()},f.tickFormat=function(d){return arguments.length?(r=d,f):r},f.tickSize=function(d){return arguments.length?(o=a=+d,f):o},f.tickSizeInner=function(d){return arguments.length?(o=+d,f):o},f.tickSizeOuter=function(d){return arguments.length?(a=+d,f):a},f.tickPadding=function(d){return arguments.length?(s=+d,f):s},f.offset=function(d){return arguments.length?(l=+d,f):l},f}function Dn(t){return Zr(Ne,t)}function Pn(t){return Zr(Yt,t)}var ka={value:()=>{}};function cn(){for(var t=0,n=arguments.length,e={},i;t<n;++t){if(!(i=arguments[t]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new Tn(e)}function Tn(t){this._=t}function Aa(t,n){return t.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");if(r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}Tn.prototype=cn.prototype={constructor:Tn,on:function(t,n){var e=this._,i=Aa(t+"",e),r,o=-1,a=i.length;if(arguments.length<2){for(;++o<a;)if((r=(t=i[o]).type)&&(r=Sa(e[r],t.name)))return r;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<a;)if(r=(t=i[o]).type)e[r]=Ai(e[r],t.name,n);else if(n==null)for(r in e)e[r]=Ai(e[r],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new Tn(t)},call:function(t,n){if((r=arguments.length-2)>0)for(var e=new Array(r),i=0,r,o;i<r;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(n,e)}};function Sa(t,n){for(var e=0,i=t.length,r;e<i;++e)if((r=t[e]).name===n)return r.value}function Ai(t,n,e){for(var i=0,r=t.length;i<r;++i)if(t[i].name===n){t[i]=ka,t=t.slice(0,i).concat(t.slice(i+1));break}return e!=null&&t.push({name:n,value:e}),t}var be="http://www.w3.org/1999/xhtml";const Si={svg:"http://www.w3.org/2000/svg",xhtml:be,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function re(t){var n=t+="",e=n.indexOf(":");return e>=0&&(n=t.slice(0,e))!=="xmlns"&&(t=t.slice(e+1)),Si.hasOwnProperty(n)?{space:Si[n],local:t}:t}function Na(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===be&&n.documentElement.namespaceURI===be?n.createElement(t):n.createElementNS(e,t)}}function ba(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function jr(t){var n=re(t);return(n.local?ba:Na)(n)}function Ta(){}function ri(t){return t==null?Ta:function(){return this.querySelector(t)}}function La(t){typeof t!="function"&&(t=ri(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],a=o.length,s=i[r]=new Array(a),l,u,c=0;c<a;++c)(l=o[c])&&(u=t.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new Q(i,this._parents)}function Kr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function $a(){return[]}function Wr(t){return t==null?$a:function(){return this.querySelectorAll(t)}}function za(t){return function(){return Kr(t.apply(this,arguments))}}function Ca(t){typeof t=="function"?t=za(t):t=Wr(t);for(var n=this._groups,e=n.length,i=[],r=[],o=0;o<e;++o)for(var a=n[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(i.push(t.call(l,l.__data__,u,a)),r.push(l));return new Q(i,r)}function Qr(t){return function(){return this.matches(t)}}function Jr(t){return function(n){return n.matches(t)}}var Ia=Array.prototype.find;function Da(t){return function(){return Ia.call(this.children,t)}}function Pa(){return this.firstElementChild}function Ra(t){return this.select(t==null?Pa:Da(typeof t=="function"?t:Jr(t)))}var Oa=Array.prototype.filter;function Ba(){return Array.from(this.children)}function Fa(t){return function(){return Oa.call(this.children,t)}}function qa(t){return this.selectAll(t==null?Ba:Fa(typeof t=="function"?t:Jr(t)))}function Ha(t){typeof t!="function"&&(t=Qr(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],a=o.length,s=i[r]=[],l,u=0;u<a;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&s.push(l);return new Q(i,this._parents)}function to(t){return new Array(t.length)}function Xa(){return new Q(this._enter||this._groups.map(to),this._parents)}function Rn(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}Rn.prototype={constructor:Rn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ga(t){return function(){return t}}function Ua(t,n,e,i,r,o){for(var a=0,s,l=n.length,u=o.length;a<u;++a)(s=n[a])?(s.__data__=o[a],i[a]=s):e[a]=new Rn(t,o[a]);for(;a<l;++a)(s=n[a])&&(r[a]=s)}function Ya(t,n,e,i,r,o,a){var s,l,u=new Map,c=n.length,h=o.length,f=new Array(c),d;for(s=0;s<c;++s)(l=n[s])&&(f[s]=d=a.call(l,l.__data__,s,n)+"",u.has(d)?r[s]=l:u.set(d,l));for(s=0;s<h;++s)d=a.call(t,o[s],s,o)+"",(l=u.get(d))?(i[s]=l,l.__data__=o[s],u.delete(d)):e[s]=new Rn(t,o[s]);for(s=0;s<c;++s)(l=n[s])&&u.get(f[s])===l&&(r[s]=l)}function Va(t){return t.__data__}function Za(t,n){if(!arguments.length)return Array.from(this,Va);var e=n?Ya:Ua,i=this._parents,r=this._groups;typeof t!="function"&&(t=Ga(t));for(var o=r.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=i[u],h=r[u],f=h.length,d=ja(t.call(c,c&&c.__data__,u,i)),p=d.length,x=s[u]=new Array(p),v=a[u]=new Array(p),y=l[u]=new Array(f);e(c,h,x,v,y,d,n);for(var M=0,N=0,m,A;M<p;++M)if(m=x[M]){for(M>=N&&(N=M+1);!(A=v[N])&&++N<p;);m._next=A||null}}return a=new Q(a,i),a._enter=s,a._exit=l,a}function ja(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ka(){return new Q(this._exit||this._groups.map(to),this._parents)}function Wa(t,n,e){var i=this.enter(),r=this,o=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),n!=null&&(r=n(r),r&&(r=r.selection())),e==null?o.remove():e(o),i&&r?i.merge(r).order():r}function Qa(t){for(var n=t.selection?t.selection():t,e=this._groups,i=n._groups,r=e.length,o=i.length,a=Math.min(r,o),s=new Array(r),l=0;l<a;++l)for(var u=e[l],c=i[l],h=u.length,f=s[l]=new Array(h),d,p=0;p<h;++p)(d=u[p]||c[p])&&(f[p]=d);for(;l<r;++l)s[l]=e[l];return new Q(s,this._parents)}function Ja(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var i=t[n],r=i.length-1,o=i[r],a;--r>=0;)(a=i[r])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function ts(t){t||(t=ns);function n(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o){for(var a=e[o],s=a.length,l=r[o]=new Array(s),u,c=0;c<s;++c)(u=a[c])&&(l[c]=u);l.sort(n)}return new Q(r,this._parents).order()}function ns(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function es(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function is(){return Array.from(this)}function rs(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null}function os(){let t=0;for(const n of this)++t;return t}function as(){return!this.node()}function ss(t){for(var n=this._groups,e=0,i=n.length;e<i;++e)for(var r=n[e],o=0,a=r.length,s;o<a;++o)(s=r[o])&&t.call(s,s.__data__,o,r);return this}function us(t){return function(){this.removeAttribute(t)}}function ls(t){return function(){this.removeAttributeNS(t.space,t.local)}}function cs(t,n){return function(){this.setAttribute(t,n)}}function fs(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function hs(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}}function ds(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function gs(t,n){var e=re(t);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((n==null?e.local?ls:us:typeof n=="function"?e.local?ds:hs:e.local?fs:cs)(e,n))}function no(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ps(t){return function(){this.style.removeProperty(t)}}function ms(t,n,e){return function(){this.style.setProperty(t,n,e)}}function ys(t,n,e){return function(){var i=n.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,e)}}function vs(t,n,e){return arguments.length>1?this.each((n==null?ps:typeof n=="function"?ys:ms)(t,n,e??"")):Rt(this.node(),t)}function Rt(t,n){return t.style.getPropertyValue(n)||no(t).getComputedStyle(t,null).getPropertyValue(n)}function _s(t){return function(){delete this[t]}}function xs(t,n){return function(){this[t]=n}}function ws(t,n){return function(){var e=n.apply(this,arguments);e==null?delete this[t]:this[t]=e}}function Es(t,n){return arguments.length>1?this.each((n==null?_s:typeof n=="function"?ws:xs)(t,n)):this.node()[t]}function eo(t){return t.trim().split(/^|\s+/)}function oi(t){return t.classList||new io(t)}function io(t){this._node=t,this._names=eo(t.getAttribute("class")||"")}io.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function ro(t,n){for(var e=oi(t),i=-1,r=n.length;++i<r;)e.add(n[i])}function oo(t,n){for(var e=oi(t),i=-1,r=n.length;++i<r;)e.remove(n[i])}function Ms(t){return function(){ro(this,t)}}function ks(t){return function(){oo(this,t)}}function As(t,n){return function(){(n.apply(this,arguments)?ro:oo)(this,t)}}function Ss(t,n){var e=eo(t+"");if(arguments.length<2){for(var i=oi(this.node()),r=-1,o=e.length;++r<o;)if(!i.contains(e[r]))return!1;return!0}return this.each((typeof n=="function"?As:n?Ms:ks)(e,n))}function Ns(){this.textContent=""}function bs(t){return function(){this.textContent=t}}function Ts(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function Ls(t){return arguments.length?this.each(t==null?Ns:(typeof t=="function"?Ts:bs)(t)):this.node().textContent}function $s(){this.innerHTML=""}function zs(t){return function(){this.innerHTML=t}}function Cs(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function Is(t){return arguments.length?this.each(t==null?$s:(typeof t=="function"?Cs:zs)(t)):this.node().innerHTML}function Ds(){this.nextSibling&&this.parentNode.appendChild(this)}function Ps(){return this.each(Ds)}function Rs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Os(){return this.each(Rs)}function Bs(t){var n=typeof t=="function"?t:jr(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function Fs(){return null}function qs(t,n){var e=typeof t=="function"?t:jr(t),i=n==null?Fs:typeof n=="function"?n:ri(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})}function Hs(){var t=this.parentNode;t&&t.removeChild(this)}function Xs(){return this.each(Hs)}function Gs(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Us(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Ys(t){return this.select(t?Us:Gs)}function Vs(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Zs(t){return function(n){t.call(this,n,this.__data__)}}function js(t){return t.trim().split(/^|\s+/).map(function(n){var e="",i=n.indexOf(".");return i>=0&&(e=n.slice(i+1),n=n.slice(0,i)),{type:n,name:e}})}function Ks(t){return function(){var n=this.__on;if(n){for(var e=0,i=-1,r=n.length,o;e<r;++e)o=n[e],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):n[++i]=o;++i?n.length=i:delete this.__on}}}function Ws(t,n,e){return function(){var i=this.__on,r,o=Zs(n);if(i){for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),r.value=n;return}}this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function Qs(t,n,e){var i=js(t+""),r,o=i.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(r=0,c=s[l];r<o;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value}return}for(s=n?Ws:Ks,r=0;r<o;++r)this.each(s(i[r],n,e));return this}function ao(t,n,e){var i=no(t),r=i.CustomEvent;typeof r=="function"?r=new r(n,e):(r=i.document.createEvent("Event"),e?(r.initEvent(n,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(n,!1,!1)),t.dispatchEvent(r)}function Js(t,n){return function(){return ao(this,t,n)}}function tu(t,n){return function(){return ao(this,t,n.apply(this,arguments))}}function nu(t,n){return this.each((typeof n=="function"?tu:Js)(t,n))}function*eu(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length,a;r<o;++r)(a=i[r])&&(yield a)}var ai=[null];function Q(t,n){this._groups=t,this._parents=n}function fn(){return new Q([[document.documentElement]],ai)}function iu(){return this}Q.prototype=fn.prototype={constructor:Q,select:La,selectAll:Ca,selectChild:Ra,selectChildren:qa,filter:Ha,data:Za,enter:Xa,exit:Ka,join:Wa,merge:Qa,selection:iu,order:Ja,sort:ts,call:es,nodes:is,node:rs,size:os,empty:as,each:ss,attr:gs,style:vs,property:Es,classed:Ss,text:Ls,html:Is,raise:Ps,lower:Os,append:Bs,insert:qs,remove:Xs,clone:Ys,datum:Vs,on:Qs,dispatch:nu,[Symbol.iterator]:eu};function O(t){return typeof t=="string"?new Q([[document.querySelector(t)]],[document.documentElement]):new Q([[t]],ai)}function ru(t){let n;for(;n=t.sourceEvent;)t=n;return t}function vt(t,n){if(t=ru(t),n===void 0&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}if(n.getBoundingClientRect){var r=n.getBoundingClientRect();return[t.clientX-r.left-n.clientLeft,t.clientY-r.top-n.clientTop]}}return[t.pageX,t.pageY]}function gn(t){return typeof t=="string"?new Q([document.querySelectorAll(t)],[document.documentElement]):new Q([Kr(t)],ai)}const ou={passive:!1},nn={capture:!0,passive:!1};function fe(t){t.stopImmediatePropagation()}function Dt(t){t.preventDefault(),t.stopImmediatePropagation()}function so(t){var n=t.document.documentElement,e=O(t).on("dragstart.drag",Dt,nn);"onselectstart"in n?e.on("selectstart.drag",Dt,nn):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function uo(t,n){var e=t.document.documentElement,i=O(t).on("dragstart.drag",null);n&&(i.on("click.drag",Dt,nn),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}const pn=t=>()=>t;function Te(t,{sourceEvent:n,subject:e,target:i,identifier:r,active:o,x:a,y:s,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}Te.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function au(t){return!t.ctrlKey&&!t.button}function su(){return this.parentNode}function uu(t,n){return n??{x:t.x,y:t.y}}function lu(){return navigator.maxTouchPoints||"ontouchstart"in this}function cu(){var t=au,n=su,e=uu,i=lu,r={},o=cn("start","drag","end"),a=0,s,l,u,c,h=0;function f(m){m.on("mousedown.drag",d).filter(i).on("touchstart.drag",v).on("touchmove.drag",y,ou).on("touchend.drag touchcancel.drag",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(m,A){if(!(c||!t.call(this,m,A))){var T=N(this,n.call(this,m,A),m,A,"mouse");T&&(O(m.view).on("mousemove.drag",p,nn).on("mouseup.drag",x,nn),so(m.view),fe(m),u=!1,s=m.clientX,l=m.clientY,T("start",m))}}function p(m){if(Dt(m),!u){var A=m.clientX-s,T=m.clientY-l;u=A*A+T*T>h}r.mouse("drag",m)}function x(m){O(m.view).on("mousemove.drag mouseup.drag",null),uo(m.view,u),Dt(m),r.mouse("end",m)}function v(m,A){if(t.call(this,m,A)){var T=m.changedTouches,L=n.call(this,m,A),z=T.length,C,I;for(C=0;C<z;++C)(I=N(this,L,m,A,T[C].identifier,T[C]))&&(fe(m),I("start",m,T[C]))}}function y(m){var A=m.changedTouches,T=A.length,L,z;for(L=0;L<T;++L)(z=r[A[L].identifier])&&(Dt(m),z("drag",m,A[L]))}function M(m){var A=m.changedTouches,T=A.length,L,z;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),L=0;L<T;++L)(z=r[A[L].identifier])&&(fe(m),z("end",m,A[L]))}function N(m,A,T,L,z,C){var I=o.copy(),b=vt(C||T,A),R,P,w;if((w=e.call(m,new Te("beforestart",{sourceEvent:T,target:f,identifier:z,active:a,x:b[0],y:b[1],dx:0,dy:0,dispatch:I}),L))!=null)return R=w.x-b[0]||0,P=w.y-b[1]||0,function g(_,E,S){var k=b,$;switch(_){case"start":r[z]=g,$=a++;break;case"end":delete r[z],--a;case"drag":b=vt(S||E,A),$=a;break}I.call(_,m,new Te(_,{sourceEvent:E,subject:w,target:f,identifier:z,active:$,x:b[0]+R,y:b[1]+P,dx:b[0]-k[0],dy:b[1]-k[1],dispatch:I}),L)}}return f.filter=function(m){return arguments.length?(t=typeof m=="function"?m:pn(!!m),f):t},f.container=function(m){return arguments.length?(n=typeof m=="function"?m:pn(m),f):n},f.subject=function(m){return arguments.length?(e=typeof m=="function"?m:pn(m),f):e},f.touchable=function(m){return arguments.length?(i=typeof m=="function"?m:pn(!!m),f):i},f.on=function(){var m=o.on.apply(o,arguments);return m===o?f:m},f.clickDistance=function(m){return arguments.length?(h=(m=+m)*m,f):Math.sqrt(h)},f}function si(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function lo(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function hn(){}var en=.7,On=1/en,Pt="\\s*([+-]?\\d+)\\s*",rn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fu=/^#([0-9a-f]{3,8})$/,hu=new RegExp(`^rgb\\(${Pt},${Pt},${Pt}\\)$`),du=new RegExp(`^rgb\\(${dt},${dt},${dt}\\)$`),gu=new RegExp(`^rgba\\(${Pt},${Pt},${Pt},${rn}\\)$`),pu=new RegExp(`^rgba\\(${dt},${dt},${dt},${rn}\\)$`),mu=new RegExp(`^hsl\\(${rn},${dt},${dt}\\)$`),yu=new RegExp(`^hsla\\(${rn},${dt},${dt},${rn}\\)$`),Ni={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};si(hn,bt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:bi,formatHex:bi,formatHex8:vu,formatHsl:_u,formatRgb:Ti,toString:Ti});function bi(){return this.rgb().formatHex()}function vu(){return this.rgb().formatHex8()}function _u(){return co(this).formatHsl()}function Ti(){return this.rgb().formatRgb()}function bt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=fu.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?Li(n):e===3?new tt(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?mn(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?mn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=hu.exec(t))?new tt(n[1],n[2],n[3],1):(n=du.exec(t))?new tt(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=gu.exec(t))?mn(n[1],n[2],n[3],n[4]):(n=pu.exec(t))?mn(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=mu.exec(t))?Ci(n[1],n[2]/100,n[3]/100,1):(n=yu.exec(t))?Ci(n[1],n[2]/100,n[3]/100,n[4]):Ni.hasOwnProperty(t)?Li(Ni[t]):t==="transparent"?new tt(NaN,NaN,NaN,0):null}function Li(t){return new tt(t>>16&255,t>>8&255,t&255,1)}function mn(t,n,e,i){return i<=0&&(t=n=e=NaN),new tt(t,n,e,i)}function xu(t){return t instanceof hn||(t=bt(t)),t?(t=t.rgb(),new tt(t.r,t.g,t.b,t.opacity)):new tt}function Le(t,n,e,i){return arguments.length===1?xu(t):new tt(t,n,e,i??1)}function tt(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}si(tt,Le,lo(hn,{brighter(t){return t=t==null?On:Math.pow(On,t),new tt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?en:Math.pow(en,t),new tt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new tt(At(this.r),At(this.g),At(this.b),Bn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$i,formatHex:$i,formatHex8:wu,formatRgb:zi,toString:zi}));function $i(){return`#${kt(this.r)}${kt(this.g)}${kt(this.b)}`}function wu(){return`#${kt(this.r)}${kt(this.g)}${kt(this.b)}${kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function zi(){const t=Bn(this.opacity);return`${t===1?"rgb(":"rgba("}${At(this.r)}, ${At(this.g)}, ${At(this.b)}${t===1?")":`, ${t})`}`}function Bn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function At(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function kt(t){return t=At(t),(t<16?"0":"")+t.toString(16)}function Ci(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new st(t,n,e,i)}function co(t){if(t instanceof st)return new st(t.h,t.s,t.l,t.opacity);if(t instanceof hn||(t=bt(t)),!t)return new st;if(t instanceof st)return t;t=t.rgb();var n=t.r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),o=Math.max(n,e,i),a=NaN,s=o-r,l=(o+r)/2;return s?(n===o?a=(e-i)/s+(e<i)*6:e===o?a=(i-n)/s+2:a=(n-e)/s+4,s/=l<.5?o+r:2-o-r,a*=60):s=l>0&&l<1?0:a,new st(a,s,l,t.opacity)}function Eu(t,n,e,i){return arguments.length===1?co(t):new st(t,n,e,i??1)}function st(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}si(st,Eu,lo(hn,{brighter(t){return t=t==null?On:Math.pow(On,t),new st(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?en:Math.pow(en,t),new st(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new tt(he(t>=240?t-240:t+120,r,i),he(t,r,i),he(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new st(Ii(this.h),yn(this.s),yn(this.l),Bn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Bn(this.opacity);return`${t===1?"hsl(":"hsla("}${Ii(this.h)}, ${yn(this.s)*100}%, ${yn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ii(t){return t=(t||0)%360,t<0?t+360:t}function yn(t){return Math.max(0,Math.min(1,t||0))}function he(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}const ui=t=>()=>t;function Mu(t,n){return function(e){return t+e*n}}function ku(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(i){return Math.pow(t+i*n,e)}}function Au(t){return(t=+t)==1?fo:function(n,e){return e-n?ku(n,e,t):ui(isNaN(n)?e:n)}}function fo(t,n){var e=n-t;return e?Mu(t,e):ui(isNaN(t)?n:t)}const Fn=function t(n){var e=Au(n);function i(r,o){var a=e((r=Le(r)).r,(o=Le(o)).r),s=e(r.g,o.g),l=e(r.b,o.b),u=fo(r.opacity,o.opacity);return function(c){return r.r=a(c),r.g=s(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=t,i}(1);function Su(t,n){n||(n=[]);var e=t?Math.min(n.length,t.length):0,i=n.slice(),r;return function(o){for(r=0;r<e;++r)i[r]=t[r]*(1-o)+n[r]*o;return i}}function Nu(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function bu(t,n){var e=n?n.length:0,i=t?Math.min(e,t.length):0,r=new Array(i),o=new Array(e),a;for(a=0;a<i;++a)r[a]=li(t[a],n[a]);for(;a<e;++a)o[a]=n[a];return function(s){for(a=0;a<i;++a)o[a]=r[a](s);return o}}function Tu(t,n){var e=new Date;return t=+t,n=+n,function(i){return e.setTime(t*(1-i)+n*i),e}}function at(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function Lu(t,n){var e={},i={},r;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(r in n)r in t?e[r]=li(t[r],n[r]):i[r]=n[r];return function(o){for(r in e)i[r]=e[r](o);return i}}var $e=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,de=new RegExp($e.source,"g");function $u(t){return function(){return t}}function zu(t){return function(n){return t(n)+""}}function ho(t,n){var e=$e.lastIndex=de.lastIndex=0,i,r,o,a=-1,s=[],l=[];for(t=t+"",n=n+"";(i=$e.exec(t))&&(r=de.exec(n));)(o=r.index)>e&&(o=n.slice(e,o),s[a]?s[a]+=o:s[++a]=o),(i=i[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:at(i,r)})),e=de.lastIndex;return e<n.length&&(o=n.slice(e),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?zu(l[0].x):$u(n):(n=l.length,function(u){for(var c=0,h;c<n;++c)s[(h=l[c]).i]=h.x(u);return s.join("")})}function li(t,n){var e=typeof n,i;return n==null||e==="boolean"?ui(n):(e==="number"?at:e==="string"?(i=bt(n))?(n=i,Fn):ho:n instanceof bt?Fn:n instanceof Date?Tu:Nu(n)?Su:Array.isArray(n)?bu:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?Lu:at)(t,n)}function Cu(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}var Di=180/Math.PI,ze={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function go(t,n,e,i,r,o){var a,s,l;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(l=t*e+n*i)&&(e-=t*l,i-=n*l),(s=Math.sqrt(e*e+i*i))&&(e/=s,i/=s,l/=s),t*i<n*e&&(t=-t,n=-n,l=-l,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(n,t)*Di,skewX:Math.atan(l)*Di,scaleX:a,scaleY:s}}var vn;function Iu(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?ze:go(n.a,n.b,n.c,n.d,n.e,n.f)}function Du(t){return t==null||(vn||(vn=document.createElementNS("http://www.w3.org/2000/svg","g")),vn.setAttribute("transform",t),!(t=vn.transform.baseVal.consolidate()))?ze:(t=t.matrix,go(t.a,t.b,t.c,t.d,t.e,t.f))}function po(t,n,e,i){function r(u){return u.length?u.pop()+" ":""}function o(u,c,h,f,d,p){if(u!==h||c!==f){var x=d.push("translate(",null,n,null,e);p.push({i:x-4,x:at(u,h)},{i:x-2,x:at(c,f)})}else(h||f)&&d.push("translate("+h+n+f+e)}function a(u,c,h,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:h.push(r(h)+"rotate(",null,i)-2,x:at(u,c)})):c&&h.push(r(h)+"rotate("+c+i)}function s(u,c,h,f){u!==c?f.push({i:h.push(r(h)+"skewX(",null,i)-2,x:at(u,c)}):c&&h.push(r(h)+"skewX("+c+i)}function l(u,c,h,f,d,p){if(u!==h||c!==f){var x=d.push(r(d)+"scale(",null,",",null,")");p.push({i:x-4,x:at(u,h)},{i:x-2,x:at(c,f)})}else(h!==1||f!==1)&&d.push(r(d)+"scale("+h+","+f+")")}return function(u,c){var h=[],f=[];return u=t(u),c=t(c),o(u.translateX,u.translateY,c.translateX,c.translateY,h,f),a(u.rotate,c.rotate,h,f),s(u.skewX,c.skewX,h,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,h,f),u=c=null,function(d){for(var p=-1,x=f.length,v;++p<x;)h[(v=f[p]).i]=v.x(d);return h.join("")}}}var Pu=po(Iu,"px, ","px)","deg)"),Ru=po(Du,", ",")",")"),Ou=1e-12;function Pi(t){return((t=Math.exp(t))+1/t)/2}function Bu(t){return((t=Math.exp(t))-1/t)/2}function Fu(t){return((t=Math.exp(2*t))-1)/(t+1)}const mo=function t(n,e,i){function r(o,a){var s=o[0],l=o[1],u=o[2],c=a[0],h=a[1],f=a[2],d=c-s,p=h-l,x=d*d+p*p,v,y;if(x<Ou)y=Math.log(f/u)/n,v=function(L){return[s+L*d,l+L*p,u*Math.exp(n*L*y)]};else{var M=Math.sqrt(x),N=(f*f-u*u+i*x)/(2*u*e*M),m=(f*f-u*u-i*x)/(2*f*e*M),A=Math.log(Math.sqrt(N*N+1)-N),T=Math.log(Math.sqrt(m*m+1)-m);y=(T-A)/n,v=function(L){var z=L*y,C=Pi(A),I=u/(e*M)*(C*Fu(n*z+A)-Bu(A));return[s+I*d,l+I*p,u*C/Pi(n*z+A)]}}return v.duration=y*1e3*n/Math.SQRT2,v}return r.rho=function(o){var a=Math.max(.001,+o),s=a*a,l=s*s;return t(a,s,l)},r}(Math.SQRT2,2,4);var Ot=0,Vt=0,Ht=0,yo=1e3,qn,Zt,Hn=0,Tt=0,oe=0,on=typeof performance=="object"&&performance.now?performance:Date,vo=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ci(){return Tt||(vo(qu),Tt=on.now()+oe)}function qu(){Tt=0}function Xn(){this._call=this._time=this._next=null}Xn.prototype=fi.prototype={constructor:Xn,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?ci():+e)+(n==null?0:+n),!this._next&&Zt!==this&&(Zt?Zt._next=this:qn=this,Zt=this),this._call=t,this._time=e,Ce()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ce())}};function fi(t,n,e){var i=new Xn;return i.restart(t,n,e),i}function Hu(){ci(),++Ot;for(var t=qn,n;t;)(n=Tt-t._time)>=0&&t._call.call(void 0,n),t=t._next;--Ot}function Ri(){Tt=(Hn=on.now())+oe,Ot=Vt=0;try{Hu()}finally{Ot=0,Gu(),Tt=0}}function Xu(){var t=on.now(),n=t-Hn;n>yo&&(oe-=n,Hn=t)}function Gu(){for(var t,n=qn,e,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:qn=e);Zt=t,Ce(i)}function Ce(t){if(!Ot){Vt&&(Vt=clearTimeout(Vt));var n=t-Tt;n>24?(t<1/0&&(Vt=setTimeout(Ri,t-on.now()-oe)),Ht&&(Ht=clearInterval(Ht))):(Ht||(Hn=on.now(),Ht=setInterval(Xu,yo)),Ot=1,vo(Ri))}}function Oi(t,n,e){var i=new Xn;return n=n==null?0:+n,i.restart(r=>{i.stop(),t(r+n)},n,e),i}var Uu=cn("start","end","cancel","interrupt"),Yu=[],_o=0,Bi=1,Ie=2,Ln=3,Fi=4,De=5,$n=6;function ae(t,n,e,i,r,o){var a=t.__transition;if(!a)t.__transition={};else if(e in a)return;Vu(t,e,{name:n,index:i,group:r,on:Uu,tween:Yu,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:_o})}function hi(t,n){var e=lt(t,n);if(e.state>_o)throw new Error("too late; already scheduled");return e}function gt(t,n){var e=lt(t,n);if(e.state>Ln)throw new Error("too late; already running");return e}function lt(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function Vu(t,n,e){var i=t.__transition,r;i[n]=e,e.timer=fi(o,0,e.time);function o(u){e.state=Bi,e.timer.restart(a,e.delay,e.time),e.delay<=u&&a(u-e.delay)}function a(u){var c,h,f,d;if(e.state!==Bi)return l();for(c in i)if(d=i[c],d.name===e.name){if(d.state===Ln)return Oi(a);d.state===Fi?(d.state=$n,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[c]):+c<n&&(d.state=$n,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[c])}if(Oi(function(){e.state===Ln&&(e.state=Fi,e.timer.restart(s,e.delay,e.time),s(u))}),e.state=Ie,e.on.call("start",t,t.__data__,e.index,e.group),e.state===Ie){for(e.state=Ln,r=new Array(f=e.tween.length),c=0,h=-1;c<f;++c)(d=e.tween[c].value.call(t,t.__data__,e.index,e.group))&&(r[++h]=d);r.length=h+1}}function s(u){for(var c=u<e.duration?e.ease.call(null,u/e.duration):(e.timer.restart(l),e.state=De,1),h=-1,f=r.length;++h<f;)r[h].call(t,c);e.state===De&&(e.on.call("end",t,t.__data__,e.index,e.group),l())}function l(){e.state=$n,e.timer.stop(),delete i[n];for(var u in i)return;delete t.__transition}}function zn(t,n){var e=t.__transition,i,r,o=!0,a;if(e){n=n==null?null:n+"";for(a in e){if((i=e[a]).name!==n){o=!1;continue}r=i.state>Ie&&i.state<De,i.state=$n,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete e[a]}o&&delete t.__transition}}function Zu(t){return this.each(function(){zn(this,t)})}function ju(t,n){var e,i;return function(){var r=gt(this,t),o=r.tween;if(o!==e){i=e=o;for(var a=0,s=i.length;a<s;++a)if(i[a].name===n){i=i.slice(),i.splice(a,1);break}}r.tween=i}}function Ku(t,n,e){var i,r;if(typeof e!="function")throw new Error;return function(){var o=gt(this,t),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:n,value:e},l=0,u=r.length;l<u;++l)if(r[l].name===n){r[l]=s;break}l===u&&r.push(s)}o.tween=r}}function Wu(t,n){var e=this._id;if(t+="",arguments.length<2){for(var i=lt(this.node(),e).tween,r=0,o=i.length,a;r<o;++r)if((a=i[r]).name===t)return a.value;return null}return this.each((n==null?ju:Ku)(e,t,n))}function di(t,n,e){var i=t._id;return t.each(function(){var r=gt(this,i);(r.value||(r.value={}))[n]=e.apply(this,arguments)}),function(r){return lt(r,i).value[n]}}function xo(t,n){var e;return(typeof n=="number"?at:n instanceof bt?Fn:(e=bt(n))?(n=e,Fn):ho)(t,n)}function Qu(t){return function(){this.removeAttribute(t)}}function Ju(t){return function(){this.removeAttributeNS(t.space,t.local)}}function tl(t,n,e){var i,r=e+"",o;return function(){var a=this.getAttribute(t);return a===r?null:a===i?o:o=n(i=a,e)}}function nl(t,n,e){var i,r=e+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===r?null:a===i?o:o=n(i=a,e)}}function el(t,n,e){var i,r,o;return function(){var a,s=e(this),l;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=s+"",a===l?null:a===i&&l===r?o:(r=l,o=n(i=a,s)))}}function il(t,n,e){var i,r,o;return function(){var a,s=e(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=s+"",a===l?null:a===i&&l===r?o:(r=l,o=n(i=a,s)))}}function rl(t,n){var e=re(t),i=e==="transform"?Ru:xo;return this.attrTween(t,typeof n=="function"?(e.local?il:el)(e,i,di(this,"attr."+t,n)):n==null?(e.local?Ju:Qu)(e):(e.local?nl:tl)(e,i,n))}function ol(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function al(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function sl(t,n){var e,i;function r(){var o=n.apply(this,arguments);return o!==i&&(e=(i=o)&&al(t,o)),e}return r._value=n,r}function ul(t,n){var e,i;function r(){var o=n.apply(this,arguments);return o!==i&&(e=(i=o)&&ol(t,o)),e}return r._value=n,r}function ll(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;var i=re(t);return this.tween(e,(i.local?sl:ul)(i,n))}function cl(t,n){return function(){hi(this,t).delay=+n.apply(this,arguments)}}function fl(t,n){return n=+n,function(){hi(this,t).delay=n}}function hl(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?cl:fl)(n,t)):lt(this.node(),n).delay}function dl(t,n){return function(){gt(this,t).duration=+n.apply(this,arguments)}}function gl(t,n){return n=+n,function(){gt(this,t).duration=n}}function pl(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?dl:gl)(n,t)):lt(this.node(),n).duration}function ml(t,n){if(typeof n!="function")throw new Error;return function(){gt(this,t).ease=n}}function yl(t){var n=this._id;return arguments.length?this.each(ml(n,t)):lt(this.node(),n).ease}function vl(t,n){return function(){var e=n.apply(this,arguments);if(typeof e!="function")throw new Error;gt(this,t).ease=e}}function _l(t){if(typeof t!="function")throw new Error;return this.each(vl(this._id,t))}function xl(t){typeof t!="function"&&(t=Qr(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],a=o.length,s=i[r]=[],l,u=0;u<a;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&s.push(l);return new xt(i,this._parents,this._name,this._id)}function wl(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,i=n.length,r=e.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var l=n[s],u=e[s],c=l.length,h=a[s]=new Array(c),f,d=0;d<c;++d)(f=l[d]||u[d])&&(h[d]=f);for(;s<i;++s)a[s]=n[s];return new xt(a,this._parents,this._name,this._id)}function El(t){return(t+"").trim().split(/^|\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||n==="start"})}function Ml(t,n,e){var i,r,o=El(n)?hi:gt;return function(){var a=o(this,t),s=a.on;s!==i&&(r=(i=s).copy()).on(n,e),a.on=r}}function kl(t,n){var e=this._id;return arguments.length<2?lt(this.node(),e).on.on(t):this.each(Ml(e,t,n))}function Al(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function Sl(){return this.on("end.remove",Al(this._id))}function Nl(t){var n=this._name,e=this._id;typeof t!="function"&&(t=ri(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s=i[a],l=s.length,u=o[a]=new Array(l),c,h,f=0;f<l;++f)(c=s[f])&&(h=t.call(c,c.__data__,f,s))&&("__data__"in c&&(h.__data__=c.__data__),u[f]=h,ae(u[f],n,e,f,u,lt(c,e)));return new xt(o,this._parents,n,e)}function bl(t){var n=this._name,e=this._id;typeof t!="function"&&(t=Wr(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var l=i[s],u=l.length,c,h=0;h<u;++h)if(c=l[h]){for(var f=t.call(c,c.__data__,h,l),d,p=lt(c,e),x=0,v=f.length;x<v;++x)(d=f[x])&&ae(d,n,e,x,f,p);o.push(f),a.push(c)}return new xt(o,a,n,e)}var Tl=fn.prototype.constructor;function Ll(){return new Tl(this._groups,this._parents)}function $l(t,n){var e,i,r;return function(){var o=Rt(this,t),a=(this.style.removeProperty(t),Rt(this,t));return o===a?null:o===e&&a===i?r:r=n(e=o,i=a)}}function wo(t){return function(){this.style.removeProperty(t)}}function zl(t,n,e){var i,r=e+"",o;return function(){var a=Rt(this,t);return a===r?null:a===i?o:o=n(i=a,e)}}function Cl(t,n,e){var i,r,o;return function(){var a=Rt(this,t),s=e(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),Rt(this,t))),a===l?null:a===i&&l===r?o:(r=l,o=n(i=a,s))}}function Il(t,n){var e,i,r,o="style."+n,a="end."+o,s;return function(){var l=gt(this,t),u=l.on,c=l.value[o]==null?s||(s=wo(n)):void 0;(u!==e||r!==c)&&(i=(e=u).copy()).on(a,r=c),l.on=i}}function Dl(t,n,e){var i=(t+="")=="transform"?Pu:xo;return n==null?this.styleTween(t,$l(t,i)).on("end.style."+t,wo(t)):typeof n=="function"?this.styleTween(t,Cl(t,i,di(this,"style."+t,n))).each(Il(this._id,t)):this.styleTween(t,zl(t,i,n),e).on("end.style."+t,null)}function Pl(t,n,e){return function(i){this.style.setProperty(t,n.call(this,i),e)}}function Rl(t,n,e){var i,r;function o(){var a=n.apply(this,arguments);return a!==r&&(i=(r=a)&&Pl(t,a,e)),i}return o._value=n,o}function Ol(t,n,e){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;return this.tween(i,Rl(t,n,e??""))}function Bl(t){return function(){this.textContent=t}}function Fl(t){return function(){var n=t(this);this.textContent=n??""}}function ql(t){return this.tween("text",typeof t=="function"?Fl(di(this,"text",t)):Bl(t==null?"":t+""))}function Hl(t){return function(n){this.textContent=t.call(this,n)}}function Xl(t){var n,e;function i(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&Hl(r)),n}return i._value=t,i}function Gl(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Xl(t))}function Ul(){for(var t=this._name,n=this._id,e=Eo(),i=this._groups,r=i.length,o=0;o<r;++o)for(var a=i[o],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var c=lt(l,n);ae(l,t,e,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new xt(i,this._parents,t,e)}function Yl(){var t,n,e=this,i=e._id,r=e.size();return new Promise(function(o,a){var s={value:a},l={value:function(){--r===0&&o()}};e.each(function(){var u=gt(this,i),c=u.on;c!==t&&(n=(t=c).copy(),n._.cancel.push(s),n._.interrupt.push(s),n._.end.push(l)),u.on=n}),r===0&&o()})}var Vl=0;function xt(t,n,e,i){this._groups=t,this._parents=n,this._name=e,this._id=i}function Eo(){return++Vl}var yt=fn.prototype;xt.prototype={constructor:xt,select:Nl,selectAll:bl,selectChild:yt.selectChild,selectChildren:yt.selectChildren,filter:xl,merge:wl,selection:Ll,transition:Ul,call:yt.call,nodes:yt.nodes,node:yt.node,size:yt.size,empty:yt.empty,each:yt.each,on:kl,attr:rl,attrTween:ll,style:Dl,styleTween:Ol,text:ql,textTween:Gl,remove:Sl,tween:Wu,delay:hl,duration:pl,ease:yl,easeVarying:_l,end:Yl,[Symbol.iterator]:yt[Symbol.iterator]};function Zl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var jl={time:null,delay:0,duration:250,ease:Zl};function Kl(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}function Wl(t){var n,e;t instanceof xt?(n=t._id,t=t._name):(n=Eo(),(e=jl).time=ci(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a=i[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&ae(l,t,n,u,a,e||Kl(l,n));return new xt(i,this._parents,t,n)}fn.prototype.interrupt=Zu;fn.prototype.transition=Wl;function Ql(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function an(t,n){return fetch(t,n).then(Ql)}function Jl(t,n){var e,i=1;t==null&&(t=0),n==null&&(n=0);function r(){var o,a=e.length,s,l=0,u=0;for(o=0;o<a;++o)s=e[o],l+=s.x,u+=s.y;for(l=(l/a-t)*i,u=(u/a-n)*i,o=0;o<a;++o)s=e[o],s.x-=l,s.y-=u}return r.initialize=function(o){e=o},r.x=function(o){return arguments.length?(t=+o,r):t},r.y=function(o){return arguments.length?(n=+o,r):n},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function tc(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return Mo(this.cover(n,e),n,e,t)}function Mo(t,n,e,i){if(isNaN(n)||isNaN(e))return t;var r,o=t._root,a={data:i},s=t._x0,l=t._y0,u=t._x1,c=t._y1,h,f,d,p,x,v,y,M;if(!o)return t._root=a,t;for(;o.length;)if((x=n>=(h=(s+u)/2))?s=h:u=h,(v=e>=(f=(l+c)/2))?l=f:c=f,r=o,!(o=o[y=v<<1|x]))return r[y]=a,t;if(d=+t._x.call(null,o.data),p=+t._y.call(null,o.data),n===d&&e===p)return a.next=o,r?r[y]=a:t._root=a,t;do r=r?r[y]=new Array(4):t._root=new Array(4),(x=n>=(h=(s+u)/2))?s=h:u=h,(v=e>=(f=(l+c)/2))?l=f:c=f;while((y=v<<1|x)===(M=(p>=f)<<1|d>=h));return r[M]=o,r[y]=a,t}function nc(t){var n,e,i=t.length,r,o,a=new Array(i),s=new Array(i),l=1/0,u=1/0,c=-1/0,h=-1/0;for(e=0;e<i;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(o=+this._y.call(null,n))||(a[e]=r,s[e]=o,r<l&&(l=r),r>c&&(c=r),o<u&&(u=o),o>h&&(h=o));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),e=0;e<i;++e)Mo(this,a[e],s[e],t[e]);return this}function ec(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(e))r=(e=Math.floor(t))+1,o=(i=Math.floor(n))+1;else{for(var a=r-e||1,s=this._root,l,u;e>t||t>=r||i>n||n>=o;)switch(u=(n<i)<<1|t<e,l=new Array(4),l[u]=s,s=l,a*=2,u){case 0:r=e+a,o=i+a;break;case 1:e=r-a,o=i+a;break;case 2:r=e+a,i=o-a;break;case 3:e=r-a,i=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._y0=i,this._x1=r,this._y1=o,this}function ic(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function rc(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function W(t,n,e,i,r){this.node=t,this.x0=n,this.y0=e,this.x1=i,this.y1=r}function oc(t,n,e){var i,r=this._x0,o=this._y0,a,s,l,u,c=this._x1,h=this._y1,f=[],d=this._root,p,x;for(d&&f.push(new W(d,r,o,c,h)),e==null?e=1/0:(r=t-e,o=n-e,c=t+e,h=n+e,e*=e);p=f.pop();)if(!(!(d=p.node)||(a=p.x0)>c||(s=p.y0)>h||(l=p.x1)<r||(u=p.y1)<o))if(d.length){var v=(a+l)/2,y=(s+u)/2;f.push(new W(d[3],v,y,l,u),new W(d[2],a,y,v,u),new W(d[1],v,s,l,y),new W(d[0],a,s,v,y)),(x=(n>=y)<<1|t>=v)&&(p=f[f.length-1],f[f.length-1]=f[f.length-1-x],f[f.length-1-x]=p)}else{var M=t-+this._x.call(null,d.data),N=n-+this._y.call(null,d.data),m=M*M+N*N;if(m<e){var A=Math.sqrt(e=m);r=t-A,o=n-A,c=t+A,h=n+A,i=d.data}}return i}function ac(t){if(isNaN(c=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var n,e=this._root,i,r,o,a=this._x0,s=this._y0,l=this._x1,u=this._y1,c,h,f,d,p,x,v,y;if(!e)return this;if(e.length)for(;;){if((p=c>=(f=(a+l)/2))?a=f:l=f,(x=h>=(d=(s+u)/2))?s=d:u=d,n=e,!(e=e[v=x<<1|p]))return this;if(!e.length)break;(n[v+1&3]||n[v+2&3]||n[v+3&3])&&(i=n,y=v)}for(;e.data!==t;)if(r=e,!(e=e.next))return this;return(o=e.next)&&delete e.next,r?(o?r.next=o:delete r.next,this):n?(o?n[v]=o:delete n[v],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(i?i[y]=e:this._root=e),this):(this._root=o,this)}function sc(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function uc(){return this._root}function lc(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function cc(t){var n=[],e,i=this._root,r,o,a,s,l;for(i&&n.push(new W(i,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(i=e.node,o=e.x0,a=e.y0,s=e.x1,l=e.y1)&&i.length){var u=(o+s)/2,c=(a+l)/2;(r=i[3])&&n.push(new W(r,u,c,s,l)),(r=i[2])&&n.push(new W(r,o,c,u,l)),(r=i[1])&&n.push(new W(r,u,a,s,c)),(r=i[0])&&n.push(new W(r,o,a,u,c))}return this}function fc(t){var n=[],e=[],i;for(this._root&&n.push(new W(this._root,this._x0,this._y0,this._x1,this._y1));i=n.pop();){var r=i.node;if(r.length){var o,a=i.x0,s=i.y0,l=i.x1,u=i.y1,c=(a+l)/2,h=(s+u)/2;(o=r[0])&&n.push(new W(o,a,s,c,h)),(o=r[1])&&n.push(new W(o,c,s,l,h)),(o=r[2])&&n.push(new W(o,a,h,c,u)),(o=r[3])&&n.push(new W(o,c,h,l,u))}e.push(i)}for(;i=e.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function hc(t){return t[0]}function dc(t){return arguments.length?(this._x=t,this):this._x}function gc(t){return t[1]}function pc(t){return arguments.length?(this._y=t,this):this._y}function gi(t,n,e){var i=new pi(n??hc,e??gc,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function pi(t,n,e,i,r,o){this._x=t,this._y=n,this._x0=e,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function qi(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var J=gi.prototype=pi.prototype;J.copy=function(){var t=new pi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,i;if(!n)return t;if(!n.length)return t._root=qi(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var r=0;r<4;++r)(i=n.source[r])&&(i.length?e.push({source:i,target:n.target[r]=new Array(4)}):n.target[r]=qi(i));return t};J.add=tc;J.addAll=nc;J.cover=ec;J.data=ic;J.extent=rc;J.find=oc;J.remove=ac;J.removeAll=sc;J.root=uc;J.size=lc;J.visit=cc;J.visitAfter=fc;J.x=dc;J.y=pc;function St(t){return function(){return t}}function Et(t){return(t()-.5)*1e-6}function mc(t){return t.x+t.vx}function yc(t){return t.y+t.vy}function vc(t){var n,e,i,r=1,o=1;typeof t!="function"&&(t=St(t==null?1:+t));function a(){for(var u,c=n.length,h,f,d,p,x,v,y=0;y<o;++y)for(h=gi(n,mc,yc).visitAfter(s),u=0;u<c;++u)f=n[u],x=e[f.index],v=x*x,d=f.x+f.vx,p=f.y+f.vy,h.visit(M);function M(N,m,A,T,L){var z=N.data,C=N.r,I=x+C;if(z){if(z.index>f.index){var b=d-z.x-z.vx,R=p-z.y-z.vy,P=b*b+R*R;P<I*I&&(b===0&&(b=Et(i),P+=b*b),R===0&&(R=Et(i),P+=R*R),P=(I-(P=Math.sqrt(P)))/P*r,f.vx+=(b*=P)*(I=(C*=C)/(v+C)),f.vy+=(R*=P)*I,z.vx-=b*(I=1-I),z.vy-=R*I)}return}return m>d+I||T<d-I||A>p+I||L<p-I}}function s(u){if(u.data)return u.r=e[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(n){var u,c=n.length,h;for(e=new Array(c),u=0;u<c;++u)h=n[u],e[h.index]=+t(h,u,n)}}return a.initialize=function(u,c){n=u,i=c,l()},a.iterations=function(u){return arguments.length?(o=+u,a):o},a.strength=function(u){return arguments.length?(r=+u,a):r},a.radius=function(u){return arguments.length?(t=typeof u=="function"?u:St(+u),l(),a):t},a}function _c(t){return t.index}function Hi(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function xc(t){var n=_c,e=h,i,r=St(30),o,a,s,l,u,c=1;t==null&&(t=[]);function h(v){return 1/Math.min(s[v.source.index],s[v.target.index])}function f(v){for(var y=0,M=t.length;y<c;++y)for(var N=0,m,A,T,L,z,C,I;N<M;++N)m=t[N],A=m.source,T=m.target,L=T.x+T.vx-A.x-A.vx||Et(u),z=T.y+T.vy-A.y-A.vy||Et(u),C=Math.sqrt(L*L+z*z),C=(C-o[N])/C*v*i[N],L*=C,z*=C,T.vx-=L*(I=l[N]),T.vy-=z*I,A.vx+=L*(I=1-I),A.vy+=z*I}function d(){if(a){var v,y=a.length,M=t.length,N=new Map(a.map((A,T)=>[n(A,T,a),A])),m;for(v=0,s=new Array(y);v<M;++v)m=t[v],m.index=v,typeof m.source!="object"&&(m.source=Hi(N,m.source)),typeof m.target!="object"&&(m.target=Hi(N,m.target)),s[m.source.index]=(s[m.source.index]||0)+1,s[m.target.index]=(s[m.target.index]||0)+1;for(v=0,l=new Array(M);v<M;++v)m=t[v],l[v]=s[m.source.index]/(s[m.source.index]+s[m.target.index]);i=new Array(M),p(),o=new Array(M),x()}}function p(){if(a)for(var v=0,y=t.length;v<y;++v)i[v]=+e(t[v],v,t)}function x(){if(a)for(var v=0,y=t.length;v<y;++v)o[v]=+r(t[v],v,t)}return f.initialize=function(v,y){a=v,u=y,d()},f.links=function(v){return arguments.length?(t=v,d(),f):t},f.id=function(v){return arguments.length?(n=v,f):n},f.iterations=function(v){return arguments.length?(c=+v,f):c},f.strength=function(v){return arguments.length?(e=typeof v=="function"?v:St(+v),p(),f):e},f.distance=function(v){return arguments.length?(r=typeof v=="function"?v:St(+v),x(),f):r},f}const wc=1664525,Ec=1013904223,Xi=4294967296;function Mc(){let t=1;return()=>(t=(wc*t+Ec)%Xi)/Xi}function kc(t){return t.x}function Ac(t){return t.y}var Sc=10,Nc=Math.PI*(3-Math.sqrt(5));function bc(t){var n,e=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=new Map,l=fi(h),u=cn("tick","end"),c=Mc();t==null&&(t=[]);function h(){f(),u.call("tick",n),e<i&&(l.stop(),u.call("end",n))}function f(x){var v,y=t.length,M;x===void 0&&(x=1);for(var N=0;N<x;++N)for(e+=(o-e)*r,s.forEach(function(m){m(e)}),v=0;v<y;++v)M=t[v],M.fx==null?M.x+=M.vx*=a:(M.x=M.fx,M.vx=0),M.fy==null?M.y+=M.vy*=a:(M.y=M.fy,M.vy=0);return n}function d(){for(var x=0,v=t.length,y;x<v;++x){if(y=t[x],y.index=x,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var M=Sc*Math.sqrt(.5+x),N=x*Nc;y.x=M*Math.cos(N),y.y=M*Math.sin(N)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(x){return x.initialize&&x.initialize(t,c),x}return d(),n={tick:f,restart:function(){return l.restart(h),n},stop:function(){return l.stop(),n},nodes:function(x){return arguments.length?(t=x,d(),s.forEach(p),n):t},alpha:function(x){return arguments.length?(e=+x,n):e},alphaMin:function(x){return arguments.length?(i=+x,n):i},alphaDecay:function(x){return arguments.length?(r=+x,n):+r},alphaTarget:function(x){return arguments.length?(o=+x,n):o},velocityDecay:function(x){return arguments.length?(a=1-x,n):1-a},randomSource:function(x){return arguments.length?(c=x,s.forEach(p),n):c},force:function(x,v){return arguments.length>1?(v==null?s.delete(x):s.set(x,p(v)),n):s.get(x)},find:function(x,v,y){var M=0,N=t.length,m,A,T,L,z;for(y==null?y=1/0:y*=y,M=0;M<N;++M)L=t[M],m=x-L.x,A=v-L.y,T=m*m+A*A,T<y&&(z=L,y=T);return z},on:function(x,v){return arguments.length>1?(u.on(x,v),n):u.on(x)}}}function Tc(){var t,n,e,i,r=St(-30),o,a=1,s=1/0,l=.81;function u(d){var p,x=t.length,v=gi(t,kc,Ac).visitAfter(h);for(i=d,p=0;p<x;++p)n=t[p],v.visit(f)}function c(){if(t){var d,p=t.length,x;for(o=new Array(p),d=0;d<p;++d)x=t[d],o[x.index]=+r(x,d,t)}}function h(d){var p=0,x,v,y=0,M,N,m;if(d.length){for(M=N=m=0;m<4;++m)(x=d[m])&&(v=Math.abs(x.value))&&(p+=x.value,y+=v,M+=v*x.x,N+=v*x.y);d.x=M/y,d.y=N/y}else{x=d,x.x=x.data.x,x.y=x.data.y;do p+=o[x.data.index];while(x=x.next)}d.value=p}function f(d,p,x,v){if(!d.value)return!0;var y=d.x-n.x,M=d.y-n.y,N=v-p,m=y*y+M*M;if(N*N/l<m)return m<s&&(y===0&&(y=Et(e),m+=y*y),M===0&&(M=Et(e),m+=M*M),m<a&&(m=Math.sqrt(a*m)),n.vx+=y*d.value*i/m,n.vy+=M*d.value*i/m),!0;if(d.length||m>=s)return;(d.data!==n||d.next)&&(y===0&&(y=Et(e),m+=y*y),M===0&&(M=Et(e),m+=M*M),m<a&&(m=Math.sqrt(a*m)));do d.data!==n&&(N=o[d.data.index]*i/m,n.vx+=y*N,n.vy+=M*N);while(d=d.next)}return u.initialize=function(d,p){t=d,e=p,c()},u.strength=function(d){return arguments.length?(r=typeof d=="function"?d:St(+d),c(),u):r},u.distanceMin=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.distanceMax=function(d){return arguments.length?(s=d*d,u):Math.sqrt(s)},u.theta=function(d){return arguments.length?(l=d*d,u):Math.sqrt(l)},u}function Lc(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Gn(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,i=t.slice(0,e);return[i.length>1?i[0]+i.slice(2):i,+t.slice(e+1)]}function Bt(t){return t=Gn(Math.abs(t)),t?t[1]:NaN}function $c(t,n){return function(e,i){for(var r=e.length,o=[],a=0,s=t[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),o.push(e.substring(r-=s,r+s)),!((l+=s+1)>i));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}}function zc(t){return function(n){return n.replace(/[0-9]/g,function(e){return t[+e]})}}var Cc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Un(t){if(!(n=Cc.exec(t)))throw new Error("invalid format: "+t);var n;return new mi({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Un.prototype=mi.prototype;function mi(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}mi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ic(t){t:for(var n=t.length,e=1,i=-1,r;e<n;++e)switch(t[e]){case".":i=r=e;break;case"0":i===0&&(i=e),r=e;break;default:if(!+t[e])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var ko;function Dc(t,n){var e=Gn(t,n);if(!e)return t+"";var i=e[0],r=e[1],o=r-(ko=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Gn(t,Math.max(0,n+o-1))[0]}function Gi(t,n){var e=Gn(t,n);if(!e)return t+"";var i=e[0],r=e[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const Ui={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Lc,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>Gi(t*100,n),r:Gi,s:Dc,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Yi(t){return t}var Vi=Array.prototype.map,Zi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Pc(t){var n=t.grouping===void 0||t.thousands===void 0?Yi:$c(Vi.call(t.grouping,Number),t.thousands+""),e=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Yi:zc(Vi.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(h){h=Un(h);var f=h.fill,d=h.align,p=h.sign,x=h.symbol,v=h.zero,y=h.width,M=h.comma,N=h.precision,m=h.trim,A=h.type;A==="n"?(M=!0,A="g"):Ui[A]||(N===void 0&&(N=12),m=!0,A="g"),(v||f==="0"&&d==="=")&&(v=!0,f="0",d="=");var T=x==="$"?e:x==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",L=x==="$"?i:/[%p]/.test(A)?a:"",z=Ui[A],C=/[defgprs%]/.test(A);N=N===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function I(b){var R=T,P=L,w,g,_;if(A==="c")P=z(b)+P,b="";else{b=+b;var E=b<0||1/b<0;if(b=isNaN(b)?l:z(Math.abs(b),N),m&&(b=Ic(b)),E&&+b==0&&p!=="+"&&(E=!1),R=(E?p==="("?p:s:p==="-"||p==="("?"":p)+R,P=(A==="s"?Zi[8+ko/3]:"")+P+(E&&p==="("?")":""),C){for(w=-1,g=b.length;++w<g;)if(_=b.charCodeAt(w),48>_||_>57){P=(_===46?r+b.slice(w+1):b.slice(w))+P,b=b.slice(0,w);break}}}M&&!v&&(b=n(b,1/0));var S=R.length+b.length+P.length,k=S<y?new Array(y-S+1).join(f):"";switch(M&&v&&(b=n(k+b,k.length?y-P.length:1/0),k=""),d){case"<":b=R+b+P+k;break;case"=":b=R+k+b+P;break;case"^":b=k.slice(0,S=k.length>>1)+R+b+P+k.slice(S);break;default:b=k+R+b+P;break}return o(b)}return I.toString=function(){return h+""},I}function c(h,f){var d=u((h=Un(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Bt(f)/3)))*3,x=Math.pow(10,-p),v=Zi[8+p/3];return function(y){return d(x*y)+v}}return{format:u,formatPrefix:c}}var _n,yi,Ao;Rc({thousands:",",grouping:[3],currency:["$",""]});function Rc(t){return _n=Pc(t),yi=_n.format,Ao=_n.formatPrefix,_n}function Oc(t){return Math.max(0,-Bt(Math.abs(t)))}function Bc(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bt(n)/3)))*3-Bt(Math.abs(t)))}function Fc(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Bt(n)-Bt(t))+1}var G=1e-6,qc=1e-12,q=Math.PI,nt=q/2,ji=q/4,rt=q*2,it=180/q,j=q/180,Y=Math.abs,So=Math.atan,sn=Math.atan2,V=Math.cos,Hc=Math.exp,Xc=Math.log,Z=Math.sin,Gc=Math.sign||function(t){return t>0?1:t<0?-1:0},$t=Math.sqrt,Uc=Math.tan;function Yc(t){return t>1?0:t<-1?q:Math.acos(t)}function un(t){return t>1?nt:t<-1?-nt:Math.asin(t)}function ot(){}function Yn(t,n){t&&Wi.hasOwnProperty(t.type)&&Wi[t.type](t,n)}var Ki={Feature:function(t,n){Yn(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,i=-1,r=e.length;++i<r;)Yn(e[i].geometry,n)}},Wi={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,i=-1,r=e.length;++i<r;)t=e[i],n.point(t[0],t[1],t[2])},LineString:function(t,n){Pe(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,i=-1,r=e.length;++i<r;)Pe(e[i],n,0)},Polygon:function(t,n){Qi(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,i=-1,r=e.length;++i<r;)Qi(e[i],n)},GeometryCollection:function(t,n){for(var e=t.geometries,i=-1,r=e.length;++i<r;)Yn(e[i],n)}};function Pe(t,n,e){var i=-1,r=t.length-e,o;for(n.lineStart();++i<r;)o=t[i],n.point(o[0],o[1],o[2]);n.lineEnd()}function Qi(t,n){var e=-1,i=t.length;for(n.polygonStart();++e<i;)Pe(t[e],n,1);n.polygonEnd()}function Ct(t,n){t&&Ki.hasOwnProperty(t.type)?Ki[t.type](t,n):Yn(t,n)}function Re(t){return[sn(t[1],t[0]),un(t[2])]}function Ft(t){var n=t[0],e=t[1],i=V(e);return[i*V(n),i*Z(n),Z(e)]}function xn(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Vn(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function ge(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function wn(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function Oe(t){var n=$t(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function Be(t,n){function e(i,r){return i=t(i,r),n(i[0],i[1])}return t.invert&&n.invert&&(e.invert=function(i,r){return i=n.invert(i,r),i&&t.invert(i[0],i[1])}),e}function Fe(t,n){return Y(t)>q&&(t-=Math.round(t/rt)*rt),[t,n]}Fe.invert=Fe;function No(t,n,e){return(t%=rt)?n||e?Be(tr(t),nr(n,e)):tr(t):n||e?nr(n,e):Fe}function Ji(t){return function(n,e){return n+=t,Y(n)>q&&(n-=Math.round(n/rt)*rt),[n,e]}}function tr(t){var n=Ji(t);return n.invert=Ji(-t),n}function nr(t,n){var e=V(t),i=Z(t),r=V(n),o=Z(n);function a(s,l){var u=V(l),c=V(s)*u,h=Z(s)*u,f=Z(l),d=f*e+c*i;return[sn(h*r-d*o,c*e-f*i),un(d*r+h*o)]}return a.invert=function(s,l){var u=V(l),c=V(s)*u,h=Z(s)*u,f=Z(l),d=f*r-h*o;return[sn(h*r+f*o,c*e+d*i),un(d*e-c*i)]},a}function Vc(t){t=No(t[0]*j,t[1]*j,t.length>2?t[2]*j:0);function n(e){return e=t(e[0]*j,e[1]*j),e[0]*=it,e[1]*=it,e}return n.invert=function(e){return e=t.invert(e[0]*j,e[1]*j),e[0]*=it,e[1]*=it,e},n}function Zc(t,n,e,i,r,o){if(e){var a=V(n),s=Z(n),l=i*e;r==null?(r=n+i*rt,o=n-l/2):(r=er(a,r),o=er(a,o),(i>0?r<o:r>o)&&(r+=i*rt));for(var u,c=r;i>0?c>o:c<o;c-=l)u=Re([a,-s*V(c),-s*Z(c)]),t.point(u[0],u[1])}}function er(t,n){n=Ft(n),n[0]-=t,Oe(n);var e=Yc(-n[1]);return((-n[2]<0?-e:e)+rt-G)%rt}function bo(){var t=[],n;return{point:function(e,i,r){n.push([e,i,r])},lineStart:function(){t.push(n=[])},lineEnd:ot,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var e=t;return t=[],n=null,e}}}function Cn(t,n){return Y(t[0]-n[0])<G&&Y(t[1]-n[1])<G}function En(t,n,e,i){this.x=t,this.z=n,this.o=e,this.e=i,this.v=!1,this.n=this.p=null}function To(t,n,e,i,r){var o=[],a=[],s,l;if(t.forEach(function(p){if(!((x=p.length-1)<=0)){var x,v=p[0],y=p[x],M;if(Cn(v,y)){if(!v[2]&&!y[2]){for(r.lineStart(),s=0;s<x;++s)r.point((v=p[s])[0],v[1]);r.lineEnd();return}y[0]+=2*G}o.push(M=new En(v,p,null,!0)),a.push(M.o=new En(v,null,M,!1)),o.push(M=new En(y,p,null,!1)),a.push(M.o=new En(y,null,M,!0))}}),!!o.length){for(a.sort(n),ir(o),ir(a),s=0,l=a.length;s<l;++s)a[s].e=e=!e;for(var u=o[0],c,h;;){for(var f=u,d=!0;f.v;)if((f=f.n)===u)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(s=0,l=c.length;s<l;++s)r.point((h=c[s])[0],h[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(d)for(c=f.p.z,s=c.length-1;s>=0;--s)r.point((h=c[s])[0],h[1]);else i(f.x,f.p.x,-1,r);f=f.p}f=f.o,c=f.z,d=!d}while(!f.v);r.lineEnd()}}}function ir(t){if(n=t.length){for(var n,e=0,i=t[0],r;++e<n;)i.n=r=t[e],r.p=i,i=r;i.n=r=t[0],r.p=i}}function pe(t){return Y(t[0])<=q?t[0]:Gc(t[0])*((Y(t[0])+q)%rt-q)}function jc(t,n){var e=pe(n),i=n[1],r=Z(i),o=[Z(e),-V(e),0],a=0,s=0,l=new Nt;r===1?i=nt+G:r===-1&&(i=-nt-G);for(var u=0,c=t.length;u<c;++u)if(f=(h=t[u]).length)for(var h,f,d=h[f-1],p=pe(d),x=d[1]/2+ji,v=Z(x),y=V(x),M=0;M<f;++M,p=m,v=T,y=L,d=N){var N=h[M],m=pe(N),A=N[1]/2+ji,T=Z(A),L=V(A),z=m-p,C=z>=0?1:-1,I=C*z,b=I>q,R=v*T;if(l.add(sn(R*C*Z(I),y*L+R*V(I))),a+=b?z+C*rt:z,b^p>=e^m>=e){var P=Vn(Ft(d),Ft(N));Oe(P);var w=Vn(o,P);Oe(w);var g=(b^z>=0?-1:1)*un(w[2]);(i>g||i===g&&(P[0]||P[1]))&&(s+=b^z>=0?1:-1)}}return(a<-G||a<G&&l<-qc)^s&1}function Lo(t,n,e,i){return function(r){var o=n(r),a=bo(),s=n(a),l=!1,u,c,h,f={point:d,lineStart:x,lineEnd:v,polygonStart:function(){f.point=y,f.lineStart=M,f.lineEnd=N,c=[],u=[]},polygonEnd:function(){f.point=d,f.lineStart=x,f.lineEnd=v,c=Vr(c);var m=jc(u,i);c.length?(l||(r.polygonStart(),l=!0),To(c,Wc,m,e,r)):m&&(l||(r.polygonStart(),l=!0),r.lineStart(),e(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),e(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(m,A){t(m,A)&&r.point(m,A)}function p(m,A){o.point(m,A)}function x(){f.point=p,o.lineStart()}function v(){f.point=d,o.lineEnd()}function y(m,A){h.push([m,A]),s.point(m,A)}function M(){s.lineStart(),h=[]}function N(){y(h[0][0],h[0][1]),s.lineEnd();var m=s.clean(),A=a.result(),T,L=A.length,z,C,I;if(h.pop(),u.push(h),h=null,!!L){if(m&1){if(C=A[0],(z=C.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),T=0;T<z;++T)r.point((I=C[T])[0],I[1]);r.lineEnd()}return}L>1&&m&2&&A.push(A.pop().concat(A.shift())),c.push(A.filter(Kc))}}return f}}function Kc(t){return t.length>1}function Wc(t,n){return((t=t.x)[0]<0?t[1]-nt-G:nt-t[1])-((n=n.x)[0]<0?n[1]-nt-G:nt-n[1])}const rr=Lo(function(){return!0},Qc,tf,[-q,-nt]);function Qc(t){var n=NaN,e=NaN,i=NaN,r;return{lineStart:function(){t.lineStart(),r=1},point:function(o,a){var s=o>0?q:-q,l=Y(o-n);Y(l-q)<G?(t.point(n,e=(e+a)/2>0?nt:-nt),t.point(i,e),t.lineEnd(),t.lineStart(),t.point(s,e),t.point(o,e),r=0):i!==s&&l>=q&&(Y(n-i)<G&&(n-=i*G),Y(o-s)<G&&(o-=s*G),e=Jc(n,e,o,a),t.point(i,e),t.lineEnd(),t.lineStart(),t.point(s,e),r=0),t.point(n=o,e=a),i=s},lineEnd:function(){t.lineEnd(),n=e=NaN},clean:function(){return 2-r}}}function Jc(t,n,e,i){var r,o,a=Z(t-e);return Y(a)>G?So((Z(n)*(o=V(i))*Z(e)-Z(i)*(r=V(n))*Z(t))/(r*o*a)):(n+i)/2}function tf(t,n,e,i){var r;if(t==null)r=e*nt,i.point(-q,r),i.point(0,r),i.point(q,r),i.point(q,0),i.point(q,-r),i.point(0,-r),i.point(-q,-r),i.point(-q,0),i.point(-q,r);else if(Y(t[0]-n[0])>G){var o=t[0]<n[0]?q:-q;r=e*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(n[0],n[1])}function nf(t){var n=V(t),e=6*j,i=n>0,r=Y(n)>G;function o(c,h,f,d){Zc(d,t,e,f,c,h)}function a(c,h){return V(c)*V(h)>n}function s(c){var h,f,d,p,x;return{lineStart:function(){p=d=!1,x=1},point:function(v,y){var M=[v,y],N,m=a(v,y),A=i?m?0:u(v,y):m?u(v+(v<0?q:-q),y):0;if(!h&&(p=d=m)&&c.lineStart(),m!==d&&(N=l(h,M),(!N||Cn(h,N)||Cn(M,N))&&(M[2]=1)),m!==d)x=0,m?(c.lineStart(),N=l(M,h),c.point(N[0],N[1])):(N=l(h,M),c.point(N[0],N[1],2),c.lineEnd()),h=N;else if(r&&h&&i^m){var T;!(A&f)&&(T=l(M,h,!0))&&(x=0,i?(c.lineStart(),c.point(T[0][0],T[0][1]),c.point(T[1][0],T[1][1]),c.lineEnd()):(c.point(T[1][0],T[1][1]),c.lineEnd(),c.lineStart(),c.point(T[0][0],T[0][1],3)))}m&&(!h||!Cn(h,M))&&c.point(M[0],M[1]),h=M,d=m,f=A},lineEnd:function(){d&&c.lineEnd(),h=null},clean:function(){return x|(p&&d)<<1}}}function l(c,h,f){var d=Ft(c),p=Ft(h),x=[1,0,0],v=Vn(d,p),y=xn(v,v),M=v[0],N=y-M*M;if(!N)return!f&&c;var m=n*y/N,A=-n*M/N,T=Vn(x,v),L=wn(x,m),z=wn(v,A);ge(L,z);var C=T,I=xn(L,C),b=xn(C,C),R=I*I-b*(xn(L,L)-1);if(!(R<0)){var P=$t(R),w=wn(C,(-I-P)/b);if(ge(w,L),w=Re(w),!f)return w;var g=c[0],_=h[0],E=c[1],S=h[1],k;_<g&&(k=g,g=_,_=k);var $=_-g,D=Y($-q)<G,B=D||$<G;if(!D&&S<E&&(k=E,E=S,S=k),B?D?E+S>0^w[1]<(Y(w[0]-g)<G?E:S):E<=w[1]&&w[1]<=S:$>q^(g<=w[0]&&w[0]<=_)){var H=wn(C,(-I+P)/b);return ge(H,L),[w,Re(H)]}}}function u(c,h){var f=i?t:q-t,d=0;return c<-f?d|=1:c>f&&(d|=2),h<-f?d|=4:h>f&&(d|=8),d}return Lo(a,s,o,i?[0,-t]:[-q,t-q])}function ef(t,n,e,i,r,o){var a=t[0],s=t[1],l=n[0],u=n[1],c=0,h=1,f=l-a,d=u-s,p;if(p=e-a,!(!f&&p>0)){if(p/=f,f<0){if(p<c)return;p<h&&(h=p)}else if(f>0){if(p>h)return;p>c&&(c=p)}if(p=r-a,!(!f&&p<0)){if(p/=f,f<0){if(p>h)return;p>c&&(c=p)}else if(f>0){if(p<c)return;p<h&&(h=p)}if(p=i-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<h&&(h=p)}else if(d>0){if(p>h)return;p>c&&(c=p)}if(p=o-s,!(!d&&p<0)){if(p/=d,d<0){if(p>h)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<h&&(h=p)}return c>0&&(t[0]=a+c*f,t[1]=s+c*d),h<1&&(n[0]=a+h*f,n[1]=s+h*d),!0}}}}}var jt=1e9,Mn=-jt;function rf(t,n,e,i){function r(u,c){return t<=u&&u<=e&&n<=c&&c<=i}function o(u,c,h,f){var d=0,p=0;if(u==null||(d=a(u,h))!==(p=a(c,h))||l(u,c)<0^h>0)do f.point(d===0||d===3?t:e,d>1?i:n);while((d=(d+h+4)%4)!==p);else f.point(c[0],c[1])}function a(u,c){return Y(u[0]-t)<G?c>0?0:3:Y(u[0]-e)<G?c>0?2:1:Y(u[1]-n)<G?c>0?1:0:c>0?3:2}function s(u,c){return l(u.x,c.x)}function l(u,c){var h=a(u,1),f=a(c,1);return h!==f?h-f:h===0?c[1]-u[1]:h===1?u[0]-c[0]:h===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,h=bo(),f,d,p,x,v,y,M,N,m,A,T,L={point:z,lineStart:R,lineEnd:P,polygonStart:I,polygonEnd:b};function z(g,_){r(g,_)&&c.point(g,_)}function C(){for(var g=0,_=0,E=d.length;_<E;++_)for(var S=d[_],k=1,$=S.length,D=S[0],B,H,X=D[0],U=D[1];k<$;++k)B=X,H=U,D=S[k],X=D[0],U=D[1],H<=i?U>i&&(X-B)*(i-H)>(U-H)*(t-B)&&++g:U<=i&&(X-B)*(i-H)<(U-H)*(t-B)&&--g;return g}function I(){c=h,f=[],d=[],T=!0}function b(){var g=C(),_=T&&g,E=(f=Vr(f)).length;(_||E)&&(u.polygonStart(),_&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),E&&To(f,s,g,o,u),u.polygonEnd()),c=u,f=d=p=null}function R(){L.point=w,d&&d.push(p=[]),A=!0,m=!1,M=N=NaN}function P(){f&&(w(x,v),y&&m&&h.rejoin(),f.push(h.result())),L.point=z,m&&c.lineEnd()}function w(g,_){var E=r(g,_);if(d&&p.push([g,_]),A)x=g,v=_,y=E,A=!1,E&&(c.lineStart(),c.point(g,_));else if(E&&m)c.point(g,_);else{var S=[M=Math.max(Mn,Math.min(jt,M)),N=Math.max(Mn,Math.min(jt,N))],k=[g=Math.max(Mn,Math.min(jt,g)),_=Math.max(Mn,Math.min(jt,_))];ef(S,k,t,n,e,i)?(m||(c.lineStart(),c.point(S[0],S[1])),c.point(k[0],k[1]),E||c.lineEnd(),T=!1):E&&(c.lineStart(),c.point(g,_),T=!1)}M=g,N=_,m=E}return L}}const qe=t=>t;var me=new Nt,He=new Nt,$o,zo,Xe,Ge,wt={point:ot,lineStart:ot,lineEnd:ot,polygonStart:function(){wt.lineStart=of,wt.lineEnd=sf},polygonEnd:function(){wt.lineStart=wt.lineEnd=wt.point=ot,me.add(Y(He)),He=new Nt},result:function(){var t=me/2;return me=new Nt,t}};function of(){wt.point=af}function af(t,n){wt.point=Co,$o=Xe=t,zo=Ge=n}function Co(t,n){He.add(Ge*t-Xe*n),Xe=t,Ge=n}function sf(){Co($o,zo)}const or=wt;var qt=1/0,Zn=qt,ln=-qt,jn=ln,uf={point:lf,lineStart:ot,lineEnd:ot,polygonStart:ot,polygonEnd:ot,result:function(){var t=[[qt,Zn],[ln,jn]];return ln=jn=-(Zn=qt=1/0),t}};function lf(t,n){t<qt&&(qt=t),t>ln&&(ln=t),n<Zn&&(Zn=n),n>jn&&(jn=n)}const Kn=uf;var Ue=0,Ye=0,Kt=0,Wn=0,Qn=0,It=0,Ve=0,Ze=0,Wt=0,Io,Do,ct,ft,ut={point:Lt,lineStart:ar,lineEnd:sr,polygonStart:function(){ut.lineStart=hf,ut.lineEnd=df},polygonEnd:function(){ut.point=Lt,ut.lineStart=ar,ut.lineEnd=sr},result:function(){var t=Wt?[Ve/Wt,Ze/Wt]:It?[Wn/It,Qn/It]:Kt?[Ue/Kt,Ye/Kt]:[NaN,NaN];return Ue=Ye=Kt=Wn=Qn=It=Ve=Ze=Wt=0,t}};function Lt(t,n){Ue+=t,Ye+=n,++Kt}function ar(){ut.point=cf}function cf(t,n){ut.point=ff,Lt(ct=t,ft=n)}function ff(t,n){var e=t-ct,i=n-ft,r=$t(e*e+i*i);Wn+=r*(ct+t)/2,Qn+=r*(ft+n)/2,It+=r,Lt(ct=t,ft=n)}function sr(){ut.point=Lt}function hf(){ut.point=gf}function df(){Po(Io,Do)}function gf(t,n){ut.point=Po,Lt(Io=ct=t,Do=ft=n)}function Po(t,n){var e=t-ct,i=n-ft,r=$t(e*e+i*i);Wn+=r*(ct+t)/2,Qn+=r*(ft+n)/2,It+=r,r=ft*t-ct*n,Ve+=r*(ct+t),Ze+=r*(ft+n),Wt+=r*3,Lt(ct=t,ft=n)}const ur=ut;function Ro(t){this._context=t}Ro.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:{this._context.moveTo(t,n),this._point=1;break}case 1:{this._context.lineTo(t,n);break}default:{this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,rt);break}}},result:ot};var je=new Nt,ye,Oo,Bo,Qt,Jt,Jn={point:ot,lineStart:function(){Jn.point=pf},lineEnd:function(){ye&&Fo(Oo,Bo),Jn.point=ot},polygonStart:function(){ye=!0},polygonEnd:function(){ye=null},result:function(){var t=+je;return je=new Nt,t}};function pf(t,n){Jn.point=Fo,Oo=Qt=t,Bo=Jt=n}function Fo(t,n){Qt-=t,Jt-=n,je.add($t(Qt*Qt+Jt*Jt)),Qt=t,Jt=n}const lr=Jn;let cr,te,fr,hr;class dr{constructor(n){this._append=n==null?qo:mf(n),this._radius=4.5,this._=""}pointRadius(n){return this._radius=+n,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(n,e){switch(this._point){case 0:{this._append`M${n},${e}`,this._point=1;break}case 1:{this._append`L${n},${e}`;break}default:{if(this._append`M${n},${e}`,this._radius!==fr||this._append!==te){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,fr=i,te=this._append,hr=this._,this._=r}this._+=hr;break}}}result(){const n=this._;return this._="",n.length?n:null}}function qo(t){let n=1;this._+=t[0];for(const e=t.length;n<e;++n)this._+=arguments[n]+t[n]}function mf(t){const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);if(n>15)return qo;if(n!==cr){const e=10**n;cr=n,te=function(r){let o=1;this._+=r[0];for(const a=r.length;o<a;++o)this._+=Math.round(arguments[o]*e)/e+r[o]}}return te}function gr(t,n){let e=3,i=4.5,r,o;function a(s){return s&&(typeof i=="function"&&o.pointRadius(+i.apply(this,arguments)),Ct(s,r(o))),o.result()}return a.area=function(s){return Ct(s,r(or)),or.result()},a.measure=function(s){return Ct(s,r(lr)),lr.result()},a.bounds=function(s){return Ct(s,r(Kn)),Kn.result()},a.centroid=function(s){return Ct(s,r(ur)),ur.result()},a.projection=function(s){return arguments.length?(r=s==null?(t=null,qe):(t=s).stream,a):t},a.context=function(s){return arguments.length?(o=s==null?(n=null,new dr(e)):new Ro(n=s),typeof i!="function"&&o.pointRadius(i),a):n},a.pointRadius=function(s){return arguments.length?(i=typeof s=="function"?s:(o.pointRadius(+s),+s),a):i},a.digits=function(s){if(!arguments.length)return e;if(s==null)e=null;else{const l=Math.floor(s);if(!(l>=0))throw new RangeError(`invalid digits: ${s}`);e=l}return n===null&&(o=new dr(e)),a},a.projection(t).digits(e).context(n)}function vi(t){return function(n){var e=new Ke;for(var i in t)e[i]=t[i];return e.stream=n,e}}function Ke(){}Ke.prototype={constructor:Ke,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _i(t,n,e){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),i!=null&&t.clipExtent(null),Ct(e,t.stream(Kn)),n(Kn.result()),i!=null&&t.clipExtent(i),t}function Ho(t,n,e){return _i(t,function(i){var r=n[1][0]-n[0][0],o=n[1][1]-n[0][1],a=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),s=+n[0][0]+(r-a*(i[1][0]+i[0][0]))/2,l=+n[0][1]+(o-a*(i[1][1]+i[0][1]))/2;t.scale(150*a).translate([s,l])},e)}function yf(t,n,e){return Ho(t,[[0,0],n],e)}function vf(t,n,e){return _i(t,function(i){var r=+n,o=r/(i[1][0]-i[0][0]),a=(r-o*(i[1][0]+i[0][0]))/2,s=-o*i[0][1];t.scale(150*o).translate([a,s])},e)}function _f(t,n,e){return _i(t,function(i){var r=+n,o=r/(i[1][1]-i[0][1]),a=-o*i[0][0],s=(r-o*(i[1][1]+i[0][1]))/2;t.scale(150*o).translate([a,s])},e)}var pr=16,xf=V(30*j);function mr(t,n){return+n?Ef(t,n):wf(t)}function wf(t){return vi({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}function Ef(t,n){function e(i,r,o,a,s,l,u,c,h,f,d,p,x,v){var y=u-i,M=c-r,N=y*y+M*M;if(N>4*n&&x--){var m=a+f,A=s+d,T=l+p,L=$t(m*m+A*A+T*T),z=un(T/=L),C=Y(Y(T)-1)<G||Y(o-h)<G?(o+h)/2:sn(A,m),I=t(C,z),b=I[0],R=I[1],P=b-i,w=R-r,g=M*P-y*w;(g*g/N>n||Y((y*P+M*w)/N-.5)>.3||a*f+s*d+l*p<xf)&&(e(i,r,o,a,s,l,b,R,C,m/=L,A/=L,T,x,v),v.point(b,R),e(b,R,C,m,A,T,u,c,h,f,d,p,x,v))}}return function(i){var r,o,a,s,l,u,c,h,f,d,p,x,v={point:y,lineStart:M,lineEnd:m,polygonStart:function(){i.polygonStart(),v.lineStart=A},polygonEnd:function(){i.polygonEnd(),v.lineStart=M}};function y(z,C){z=t(z,C),i.point(z[0],z[1])}function M(){h=NaN,v.point=N,i.lineStart()}function N(z,C){var I=Ft([z,C]),b=t(z,C);e(h,f,c,d,p,x,h=b[0],f=b[1],c=z,d=I[0],p=I[1],x=I[2],pr,i),i.point(h,f)}function m(){v.point=y,i.lineEnd()}function A(){M(),v.point=T,v.lineEnd=L}function T(z,C){N(r=z,C),o=h,a=f,s=d,l=p,u=x,v.point=N}function L(){e(h,f,c,d,p,x,o,a,r,s,l,u,pr,i),v.lineEnd=m,m()}return v}}var Mf=vi({point:function(t,n){this.stream.point(t*j,n*j)}});function kf(t){return vi({point:function(n,e){var i=t(n,e);return this.stream.point(i[0],i[1])}})}function Af(t,n,e,i,r){function o(a,s){return a*=i,s*=r,[n+t*a,e-t*s]}return o.invert=function(a,s){return[(a-n)/t*i,(e-s)/t*r]},o}function yr(t,n,e,i,r,o){if(!o)return Af(t,n,e,i,r);var a=V(o),s=Z(o),l=a*t,u=s*t,c=a/t,h=s/t,f=(s*e-a*n)/t,d=(s*n+a*e)/t;function p(x,v){return x*=i,v*=r,[l*x-u*v+n,e-u*x-l*v]}return p.invert=function(x,v){return[i*(c*x-h*v+f),r*(d-h*x-c*v)]},p}function Sf(t){return Nf(function(){return t})()}function Nf(t){var n,e=150,i=480,r=250,o=0,a=0,s=0,l=0,u=0,c,h=0,f=1,d=1,p=null,x=rr,v=null,y,M,N,m=qe,A=.5,T,L,z,C,I;function b(g){return z(g[0]*j,g[1]*j)}function R(g){return g=z.invert(g[0],g[1]),g&&[g[0]*it,g[1]*it]}b.stream=function(g){return C&&I===g?C:C=Mf(kf(c)(x(T(m(I=g)))))},b.preclip=function(g){return arguments.length?(x=g,p=void 0,w()):x},b.postclip=function(g){return arguments.length?(m=g,v=y=M=N=null,w()):m},b.clipAngle=function(g){return arguments.length?(x=+g?nf(p=g*j):(p=null,rr),w()):p*it},b.clipExtent=function(g){return arguments.length?(m=g==null?(v=y=M=N=null,qe):rf(v=+g[0][0],y=+g[0][1],M=+g[1][0],N=+g[1][1]),w()):v==null?null:[[v,y],[M,N]]},b.scale=function(g){return arguments.length?(e=+g,P()):e},b.translate=function(g){return arguments.length?(i=+g[0],r=+g[1],P()):[i,r]},b.center=function(g){return arguments.length?(o=g[0]%360*j,a=g[1]%360*j,P()):[o*it,a*it]},b.rotate=function(g){return arguments.length?(s=g[0]%360*j,l=g[1]%360*j,u=g.length>2?g[2]%360*j:0,P()):[s*it,l*it,u*it]},b.angle=function(g){return arguments.length?(h=g%360*j,P()):h*it},b.reflectX=function(g){return arguments.length?(f=g?-1:1,P()):f<0},b.reflectY=function(g){return arguments.length?(d=g?-1:1,P()):d<0},b.precision=function(g){return arguments.length?(T=mr(L,A=g*g),w()):$t(A)},b.fitExtent=function(g,_){return Ho(b,g,_)},b.fitSize=function(g,_){return yf(b,g,_)},b.fitWidth=function(g,_){return vf(b,g,_)},b.fitHeight=function(g,_){return _f(b,g,_)};function P(){var g=yr(e,0,0,f,d,h).apply(null,n(o,a)),_=yr(e,i-g[0],r-g[1],f,d,h);return c=No(s,l,u),L=Be(n,_),z=Be(c,L),T=mr(L,A),w()}function w(){return C=I=null,b}return function(){return n=t.apply(this,arguments),b.invert=n.invert&&R,P()}}function xi(t,n){return[t,Xc(Uc((nt+n)/2))]}xi.invert=function(t,n){return[t,2*So(Hc(n))-nt]};function bf(){return Tf(xi).scale(961/rt)}function Tf(t){var n=Sf(t),e=n.center,i=n.scale,r=n.translate,o=n.clipExtent,a=null,s,l,u;n.scale=function(h){return arguments.length?(i(h),c()):i()},n.translate=function(h){return arguments.length?(r(h),c()):r()},n.center=function(h){return arguments.length?(e(h),c()):e()},n.clipExtent=function(h){return arguments.length?(h==null?a=s=l=u=null:(a=+h[0][0],s=+h[0][1],l=+h[1][0],u=+h[1][1]),c()):a==null?null:[[a,s],[l,u]]};function c(){var h=q*i(),f=n(Vc(n.rotate()).invert([0,0]));return o(a==null?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:t===xi?[[Math.max(f[0]-h,a),s],[Math.min(f[0]+h,l),u]]:[[a,Math.max(f[1]-h,s)],[l,Math.min(f[1]+h,u)]])}return c()}function Lf(t){var n=0,e=t.children,i=e&&e.length;if(!i)n=1;else for(;--i>=0;)n+=e[i].value;t.value=n}function $f(){return this.eachAfter(Lf)}function zf(t,n){let e=-1;for(const i of this)t.call(n,i,++e,this);return this}function Cf(t,n){for(var e=this,i=[e],r,o,a=-1;e=i.pop();)if(t.call(n,e,++a,this),r=e.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function If(t,n){for(var e=this,i=[e],r=[],o,a,s,l=-1;e=i.pop();)if(r.push(e),o=e.children)for(a=0,s=o.length;a<s;++a)i.push(o[a]);for(;e=r.pop();)t.call(n,e,++l,this);return this}function Df(t,n){let e=-1;for(const i of this)if(t.call(n,i,++e,this))return i}function Pf(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,i=n.children,r=i&&i.length;--r>=0;)e+=i[r].value;n.value=e})}function Rf(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})}function Of(t){for(var n=this,e=Bf(n,t),i=[n];n!==e;)n=n.parent,i.push(n);for(var r=i.length;t!==e;)i.splice(r,0,t),t=t.parent;return i}function Bf(t,n){if(t===n)return t;var e=t.ancestors(),i=n.ancestors(),r=null;for(t=e.pop(),n=i.pop();t===n;)r=t,t=e.pop(),n=i.pop();return r}function Ff(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n}function qf(){return Array.from(this)}function Hf(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t}function Xf(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n}function*Gf(){var t=this,n,e=[t],i,r,o;do for(n=e.reverse(),e=[];t=n.pop();)if(yield t,i=t.children)for(r=0,o=i.length;r<o;++r)e.push(i[r]);while(e.length)}function wi(t,n){t instanceof Map?(t=[void 0,t],n===void 0&&(n=Vf)):n===void 0&&(n=Yf);for(var e=new ne(t),i,r=[e],o,a,s,l;i=r.pop();)if((a=n(i.data))&&(l=(a=Array.from(a)).length))for(i.children=a,s=l-1;s>=0;--s)r.push(o=a[s]=new ne(a[s])),o.parent=i,o.depth=i.depth+1;return e.eachBefore(jf)}function Uf(){return wi(this).eachBefore(Zf)}function Yf(t){return t.children}function Vf(t){return Array.isArray(t)?t[1]:null}function Zf(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function jf(t){var n=0;do t.height=n;while((t=t.parent)&&t.height<++n)}function ne(t){this.data=t,this.depth=this.height=0,this.parent=null}ne.prototype=wi.prototype={constructor:ne,count:$f,each:zf,eachAfter:If,eachBefore:Cf,find:Df,sum:Pf,sort:Rf,path:Of,ancestors:Ff,descendants:qf,leaves:Hf,links:Xf,copy:Uf,[Symbol.iterator]:Gf};function Kf(t){return t==null?null:Wf(t)}function Wf(t){if(typeof t!="function")throw new Error;return t}function vr(){return 0}function Qf(t){return function(){return t}}const Jf=1664525,th=1013904223,_r=4294967296;function nh(){let t=1;return()=>(t=(Jf*t+th)%_r)/_r}function eh(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ih(t,n){let e=t.length,i,r;for(;e;)r=n()*e--|0,i=t[e],t[e]=t[r],t[r]=i;return t}function rh(t,n){for(var e=0,i=(t=ih(Array.from(t),n)).length,r=[],o,a;e<i;)o=t[e],a&&Xo(a,o)?++e:(a=ah(r=oh(r,o)),e=0);return a}function oh(t,n){var e,i;if(ve(n,t))return[n];for(e=0;e<t.length;++e)if(kn(n,t[e])&&ve(tn(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(i=e+1;i<t.length;++i)if(kn(tn(t[e],t[i]),n)&&kn(tn(t[e],n),t[i])&&kn(tn(t[i],n),t[e])&&ve(Go(t[e],t[i],n),t))return[t[e],t[i],n];throw new Error}function kn(t,n){var e=t.r-n.r,i=n.x-t.x,r=n.y-t.y;return e<0||e*e<i*i+r*r}function Xo(t,n){var e=t.r-n.r+Math.max(t.r,n.r,1)*1e-9,i=n.x-t.x,r=n.y-t.y;return e>0&&e*e>i*i+r*r}function ve(t,n){for(var e=0;e<n.length;++e)if(!Xo(t,n[e]))return!1;return!0}function ah(t){switch(t.length){case 1:return sh(t[0]);case 2:return tn(t[0],t[1]);case 3:return Go(t[0],t[1],t[2])}}function sh(t){return{x:t.x,y:t.y,r:t.r}}function tn(t,n){var e=t.x,i=t.y,r=t.r,o=n.x,a=n.y,s=n.r,l=o-e,u=a-i,c=s-r,h=Math.sqrt(l*l+u*u);return{x:(e+o+l/h*c)/2,y:(i+a+u/h*c)/2,r:(h+r+s)/2}}function Go(t,n,e){var i=t.x,r=t.y,o=t.r,a=n.x,s=n.y,l=n.r,u=e.x,c=e.y,h=e.r,f=i-a,d=i-u,p=r-s,x=r-c,v=l-o,y=h-o,M=i*i+r*r-o*o,N=M-a*a-s*s+l*l,m=M-u*u-c*c+h*h,A=d*p-f*x,T=(p*m-x*N)/(A*2)-i,L=(x*v-p*y)/A,z=(d*N-f*m)/(A*2)-r,C=(f*y-d*v)/A,I=L*L+C*C-1,b=2*(o+T*L+z*C),R=T*T+z*z-o*o,P=-(Math.abs(I)>1e-6?(b+Math.sqrt(b*b-4*I*R))/(2*I):R/b);return{x:i+T+L*P,y:r+z+C*P,r:P}}function xr(t,n,e){var i=t.x-n.x,r,o,a=t.y-n.y,s,l,u=i*i+a*a;u?(o=n.r+e.r,o*=o,l=t.r+e.r,l*=l,o>l?(r=(u+l-o)/(2*u),s=Math.sqrt(Math.max(0,l/u-r*r)),e.x=t.x-r*i-s*a,e.y=t.y-r*a+s*i):(r=(u+o-l)/(2*u),s=Math.sqrt(Math.max(0,o/u-r*r)),e.x=n.x+r*i-s*a,e.y=n.y+r*a+s*i)):(e.x=n.x+e.r,e.y=n.y)}function wr(t,n){var e=t.r+n.r-1e-6,i=n.x-t.x,r=n.y-t.y;return e>0&&e*e>i*i+r*r}function Er(t){var n=t._,e=t.next._,i=n.r+e.r,r=(n.x*e.r+e.x*n.r)/i,o=(n.y*e.r+e.y*n.r)/i;return r*r+o*o}function An(t){this._=t,this.next=null,this.previous=null}function uh(t,n){if(!(o=(t=eh(t)).length))return 0;var e,i,r,o,a,s,l,u,c,h,f;if(e=t[0],e.x=0,e.y=0,!(o>1))return e.r;if(i=t[1],e.x=-i.r,i.x=e.r,i.y=0,!(o>2))return e.r+i.r;xr(i,e,r=t[2]),e=new An(e),i=new An(i),r=new An(r),e.next=r.previous=i,i.next=e.previous=r,r.next=i.previous=e;t:for(l=3;l<o;++l){xr(e._,i._,r=t[l]),r=new An(r),u=i.next,c=e.previous,h=i._.r,f=e._.r;do if(h<=f){if(wr(u._,r._)){i=u,e.next=i,i.previous=e,--l;continue t}h+=u._.r,u=u.next}else{if(wr(c._,r._)){e=c,e.next=i,i.previous=e,--l;continue t}f+=c._.r,c=c.previous}while(u!==c.next);for(r.previous=e,r.next=i,e.next=i.previous=i=r,a=Er(e);(r=r.next)!==i;)(s=Er(r))<a&&(e=r,a=s);i=e.next}for(e=[i._],r=i;(r=r.next)!==i;)e.push(r._);for(r=rh(e,n),l=0;l<o;++l)e=t[l],e.x-=r.x,e.y-=r.y;return r.r}function lh(t){return Math.sqrt(t.value)}function ch(){var t=null,n=1,e=1,i=vr;function r(o){const a=nh();return o.x=n/2,o.y=e/2,t?o.eachBefore(Mr(t)).eachAfter(_e(i,.5,a)).eachBefore(kr(1)):o.eachBefore(Mr(lh)).eachAfter(_e(vr,1,a)).eachAfter(_e(i,o.r/Math.min(n,e),a)).eachBefore(kr(Math.min(n,e)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(t=Kf(o),r):t},r.size=function(o){return arguments.length?(n=+o[0],e=+o[1],r):[n,e]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:Qf(+o),r):i},r}function Mr(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function _e(t,n,e){return function(i){if(r=i.children){var r,o,a=r.length,s=t(i)*n||0,l;if(s)for(o=0;o<a;++o)r[o].r+=s;if(l=uh(r,e),s)for(o=0;o<a;++o)r[o].r-=s;i.r=l+s}}}function kr(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function se(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}const Ar=Symbol("implicit");function Uo(){var t=new Mi,n=[],e=[],i=Ar;function r(o){let a=t.get(o);if(a===void 0){if(i!==Ar)return i;t.set(o,a=n.push(o)-1)}return e[a%e.length]}return r.domain=function(o){if(!arguments.length)return n.slice();n=[],t=new Mi;for(const a of o)t.has(a)||t.set(a,n.push(a)-1);return r},r.range=function(o){return arguments.length?(e=Array.from(o),r):e.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return Uo(n,e).unknown(i)},se.apply(r,arguments),r}function Ei(){var t=Uo().unknown(void 0),n=t.domain,e=t.range,i=0,r=1,o,a,s=!1,l=0,u=0,c=.5;delete t.unknown;function h(){var f=n().length,d=r<i,p=d?r:i,x=d?i:r;o=(x-p)/Math.max(1,f-l+u*2),s&&(o=Math.floor(o)),p+=(x-p-o*(f-l))*c,a=o*(1-l),s&&(p=Math.round(p),a=Math.round(a));var v=ma(f).map(function(y){return p+o*y});return e(d?v.reverse():v)}return t.domain=function(f){return arguments.length?(n(f),h()):n()},t.range=function(f){return arguments.length?([i,r]=f,i=+i,r=+r,h()):[i,r]},t.rangeRound=function(f){return[i,r]=f,i=+i,r=+r,s=!0,h()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(f){return arguments.length?(s=!!f,h()):s},t.padding=function(f){return arguments.length?(l=Math.min(1,u=+f),h()):l},t.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),h()):l},t.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),h()):c},t.copy=function(){return Ei(n(),[i,r]).round(s).paddingInner(l).paddingOuter(u).align(c)},se.apply(h(),arguments)}function fh(t){return function(){return t}}function hh(t){return+t}var Sr=[0,1];function ht(t){return t}function We(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:fh(isNaN(n)?NaN:.5)}function dh(t,n){var e;return t>n&&(e=t,t=n,n=e),function(i){return Math.max(t,Math.min(n,i))}}function gh(t,n,e){var i=t[0],r=t[1],o=n[0],a=n[1];return r<i?(i=We(r,i),o=e(a,o)):(i=We(i,r),o=e(o,a)),function(s){return o(i(s))}}function ph(t,n,e){var i=Math.min(t.length,n.length)-1,r=new Array(i),o=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<i;)r[a]=We(t[a],t[a+1]),o[a]=e(n[a],n[a+1]);return function(s){var l=sa(t,s,1,i)-1;return o[l](r[l](s))}}function Yo(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Vo(){var t=Sr,n=Sr,e=li,i,r,o,a=ht,s,l,u;function c(){var f=Math.min(t.length,n.length);return a!==ht&&(a=dh(t[0],t[f-1])),s=f>2?ph:gh,l=u=null,h}function h(f){return f==null||isNaN(f=+f)?o:(l||(l=s(t.map(i),n,e)))(i(a(f)))}return h.invert=function(f){return a(r((u||(u=s(n,t.map(i),at)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,hh),c()):t.slice()},h.range=function(f){return arguments.length?(n=Array.from(f),c()):n.slice()},h.rangeRound=function(f){return n=Array.from(f),e=Cu,c()},h.clamp=function(f){return arguments.length?(a=f?!0:ht,c()):a!==ht},h.interpolate=function(f){return arguments.length?(e=f,c()):e},h.unknown=function(f){return arguments.length?(o=f,h):o},function(f,d){return i=f,r=d,c()}}function mh(){return Vo()(ht,ht)}function yh(t,n,e,i){var r=da(t,n,e),o;switch(i=Un(i??",f"),i.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(n));return i.precision==null&&!isNaN(o=Bc(r,a))&&(i.precision=o),Ao(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=Fc(r,Math.max(Math.abs(t),Math.abs(n))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=Oc(r))&&(i.precision=o-(i.type==="%")*2);break}}return yi(i)}function Zo(t){var n=t.domain;return t.ticks=function(e){var i=n();return ha(i[0],i[i.length-1],e??10)},t.tickFormat=function(e,i){var r=n();return yh(r[0],r[r.length-1],e??10,i)},t.nice=function(e){e==null&&(e=10);var i=n(),r=0,o=i.length-1,a=i[r],s=i[o],l,u,c=10;for(s<a&&(u=a,a=s,s=u,u=r,r=o,o=u);c-- >0;){if(u=Se(a,s,e),u===l)return i[r]=a,i[o]=s,n(i);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function dn(){var t=mh();return t.copy=function(){return Yo(t,dn())},se.apply(t,arguments),Zo(t)}function Nr(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function vh(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function _h(t){return t<0?-t*t:t*t}function xh(t){var n=t(ht,ht),e=1;function i(){return e===1?t(ht,ht):e===.5?t(vh,_h):t(Nr(e),Nr(1/e))}return n.exponent=function(r){return arguments.length?(e=+r,i()):e},Zo(n)}function jo(){var t=xh(Vo());return t.copy=function(){return Yo(t,jo()).exponent(t.exponent())},se.apply(t,arguments),t}function wh(){return jo.apply(null,arguments).exponent(.5)}const Sn=t=>()=>t;function Eh(t,{sourceEvent:n,target:e,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function _t(t,n,e){this.k=t,this.x=n,this.y=e}_t.prototype={constructor:_t,scale:function(t){return t===1?this:new _t(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new _t(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ee=new _t(1,0,0);_t.prototype;function xe(t){t.stopImmediatePropagation()}function Xt(t){t.preventDefault(),t.stopImmediatePropagation()}function Mh(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function kh(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function br(){return this.__zoom||ee}function Ah(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Sh(){return navigator.maxTouchPoints||"ontouchstart"in this}function Nh(t,n,e){var i=t.invertX(n[0][0])-e[0][0],r=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],a=t.invertY(n[1][1])-e[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function Ko(){var t=Mh,n=kh,e=Nh,i=Ah,r=Sh,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,l=mo,u=cn("start","zoom","end"),c,h,f,d=500,p=150,x=0,v=10;function y(w){w.property("__zoom",br).on("wheel.zoom",z,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",I).filter(r).on("touchstart.zoom",b).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(w,g,_,E){var S=w.selection?w.selection():w;S.property("__zoom",br),w!==S?A(w,g,_,E):S.interrupt().each(function(){T(this,arguments).event(E).start().zoom(null,typeof g=="function"?g.apply(this,arguments):g).end()})},y.scaleBy=function(w,g,_,E){y.scaleTo(w,function(){var S=this.__zoom.k,k=typeof g=="function"?g.apply(this,arguments):g;return S*k},_,E)},y.scaleTo=function(w,g,_,E){y.transform(w,function(){var S=n.apply(this,arguments),k=this.__zoom,$=_==null?m(S):typeof _=="function"?_.apply(this,arguments):_,D=k.invert($),B=typeof g=="function"?g.apply(this,arguments):g;return e(N(M(k,B),$,D),S,a)},_,E)},y.translateBy=function(w,g,_,E){y.transform(w,function(){return e(this.__zoom.translate(typeof g=="function"?g.apply(this,arguments):g,typeof _=="function"?_.apply(this,arguments):_),n.apply(this,arguments),a)},null,E)},y.translateTo=function(w,g,_,E,S){y.transform(w,function(){var k=n.apply(this,arguments),$=this.__zoom,D=E==null?m(k):typeof E=="function"?E.apply(this,arguments):E;return e(ee.translate(D[0],D[1]).scale($.k).translate(typeof g=="function"?-g.apply(this,arguments):-g,typeof _=="function"?-_.apply(this,arguments):-_),k,a)},E,S)};function M(w,g){return g=Math.max(o[0],Math.min(o[1],g)),g===w.k?w:new _t(g,w.x,w.y)}function N(w,g,_){var E=g[0]-_[0]*w.k,S=g[1]-_[1]*w.k;return E===w.x&&S===w.y?w:new _t(w.k,E,S)}function m(w){return[(+w[0][0]+ +w[1][0])/2,(+w[0][1]+ +w[1][1])/2]}function A(w,g,_,E){w.on("start.zoom",function(){T(this,arguments).event(E).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(E).end()}).tween("zoom",function(){var S=this,k=arguments,$=T(S,k).event(E),D=n.apply(S,k),B=_==null?m(D):typeof _=="function"?_.apply(S,k):_,H=Math.max(D[1][0]-D[0][0],D[1][1]-D[0][1]),X=S.__zoom,U=typeof g=="function"?g.apply(S,k):g,et=l(X.invert(B).concat(H/X.k),U.invert(B).concat(H/U.k));return function(K){if(K===1)K=U;else{var pt=et(K),ue=H/pt[2];K=new _t(ue,B[0]-pt[0]*ue,B[1]-pt[1]*ue)}$.zoom(null,K)}})}function T(w,g,_){return!_&&w.__zooming||new L(w,g)}function L(w,g){this.that=w,this.args=g,this.active=0,this.sourceEvent=null,this.extent=n.apply(w,g),this.taps=0}L.prototype={event:function(w){return w&&(this.sourceEvent=w),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(w,g){return this.mouse&&w!=="mouse"&&(this.mouse[1]=g.invert(this.mouse[0])),this.touch0&&w!=="touch"&&(this.touch0[1]=g.invert(this.touch0[0])),this.touch1&&w!=="touch"&&(this.touch1[1]=g.invert(this.touch1[0])),this.that.__zoom=g,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(w){var g=O(this.that).datum();u.call(w,this.that,new Eh(w,{sourceEvent:this.sourceEvent,target:y,type:w,transform:this.that.__zoom,dispatch:u}),g)}};function z(w,...g){if(!t.apply(this,arguments))return;var _=T(this,g).event(w),E=this.__zoom,S=Math.max(o[0],Math.min(o[1],E.k*Math.pow(2,i.apply(this,arguments)))),k=vt(w);if(_.wheel)(_.mouse[0][0]!==k[0]||_.mouse[0][1]!==k[1])&&(_.mouse[1]=E.invert(_.mouse[0]=k)),clearTimeout(_.wheel);else{if(E.k===S)return;_.mouse=[k,E.invert(k)],zn(this),_.start()}Xt(w),_.wheel=setTimeout($,p),_.zoom("mouse",e(N(M(E,S),_.mouse[0],_.mouse[1]),_.extent,a));function $(){_.wheel=null,_.end()}}function C(w,...g){if(f||!t.apply(this,arguments))return;var _=w.currentTarget,E=T(this,g,!0).event(w),S=O(w.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",H,!0),k=vt(w,_),$=w.clientX,D=w.clientY;so(w.view),xe(w),E.mouse=[k,this.__zoom.invert(k)],zn(this),E.start();function B(X){if(Xt(X),!E.moved){var U=X.clientX-$,et=X.clientY-D;E.moved=U*U+et*et>x}E.event(X).zoom("mouse",e(N(E.that.__zoom,E.mouse[0]=vt(X,_),E.mouse[1]),E.extent,a))}function H(X){S.on("mousemove.zoom mouseup.zoom",null),uo(X.view,E.moved),Xt(X),E.event(X).end()}}function I(w,...g){if(t.apply(this,arguments)){var _=this.__zoom,E=vt(w.changedTouches?w.changedTouches[0]:w,this),S=_.invert(E),k=_.k*(w.shiftKey?.5:2),$=e(N(M(_,k),E,S),n.apply(this,g),a);Xt(w),s>0?O(this).transition().duration(s).call(A,$,E,w):O(this).call(y.transform,$,E,w)}}function b(w,...g){if(t.apply(this,arguments)){var _=w.touches,E=_.length,S=T(this,g,w.changedTouches.length===E).event(w),k,$,D,B;for(xe(w),$=0;$<E;++$)D=_[$],B=vt(D,this),B=[B,this.__zoom.invert(B),D.identifier],S.touch0?!S.touch1&&S.touch0[2]!==B[2]&&(S.touch1=B,S.taps=0):(S.touch0=B,k=!0,S.taps=1+!!c);c&&(c=clearTimeout(c)),k&&(S.taps<2&&(h=B[0],c=setTimeout(function(){c=null},d)),zn(this),S.start())}}function R(w,...g){if(this.__zooming){var _=T(this,g).event(w),E=w.changedTouches,S=E.length,k,$,D,B;for(Xt(w),k=0;k<S;++k)$=E[k],D=vt($,this),_.touch0&&_.touch0[2]===$.identifier?_.touch0[0]=D:_.touch1&&_.touch1[2]===$.identifier&&(_.touch1[0]=D);if($=_.that.__zoom,_.touch1){var H=_.touch0[0],X=_.touch0[1],U=_.touch1[0],et=_.touch1[1],K=(K=U[0]-H[0])*K+(K=U[1]-H[1])*K,pt=(pt=et[0]-X[0])*pt+(pt=et[1]-X[1])*pt;$=M($,Math.sqrt(K/pt)),D=[(H[0]+U[0])/2,(H[1]+U[1])/2],B=[(X[0]+et[0])/2,(X[1]+et[1])/2]}else if(_.touch0)D=_.touch0[0],B=_.touch0[1];else return;_.zoom("touch",e(N($,D,B),_.extent,a))}}function P(w,...g){if(this.__zooming){var _=T(this,g).event(w),E=w.changedTouches,S=E.length,k,$;for(xe(w),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),k=0;k<S;++k)$=E[k],_.touch0&&_.touch0[2]===$.identifier?delete _.touch0:_.touch1&&_.touch1[2]===$.identifier&&delete _.touch1;if(_.touch1&&!_.touch0&&(_.touch0=_.touch1,delete _.touch1),_.touch0)_.touch0[1]=this.__zoom.invert(_.touch0[0]);else if(_.end(),_.taps===2&&($=vt($,this),Math.hypot(h[0]-$[0],h[1]-$[1])<v)){var D=O(this).on("dblclick.zoom");D&&D.apply(this,arguments)}}}return y.wheelDelta=function(w){return arguments.length?(i=typeof w=="function"?w:Sn(+w),y):i},y.filter=function(w){return arguments.length?(t=typeof w=="function"?w:Sn(!!w),y):t},y.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:Sn(!!w),y):r},y.extent=function(w){return arguments.length?(n=typeof w=="function"?w:Sn([[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]]),y):n},y.scaleExtent=function(w){return arguments.length?(o[0]=+w[0],o[1]=+w[1],y):[o[0],o[1]]},y.translateExtent=function(w){return arguments.length?(a[0][0]=+w[0][0],a[1][0]=+w[1][0],a[0][1]=+w[0][1],a[1][1]=+w[1][1],y):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},y.constrain=function(w){return arguments.length?(e=w,y):e},y.duration=function(w){return arguments.length?(s=+w,y):s},y.interpolate=function(w){return arguments.length?(l=w,y):l},y.on=function(){var w=u.on.apply(u,arguments);return w===u?y:w},y.clickDistance=function(w){return arguments.length?(x=(w=+w)*w,y):Math.sqrt(x)},y.tapDistance=function(w){return arguments.length?(v=+w,y):v},y}const bh="data/circle_packing_data.json",Tr="circle-packing-plot",Th="circle-packing-title",Lh="circle-packing-text",Lr="#f4efda",$h="#9e2846",zh="#000000",Ch=3,Ih=5,Dh=100,Ph="",Rh={culture:"Division Culture",marterey:"Quartier Marterey",campagne:"Division Campagne",commerce:"Division Commerce",centre:"Division Centre",affaires:"Division Affaires",cathedrale:"Division Cathédrale"},Oh="Pour vivre une expérience d'exploration historique immersive, nous vous invitons à découvrir les divisions et quartiers qui constituaient la ville. Pour ce faire, il suffit de cliquer sur les cercles correspondant à chaque quartier ou division.",Bh={culture:"Dans le domaine culturel, la rue Marterey de Lausanne se distingue. En 1803, un théâtre est initié sur le côté occidental de cette rue, et sa construction s'achève en 1805, renforçant l'identité culturelle de ce secteur de la ville.",marterey:"Dans le domaine culturel, la rue Marterey de Lausanne se distingue. En 1803, un théâtre est initié sur le côté occidental de cette rue, et sa construction s'achève en 1805, renforçant l'identité culturelle de ce secteur de la ville.",campagne:"La campagne lausannoise, parsemée de hameaux charmants, offrait un cadre idyllique pour ceux cherchant à échapper à l'agitation urbaine. Cette zone était notamment prisée par les rentiers pour sa tranquillité et se situait également sur des axes stratégiques. Ce contexte attirait les familles aristocratiques qui y établissaient leurs villas suburbaines, symbolisant à la fois un lien étroit avec la nature et un certain statut social. D'autre part, les agriculteurs et vignerons, en tant que paysans, se consacraient à leurs activités agricoles et viticoles dans cette campagne luxuriante.",commerce:"Le dynamisme commercial de Lausanne était palpable dans plusieurs quartiers vibrants de la ville avec des centres actifs comme le Grand St-Jean, St-Laurent, Palud, Ale et la Montée de St-Laurent. La place Chauderon, inaugurée en 1830, servait de point de transfert pour les marchandises, tandis que la place de la Palud, avec l'Hôtel de Ville et son marché de fromages, constituait un autre pôle d'activité.",centre:"Le centre de Lausanne était marqué par des rues pittoresques et animées, comme la Montée St-François, le Chêneau de Bourg et la Rue du Pré. Toutefois, le paysage social était significativement influencé par la présence de la tannerie Mercier dans le quartier du Rôtillon. Malgré son importance économique, la tannerie était associée à des conditions sanitaires défavorables et des odeurs désagréables, ce qui a limité la présence de la bourgeoisie dans ce secteur.",affaires:"Le cœur économique de Lausanne se trouvait dans le quartier du Bourg. Ce dernier, vibrant d'activité, abritait l'Hôtel des postes, créé entre 1806 et 1808 suite à la transformation d'une partie de l'ancien manège. C'était ici que le courrier était centralisé et expédié. De plus, ce quartier jouait un rôle crucial dans le transport. En effet, la place Saint-François était le terminus des diligences en provenance ou à destination de Berne, Genève ou Paris. Le quartier du Bourg était donc un véritable pôle d'affaires, où se croisaient les flux de courriers et de voyageurs, symbolisant le dynamisme économique de Lausanne à cette époque.",cathedrale:"La cathédrale de Lausanne se dressait majestueusement comme un emblème du patrimoine de la ville. Implantée au cœur de la Cité Derrière, son architecture impressionnante dominait l'horizon, attirant l'attention et l'admiration des résidents et des visiteurs. Les quartiers pittoresques de la Cité Dessous et de la Barre enveloppaient la cathédrale dans un tissu urbain dense. En outre, la présence de l'académie dans cette division renforçait le statut de la cathédrale comme centre de l'enseignement et de l'érudition."};class Fh{constructor(){F(this,"data");F(this,"width");F(this,"height");this.loadData().then(()=>{this.initDimensions(),this.initPacking()})}async loadData(){return new Promise(n=>{an(bh).then(e=>{this.data=e,n()})})}initDimensions(){const n=document.getElementById(Tr);if(n){const e=Math.min(n.clientWidth,n.clientHeight);this.width=e,this.height=e}}initPacking(){const e=(f=>ch().size([this.width,this.height]).padding(Ch)(wi(f).sum(d=>d.value).sort((d,p)=>p.value-d.value)))(this.data);let i=e;const r=dn().domain([0,2]).range([Lr,$h]),o=wh().domain([ga(e.descendants(),f=>f.r),ii(e.descendants(),f=>f.r)]).range([Ih,Dh]),a=O(`#${Tr}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",`-${this.width/2} -${this.height/2} ${this.width} ${this.height}`).style("display","block").style("background",r(0)).style("cursor","pointer").on("click",f=>h(f,e)),s=a.append("g").selectAll("circle").data(e.descendants().slice(1)).join("circle").attr("fill",f=>f.children?r(f.depth):Lr).attr("pointer-events",f=>f.children?null:"none").on("mouseover",function(){O(this).attr("stroke",zh)}).on("mouseout",function(){O(this).attr("stroke",null)}).on("click",(f,d)=>i!==d&&(h(f,d),f.stopPropagation())),l=a.append("g").style("font-family","var(--default-font-family)").attr("pointer-events","none").attr("text-anchor","middle").selectAll("text").data(e.descendants()).join("text").attr("dy","0.3em").style("font-size",f=>`${o(f.r)}px`).style("fill-opacity",f=>f.parent===e?1:0).style("display",f=>f.parent===e?"inline":"none").text(f=>f.data.name);let u;const c=f=>{const d=this.width/f[2];u=f,l.attr("transform",p=>`translate(${(p.x-f[0])*d},${(p.y-f[1])*d})`),s.attr("transform",p=>`translate(${(p.x-f[0])*d},${(p.y-f[1])*d})`),s.attr("r",p=>p.r*d)};c([e.x,e.y,e.r*2]);function h(f,d){const p=document.getElementById(Th);if(p){const y=Rh[d.data.name]||Ph;p.innerHTML=y}const x=document.getElementById(Lh);if(x){const y=Bh[d.data.name]||Oh;x.innerHTML=y}i=d;const v=a.transition().duration(f.altKey?7500:750).tween("zoom",()=>{const y=mo(u,[i.x,i.y,i.r*2]);return M=>c(y(M))});l.filter(function(y){return y.parent===i||this.style.display==="inline"}).transition(v).style("fill-opacity",y=>y.parent===i?1:0).on("start",function(y){y.parent===i&&(this.style.display="inline")}).on("end",function(y){y.parent!==i&&(this.style.display="none")})}}}const qh="select_job",Hh="check_proportion",we="bar",Xh="bar-svg",Gt=500,Gh=t=>({administration:"blue",agricole:"#00A59B",artisanat:"#6F2282",commerce:"#E84E10",construction:"#FCBB00",rente:"#143A85",service:"#00973B"})[t]||"#ffffff",Uh={no_job:{min:0,max:1},administration:{min:1,max:17,color:"blue"},agricole:{min:3,max:122,color:"#00A59B"},artisanat:{min:2,max:93,color:"#6F2282"},commerce:{min:6,max:44,color:"#E84E10"},construction:{min:1,max:39,color:"#FCBB00"},rente:{min:5,max:140,color:"#143A85"},service:{min:1,max:77,color:"#00973B"}};class Yh{constructor(n,e,i,r=7e5,o=[6.635,46.525],a=100,s="rgb(128, 128, 128)"){this.map_file=n,this.locations_file=e,this.mapBarPlot=i,this.scale=r,this.center=o,this.min_zoom_dimension=a,this.default_zone_color=s,this.is_zoomed=!1,this.clicked_zone=null,this.initDimensions(),this.svg=this.init_svg(),this.layer_1=this.init_g(),this.layer_2=this.init_g(),this.projection=this.init_projection(),this.zoom=this.init_zoom();let l="no_job",u=!1;document.getElementById(Hh).addEventListener("change",f=>{u=f.target.checked,this.handleSelectJob(l,u)}),document.getElementById(qh).addEventListener("change",f=>{l=f.target.value,this.handleSelectJob(f.target.value,u)})}handleSelectJob(n,e){console.log(n,e);const i=Uh[n],r=dn().domain([e?0:i.min,e?1:i.max]).range(["white",i.color]);this.layer_1.selectAll(".zone").transition().duration(500).attr("fill",o=>!(n in o.properties.jobs)||n==="no_job"?this.default_zone_color:r(o.properties.jobs[n]/(e?o.properties.population:1)))}initDimensions(){const n=document.getElementById("map-chart");n&&(this.width=n.clientWidth,this.height=n.clientHeight)}init_svg(){return O("#map").append("svg").attr("width",this.width).attr("height",this.height)}init_projection(){return bf().center(this.center).scale(this.scale).translate([this.svg_width/2,this.svg_height/2])}init_g(){return this.svg.append("g")}init_zoom(){const n=Ko().scaleExtent([1,8]).on("zoom",({transform:e})=>{this.layer_1.attr("transform",e),this.layer_2.attr("transform",e)});return this.svg.call(n),n}get svg_width(){return this.svg.node().getBoundingClientRect().width}get svg_height(){return this.svg.node().getBoundingClientRect().height}get path_generator(){return gr().projection(this.projection)}load_data(){an(this.map_file).then(n=>{this.layer_1.selectAll("path").data(n.features).enter().append("path").attr("class","zone").attr("id",e=>e.properties.id).attr("fill",e=>this.default_zone_color).attr("data-old-color",e=>this.default_zone_color).attr("d",gr().projection(this.projection)).style("stroke","white").style("stroke-width",.2).on("mouseover",e=>{this.onMouseOverZone(e.target)}).on("mouseout",e=>{this.onMouseOutZone(e.target)}).on("click",e=>{this.is_zoomed?this.zoomOut():this.zoomOnZone(e.target),this.is_zoomed=!this.is_zoomed,this.zoom.filter(()=>!this.is_zoomed),this.is_zoomed||this.resetZone(this.clicked_zone),this.clicked_zone=this.is_zoomed?e.target:null})}),this.load_locations()}load_locations(){an(this.locations_file).then(n=>{n=Object.entries(n),this.layer_2.selectAll("circle").data(n).enter().append("circle").attr("cx",e=>this.projection(e[1])[0]).attr("cy",e=>this.projection(e[1])[1]).attr("r",2).attr("fill","black").style("pointer-events","none"),this.layer_2.selectAll("text").data(n).enter().append("text").attr("x",e=>this.projection(e[1])[0]).attr("y",e=>this.projection(e[1])[1]).attr("dy",-3).text(e=>e[0]).style("font-size","6px").style("fill","black").style("text-anchor","middle").style("pointer-events","none").style("font-family","sans-serif")})}unload_data(){this.layer_1.selectAll("*").remove(),this.layer_2.selectAll("*").remove()}update_data(n){this.map_file=n,this.layer_1.selectAll("*").remove(),this.layer_2.selectAll("*").remove(),this.load_data()}onMouseOverZone(n){if(this.is_zoomed)return;const e=O(n).attr("fill");O(n).attr("data-old-color",e);const i=e.replace(/[^\d,]/g,"").split(","),r=`rgb(${i[0]*1.25}, ${i[1]*1.25}, ${i[2]*1.25})`;this.fadeToColor(n,r);const a=this.getZoneCenter(n)[0];this.addZoneTitle(n,a[0],a[1])}onMouseOutZone(n){if(this.is_zoomed)return;const e=O(n).attr("data-old-color");this.fadeToColor(n,e),this.removeZoneTitle()}fadeToColor(n,e){this.is_zoomed||O(n).attr("fill",e)}getZoneCenter(n,e,i){const o=O(n).node().getBBox();let a=[o.x+o.width/2,o.y+o.height/2];return e||(a=this.projection.invert(a)),[a,i?this.getZoneBorders(n,e):null]}getZoneBorders(n,e){const r=O(n).node().getBBox();let o=[r.x,r.y+r.height],a=[r.x+r.width,r.y+r.height],s=[r.x,r.y],l=[r.x+r.width,r.y];return e||(o=this.projection.invert(o),a=this.projection.invert(a),s=this.projection.invert(s),l=this.projection.invert(l)),[o,a,s,l]}getZoneTitle(n){let e=n;e.nodeName=="path"&&(e=O(n).data()[0]);let i=e.properties.name;return(i==null||i==""||i=="nan")&&(i=e.properties.class),i=decodeURIComponent(escape(i)),i=i.split(" ")[0],i=i.replace(",",""),i}addZoneTitle(n,e,i){let r=this.getZoneTitle(n);this.layer_2.append("text").attr("x",this.projection([e,i])[0]).attr("y",this.projection([e,i])[1]).attr("text-anchor","middle").attr("id","zone_name").text(r).attr("font-family","sans-serif").attr("font-size","10px").attr("fill","black").style("pointer-events","none")}removeZoneTitle(){O("#zone_name").remove()}zoomOnZone(n){const e=this.getZoneCenter(n,!0,!0),i=e[0],r=e[1][0],o=e[1][1],a=e[1][2];let s=Math.abs(o[0]-r[0]);s=Math.max(s,this.min_zoom_dimension);let l=Math.abs(a[1]-r[1]);l=Math.max(l,this.min_zoom_dimension);const u=Math.min(this.svg_width/s,this.svg_height/l)*.7,c=this.svg_width/2-i[0]*u,h=this.svg_height/2-i[1]*u,f=ee.translate(c,h).scale(u);this.svg.transition().duration(750).call(this.zoom.transform,f);let d=n.__data__.properties.jobs;d=Object.keys(d).map(function(p){return{id:p,value:d[p]}}),this.mapBarPlot.drawBarPlot(d)}zoomOut(){this.svg.transition().duration(750).call(this.zoom.transform,ee)}resetZone(n){const e=O(n).attr("data-old-color");this.fadeToColor(n,e),this.removeZoneTitle()}}class Vh{constructor(){F(this,"width");F(this,"height");F(this,"svg");this.initDimensions(),this.initColor()}initDimensions(){const n=document.getElementById(we);if(n){const e=Math.min(n.clientWidth,n.clientHeight);this.width=e,this.height=e}}initColor(){this.color=Gh}drawBarPlot(n){const e={top:10,right:30,bottom:100,left:50},i=this.width-e.left-e.right,r=this.height-e.top-e.bottom;let o=O(`#${we}`).select("svg"),a;o.empty()?(o=O(`#${we}`).append("svg").attr("id",Xh).attr("width",i+e.left+e.right).attr("height",r+e.top+e.bottom).append("g").attr("transform",`translate(${e.left},${e.top})`),a=o.append("g")):a=o.select("g"),n.sort((d,p)=>ei(d.value,p.value));const s=Ei().range([0,i]).domain(n.map(d=>d.id)).padding(.2),l=dn().domain([0,ii(n,d=>d.value)]).range([r,0]);let u=o.select(".x-axis");u.empty()?u=o.append("g").attr("class","x-axis").attr("transform",`translate(0,${r})`).call(Dn(s).tickFormat(d=>d)).attr("color","white").selectAll("text").style("fill","white"):u.transition().duration(Gt).call(Dn(s).tickFormat(d=>d)).attr("color","white").selectAll("text").style("fill","white");let c=o.select(".y-axis");c.empty()?c=o.append("g").attr("class","y-axis").call(Pn(l)).attr("color","white").selectAll("text").style("fill","white"):c.transition().duration(Gt).call(Pn(l)).attr("color","white").selectAll("text").style("fill","white");const h=a.selectAll(".sankey-bar").data(n,d=>d.id);h.exit().transition().duration(Gt).attr("height",0).attr("y",l(0)).remove(),h.transition().duration(Gt).attr("x",d=>s(d.id)).attr("width",s.bandwidth()).attr("y",d=>l(d.value)).attr("height",d=>r-l(d.value)),h.enter().append("rect").attr("class","sankey-bar").attr("x",d=>s(d.id)).attr("width",s.bandwidth()).attr("y",l(0)).attr("height",0).attr("fill",d=>this.color(d.id)).transition().duration(Gt).attr("height",d=>r-l(d.value)).attr("y",d=>l(d.value))}}function $r(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e<i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e<r||e===void 0&&r>=r)&&(e=r)}return e}function Wo(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e>i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e>r||e===void 0&&r>=r)&&(e=r)}return e}function Ee(t,n){let e=0;if(n===void 0)for(let i of t)(i=+i)&&(e+=i);else{let i=-1;for(let r of t)(r=+n(r,++i,t))&&(e+=r)}return e}function Zh(t){return t.target.depth}function jh(t){return t.depth}function Kh(t,n){return n-1-t.height}function Qo(t,n){return t.sourceLinks.length?t.depth:n-1}function Wh(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?Wo(t.sourceLinks,Zh)-1:0}function Nn(t){return function(){return t}}function zr(t,n){return ie(t.source,n.source)||t.index-n.index}function Cr(t,n){return ie(t.target,n.target)||t.index-n.index}function ie(t,n){return t.y0-n.y0}function Me(t){return t.value}function Qh(t){return t.index}function Jh(t){return t.nodes}function td(t){return t.links}function Ir(t,n){const e=t.get(n);if(!e)throw new Error("missing: "+n);return e}function Dr({nodes:t}){for(const n of t){let e=n.y0,i=e;for(const r of n.sourceLinks)r.y0=e+r.width/2,e+=r.width;for(const r of n.targetLinks)r.y1=i+r.width/2,i+=r.width}}function nd(){let t=0,n=0,e=1,i=1,r=24,o=8,a,s=Qh,l=Qo,u,c,h=Jh,f=td,d=6;function p(){const g={nodes:h.apply(null,arguments),links:f.apply(null,arguments)};return x(g),v(g),y(g),M(g),A(g),Dr(g),g}p.update=function(g){return Dr(g),g},p.nodeId=function(g){return arguments.length?(s=typeof g=="function"?g:Nn(g),p):s},p.nodeAlign=function(g){return arguments.length?(l=typeof g=="function"?g:Nn(g),p):l},p.nodeSort=function(g){return arguments.length?(u=g,p):u},p.nodeWidth=function(g){return arguments.length?(r=+g,p):r},p.nodePadding=function(g){return arguments.length?(o=a=+g,p):o},p.nodes=function(g){return arguments.length?(h=typeof g=="function"?g:Nn(g),p):h},p.links=function(g){return arguments.length?(f=typeof g=="function"?g:Nn(g),p):f},p.linkSort=function(g){return arguments.length?(c=g,p):c},p.size=function(g){return arguments.length?(t=n=0,e=+g[0],i=+g[1],p):[e-t,i-n]},p.extent=function(g){return arguments.length?(t=+g[0][0],e=+g[1][0],n=+g[0][1],i=+g[1][1],p):[[t,n],[e,i]]},p.iterations=function(g){return arguments.length?(d=+g,p):d};function x({nodes:g,links:_}){for(const[S,k]of g.entries())k.index=S,k.sourceLinks=[],k.targetLinks=[];const E=new Map(g.map((S,k)=>[s(S,k,g),S]));for(const[S,k]of _.entries()){k.index=S;let{source:$,target:D}=k;typeof $!="object"&&($=k.source=Ir(E,$)),typeof D!="object"&&(D=k.target=Ir(E,D)),$.sourceLinks.push(k),D.targetLinks.push(k)}if(c!=null)for(const{sourceLinks:S,targetLinks:k}of g)S.sort(c),k.sort(c)}function v({nodes:g}){for(const _ of g)_.value=_.fixedValue===void 0?Math.max(Ee(_.sourceLinks,Me),Ee(_.targetLinks,Me)):_.fixedValue}function y({nodes:g}){const _=g.length;let E=new Set(g),S=new Set,k=0;for(;E.size;){for(const $ of E){$.depth=k;for(const{target:D}of $.sourceLinks)S.add(D)}if(++k>_)throw new Error("circular link");E=S,S=new Set}}function M({nodes:g}){const _=g.length;let E=new Set(g),S=new Set,k=0;for(;E.size;){for(const $ of E){$.height=k;for(const{source:D}of $.targetLinks)S.add(D)}if(++k>_)throw new Error("circular link");E=S,S=new Set}}function N({nodes:g}){const _=$r(g,k=>k.depth)+1,E=(e-t-r)/(_-1),S=new Array(_);for(const k of g){const $=Math.max(0,Math.min(_-1,Math.floor(l.call(null,k,_))));k.layer=$,k.x0=t+$*E,k.x1=k.x0+r,S[$]?S[$].push(k):S[$]=[k]}if(u)for(const k of S)k.sort(u);return S}function m(g){const _=Wo(g,E=>(i-n-(E.length-1)*a)/Ee(E,Me));for(const E of g){let S=n;for(const k of E){k.y0=S,k.y1=S+k.value*_,S=k.y1+a;for(const $ of k.sourceLinks)$.width=$.value*_}S=(i-S+a)/(E.length+1);for(let k=0;k<E.length;++k){const $=E[k];$.y0+=S*(k+1),$.y1+=S*(k+1)}R(E)}}function A(g){const _=N(g);a=Math.min(o,(i-n)/($r(_,E=>E.length)-1)),m(_);for(let E=0;E<d;++E){const S=Math.pow(.99,E),k=Math.max(1-S,(E+1)/d);L(_,S,k),T(_,S,k)}}function T(g,_,E){for(let S=1,k=g.length;S<k;++S){const $=g[S];for(const D of $){let B=0,H=0;for(const{source:U,value:et}of D.targetLinks){let K=et*(D.layer-U.layer);B+=P(U,D)*K,H+=K}if(!(H>0))continue;let X=(B/H-D.y0)*_;D.y0+=X,D.y1+=X,b(D)}u===void 0&&$.sort(ie),z($,E)}}function L(g,_,E){for(let S=g.length,k=S-2;k>=0;--k){const $=g[k];for(const D of $){let B=0,H=0;for(const{target:U,value:et}of D.sourceLinks){let K=et*(U.layer-D.layer);B+=w(D,U)*K,H+=K}if(!(H>0))continue;let X=(B/H-D.y0)*_;D.y0+=X,D.y1+=X,b(D)}u===void 0&&$.sort(ie),z($,E)}}function z(g,_){const E=g.length>>1,S=g[E];I(g,S.y0-a,E-1,_),C(g,S.y1+a,E+1,_),I(g,i,g.length-1,_),C(g,n,0,_)}function C(g,_,E,S){for(;E<g.length;++E){const k=g[E],$=(_-k.y0)*S;$>1e-6&&(k.y0+=$,k.y1+=$),_=k.y1+a}}function I(g,_,E,S){for(;E>=0;--E){const k=g[E],$=(k.y1-_)*S;$>1e-6&&(k.y0-=$,k.y1-=$),_=k.y0-a}}function b({sourceLinks:g,targetLinks:_}){if(c===void 0){for(const{source:{sourceLinks:E}}of _)E.sort(Cr);for(const{target:{targetLinks:E}}of g)E.sort(zr)}}function R(g){if(c===void 0)for(const{sourceLinks:_,targetLinks:E}of g)_.sort(Cr),E.sort(zr)}function P(g,_){let E=g.y0-(g.sourceLinks.length-1)*a/2;for(const{target:S,width:k}of g.sourceLinks){if(S===_)break;E+=k+a}for(const{source:S,width:k}of _.targetLinks){if(S===g)break;E-=k}return E}function w(g,_){let E=_.y0-(_.targetLinks.length-1)*a/2;for(const{source:S,width:k}of _.targetLinks){if(S===g)break;E+=k+a}for(const{target:S,width:k}of g.sourceLinks){if(S===_)break;E-=k}return E}return p}var Qe=Math.PI,Je=2*Qe,Mt=1e-6,ed=Je-Mt;function ti(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Jo(){return new ti}ti.prototype=Jo.prototype={constructor:ti,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,i){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+i)},bezierCurveTo:function(t,n,e,i,r,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,n,e,i,r){t=+t,n=+n,e=+e,i=+i,r=+r;var o=this._x1,a=this._y1,s=e-t,l=i-n,u=o-t,c=a-n,h=u*u+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(h>Mt)if(!(Math.abs(c*s-l*u)>Mt)||!r)this._+="L"+(this._x1=t)+","+(this._y1=n);else{var f=e-o,d=i-a,p=s*s+l*l,x=f*f+d*d,v=Math.sqrt(p),y=Math.sqrt(h),M=r*Math.tan((Qe-Math.acos((p+h-x)/(2*v*y)))/2),N=M/y,m=M/v;Math.abs(N-1)>Mt&&(this._+="L"+(t+N*u)+","+(n+N*c)),this._+="A"+r+","+r+",0,0,"+ +(c*f>u*d)+","+(this._x1=t+m*s)+","+(this._y1=n+m*l)}},arc:function(t,n,e,i,r,o){t=+t,n=+n,e=+e,o=!!o;var a=e*Math.cos(i),s=e*Math.sin(i),l=t+a,u=n+s,c=1^o,h=o?i-r:r-i;if(e<0)throw new Error("negative radius: "+e);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Mt||Math.abs(this._y1-u)>Mt)&&(this._+="L"+l+","+u),e&&(h<0&&(h=h%Je+Je),h>ed?this._+="A"+e+","+e+",0,1,"+c+","+(t-a)+","+(n-s)+"A"+e+","+e+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>Mt&&(this._+="A"+e+","+e+",0,"+ +(h>=Qe)+","+c+","+(this._x1=t+e*Math.cos(r))+","+(this._y1=n+e*Math.sin(r))))},rect:function(t,n,e,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +i+"h"+-e+"Z"},toString:function(){return this._}};function Pr(t){return function(){return t}}function id(t){return t[0]}function rd(t){return t[1]}var od=Array.prototype.slice;function ad(t){return t.source}function sd(t){return t.target}function ud(t){var n=ad,e=sd,i=id,r=rd,o=null;function a(){var s,l=od.call(arguments),u=n.apply(this,l),c=e.apply(this,l);if(o||(o=s=Jo()),t(o,+i.apply(this,(l[0]=u,l)),+r.apply(this,l),+i.apply(this,(l[0]=c,l)),+r.apply(this,l)),s)return o=null,s+""||null}return a.source=function(s){return arguments.length?(n=s,a):n},a.target=function(s){return arguments.length?(e=s,a):e},a.x=function(s){return arguments.length?(i=typeof s=="function"?s:Pr(+s),a):i},a.y=function(s){return arguments.length?(r=typeof s=="function"?s:Pr(+s),a):r},a.context=function(s){return arguments.length?(o=s??null,a):o},a}function ld(t,n,e,i,r){t.moveTo(n,e),t.bezierCurveTo(n=(n+i)/2,e,n,r,i,r)}function cd(){return ud(ld)}function fd(t){return[t.source.x1,t.y0]}function hd(t){return[t.target.x0,t.y1]}function dd(){return cd().source(fd).target(hd)}const Rr="sankey",zt="sankey-tooltip",ke="sankey-barplot",gd="sankey-barplot-svg",pd=.8,md="justify",yd=t=>t.id.split(/\W/)[0],vd=15,_d=10,xd=1,wd=1,Ed=5,Md=5,kd=",",Ad="currentColor",Sd=.5,Nd=1.5,bd="round",Or=.5,Td="multiply",Ld=dd(),Br=6,Fr="#aaaaaa",Ut=500,ta=t=>({bourg:"#2081C3",place_st_francois:"#2081C3",chailly:"#289e61",grange_neuve:"#289e61",la_sallaz:"#289e61",ouchy:"#289e61",barre:"#725AC1",cite_derriere:"#725AC1",cite_dessous:"#725AC1",cheneau_de_bourg:"#F4743B",montee_st_francois:"#F4743B",rue_du_pre:"#F4743B",ale:"#F4B860",grand_st_jean:"#F4B860",montee_de_st_laurent:"#F4B860",palud:"#F4B860",st_laurent:"#F4B860",marterey:"#9E2846",affaires_division:"#2081C3",campagne_division:"#289e61",cathedrale_division:"#725AC1",centre_division:"#F4743B",commerce_division:"#F4B860",culture_division:"#9E2846",administration:"#cccccc",agricole:"#cccccc",artisanat:"#cccccc",commerce:"#cccccc",construction:"#cccccc",rente:"#cccccc",service:"#cccccc",hors_lausanne:"#cccccc",lausanne:"#cccccc"})[t]??"#aaaaaa",ni=t=>({bourg:"Bourg",place_st_francois:"Place St-François",chailly:"Chailly",grange_neuve:"Grange-Neuve",la_sallaz:"La Sallaz",ouchy:"Ouchy",barre:"Barre",cite_derriere:"Cité Derrière",cite_dessous:"Cité Dessous",cheneau_de_bourg:"Chêneau-de-Bourg",montee_st_francois:"Montée St-François",rue_du_pre:"Rue du Pré",ale:"Ale",grand_st_jean:"Grand St-Jean",montee_de_st_laurent:"Montée de St-Laurent",palud:"Palud",st_laurent:"St-Laurent",marterey:"Marterey",affaires_division:"Affaires",campagne_division:"Campagne",cathedrale_division:"Cathédrale",centre_division:"Centre",commerce_division:"Commerce",culture_division:"Culture",administration:"Administration",agricole:"Agricole",artisanat:"Artisanat",commerce:"Commerce",construction:"Construction",rente:"Rente",service:"Service",hors_lausanne:"Hors Lausanne",lausanne:"Lausanne"})[t]??t;class $d{constructor(n,e){F(this,"dataPath");F(this,"uid");F(this,"width");F(this,"height");F(this,"data");F(this,"links");F(this,"nodes");F(this,"N");F(this,"G");F(this,"nodeAlign");F(this,"color");F(this,"format");F(this,"svg");F(this,"node");F(this,"link");this.dataPath=n,this.sankeyBarPlot=e,this.uid=`O-${Math.random().toString(16).slice(2)}`,this.loadData().then(()=>{this.initDimensions(),this.initNodeAlign(),this.initGraph(),this.initColor(),this.computeSankeyLayout(),this.initSvgElements()})}loadData(){return new Promise(n=>{an(this.dataPath).then(e=>{this.data=e,n()})})}initDimensions(){const n=document.getElementById(Rr);if(n){const e=Math.min(n.clientWidth,n.clientHeight);this.width=e,this.height=e}}initNodeAlign(){this.nodeAlign={left:jh,right:Kh,center:Wh}[md]??Qo}initGraph(){const n=mt(this.data,({source:r})=>r),e=mt(this.data,({target:r})=>r),i=mt(this.data,({value:r})=>r);this.nodes=Array.from(ya(n,e),r=>({id:r})),this.N=mt(this.nodes,r=>r.id),this.G=mt(this.nodes,yd),this.nodes=mt(this.nodes,(r,o)=>({id:this.N[o]})),this.links=mt(this.data,(r,o)=>({source:n[o],target:e[o],value:i[o]}))}initColor(){this.color=ta}computeSankeyLayout(){nd().nodeId(({index:n})=>this.N[n]).nodeAlign(this.nodeAlign).nodeWidth(vd).nodePadding(_d).extent([[xd,Ed],[this.width-wd,this.height-Md]])({nodes:this.nodes,links:this.links})}initSvgElements(){this.format=yi(kd);const n=this.N;mt(this.nodes,e=>`${e.id}
${this.format(e.value)}`),mt(this.links,e=>`${e.source.id} → ${e.target.id}
${this.format(e.value)}`),this.svg=O(`#${Rr}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this.node=this.svg.append("g").attr("stroke",Ad).attr("stroke-width",Nd).attr("stroke-opacity",Sd).attr("stroke-linejoin",bd).selectAll("rect").data(this.nodes).join("rect").attr("id",e=>e.id).attr("class",e=>"sankey-rect").attr("x",e=>e.x0).attr("y",e=>e.y0).attr("height",e=>e.y1-e.y0).attr("width",e=>e.x1-e.x0),this.node.on("mouseover",(e,i)=>{gn(".sankey-rect").style("fill",Fr),gn(".sankey-path").style("stroke",Fr),O(`#${i.id}`).style("fill",o=>this.color(o.id)),i.sourceLinks.forEach(o=>O(`#${o.target.id}`).style("fill",a=>this.color(a.id))),i.targetLinks.forEach(o=>O(`#${o.source.id}`).style("fill",a=>this.color(a.id))),i.sourceLinks.forEach(o=>O(`#${o.source.id}-${o.target.id}`).style("stroke",a=>this.color(a.source.id))),i.targetLinks.forEach(o=>O(`#${o.source.id}-${o.target.id}`).style("stroke",a=>this.color(a.source.id)));const r=O(`#${zt}`);r.style("visibility","visible"),r.html(`${i.value}`)}).on("mouseout",(e,i)=>{gn(".sankey-rect").style("fill",o=>this.color(o.id)),gn(".sankey-path").style("stroke",o=>this.color(o.source.id)),O(`#${zt}`).style("visibility","hidden")}).on("mousemove",e=>{O(`#${zt}`).style("top",e.pageY-10+"px").style("left",e.pageX+10+"px")}).on("click",(e,i)=>{this.updateBarChart(i)}),this.G&&this.node.attr("fill",({index:e})=>this.color(this.G[e])),this.link=this.svg.append("g").attr("fill","none").attr("stroke-opacity",Or).selectAll("g").data(this.links).join("g").style("mix-blend-mode",Td),this.link.append("path").attr("d",Ld).attr("id",e=>`${e.source.id}-${e.target.id}`).attr("class",e=>"sankey-path").attr("stroke",({source:{index:e}})=>this.color(this.G[e])).attr("stroke-width",({width:e})=>Math.max(1,e)),this.link.on("mouseover",function(e,i){O(this).style("stroke-opacity",pd);const r=O(`#${zt}`);r.style("visibility","visible"),r.html(`${i.value}`)}).on("mouseout",e=>{this.link.style("stroke-opacity",Or),O(`#${zt}`).style("visibility","hidden")}).on("mousemove",e=>{O(`#${zt}`).style("top",e.pageY-10+"px").style("left",e.pageX+10+"px")}),n&&this.svg.append("g").attr("font-family","sans-serif").attr("font-size",10).selectAll("text").data(this.nodes).join("text").attr("x",e=>e.x0<this.width/2?e.x1+Br:e.x0-Br).attr("y",e=>(e.y1+e.y0)/2).attr("dy","0.35em").attr("text-anchor",e=>e.x0<this.width/2?"start":"end").attr("pointer-events","none").text(({index:e})=>ni(n[e]))}updateBarChart(n){const e=n.sourceLinks.map(o=>({id:o.target.id,value:o.value})),i=n.targetLinks.map(o=>({id:o.source.id,value:o.value}));if(e.length===0&&i.length===0)return;let r=e.length===0?i:e;this.sankeyBarPlot.drawBarPlot(r)}}class zd{constructor(){F(this,"width");F(this,"height");F(this,"svg");this.initDimensions(),this.initColor()}initDimensions(){const n=document.getElementById(ke);if(n){const e=Math.min(n.clientWidth,n.clientHeight);this.width=e,this.height=e}}initColor(){this.color=ta}drawBarPlot(n){const e={top:10,right:30,bottom:100,left:50},i=this.width-e.left-e.right,r=this.height-e.top-e.bottom;let o=O(`#${ke}`).select("svg"),a;o.empty()?(o=O(`#${ke}`).append("svg").attr("id",gd).attr("width",i+e.left+e.right).attr("height",r+e.top+e.bottom).append("g").attr("transform",`translate(${e.left},${e.top})`),a=o.append("g")):a=o.select("g"),n.sort((d,p)=>ei(d.value,p.value));const s=Ei().range([0,i]).domain(n.map(d=>d.id)).padding(.2),l=dn().domain([0,ii(n,d=>d.value)]).range([r,0]);let u=o.select(".x-axis");u.empty()?u=o.append("g").attr("class","x-axis").attr("transform",`translate(0,${r})`).call(Dn(s).tickFormat(d=>ni(d))):u.transition().duration(Ut).call(Dn(s).tickFormat(d=>ni(d)));let c=o.select(".y-axis");c.empty()?c=o.append("g").attr("class","y-axis").call(Pn(l)):c.transition().duration(Ut).call(Pn(l));const h=a.selectAll(".sankey-bar").data(n,d=>d.id);h.exit().transition().duration(Ut).attr("height",0).attr("y",l(0)).remove(),h.transition().duration(Ut).attr("x",d=>s(d.id)).attr("width",s.bandwidth()).attr("y",d=>l(d.value)).attr("height",d=>r-l(d.value)),h.enter().append("rect").attr("class","sankey-bar").attr("x",d=>s(d.id)).attr("width",s.bandwidth()).attr("y",l(0)).attr("height",0).attr("fill",d=>this.color(d.id)).transition().duration(Ut).attr("height",d=>r-l(d.value)).attr("y",d=>l(d.value))}}document.addEventListener("DOMContentLoaded",()=>{new Fh;const t=new Vh;new Yh("data/berney_divisions.geojson","data/locations.json",t).load_data();const e=new zd;new $d("data/sankey_ddo.json",e)});const qr=100;document.addEventListener("DOMContentLoaded",()=>{let t;function n(s){const l=s.getBoundingClientRect(),u=window.innerHeight||document.documentElement.clientHeight,c=window.innerWidth||document.documentElement.clientWidth;return l.top>=0&&l.left>=0&&l.bottom<=u+1&&l.right<=c+1}function e(s,l){const u=window.pageYOffset,c=s.getBoundingClientRect().top,h=performance.now();function f(d){const p=d-h,x=Math.min(p/l,1);window.scrollTo({top:u+c*i(x)}),p<l&&window.requestAnimationFrame(f)}window.requestAnimationFrame(f)}function i(s){return s<.5?2*s*s:-1+(4-2*s)*s}function r(s){return s.deltaY>0?"down":"up"}function o(s){s.preventDefault();const l=["title-container","p1-container","p2-container","p3-container","p4-container","p5-container","p6-container","p7-container","final-container"];let u=null;s.type==="wheel"&&(u=r(s)),s.type==="touchmove"&&(u=s.touches[0].pageY>t?"up":"down");for(let c=0;c<l.length;c++){const h=c>=1?document.getElementById(l[c-1]):null,f=document.getElementById(l[c]),d=c<l.length-1?document.getElementById(l[c+1]):null;h&&n(f)&&u==="up"&&e(h,qr),d&&n(f)&&u==="down"&&e(d,qr)}}document.addEventListener("wheel",o,{passive:!1}),document.addEventListener("touchmove",o,{passive:!1});const a=document.getElementById("title-container");e(a,0)});const Cd="data/networks",Id="road_vocation_data",Dd="vocation",Pd="#network-graph",Rd="network-chart",Od="#network-title",Bd="#network-text",Fd="#979487",Hr="#aaaaaa",qd={road_vocation_data:{road:"#289e61",vocation:"#9e2846"},bipartite_division_type_metiers:{division:"#289e61",job_category:"#9e2846"},bipartite_origine_category_type_metiers:{origine_category:"#289e61",job_category:"#9e2846"},bipartite_street_type_metiers:{street:"#289e61",job_category:"#9e2846"},bipartite_rue_origines:{street:"#289e61",origine_category:"#9e2846"},bipartite_divisions_origines:{division:"#289e61",origine_category:"#9e2846"}},Hd={road_vocation_data:{title:"Vocations Voisines",text:"Ce premier graphe tisse un lien entre les vocations et les rues. Chaque métier est connecté à une rue, la taille de chaque nœud reflétant le nombre de personnes concernées. Les liens entre les rues et les métiers mettent en lumière des proximités intéressantes : par exemple, les rues de <i>Chavannes</i> et de <i>La Sallaz</i> se retrouvent proches dans notre graphe, illustrant la forte présence de paysans parmi leurs habitants, comme l'indiquent les liens avec les nœuds 'laboureur' et 'fermier'. De plus, des rues géographiquement voisines comme <i>Rue Saint François</i> et <i>Place Saint François</i> se retrouvent également proches dans notre réseau, révélant une similarité dans la composition professionnelle de leurs résidents."},bipartite_division_type_metiers:{title:"Métiers Mappés",text:"Ce graphe met en lumière les liens entre les divisions de la ville de Lausanne et les classes de métiers. Il offre une vue claire sur la répartition des professions à travers la ville. Par exemple, il est évident que la majorité des rentiers proviennent des divisions 17 et 1-2, qui correspondent respectivement à la campagne vers le sud de Lausanne et au quartier de Marterey et ses environs."},bipartite_origine_category_type_metiers:{title:"Origines Occupées",text:"Cete visualization dévoile les interactions entre les classes d'origine et les classes de vocations On observe une distribution plutôt homogène des métiers pour chaque origine. Par ailleurs, Yverdon se distingue par une plus grande concentration de constructeurs et d'artisans. Le Lavaux, région connue pour son paysage viticole et agricole, présente une majorité de personnes engagées dans l'agriculture."},bipartite_street_type_metiers:{title:"Rues Révélées",text:"Ce graphe lie les classes de métiers aux rues, offrant une perspective encore plus granulaire de la vie à Lausanne au XIX<sup>ème</sup> siècle. Certaines petites rues présentent une faible diversité de vocations, comme Vidy, Paleyres, et Petit Ouchy, où prédomine l'agriculture en périphérie de la ville."},bipartite_rue_origines:{title:"Rues Racines",text:"Cette nouvelle visualisation lie les rues de Lausanne à leurs classes d'origine, offrant une compréhension encore plus nuancée des dynamiques sociales de la ville. Chaque rue se voit attribuer un spectre d'origines, révélant la diversité et la complexité de la composition démographique de la ville. De cette manière, on peut mieux apprécier l'histoire multiculturelle de Lausanne, où chaque rue porte en elle les traces de nombreuses origines différentes, formant un patchwork unique de cultures et de traditions."},bipartite_divisions_origines:{title:"Origines Organisées",text:"Cette dernière visualisation établit un lien direct entre les divisions de la ville et les origines de ses habitants. Elle offre une vue panoramique de la diversité culturelle, illustrant comment les différentes origines ont contribué à la formation de chaque division. À travers ce graphe, nous pouvons voir comment Lausanne, même à cette époque, était un creuset de cultures, où chaque division a été façonnée par une mosaïque d'origines différentes, contribuant à l'identité unique de la ville."}},Xd=.1,Gd=10;class Ud{constructor(n=.7,e=.7,i=.1,r=7,o=40,a=1,s=8,l=5,u=5,c=5,h=-700,f=2,d=200){F(this,"svg");F(this,"gnodes");F(this,"glinks");F(this,"simulation");F(this,"data");F(this,"container");F(this,"dragActive",!1);F(this,"networkName",Dd);F(this,"linkedById");this.expNodeSizeScale=n,this.expLinkWeightScale=e,this.transparency=i,this.minNodeSize=r,this.maxNodeSize=o,this.minLinkWeight=a,this.maxLinkWeight=s,this.labelSizeAdd=l,this.nodeSizeInc=u,this.labelSizeInc=c,this.chargeStrength=h,this.collideSizeAdd=f,this.transitionDuration=d,this.initDimensions(),this.initStaticElements(),this.initEvents(),this.updatePlot(Id)}async loadData(n){const e=`${Cd}/${n}.json`;return new Promise(i=>{an(e).then(r=>{i(r)})})}initDimensions(){this.container=O(Pd);const n=document.getElementById(Rd);n&&(this.width=n.clientWidth,this.height=n.clientHeight)}initStaticElements(){this.svg=this.container.append("svg").attr("width",this.width).attr("height",this.height),this.glinks=this.svg.append("g").attr("class","links"),this.gnodes=this.svg.append("g").attr("class","nodes")}initEvents(){const n=document.getElementById("graph-selector");n&&n.addEventListener("change",e=>{const i=e.target.value;this.updatePlot(i)})}get_scaled_size(n,e,i,r,o){return i-e==0?(r+o)/2:r+(n-e)*(o-r)/(i-e)}isConnected(n,e){return this.linkedById[n].indexOf(e)>-1||this.linkedById[e].indexOf(n)>-1||n==e}drag(n){const e=o=>{this.dragActive=!0,o.active||n.alphaTarget(.3).restart(),o.subject.fx=o.subject.x,o.subject.fy=o.subject.y},i=o=>{o.subject.fx=o.x,o.subject.fy=o.y},r=o=>{this.dragActive=!1,o.active||n.alphaTarget(0),o.subject.fx=null,o.subject.fy=null};return cu().on("start",e).on("drag",i).on("end",r)}initData(){let n=this.data.nodes.reduce((o,a)=>Math.max(o,a.size),0),e=this.data.nodes.reduce((o,a)=>Math.min(o,a.size),1/0);n=Math.pow(n,this.expNodeSizeScale),e=Math.pow(e,this.expNodeSizeScale),this.data.nodes.forEach(o=>o.size=this.get_scaled_size(Math.pow(o.size,this.expNodeSizeScale),e,n,this.minNodeSize,this.maxNodeSize));let i=this.data.links.reduce((o,a)=>Math.max(o,a.weight),0),r=this.data.links.reduce((o,a)=>Math.min(o,a.weight),1/0);i=Math.pow(i,this.expLinkWeightScale),r=Math.pow(r,this.expLinkWeightScale),this.data.links.forEach(o=>o.weight=this.get_scaled_size(Math.pow(o.weight,this.expLinkWeightScale),r,i,this.minLinkWeight,this.maxLinkWeight)),this.linkedById={},this.data.links.forEach(o=>{this.linkedById[o.source]=[],this.linkedById[o.target]=[]}),this.data.links.forEach(o=>{this.linkedById[o.source].push(o.target),this.linkedById[o.target].push(o.source)})}createLinks(){this.glinks.attr("stroke",Fd).attr("stroke-opacity",1).selectAll("line").data(this.data.links).enter().append("line").attr("stroke-width",function(n){return n.weight})}createNodes(){const n=this.gnodes.selectAll(".node").data(this.data.nodes).enter().append("g").attr("class","node");n.append("circle").attr("class","node-circle").attr("r",function(e){return e.size}).attr("fill",e=>{const i=qd[this.networkName],r=i?i[e.type]:Hr;return r||Hr}).call(this.drag(this.simulation)).on("mouseover",(e,i)=>{if(this.dragActive)return;const r=i.id;this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("r",o=>{if(o.id==r)return o.size+this.nodeSizeInc;if(this.isConnected(r,o.id)){let a=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const s=this.data.links.filter(h=>h.source.id==r||h.target.id==r),l=s.reduce((h,f)=>Math.min(h,f.weight),1/0),u=s.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(a,l,u,this.minNodeSize,this.maxNodeSize)}return o.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",o=>o.source.id==r||o.target.id==r?1:this.transparency),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("font-size",o=>{if(o.id==r)return o.size+this.labelSizeInc+this.labelSizeAdd;if(this.isConnected(r,o.id)){let a=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const s=this.data.links.filter(h=>h.source.id==r||h.target.id==r),l=s.reduce((h,f)=>Math.min(h,f.weight),1/0),u=s.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(a,l,u,this.minNodeSize,this.maxNodeSize)+this.labelSizeAdd}return o.size+this.labelSizeAdd})}).on("mouseout",e=>{this.dragActive||(this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("r",function(i){return i.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",1),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("font-size",i=>i.size+this.labelSizeAdd))}),n.append("text").attr("class","node-text").text(function(e){return e.label}).attr("font-size",e=>e.size+this.labelSizeAdd).attr("font-family","sans-serif").attr("font-weight","bold").attr("text-anchor","middle").attr("alignment-baseline","middle").style("pointer-events","none")}initZoom(){const n=Ko().scaleExtent([Xd,Gd]).on("zoom",({transform:e})=>{this.gnodes.attr("transform",e),this.glinks.attr("transform",e)});this.svg.call(n)}initSimulation(){this.simulation=bc().force("link",xc().id(function(e){return e.id})).force("charge",Tc().strength(this.chargeStrength)).force("center",Jl(this.width/2,this.height/2)).force("collide",vc().radius(e=>e.size+this.collideSizeAdd));const n=()=>{this.glinks.selectAll("line").attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),this.gnodes.selectAll(".node-circle").attr("cx",e=>e.x).attr("cy",e=>e.y),this.gnodes.selectAll(".node-text").attr("x",e=>e.x+10).attr("y",e=>e.y+4).attr("dx",-9).attr("dy",".1em")};this.simulation.nodes(this.data.nodes).on("tick",n),this.simulation.force("link").links(this.data.links)}async updatePlot(n){return new Promise(e=>{this.loadData(n).then(i=>{this.networkName=n,this.deletePlot(),this.data=i,this.initData(),this.initSimulation(),this.createLinks(),this.createNodes(),this.initZoom();const r=document.querySelector(Od),o=document.querySelector(Bd),a=Hd[n];r&&o&&(r.innerHTML=a.title,o.innerHTML=a.text)}),e()})}deletePlot(){this.gnodes.selectAll("*").remove(),this.glinks.selectAll("*").remove()}}document.addEventListener("DOMContentLoaded",()=>{console.log("Loading networks..."),new Ud,console.log("Networks loaded.")});

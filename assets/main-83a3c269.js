var ai=Object.defineProperty;var ui=(t,e,n)=>e in t?ai(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var B=(t,e,n)=>(ui(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function qt(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ci(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function _n(t){let e,n,i;t.length!==2?(e=qt,n=(a,c)=>qt(t(a),c),i=(a,c)=>t(a)-c):(e=t===qt||t===ci?t:li,n=t,i=t);function r(a,c,u=0,l=a.length){if(u<l){if(e(c,c)!==0)return l;do{const h=u+l>>>1;n(a[h],c)<0?u=h+1:l=h}while(u<l)}return u}function o(a,c,u=0,l=a.length){if(u<l){if(e(c,c)!==0)return l;do{const h=u+l>>>1;n(a[h],c)<=0?u=h+1:l=h}while(u<l)}return u}function s(a,c,u=0,l=a.length){const h=r(a,c,u,l-1);return h>u&&i(a[h-1],c)>-i(a[h],c)?h-1:h}return{left:r,center:s,right:o}}function li(){return 0}function fi(t){return t===null?NaN:+t}const hi=_n(qt),di=hi.right;_n(fi).center;const gi=di,pi=Math.sqrt(50),mi=Math.sqrt(10),yi=Math.sqrt(2);function Bt(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),s=o>=pi?10:o>=mi?5:o>=yi?2:1;let a,c,u;return r<0?(u=Math.pow(10,-r)/s,a=Math.round(t*u),c=Math.round(e*u),a/u<t&&++a,c/u>e&&--c,u=-u):(u=Math.pow(10,r)*s,a=Math.round(t/u),c=Math.round(e/u),a*u<t&&++a,c*u>e&&--c),c<a&&.5<=n&&n<2?Bt(t,e,n*2):[a,c,u]}function vi(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,o,s]=i?Bt(e,t,n):Bt(t,e,n);if(!(o>=r))return[];const a=o-r+1,c=new Array(a);if(i)if(s<0)for(let u=0;u<a;++u)c[u]=(o-u)/-s;else for(let u=0;u<a;++u)c[u]=(o-u)*s;else if(s<0)for(let u=0;u<a;++u)c[u]=(r+u)/-s;else for(let u=0;u<a;++u)c[u]=(r+u)*s;return c}function fe(t,e,n){return e=+e,t=+t,n=+n,Bt(t,e,n)[2]}function _i(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?fe(e,t,n):fe(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function xi(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function wi(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}var bi={value:()=>{}};function Et(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Ot(n)}function Ot(t){this._=t}function Mi(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Ot.prototype=Et.prototype={constructor:Ot,on:function(t,e){var n=this._,i=Mi(t+"",n),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(t=i[o]).type)&&(r=Ni(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(r=(t=i[o]).type)n[r]=Ce(n[r],t.name,e);else if(e==null)for(r in n)n[r]=Ce(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ot(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};function Ni(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function Ce(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=bi,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var he="http://www.w3.org/1999/xhtml";const Le={svg:"http://www.w3.org/2000/svg",xhtml:he,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function te(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Le.hasOwnProperty(e)?{space:Le[e],local:t}:t}function Ai(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===he&&e.documentElement.namespaceURI===he?e.createElement(t):e.createElementNS(n,t)}}function ki(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function xn(t){var e=te(t);return(e.local?ki:Ai)(e)}function Ei(){}function we(t){return t==null?Ei:function(){return this.querySelector(t)}}function Si(t){typeof t!="function"&&(t=we(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],s=o.length,a=i[r]=new Array(s),c,u,l=0;l<s;++l)(c=o[l])&&(u=t.call(c,c.__data__,l,o))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new V(i,this._parents)}function zi(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ti(){return[]}function wn(t){return t==null?Ti:function(){return this.querySelectorAll(t)}}function Di(t){return function(){return zi(t.apply(this,arguments))}}function Ii(t){typeof t=="function"?t=Di(t):t=wn(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var s=e[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(i.push(t.call(c,c.__data__,u,s)),r.push(c));return new V(i,r)}function bn(t){return function(){return this.matches(t)}}function Mn(t){return function(e){return e.matches(t)}}var $i=Array.prototype.find;function Ci(t){return function(){return $i.call(this.children,t)}}function Li(){return this.firstElementChild}function Pi(t){return this.select(t==null?Li:Ci(typeof t=="function"?t:Mn(t)))}var Ri=Array.prototype.filter;function qi(){return Array.from(this.children)}function Oi(t){return function(){return Ri.call(this.children,t)}}function Fi(t){return this.selectAll(t==null?qi:Oi(typeof t=="function"?t:Mn(t)))}function Xi(t){typeof t!="function"&&(t=bn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],s=o.length,a=i[r]=[],c,u=0;u<s;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&a.push(c);return new V(i,this._parents)}function Nn(t){return new Array(t.length)}function Hi(){return new V(this._enter||this._groups.map(Nn),this._parents)}function Yt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Yt.prototype={constructor:Yt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Bi(t){return function(){return t}}function Yi(t,e,n,i,r,o){for(var s=0,a,c=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new Yt(t,o[s]);for(;s<c;++s)(a=e[s])&&(r[s]=a)}function Vi(t,e,n,i,r,o,s){var a,c,u=new Map,l=e.length,h=o.length,f=new Array(l),d;for(a=0;a<l;++a)(c=e[a])&&(f[a]=d=s.call(c,c.__data__,a,e)+"",u.has(d)?r[a]=c:u.set(d,c));for(a=0;a<h;++a)d=s.call(t,o[a],a,o)+"",(c=u.get(d))?(i[a]=c,c.__data__=o[a],u.delete(d)):n[a]=new Yt(t,o[a]);for(a=0;a<l;++a)(c=e[a])&&u.get(f[a])===c&&(r[a]=c)}function Ki(t){return t.__data__}function Ui(t,e){if(!arguments.length)return Array.from(this,Ki);var n=e?Vi:Yi,i=this._parents,r=this._groups;typeof t!="function"&&(t=Bi(t));for(var o=r.length,s=new Array(o),a=new Array(o),c=new Array(o),u=0;u<o;++u){var l=i[u],h=r[u],f=h.length,d=Wi(t.call(l,l&&l.__data__,u,i)),_=d.length,v=a[u]=new Array(_),y=s[u]=new Array(_),g=c[u]=new Array(f);n(l,h,v,y,g,d,e);for(var w=0,M=0,m,b;w<_;++w)if(m=v[w]){for(w>=M&&(M=w+1);!(b=y[M])&&++M<_;);m._next=b||null}}return s=new V(s,i),s._enter=a,s._exit=c,s}function Wi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Gi(){return new V(this._exit||this._groups.map(Nn),this._parents)}function Zi(t,e,n){var i=this.enter(),r=this,o=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function Qi(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),c=0;c<s;++c)for(var u=n[c],l=i[c],h=u.length,f=a[c]=new Array(h),d,_=0;_<h;++_)(d=u[_]||l[_])&&(f[_]=d);for(;c<r;++c)a[c]=n[c];return new V(a,this._parents)}function ji(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Ji(t){t||(t=tr);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s=n[o],a=s.length,c=r[o]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(e)}return new V(r,this._parents).order()}function tr(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function er(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function nr(){return Array.from(this)}function ir(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function rr(){let t=0;for(const e of this)++t;return t}function or(){return!this.node()}function sr(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],o=0,s=r.length,a;o<s;++o)(a=r[o])&&t.call(a,a.__data__,o,r);return this}function ar(t){return function(){this.removeAttribute(t)}}function ur(t){return function(){this.removeAttributeNS(t.space,t.local)}}function cr(t,e){return function(){this.setAttribute(t,e)}}function lr(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function fr(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function hr(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function dr(t,e){var n=te(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?ur:ar:typeof e=="function"?n.local?hr:fr:n.local?lr:cr)(n,e))}function An(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gr(t){return function(){this.style.removeProperty(t)}}function pr(t,e,n){return function(){this.style.setProperty(t,e,n)}}function mr(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function yr(t,e,n){return arguments.length>1?this.each((e==null?gr:typeof e=="function"?mr:pr)(t,e,n??"")):pt(this.node(),t)}function pt(t,e){return t.style.getPropertyValue(e)||An(t).getComputedStyle(t,null).getPropertyValue(e)}function vr(t){return function(){delete this[t]}}function _r(t,e){return function(){this[t]=e}}function xr(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function wr(t,e){return arguments.length>1?this.each((e==null?vr:typeof e=="function"?xr:_r)(t,e)):this.node()[t]}function kn(t){return t.trim().split(/^|\s+/)}function be(t){return t.classList||new En(t)}function En(t){this._node=t,this._names=kn(t.getAttribute("class")||"")}En.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Sn(t,e){for(var n=be(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function zn(t,e){for(var n=be(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function br(t){return function(){Sn(this,t)}}function Mr(t){return function(){zn(this,t)}}function Nr(t,e){return function(){(e.apply(this,arguments)?Sn:zn)(this,t)}}function Ar(t,e){var n=kn(t+"");if(arguments.length<2){for(var i=be(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Nr:e?br:Mr)(n,e))}function kr(){this.textContent=""}function Er(t){return function(){this.textContent=t}}function Sr(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function zr(t){return arguments.length?this.each(t==null?kr:(typeof t=="function"?Sr:Er)(t)):this.node().textContent}function Tr(){this.innerHTML=""}function Dr(t){return function(){this.innerHTML=t}}function Ir(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function $r(t){return arguments.length?this.each(t==null?Tr:(typeof t=="function"?Ir:Dr)(t)):this.node().innerHTML}function Cr(){this.nextSibling&&this.parentNode.appendChild(this)}function Lr(){return this.each(Cr)}function Pr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Rr(){return this.each(Pr)}function qr(t){var e=typeof t=="function"?t:xn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Or(){return null}function Fr(t,e){var n=typeof t=="function"?t:xn(t),i=e==null?Or:typeof e=="function"?e:we(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Xr(){var t=this.parentNode;t&&t.removeChild(this)}function Hr(){return this.each(Xr)}function Br(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Yr(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Vr(t){return this.select(t?Yr:Br)}function Kr(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ur(t){return function(e){t.call(this,e,this.__data__)}}function Wr(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Gr(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,o;n<r;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++i]=o;++i?e.length=i:delete this.__on}}}function Zr(t,e,n){return function(){var i=this.__on,r,o=Ur(e);if(i){for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=e;return}}this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function Qr(t,e,n){var i=Wr(t+""),r,o=i.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(r=0,l=a[c];r<o;++r)if((s=i[r]).type===l.type&&s.name===l.name)return l.value}return}for(a=e?Zr:Gr,r=0;r<o;++r)this.each(a(i[r],e,n));return this}function Tn(t,e,n){var i=An(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function jr(t,e){return function(){return Tn(this,t,e)}}function Jr(t,e){return function(){return Tn(this,t,e.apply(this,arguments))}}function to(t,e){return this.each((typeof e=="function"?Jr:jr)(t,e))}function*eo(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var Dn=[null];function V(t,e){this._groups=t,this._parents=e}function St(){return new V([[document.documentElement]],Dn)}function no(){return this}V.prototype=St.prototype={constructor:V,select:Si,selectAll:Ii,selectChild:Pi,selectChildren:Fi,filter:Xi,data:Ui,enter:Hi,exit:Gi,join:Zi,merge:Qi,selection:no,order:ji,sort:Ji,call:er,nodes:nr,node:ir,size:rr,empty:or,each:sr,attr:dr,style:yr,property:wr,classed:Ar,text:zr,html:$r,raise:Lr,lower:Rr,append:qr,insert:Fr,remove:Hr,clone:Vr,datum:Kr,on:Qr,dispatch:to,[Symbol.iterator]:eo};function Y(t){return typeof t=="string"?new V([[document.querySelector(t)]],[document.documentElement]):new V([[t]],Dn)}function io(t){let e;for(;e=t.sourceEvent;)t=e;return t}function rt(t,e){if(t=io(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const ro={passive:!1},Mt={capture:!0,passive:!1};function re(t){t.stopImmediatePropagation()}function dt(t){t.preventDefault(),t.stopImmediatePropagation()}function In(t){var e=t.document.documentElement,n=Y(t).on("dragstart.drag",dt,Mt);"onselectstart"in e?n.on("selectstart.drag",dt,Mt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function $n(t,e){var n=t.document.documentElement,i=Y(t).on("dragstart.drag",null);e&&(i.on("click.drag",dt,Mt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Tt=t=>()=>t;function de(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:o,x:s,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}de.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function oo(t){return!t.ctrlKey&&!t.button}function so(){return this.parentNode}function ao(t,e){return e??{x:t.x,y:t.y}}function uo(){return navigator.maxTouchPoints||"ontouchstart"in this}function co(){var t=oo,e=so,n=ao,i=uo,r={},o=Et("start","drag","end"),s=0,a,c,u,l,h=0;function f(m){m.on("mousedown.drag",d).filter(i).on("touchstart.drag",y).on("touchmove.drag",g,ro).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(m,b){if(!(l||!t.call(this,m,b))){var E=M(this,e.call(this,m,b),m,b,"mouse");E&&(Y(m.view).on("mousemove.drag",_,Mt).on("mouseup.drag",v,Mt),In(m.view),re(m),u=!1,a=m.clientX,c=m.clientY,E("start",m))}}function _(m){if(dt(m),!u){var b=m.clientX-a,E=m.clientY-c;u=b*b+E*E>h}r.mouse("drag",m)}function v(m){Y(m.view).on("mousemove.drag mouseup.drag",null),$n(m.view,u),dt(m),r.mouse("end",m)}function y(m,b){if(t.call(this,m,b)){var E=m.changedTouches,T=e.call(this,m,b),D=E.length,C,$;for(C=0;C<D;++C)($=M(this,T,m,b,E[C].identifier,E[C]))&&(re(m),$("start",m,E[C]))}}function g(m){var b=m.changedTouches,E=b.length,T,D;for(T=0;T<E;++T)(D=r[b[T].identifier])&&(dt(m),D("drag",m,b[T]))}function w(m){var b=m.changedTouches,E=b.length,T,D;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),T=0;T<E;++T)(D=r[b[T].identifier])&&(re(m),D("end",m,b[T]))}function M(m,b,E,T,D,C){var $=o.copy(),k=rt(C||E,b),R,L,p;if((p=n.call(m,new de("beforestart",{sourceEvent:E,target:f,identifier:D,active:s,x:k[0],y:k[1],dx:0,dy:0,dispatch:$}),T))!=null)return R=p.x-k[0]||0,L=p.y-k[1]||0,function N(x,A,z){var S=k,I;switch(x){case"start":r[D]=N,I=s++;break;case"end":delete r[D],--s;case"drag":k=rt(z||A,b),I=s;break}$.call(x,m,new de(x,{sourceEvent:A,subject:p,target:f,identifier:D,active:I,x:k[0]+R,y:k[1]+L,dx:k[0]-S[0],dy:k[1]-S[1],dispatch:$}),T)}}return f.filter=function(m){return arguments.length?(t=typeof m=="function"?m:Tt(!!m),f):t},f.container=function(m){return arguments.length?(e=typeof m=="function"?m:Tt(m),f):e},f.subject=function(m){return arguments.length?(n=typeof m=="function"?m:Tt(m),f):n},f.touchable=function(m){return arguments.length?(i=typeof m=="function"?m:Tt(!!m),f):i},f.on=function(){var m=o.on.apply(o,arguments);return m===o?f:m},f.clickDistance=function(m){return arguments.length?(h=(m=+m)*m,f):Math.sqrt(h)},f}function Me(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Cn(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function zt(){}var Nt=.7,Vt=1/Nt,gt="\\s*([+-]?\\d+)\\s*",At="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",J="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lo=/^#([0-9a-f]{3,8})$/,fo=new RegExp(`^rgb\\(${gt},${gt},${gt}\\)$`),ho=new RegExp(`^rgb\\(${J},${J},${J}\\)$`),go=new RegExp(`^rgba\\(${gt},${gt},${gt},${At}\\)$`),po=new RegExp(`^rgba\\(${J},${J},${J},${At}\\)$`),mo=new RegExp(`^hsl\\(${At},${J},${J}\\)$`),yo=new RegExp(`^hsla\\(${At},${J},${J},${At}\\)$`),Pe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Me(zt,ft,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Re,formatHex:Re,formatHex8:vo,formatHsl:_o,formatRgb:qe,toString:qe});function Re(){return this.rgb().formatHex()}function vo(){return this.rgb().formatHex8()}function _o(){return Ln(this).formatHsl()}function qe(){return this.rgb().formatRgb()}function ft(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=lo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Oe(e):n===3?new H(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Dt(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Dt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=fo.exec(t))?new H(e[1],e[2],e[3],1):(e=ho.exec(t))?new H(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=go.exec(t))?Dt(e[1],e[2],e[3],e[4]):(e=po.exec(t))?Dt(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=mo.exec(t))?He(e[1],e[2]/100,e[3]/100,1):(e=yo.exec(t))?He(e[1],e[2]/100,e[3]/100,e[4]):Pe.hasOwnProperty(t)?Oe(Pe[t]):t==="transparent"?new H(NaN,NaN,NaN,0):null}function Oe(t){return new H(t>>16&255,t>>8&255,t&255,1)}function Dt(t,e,n,i){return i<=0&&(t=e=n=NaN),new H(t,e,n,i)}function xo(t){return t instanceof zt||(t=ft(t)),t?(t=t.rgb(),new H(t.r,t.g,t.b,t.opacity)):new H}function ge(t,e,n,i){return arguments.length===1?xo(t):new H(t,e,n,i??1)}function H(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}Me(H,ge,Cn(zt,{brighter(t){return t=t==null?Vt:Math.pow(Vt,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Nt:Math.pow(Nt,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new H(ct(this.r),ct(this.g),ct(this.b),Kt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Fe,formatHex:Fe,formatHex8:wo,formatRgb:Xe,toString:Xe}));function Fe(){return`#${ut(this.r)}${ut(this.g)}${ut(this.b)}`}function wo(){return`#${ut(this.r)}${ut(this.g)}${ut(this.b)}${ut((isNaN(this.opacity)?1:this.opacity)*255)}`}function Xe(){const t=Kt(this.opacity);return`${t===1?"rgb(":"rgba("}${ct(this.r)}, ${ct(this.g)}, ${ct(this.b)}${t===1?")":`, ${t})`}`}function Kt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ct(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ut(t){return t=ct(t),(t<16?"0":"")+t.toString(16)}function He(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new G(t,e,n,i)}function Ln(t){if(t instanceof G)return new G(t.h,t.s,t.l,t.opacity);if(t instanceof zt||(t=ft(t)),!t)return new G;if(t instanceof G)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,c=(o+r)/2;return a?(e===o?s=(n-i)/a+(n<i)*6:n===o?s=(i-e)/a+2:s=(e-n)/a+4,a/=c<.5?o+r:2-o-r,s*=60):a=c>0&&c<1?0:s,new G(s,a,c,t.opacity)}function bo(t,e,n,i){return arguments.length===1?Ln(t):new G(t,e,n,i??1)}function G(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Me(G,bo,Cn(zt,{brighter(t){return t=t==null?Vt:Math.pow(Vt,t),new G(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Nt:Math.pow(Nt,t),new G(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new H(oe(t>=240?t-240:t+120,r,i),oe(t,r,i),oe(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new G(Be(this.h),It(this.s),It(this.l),Kt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Kt(this.opacity);return`${t===1?"hsl(":"hsla("}${Be(this.h)}, ${It(this.s)*100}%, ${It(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Be(t){return t=(t||0)%360,t<0?t+360:t}function It(t){return Math.max(0,Math.min(1,t||0))}function oe(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Ne=t=>()=>t;function Mo(t,e){return function(n){return t+n*e}}function No(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Ao(t){return(t=+t)==1?Pn:function(e,n){return n-e?No(e,n,t):Ne(isNaN(e)?n:e)}}function Pn(t,e){var n=e-t;return n?Mo(t,n):Ne(isNaN(t)?e:t)}const Ut=function t(e){var n=Ao(e);function i(r,o){var s=n((r=ge(r)).r,(o=ge(o)).r),a=n(r.g,o.g),c=n(r.b,o.b),u=Pn(r.opacity,o.opacity);return function(l){return r.r=s(l),r.g=a(l),r.b=c(l),r.opacity=u(l),r+""}}return i.gamma=t,i}(1);function ko(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function Eo(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function So(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),o=new Array(n),s;for(s=0;s<i;++s)r[s]=Ae(t[s],e[s]);for(;s<n;++s)o[s]=e[s];return function(a){for(s=0;s<i;++s)o[s]=r[s](a);return o}}function zo(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function W(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function To(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=Ae(t[r],e[r]):i[r]=e[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var pe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,se=new RegExp(pe.source,"g");function Do(t){return function(){return t}}function Io(t){return function(e){return t(e)+""}}function Rn(t,e){var n=pe.lastIndex=se.lastIndex=0,i,r,o,s=-1,a=[],c=[];for(t=t+"",e=e+"";(i=pe.exec(t))&&(r=se.exec(e));)(o=r.index)>n&&(o=e.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(i=i[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,c.push({i:s,x:W(i,r)})),n=se.lastIndex;return n<e.length&&(o=e.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?c[0]?Io(c[0].x):Do(e):(e=c.length,function(u){for(var l=0,h;l<e;++l)a[(h=c[l]).i]=h.x(u);return a.join("")})}function Ae(t,e){var n=typeof e,i;return e==null||n==="boolean"?Ne(e):(n==="number"?W:n==="string"?(i=ft(e))?(e=i,Ut):Rn:e instanceof ft?Ut:e instanceof Date?zo:Eo(e)?ko:Array.isArray(e)?So:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?To:W)(t,e)}function $o(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Ye=180/Math.PI,me={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qn(t,e,n,i,r,o){var s,a,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*n+e*i)&&(n-=t*c,i-=e*c),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,c/=a),t*i<e*n&&(t=-t,e=-e,c=-c,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*Ye,skewX:Math.atan(c)*Ye,scaleX:s,scaleY:a}}var $t;function Co(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?me:qn(e.a,e.b,e.c,e.d,e.e,e.f)}function Lo(t){return t==null||($t||($t=document.createElementNS("http://www.w3.org/2000/svg","g")),$t.setAttribute("transform",t),!(t=$t.transform.baseVal.consolidate()))?me:(t=t.matrix,qn(t.a,t.b,t.c,t.d,t.e,t.f))}function On(t,e,n,i){function r(u){return u.length?u.pop()+" ":""}function o(u,l,h,f,d,_){if(u!==h||l!==f){var v=d.push("translate(",null,e,null,n);_.push({i:v-4,x:W(u,h)},{i:v-2,x:W(l,f)})}else(h||f)&&d.push("translate("+h+e+f+n)}function s(u,l,h,f){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),f.push({i:h.push(r(h)+"rotate(",null,i)-2,x:W(u,l)})):l&&h.push(r(h)+"rotate("+l+i)}function a(u,l,h,f){u!==l?f.push({i:h.push(r(h)+"skewX(",null,i)-2,x:W(u,l)}):l&&h.push(r(h)+"skewX("+l+i)}function c(u,l,h,f,d,_){if(u!==h||l!==f){var v=d.push(r(d)+"scale(",null,",",null,")");_.push({i:v-4,x:W(u,h)},{i:v-2,x:W(l,f)})}else(h!==1||f!==1)&&d.push(r(d)+"scale("+h+","+f+")")}return function(u,l){var h=[],f=[];return u=t(u),l=t(l),o(u.translateX,u.translateY,l.translateX,l.translateY,h,f),s(u.rotate,l.rotate,h,f),a(u.skewX,l.skewX,h,f),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,h,f),u=l=null,function(d){for(var _=-1,v=f.length,y;++_<v;)h[(y=f[_]).i]=y.x(d);return h.join("")}}}var Po=On(Co,"px, ","px)","deg)"),Ro=On(Lo,", ",")",")"),qo=1e-12;function Ve(t){return((t=Math.exp(t))+1/t)/2}function Oo(t){return((t=Math.exp(t))-1/t)/2}function Fo(t){return((t=Math.exp(2*t))-1)/(t+1)}const Fn=function t(e,n,i){function r(o,s){var a=o[0],c=o[1],u=o[2],l=s[0],h=s[1],f=s[2],d=l-a,_=h-c,v=d*d+_*_,y,g;if(v<qo)g=Math.log(f/u)/e,y=function(T){return[a+T*d,c+T*_,u*Math.exp(e*T*g)]};else{var w=Math.sqrt(v),M=(f*f-u*u+i*v)/(2*u*n*w),m=(f*f-u*u-i*v)/(2*f*n*w),b=Math.log(Math.sqrt(M*M+1)-M),E=Math.log(Math.sqrt(m*m+1)-m);g=(E-b)/e,y=function(T){var D=T*g,C=Ve(b),$=u/(n*w)*(C*Fo(e*D+b)-Oo(b));return[a+$*d,c+$*_,u*C/Ve(e*D+b)]}}return y.duration=g*1e3*e/Math.SQRT2,y}return r.rho=function(o){var s=Math.max(.001,+o),a=s*s,c=a*a;return t(s,a,c)},r}(Math.SQRT2,2,4);var mt=0,xt=0,vt=0,Xn=1e3,Wt,wt,Gt=0,ht=0,ee=0,kt=typeof performance=="object"&&performance.now?performance:Date,Hn=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ke(){return ht||(Hn(Xo),ht=kt.now()+ee)}function Xo(){ht=0}function Zt(){this._call=this._time=this._next=null}Zt.prototype=Ee.prototype={constructor:Zt,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?ke():+n)+(e==null?0:+e),!this._next&&wt!==this&&(wt?wt._next=this:Wt=this,wt=this),this._call=t,this._time=n,ye()},stop:function(){this._call&&(this._call=null,this._time=1/0,ye())}};function Ee(t,e,n){var i=new Zt;return i.restart(t,e,n),i}function Ho(){ke(),++mt;for(var t=Wt,e;t;)(e=ht-t._time)>=0&&t._call.call(void 0,e),t=t._next;--mt}function Ke(){ht=(Gt=kt.now())+ee,mt=xt=0;try{Ho()}finally{mt=0,Yo(),ht=0}}function Bo(){var t=kt.now(),e=t-Gt;e>Xn&&(ee-=e,Gt=t)}function Yo(){for(var t,e=Wt,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Wt=n);wt=t,ye(i)}function ye(t){if(!mt){xt&&(xt=clearTimeout(xt));var e=t-ht;e>24?(t<1/0&&(xt=setTimeout(Ke,t-kt.now()-ee)),vt&&(vt=clearInterval(vt))):(vt||(Gt=kt.now(),vt=setInterval(Bo,Xn)),mt=1,Hn(Ke))}}function Ue(t,e,n){var i=new Zt;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var Vo=Et("start","end","cancel","interrupt"),Ko=[],Bn=0,We=1,ve=2,Ft=3,Ge=4,_e=5,Xt=6;function ne(t,e,n,i,r,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Uo(t,n,{name:e,index:i,group:r,on:Vo,tween:Ko,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Bn})}function Se(t,e){var n=Z(t,e);if(n.state>Bn)throw new Error("too late; already scheduled");return n}function tt(t,e){var n=Z(t,e);if(n.state>Ft)throw new Error("too late; already running");return n}function Z(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Uo(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=Ee(o,0,n.time);function o(u){n.state=We,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var l,h,f,d;if(n.state!==We)return c();for(l in i)if(d=i[l],d.name===n.name){if(d.state===Ft)return Ue(s);d.state===Ge?(d.state=Xt,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[l]):+l<e&&(d.state=Xt,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[l])}if(Ue(function(){n.state===Ft&&(n.state=Ge,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=ve,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ve){for(n.state=Ft,r=new Array(f=n.tween.length),l=0,h=-1;l<f;++l)(d=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++h]=d);r.length=h+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=_e,1),h=-1,f=r.length;++h<f;)r[h].call(t,l);n.state===_e&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Xt,n.timer.stop(),delete i[e];for(var u in i)return;delete t.__transition}}function Ht(t,e){var n=t.__transition,i,r,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((i=n[s]).name!==e){o=!1;continue}r=i.state>ve&&i.state<_e,i.state=Xt,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[s]}o&&delete t.__transition}}function Wo(t){return this.each(function(){Ht(this,t)})}function Go(t,e){var n,i;return function(){var r=tt(this,t),o=r.tween;if(o!==n){i=n=o;for(var s=0,a=i.length;s<a;++s)if(i[s].name===e){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function Zo(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=tt(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:e,value:n},c=0,u=r.length;c<u;++c)if(r[c].name===e){r[c]=a;break}c===u&&r.push(a)}o.tween=r}}function Qo(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Z(this.node(),n).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===t)return s.value;return null}return this.each((e==null?Go:Zo)(n,t,e))}function ze(t,e,n){var i=t._id;return t.each(function(){var r=tt(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Z(r,i).value[e]}}function Yn(t,e){var n;return(typeof e=="number"?W:e instanceof ft?Ut:(n=ft(e))?(e=n,Ut):Rn)(t,e)}function jo(t){return function(){this.removeAttribute(t)}}function Jo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ts(t,e,n){var i,r=n+"",o;return function(){var s=this.getAttribute(t);return s===r?null:s===i?o:o=e(i=s,n)}}function es(t,e,n){var i,r=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?o:o=e(i=s,n)}}function ns(t,e,n){var i,r,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=a+"",s===c?null:s===i&&c===r?o:(r=c,o=e(i=s,a)))}}function is(t,e,n){var i,r,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=a+"",s===c?null:s===i&&c===r?o:(r=c,o=e(i=s,a)))}}function rs(t,e){var n=te(t),i=n==="transform"?Ro:Yn;return this.attrTween(t,typeof e=="function"?(n.local?is:ns)(n,i,ze(this,"attr."+t,e)):e==null?(n.local?Jo:jo)(n):(n.local?es:ts)(n,i,e))}function os(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ss(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function as(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&ss(t,o)),n}return r._value=e,r}function us(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&os(t,o)),n}return r._value=e,r}function cs(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=te(t);return this.tween(n,(i.local?as:us)(i,e))}function ls(t,e){return function(){Se(this,t).delay=+e.apply(this,arguments)}}function fs(t,e){return e=+e,function(){Se(this,t).delay=e}}function hs(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ls:fs)(e,t)):Z(this.node(),e).delay}function ds(t,e){return function(){tt(this,t).duration=+e.apply(this,arguments)}}function gs(t,e){return e=+e,function(){tt(this,t).duration=e}}function ps(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ds:gs)(e,t)):Z(this.node(),e).duration}function ms(t,e){if(typeof e!="function")throw new Error;return function(){tt(this,t).ease=e}}function ys(t){var e=this._id;return arguments.length?this.each(ms(e,t)):Z(this.node(),e).ease}function vs(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;tt(this,t).ease=n}}function _s(t){if(typeof t!="function")throw new Error;return this.each(vs(this._id,t))}function xs(t){typeof t!="function"&&(t=bn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],s=o.length,a=i[r]=[],c,u=0;u<s;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&a.push(c);return new st(i,this._parents,this._name,this._id)}function ws(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var c=e[a],u=n[a],l=c.length,h=s[a]=new Array(l),f,d=0;d<l;++d)(f=c[d]||u[d])&&(h[d]=f);for(;a<i;++a)s[a]=e[a];return new st(s,this._parents,this._name,this._id)}function bs(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Ms(t,e,n){var i,r,o=bs(e)?Se:tt;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(e,n),s.on=r}}function Ns(t,e){var n=this._id;return arguments.length<2?Z(this.node(),n).on.on(t):this.each(Ms(n,t,e))}function As(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function ks(){return this.on("end.remove",As(this._id))}function Es(t){var e=this._name,n=this._id;typeof t!="function"&&(t=we(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a=i[s],c=a.length,u=o[s]=new Array(c),l,h,f=0;f<c;++f)(l=a[f])&&(h=t.call(l,l.__data__,f,a))&&("__data__"in l&&(h.__data__=l.__data__),u[f]=h,ne(u[f],e,n,f,u,Z(l,n)));return new st(o,this._parents,e,n)}function Ss(t){var e=this._name,n=this._id;typeof t!="function"&&(t=wn(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var c=i[a],u=c.length,l,h=0;h<u;++h)if(l=c[h]){for(var f=t.call(l,l.__data__,h,c),d,_=Z(l,n),v=0,y=f.length;v<y;++v)(d=f[v])&&ne(d,e,n,v,f,_);o.push(f),s.push(l)}return new st(o,s,e,n)}var zs=St.prototype.constructor;function Ts(){return new zs(this._groups,this._parents)}function Ds(t,e){var n,i,r;return function(){var o=pt(this,t),s=(this.style.removeProperty(t),pt(this,t));return o===s?null:o===n&&s===i?r:r=e(n=o,i=s)}}function Vn(t){return function(){this.style.removeProperty(t)}}function Is(t,e,n){var i,r=n+"",o;return function(){var s=pt(this,t);return s===r?null:s===i?o:o=e(i=s,n)}}function $s(t,e,n){var i,r,o;return function(){var s=pt(this,t),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),pt(this,t))),s===c?null:s===i&&c===r?o:(r=c,o=e(i=s,a))}}function Cs(t,e){var n,i,r,o="style."+e,s="end."+o,a;return function(){var c=tt(this,t),u=c.on,l=c.value[o]==null?a||(a=Vn(e)):void 0;(u!==n||r!==l)&&(i=(n=u).copy()).on(s,r=l),c.on=i}}function Ls(t,e,n){var i=(t+="")=="transform"?Po:Yn;return e==null?this.styleTween(t,Ds(t,i)).on("end.style."+t,Vn(t)):typeof e=="function"?this.styleTween(t,$s(t,i,ze(this,"style."+t,e))).each(Cs(this._id,t)):this.styleTween(t,Is(t,i,e),n).on("end.style."+t,null)}function Ps(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function Rs(t,e,n){var i,r;function o(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&Ps(t,s,n)),i}return o._value=e,o}function qs(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,Rs(t,e,n??""))}function Os(t){return function(){this.textContent=t}}function Fs(t){return function(){var e=t(this);this.textContent=e??""}}function Xs(t){return this.tween("text",typeof t=="function"?Fs(ze(this,"text",t)):Os(t==null?"":t+""))}function Hs(t){return function(e){this.textContent=t.call(this,e)}}function Bs(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Hs(r)),e}return i._value=t,i}function Ys(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Bs(t))}function Vs(){for(var t=this._name,e=this._id,n=Kn(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=Z(c,e);ne(c,t,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new st(i,this._parents,t,n)}function Ks(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var a={value:s},c={value:function(){--r===0&&o()}};n.each(function(){var u=tt(this,i),l=u.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),u.on=e}),r===0&&o()})}var Us=0;function st(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Kn(){return++Us}var it=St.prototype;st.prototype={constructor:st,select:Es,selectAll:Ss,selectChild:it.selectChild,selectChildren:it.selectChildren,filter:xs,merge:ws,selection:Ts,transition:Vs,call:it.call,nodes:it.nodes,node:it.node,size:it.size,empty:it.empty,each:it.each,on:Ns,attr:rs,attrTween:cs,style:Ls,styleTween:qs,text:Xs,textTween:Ys,remove:ks,tween:Qo,delay:hs,duration:ps,ease:ys,easeVarying:_s,end:Ks,[Symbol.iterator]:it[Symbol.iterator]};function Ws(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Gs={time:null,delay:0,duration:250,ease:Ws};function Zs(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Qs(t){var e,n;t instanceof st?(e=t._id,t=t._name):(e=Kn(),(n=Gs).time=ke(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&ne(c,t,e,u,s,n||Zs(c,e));return new st(i,this._parents,t,e)}St.prototype.interrupt=Wo;St.prototype.transition=Qs;function js(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function Un(t,e){return fetch(t,e).then(js)}function Js(t,e){var n,i=1;t==null&&(t=0),e==null&&(e=0);function r(){var o,s=n.length,a,c=0,u=0;for(o=0;o<s;++o)a=n[o],c+=a.x,u+=a.y;for(c=(c/s-t)*i,u=(u/s-e)*i,o=0;o<s;++o)a=n[o],a.x-=c,a.y-=u}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(t=+o,r):t},r.y=function(o){return arguments.length?(e=+o,r):e},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function ta(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Wn(this.cover(e,n),e,n,t)}function Wn(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o=t._root,s={data:i},a=t._x0,c=t._y0,u=t._x1,l=t._y1,h,f,d,_,v,y,g,w;if(!o)return t._root=s,t;for(;o.length;)if((v=e>=(h=(a+u)/2))?a=h:u=h,(y=n>=(f=(c+l)/2))?c=f:l=f,r=o,!(o=o[g=y<<1|v]))return r[g]=s,t;if(d=+t._x.call(null,o.data),_=+t._y.call(null,o.data),e===d&&n===_)return s.next=o,r?r[g]=s:t._root=s,t;do r=r?r[g]=new Array(4):t._root=new Array(4),(v=e>=(h=(a+u)/2))?a=h:u=h,(y=n>=(f=(c+l)/2))?c=f:l=f;while((g=y<<1|v)===(w=(_>=f)<<1|d>=h));return r[w]=o,r[g]=s,t}function ea(t){var e,n,i=t.length,r,o,s=new Array(i),a=new Array(i),c=1/0,u=1/0,l=-1/0,h=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(s[n]=r,a[n]=o,r<c&&(c=r),r>l&&(l=r),o<u&&(u=o),o>h&&(h=o));if(c>l||u>h)return this;for(this.cover(c,u).cover(l,h),n=0;n<i;++n)Wn(this,s[n],a[n],t[n]);return this}function na(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{for(var s=r-n||1,a=this._root,c,u;n>t||t>=r||i>e||e>=o;)switch(u=(e<i)<<1|t<n,c=new Array(4),c[u]=a,a=c,s*=2,u){case 0:r=n+s,o=i+s;break;case 1:n=r-s,o=i+s;break;case 2:r=n+s,i=o-s;break;case 3:n=r-s,i=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function ia(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function ra(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function F(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function oa(t,e,n){var i,r=this._x0,o=this._y0,s,a,c,u,l=this._x1,h=this._y1,f=[],d=this._root,_,v;for(d&&f.push(new F(d,r,o,l,h)),n==null?n=1/0:(r=t-n,o=e-n,l=t+n,h=e+n,n*=n);_=f.pop();)if(!(!(d=_.node)||(s=_.x0)>l||(a=_.y0)>h||(c=_.x1)<r||(u=_.y1)<o))if(d.length){var y=(s+c)/2,g=(a+u)/2;f.push(new F(d[3],y,g,c,u),new F(d[2],s,g,y,u),new F(d[1],y,a,c,g),new F(d[0],s,a,y,g)),(v=(e>=g)<<1|t>=y)&&(_=f[f.length-1],f[f.length-1]=f[f.length-1-v],f[f.length-1-v]=_)}else{var w=t-+this._x.call(null,d.data),M=e-+this._y.call(null,d.data),m=w*w+M*M;if(m<n){var b=Math.sqrt(n=m);r=t-b,o=e-b,l=t+b,h=e+b,i=d.data}}return i}function sa(t){if(isNaN(l=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,n=this._root,i,r,o,s=this._x0,a=this._y0,c=this._x1,u=this._y1,l,h,f,d,_,v,y,g;if(!n)return this;if(n.length)for(;;){if((_=l>=(f=(s+c)/2))?s=f:c=f,(v=h>=(d=(a+u)/2))?a=d:u=d,e=n,!(n=n[y=v<<1|_]))return this;if(!n.length)break;(e[y+1&3]||e[y+2&3]||e[y+3&3])&&(i=e,g=y)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):e?(o?e[y]=o:delete e[y],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[g]=n:this._root=n),this):(this._root=o,this)}function aa(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function ua(){return this._root}function ca(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function la(t){var e=[],n,i=this._root,r,o,s,a,c;for(i&&e.push(new F(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,o=n.x0,s=n.y0,a=n.x1,c=n.y1)&&i.length){var u=(o+a)/2,l=(s+c)/2;(r=i[3])&&e.push(new F(r,u,l,a,c)),(r=i[2])&&e.push(new F(r,o,l,u,c)),(r=i[1])&&e.push(new F(r,u,s,a,l)),(r=i[0])&&e.push(new F(r,o,s,u,l))}return this}function fa(t){var e=[],n=[],i;for(this._root&&e.push(new F(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var o,s=i.x0,a=i.y0,c=i.x1,u=i.y1,l=(s+c)/2,h=(a+u)/2;(o=r[0])&&e.push(new F(o,s,a,l,h)),(o=r[1])&&e.push(new F(o,l,a,c,h)),(o=r[2])&&e.push(new F(o,s,h,l,u)),(o=r[3])&&e.push(new F(o,l,h,c,u))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function ha(t){return t[0]}function da(t){return arguments.length?(this._x=t,this):this._x}function ga(t){return t[1]}function pa(t){return arguments.length?(this._y=t,this):this._y}function Te(t,e,n){var i=new De(e??ha,n??ga,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function De(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Ze(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var X=Te.prototype=De.prototype;X.copy=function(){var t=new De(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=Ze(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=Ze(i));return t};X.add=ta;X.addAll=ea;X.cover=na;X.data=ia;X.extent=ra;X.find=oa;X.remove=sa;X.removeAll=aa;X.root=ua;X.size=ca;X.visit=la;X.visitAfter=fa;X.x=da;X.y=pa;function lt(t){return function(){return t}}function at(t){return(t()-.5)*1e-6}function ma(t){return t.x+t.vx}function ya(t){return t.y+t.vy}function va(t){var e,n,i,r=1,o=1;typeof t!="function"&&(t=lt(t==null?1:+t));function s(){for(var u,l=e.length,h,f,d,_,v,y,g=0;g<o;++g)for(h=Te(e,ma,ya).visitAfter(a),u=0;u<l;++u)f=e[u],v=n[f.index],y=v*v,d=f.x+f.vx,_=f.y+f.vy,h.visit(w);function w(M,m,b,E,T){var D=M.data,C=M.r,$=v+C;if(D){if(D.index>f.index){var k=d-D.x-D.vx,R=_-D.y-D.vy,L=k*k+R*R;L<$*$&&(k===0&&(k=at(i),L+=k*k),R===0&&(R=at(i),L+=R*R),L=($-(L=Math.sqrt(L)))/L*r,f.vx+=(k*=L)*($=(C*=C)/(y+C)),f.vy+=(R*=L)*$,D.vx-=k*($=1-$),D.vy-=R*$)}return}return m>d+$||E<d-$||b>_+$||T<_-$}}function a(u){if(u.data)return u.r=n[u.data.index];for(var l=u.r=0;l<4;++l)u[l]&&u[l].r>u.r&&(u.r=u[l].r)}function c(){if(e){var u,l=e.length,h;for(n=new Array(l),u=0;u<l;++u)h=e[u],n[h.index]=+t(h,u,e)}}return s.initialize=function(u,l){e=u,i=l,c()},s.iterations=function(u){return arguments.length?(o=+u,s):o},s.strength=function(u){return arguments.length?(r=+u,s):r},s.radius=function(u){return arguments.length?(t=typeof u=="function"?u:lt(+u),c(),s):t},s}function _a(t){return t.index}function Qe(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function xa(t){var e=_a,n=h,i,r=lt(30),o,s,a,c,u,l=1;t==null&&(t=[]);function h(y){return 1/Math.min(a[y.source.index],a[y.target.index])}function f(y){for(var g=0,w=t.length;g<l;++g)for(var M=0,m,b,E,T,D,C,$;M<w;++M)m=t[M],b=m.source,E=m.target,T=E.x+E.vx-b.x-b.vx||at(u),D=E.y+E.vy-b.y-b.vy||at(u),C=Math.sqrt(T*T+D*D),C=(C-o[M])/C*y*i[M],T*=C,D*=C,E.vx-=T*($=c[M]),E.vy-=D*$,b.vx+=T*($=1-$),b.vy+=D*$}function d(){if(s){var y,g=s.length,w=t.length,M=new Map(s.map((b,E)=>[e(b,E,s),b])),m;for(y=0,a=new Array(g);y<w;++y)m=t[y],m.index=y,typeof m.source!="object"&&(m.source=Qe(M,m.source)),typeof m.target!="object"&&(m.target=Qe(M,m.target)),a[m.source.index]=(a[m.source.index]||0)+1,a[m.target.index]=(a[m.target.index]||0)+1;for(y=0,c=new Array(w);y<w;++y)m=t[y],c[y]=a[m.source.index]/(a[m.source.index]+a[m.target.index]);i=new Array(w),_(),o=new Array(w),v()}}function _(){if(s)for(var y=0,g=t.length;y<g;++y)i[y]=+n(t[y],y,t)}function v(){if(s)for(var y=0,g=t.length;y<g;++y)o[y]=+r(t[y],y,t)}return f.initialize=function(y,g){s=y,u=g,d()},f.links=function(y){return arguments.length?(t=y,d(),f):t},f.id=function(y){return arguments.length?(e=y,f):e},f.iterations=function(y){return arguments.length?(l=+y,f):l},f.strength=function(y){return arguments.length?(n=typeof y=="function"?y:lt(+y),_(),f):n},f.distance=function(y){return arguments.length?(r=typeof y=="function"?y:lt(+y),v(),f):r},f}const wa=1664525,ba=1013904223,je=4294967296;function Ma(){let t=1;return()=>(t=(wa*t+ba)%je)/je}function Na(t){return t.x}function Aa(t){return t.y}var ka=10,Ea=Math.PI*(3-Math.sqrt(5));function Sa(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,c=Ee(h),u=Et("tick","end"),l=Ma();t==null&&(t=[]);function h(){f(),u.call("tick",e),n<i&&(c.stop(),u.call("end",e))}function f(v){var y,g=t.length,w;v===void 0&&(v=1);for(var M=0;M<v;++M)for(n+=(o-n)*r,a.forEach(function(m){m(n)}),y=0;y<g;++y)w=t[y],w.fx==null?w.x+=w.vx*=s:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=s:(w.y=w.fy,w.vy=0);return e}function d(){for(var v=0,y=t.length,g;v<y;++v){if(g=t[v],g.index=v,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var w=ka*Math.sqrt(.5+v),M=v*Ea;g.x=w*Math.cos(M),g.y=w*Math.sin(M)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function _(v){return v.initialize&&v.initialize(t,l),v}return d(),e={tick:f,restart:function(){return c.restart(h),e},stop:function(){return c.stop(),e},nodes:function(v){return arguments.length?(t=v,d(),a.forEach(_),e):t},alpha:function(v){return arguments.length?(n=+v,e):n},alphaMin:function(v){return arguments.length?(i=+v,e):i},alphaDecay:function(v){return arguments.length?(r=+v,e):+r},alphaTarget:function(v){return arguments.length?(o=+v,e):o},velocityDecay:function(v){return arguments.length?(s=1-v,e):1-s},randomSource:function(v){return arguments.length?(l=v,a.forEach(_),e):l},force:function(v,y){return arguments.length>1?(y==null?a.delete(v):a.set(v,_(y)),e):a.get(v)},find:function(v,y,g){var w=0,M=t.length,m,b,E,T,D;for(g==null?g=1/0:g*=g,w=0;w<M;++w)T=t[w],m=v-T.x,b=y-T.y,E=m*m+b*b,E<g&&(D=T,g=E);return D},on:function(v,y){return arguments.length>1?(u.on(v,y),e):u.on(v)}}}function za(){var t,e,n,i,r=lt(-30),o,s=1,a=1/0,c=.81;function u(d){var _,v=t.length,y=Te(t,Na,Aa).visitAfter(h);for(i=d,_=0;_<v;++_)e=t[_],y.visit(f)}function l(){if(t){var d,_=t.length,v;for(o=new Array(_),d=0;d<_;++d)v=t[d],o[v.index]=+r(v,d,t)}}function h(d){var _=0,v,y,g=0,w,M,m;if(d.length){for(w=M=m=0;m<4;++m)(v=d[m])&&(y=Math.abs(v.value))&&(_+=v.value,g+=y,w+=y*v.x,M+=y*v.y);d.x=w/g,d.y=M/g}else{v=d,v.x=v.data.x,v.y=v.data.y;do _+=o[v.data.index];while(v=v.next)}d.value=_}function f(d,_,v,y){if(!d.value)return!0;var g=d.x-e.x,w=d.y-e.y,M=y-_,m=g*g+w*w;if(M*M/c<m)return m<a&&(g===0&&(g=at(n),m+=g*g),w===0&&(w=at(n),m+=w*w),m<s&&(m=Math.sqrt(s*m)),e.vx+=g*d.value*i/m,e.vy+=w*d.value*i/m),!0;if(d.length||m>=a)return;(d.data!==e||d.next)&&(g===0&&(g=at(n),m+=g*g),w===0&&(w=at(n),m+=w*w),m<s&&(m=Math.sqrt(s*m)));do d.data!==e&&(M=o[d.data.index]*i/m,e.vx+=g*M,e.vy+=w*M);while(d=d.next)}return u.initialize=function(d,_){t=d,n=_,l()},u.strength=function(d){return arguments.length?(r=typeof d=="function"?d:lt(+d),l(),u):r},u.distanceMin=function(d){return arguments.length?(s=d*d,u):Math.sqrt(s)},u.distanceMax=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.theta=function(d){return arguments.length?(c=d*d,u):Math.sqrt(c)},u}function Ta(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Qt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function yt(t){return t=Qt(Math.abs(t)),t?t[1]:NaN}function Da(t,e){return function(n,i){for(var r=n.length,o=[],s=0,a=t[0],c=0;r>0&&a>0&&(c+a+1>i&&(a=Math.max(1,i-c)),o.push(n.substring(r-=a,r+a)),!((c+=a+1)>i));)a=t[s=(s+1)%t.length];return o.reverse().join(e)}}function Ia(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var $a=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jt(t){if(!(e=$a.exec(t)))throw new Error("invalid format: "+t);var e;return new Ie({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}jt.prototype=Ie.prototype;function Ie(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ie.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ca(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var Gn;function La(t,e){var n=Qt(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(Gn=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Qt(t,Math.max(0,e+o-1))[0]}function Je(t,e){var n=Qt(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const tn={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ta,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Je(t*100,e),r:Je,s:La,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function en(t){return t}var nn=Array.prototype.map,rn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Pa(t){var e=t.grouping===void 0||t.thousands===void 0?en:Da(nn.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?en:Ia(nn.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(h){h=jt(h);var f=h.fill,d=h.align,_=h.sign,v=h.symbol,y=h.zero,g=h.width,w=h.comma,M=h.precision,m=h.trim,b=h.type;b==="n"?(w=!0,b="g"):tn[b]||(M===void 0&&(M=12),m=!0,b="g"),(y||f==="0"&&d==="=")&&(y=!0,f="0",d="=");var E=v==="$"?n:v==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",T=v==="$"?i:/[%p]/.test(b)?s:"",D=tn[b],C=/[defgprs%]/.test(b);M=M===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function $(k){var R=E,L=T,p,N,x;if(b==="c")L=D(k)+L,k="";else{k=+k;var A=k<0||1/k<0;if(k=isNaN(k)?c:D(Math.abs(k),M),m&&(k=Ca(k)),A&&+k==0&&_!=="+"&&(A=!1),R=(A?_==="("?_:a:_==="-"||_==="("?"":_)+R,L=(b==="s"?rn[8+Gn/3]:"")+L+(A&&_==="("?")":""),C){for(p=-1,N=k.length;++p<N;)if(x=k.charCodeAt(p),48>x||x>57){L=(x===46?r+k.slice(p+1):k.slice(p))+L,k=k.slice(0,p);break}}}w&&!y&&(k=e(k,1/0));var z=R.length+k.length+L.length,S=z<g?new Array(g-z+1).join(f):"";switch(w&&y&&(k=e(S+k,S.length?g-L.length:1/0),S=""),d){case"<":k=R+k+L+S;break;case"=":k=R+S+k+L;break;case"^":k=S.slice(0,z=S.length>>1)+R+k+L+S.slice(z);break;default:k=S+R+k+L;break}return o(k)}return $.toString=function(){return h+""},$}function l(h,f){var d=u((h=jt(h),h.type="f",h)),_=Math.max(-8,Math.min(8,Math.floor(yt(f)/3)))*3,v=Math.pow(10,-_),y=rn[8+_/3];return function(g){return d(v*g)+y}}return{format:u,formatPrefix:l}}var Ct,Zn,Qn;Ra({thousands:",",grouping:[3],currency:["$",""]});function Ra(t){return Ct=Pa(t),Zn=Ct.format,Qn=Ct.formatPrefix,Ct}function qa(t){return Math.max(0,-yt(Math.abs(t)))}function Oa(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yt(e)/3)))*3-yt(Math.abs(t)))}function Fa(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,yt(e)-yt(t))+1}function Xa(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function Ha(){return this.eachAfter(Xa)}function Ba(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this}function Ya(t,e){for(var n=this,i=[n],r,o,s=-1;n=i.pop();)if(t.call(e,n,++s,this),r=n.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function Va(t,e){for(var n=this,i=[n],r=[],o,s,a,c=-1;n=i.pop();)if(r.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)i.push(o[s]);for(;n=r.pop();)t.call(e,n,++c,this);return this}function Ka(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i}function Ua(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})}function Wa(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Ga(t){for(var e=this,n=Za(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i}function Za(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function Qa(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function ja(){return Array.from(this)}function Ja(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function tu(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*eu(){var t=this,e,n=[t],i,r,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,i=t.children)for(r=0,o=i.length;r<o;++r)n.push(i[r]);while(n.length)}function $e(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=ru)):e===void 0&&(e=iu);for(var n=new Jt(t),i,r=[n],o,s,a,c;i=r.pop();)if((s=e(i.data))&&(c=(s=Array.from(s)).length))for(i.children=s,a=c-1;a>=0;--a)r.push(o=s[a]=new Jt(s[a])),o.parent=i,o.depth=i.depth+1;return n.eachBefore(su)}function nu(){return $e(this).eachBefore(ou)}function iu(t){return t.children}function ru(t){return Array.isArray(t)?t[1]:null}function ou(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function su(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Jt(t){this.data=t,this.depth=this.height=0,this.parent=null}Jt.prototype=$e.prototype={constructor:Jt,count:Ha,each:Ba,eachAfter:Va,eachBefore:Ya,find:Ka,sum:Ua,sort:Wa,path:Ga,ancestors:Qa,descendants:ja,leaves:Ja,links:tu,copy:nu,[Symbol.iterator]:eu};function au(t){return t==null?null:uu(t)}function uu(t){if(typeof t!="function")throw new Error;return t}function on(){return 0}function cu(t){return function(){return t}}const lu=1664525,fu=1013904223,sn=4294967296;function hu(){let t=1;return()=>(t=(lu*t+fu)%sn)/sn}function du(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function gu(t,e){let n=t.length,i,r;for(;n;)r=e()*n--|0,i=t[n],t[n]=t[r],t[r]=i;return t}function pu(t,e){for(var n=0,i=(t=gu(Array.from(t),e)).length,r=[],o,s;n<i;)o=t[n],s&&jn(s,o)?++n:(s=yu(r=mu(r,o)),n=0);return s}function mu(t,e){var n,i;if(ae(e,t))return[e];for(n=0;n<t.length;++n)if(Lt(e,t[n])&&ae(bt(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(Lt(bt(t[n],t[i]),e)&&Lt(bt(t[n],e),t[i])&&Lt(bt(t[i],e),t[n])&&ae(Jn(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function Lt(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function jn(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function ae(t,e){for(var n=0;n<e.length;++n)if(!jn(t,e[n]))return!1;return!0}function yu(t){switch(t.length){case 1:return vu(t[0]);case 2:return bt(t[0],t[1]);case 3:return Jn(t[0],t[1],t[2])}}function vu(t){return{x:t.x,y:t.y,r:t.r}}function bt(t,e){var n=t.x,i=t.y,r=t.r,o=e.x,s=e.y,a=e.r,c=o-n,u=s-i,l=a-r,h=Math.sqrt(c*c+u*u);return{x:(n+o+c/h*l)/2,y:(i+s+u/h*l)/2,r:(h+r+a)/2}}function Jn(t,e,n){var i=t.x,r=t.y,o=t.r,s=e.x,a=e.y,c=e.r,u=n.x,l=n.y,h=n.r,f=i-s,d=i-u,_=r-a,v=r-l,y=c-o,g=h-o,w=i*i+r*r-o*o,M=w-s*s-a*a+c*c,m=w-u*u-l*l+h*h,b=d*_-f*v,E=(_*m-v*M)/(b*2)-i,T=(v*y-_*g)/b,D=(d*M-f*m)/(b*2)-r,C=(f*g-d*y)/b,$=T*T+C*C-1,k=2*(o+E*T+D*C),R=E*E+D*D-o*o,L=-(Math.abs($)>1e-6?(k+Math.sqrt(k*k-4*$*R))/(2*$):R/k);return{x:i+E+T*L,y:r+D+C*L,r:L}}function an(t,e,n){var i=t.x-e.x,r,o,s=t.y-e.y,a,c,u=i*i+s*s;u?(o=e.r+n.r,o*=o,c=t.r+n.r,c*=c,o>c?(r=(u+c-o)/(2*u),a=Math.sqrt(Math.max(0,c/u-r*r)),n.x=t.x-r*i-a*s,n.y=t.y-r*s+a*i):(r=(u+o-c)/(2*u),a=Math.sqrt(Math.max(0,o/u-r*r)),n.x=e.x+r*i-a*s,n.y=e.y+r*s+a*i)):(n.x=e.x+n.r,n.y=e.y)}function un(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function cn(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,o=(e.y*n.r+n.y*e.r)/i;return r*r+o*o}function Pt(t){this._=t,this.next=null,this.previous=null}function _u(t,e){if(!(o=(t=du(t)).length))return 0;var n,i,r,o,s,a,c,u,l,h,f;if(n=t[0],n.x=0,n.y=0,!(o>1))return n.r;if(i=t[1],n.x=-i.r,i.x=n.r,i.y=0,!(o>2))return n.r+i.r;an(i,n,r=t[2]),n=new Pt(n),i=new Pt(i),r=new Pt(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;t:for(c=3;c<o;++c){an(n._,i._,r=t[c]),r=new Pt(r),u=i.next,l=n.previous,h=i._.r,f=n._.r;do if(h<=f){if(un(u._,r._)){i=u,n.next=i,i.previous=n,--c;continue t}h+=u._.r,u=u.next}else{if(un(l._,r._)){n=l,n.next=i,i.previous=n,--c;continue t}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,s=cn(n);(r=r.next)!==i;)(a=cn(r))<s&&(n=r,s=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=pu(n,e),c=0;c<o;++c)n=t[c],n.x-=r.x,n.y-=r.y;return r.r}function xu(t){return Math.sqrt(t.value)}function wu(){var t=null,e=1,n=1,i=on;function r(o){const s=hu();return o.x=e/2,o.y=n/2,t?o.eachBefore(ln(t)).eachAfter(ue(i,.5,s)).eachBefore(fn(1)):o.eachBefore(ln(xu)).eachAfter(ue(on,1,s)).eachAfter(ue(i,o.r/Math.min(e,n),s)).eachBefore(fn(Math.min(e,n)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(t=au(o),r):t},r.size=function(o){return arguments.length?(e=+o[0],n=+o[1],r):[e,n]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:cu(+o),r):i},r}function ln(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function ue(t,e,n){return function(i){if(r=i.children){var r,o,s=r.length,a=t(i)*e||0,c;if(a)for(o=0;o<s;++o)r[o].r+=a;if(c=_u(r,n),a)for(o=0;o<s;++o)r[o].r-=a;i.r=c+a}}}function fn(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function ti(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function bu(t){return function(){return t}}function Mu(t){return+t}var hn=[0,1];function j(t){return t}function xe(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:bu(isNaN(e)?NaN:.5)}function Nu(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function Au(t,e,n){var i=t[0],r=t[1],o=e[0],s=e[1];return r<i?(i=xe(r,i),o=n(s,o)):(i=xe(i,r),o=n(o,s)),function(a){return o(i(a))}}function ku(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=xe(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(a){var c=gi(t,a,1,i)-1;return o[c](r[c](a))}}function ei(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ni(){var t=hn,e=hn,n=Ae,i,r,o,s=j,a,c,u;function l(){var f=Math.min(t.length,e.length);return s!==j&&(s=Nu(t[0],t[f-1])),a=f>2?ku:Au,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?o:(c||(c=a(t.map(i),e,n)))(i(s(f)))}return h.invert=function(f){return s(r((u||(u=a(e,t.map(i),W)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,Mu),l()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),l()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),n=$o,l()},h.clamp=function(f){return arguments.length?(s=f?!0:j,l()):s!==j},h.interpolate=function(f){return arguments.length?(n=f,l()):n},h.unknown=function(f){return arguments.length?(o=f,h):o},function(f,d){return i=f,r=d,l()}}function Eu(){return ni()(j,j)}function Su(t,e,n,i){var r=_i(t,e,n),o;switch(i=jt(i??",f"),i.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(o=Oa(r,s))&&(i.precision=o),Qn(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=Fa(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=qa(r))&&(i.precision=o-(i.type==="%")*2);break}}return Zn(i)}function ii(t){var e=t.domain;return t.ticks=function(n){var i=e();return vi(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return Su(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,o=i.length-1,s=i[r],a=i[o],c,u,l=10;for(a<s&&(u=s,s=a,a=u,u=r,r=o,o=u);l-- >0;){if(u=fe(s,a,n),u===c)return i[r]=s,i[o]=a,e(i);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;c=u}return t},t}function ri(){var t=Eu();return t.copy=function(){return ei(t,ri())},ti.apply(t,arguments),ii(t)}function dn(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function zu(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Tu(t){return t<0?-t*t:t*t}function Du(t){var e=t(j,j),n=1;function i(){return n===1?t(j,j):n===.5?t(zu,Tu):t(dn(n),dn(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,i()):n},ii(e)}function oi(){var t=Du(ni());return t.copy=function(){return ei(t,oi()).exponent(t.exponent())},ti.apply(t,arguments),t}function Iu(){return oi.apply(null,arguments).exponent(.5)}const Rt=t=>()=>t;function $u(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function ot(t,e,n){this.k=t,this.x=e,this.y=n}ot.prototype={constructor:ot,scale:function(t){return t===1?this:new ot(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ot(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var si=new ot(1,0,0);ot.prototype;function ce(t){t.stopImmediatePropagation()}function _t(t){t.preventDefault(),t.stopImmediatePropagation()}function Cu(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Lu(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function gn(){return this.__zoom||si}function Pu(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ru(){return navigator.maxTouchPoints||"ontouchstart"in this}function qu(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function Ou(){var t=Cu,e=Lu,n=qu,i=Pu,r=Ru,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Fn,u=Et("start","zoom","end"),l,h,f,d=500,_=150,v=0,y=10;function g(p){p.property("__zoom",gn).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",$).filter(r).on("touchstart.zoom",k).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(p,N,x,A){var z=p.selection?p.selection():p;z.property("__zoom",gn),p!==z?b(p,N,x,A):z.interrupt().each(function(){E(this,arguments).event(A).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},g.scaleBy=function(p,N,x,A){g.scaleTo(p,function(){var z=this.__zoom.k,S=typeof N=="function"?N.apply(this,arguments):N;return z*S},x,A)},g.scaleTo=function(p,N,x,A){g.transform(p,function(){var z=e.apply(this,arguments),S=this.__zoom,I=x==null?m(z):typeof x=="function"?x.apply(this,arguments):x,P=S.invert(I),q=typeof N=="function"?N.apply(this,arguments):N;return n(M(w(S,q),I,P),z,s)},x,A)},g.translateBy=function(p,N,x,A){g.transform(p,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof x=="function"?x.apply(this,arguments):x),e.apply(this,arguments),s)},null,A)},g.translateTo=function(p,N,x,A,z){g.transform(p,function(){var S=e.apply(this,arguments),I=this.__zoom,P=A==null?m(S):typeof A=="function"?A.apply(this,arguments):A;return n(si.translate(P[0],P[1]).scale(I.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof x=="function"?-x.apply(this,arguments):-x),S,s)},A,z)};function w(p,N){return N=Math.max(o[0],Math.min(o[1],N)),N===p.k?p:new ot(N,p.x,p.y)}function M(p,N,x){var A=N[0]-x[0]*p.k,z=N[1]-x[1]*p.k;return A===p.x&&z===p.y?p:new ot(p.k,A,z)}function m(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function b(p,N,x,A){p.on("start.zoom",function(){E(this,arguments).event(A).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(A).end()}).tween("zoom",function(){var z=this,S=arguments,I=E(z,S).event(A),P=e.apply(z,S),q=x==null?m(P):typeof x=="function"?x.apply(z,S):x,Q=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),O=z.__zoom,K=typeof N=="function"?N.apply(z,S):N,et=c(O.invert(q).concat(Q/O.k),K.invert(q).concat(Q/K.k));return function(U){if(U===1)U=K;else{var nt=et(U),ie=Q/nt[2];U=new ot(ie,q[0]-nt[0]*ie,q[1]-nt[1]*ie)}I.zoom(null,U)}})}function E(p,N,x){return!x&&p.__zooming||new T(p,N)}function T(p,N){this.that=p,this.args=N,this.active=0,this.sourceEvent=null,this.extent=e.apply(p,N),this.taps=0}T.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,N){return this.mouse&&p!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&p!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&p!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var N=Y(this.that).datum();u.call(p,this.that,new $u(p,{sourceEvent:this.sourceEvent,target:g,type:p,transform:this.that.__zoom,dispatch:u}),N)}};function D(p,...N){if(!t.apply(this,arguments))return;var x=E(this,N).event(p),A=this.__zoom,z=Math.max(o[0],Math.min(o[1],A.k*Math.pow(2,i.apply(this,arguments)))),S=rt(p);if(x.wheel)(x.mouse[0][0]!==S[0]||x.mouse[0][1]!==S[1])&&(x.mouse[1]=A.invert(x.mouse[0]=S)),clearTimeout(x.wheel);else{if(A.k===z)return;x.mouse=[S,A.invert(S)],Ht(this),x.start()}_t(p),x.wheel=setTimeout(I,_),x.zoom("mouse",n(M(w(A,z),x.mouse[0],x.mouse[1]),x.extent,s));function I(){x.wheel=null,x.end()}}function C(p,...N){if(f||!t.apply(this,arguments))return;var x=p.currentTarget,A=E(this,N,!0).event(p),z=Y(p.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",Q,!0),S=rt(p,x),I=p.clientX,P=p.clientY;In(p.view),ce(p),A.mouse=[S,this.__zoom.invert(S)],Ht(this),A.start();function q(O){if(_t(O),!A.moved){var K=O.clientX-I,et=O.clientY-P;A.moved=K*K+et*et>v}A.event(O).zoom("mouse",n(M(A.that.__zoom,A.mouse[0]=rt(O,x),A.mouse[1]),A.extent,s))}function Q(O){z.on("mousemove.zoom mouseup.zoom",null),$n(O.view,A.moved),_t(O),A.event(O).end()}}function $(p,...N){if(t.apply(this,arguments)){var x=this.__zoom,A=rt(p.changedTouches?p.changedTouches[0]:p,this),z=x.invert(A),S=x.k*(p.shiftKey?.5:2),I=n(M(w(x,S),A,z),e.apply(this,N),s);_t(p),a>0?Y(this).transition().duration(a).call(b,I,A,p):Y(this).call(g.transform,I,A,p)}}function k(p,...N){if(t.apply(this,arguments)){var x=p.touches,A=x.length,z=E(this,N,p.changedTouches.length===A).event(p),S,I,P,q;for(ce(p),I=0;I<A;++I)P=x[I],q=rt(P,this),q=[q,this.__zoom.invert(q),P.identifier],z.touch0?!z.touch1&&z.touch0[2]!==q[2]&&(z.touch1=q,z.taps=0):(z.touch0=q,S=!0,z.taps=1+!!l);l&&(l=clearTimeout(l)),S&&(z.taps<2&&(h=q[0],l=setTimeout(function(){l=null},d)),Ht(this),z.start())}}function R(p,...N){if(this.__zooming){var x=E(this,N).event(p),A=p.changedTouches,z=A.length,S,I,P,q;for(_t(p),S=0;S<z;++S)I=A[S],P=rt(I,this),x.touch0&&x.touch0[2]===I.identifier?x.touch0[0]=P:x.touch1&&x.touch1[2]===I.identifier&&(x.touch1[0]=P);if(I=x.that.__zoom,x.touch1){var Q=x.touch0[0],O=x.touch0[1],K=x.touch1[0],et=x.touch1[1],U=(U=K[0]-Q[0])*U+(U=K[1]-Q[1])*U,nt=(nt=et[0]-O[0])*nt+(nt=et[1]-O[1])*nt;I=w(I,Math.sqrt(U/nt)),P=[(Q[0]+K[0])/2,(Q[1]+K[1])/2],q=[(O[0]+et[0])/2,(O[1]+et[1])/2]}else if(x.touch0)P=x.touch0[0],q=x.touch0[1];else return;x.zoom("touch",n(M(I,P,q),x.extent,s))}}function L(p,...N){if(this.__zooming){var x=E(this,N).event(p),A=p.changedTouches,z=A.length,S,I;for(ce(p),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),S=0;S<z;++S)I=A[S],x.touch0&&x.touch0[2]===I.identifier?delete x.touch0:x.touch1&&x.touch1[2]===I.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(I=rt(I,this),Math.hypot(h[0]-I[0],h[1]-I[1])<y)){var P=Y(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return g.wheelDelta=function(p){return arguments.length?(i=typeof p=="function"?p:Rt(+p),g):i},g.filter=function(p){return arguments.length?(t=typeof p=="function"?p:Rt(!!p),g):t},g.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:Rt(!!p),g):r},g.extent=function(p){return arguments.length?(e=typeof p=="function"?p:Rt([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),g):e},g.scaleExtent=function(p){return arguments.length?(o[0]=+p[0],o[1]=+p[1],g):[o[0],o[1]]},g.translateExtent=function(p){return arguments.length?(s[0][0]=+p[0][0],s[1][0]=+p[1][0],s[0][1]=+p[0][1],s[1][1]=+p[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(p){return arguments.length?(n=p,g):n},g.duration=function(p){return arguments.length?(a=+p,g):a},g.interpolate=function(p){return arguments.length?(c=p,g):c},g.on=function(){var p=u.on.apply(u,arguments);return p===u?g:p},g.clickDistance=function(p){return arguments.length?(v=(p=+p)*p,g):Math.sqrt(v)},g.tapDistance=function(p){return arguments.length?(y=+p,g):y},g}const Fu="data/circle_packing_data.json",pn="circle-packing-plot",Xu="circle-packing-title",Hu="circle-packing-text",mn="#f4efda",Bu="#9e2846",Yu="#000000",Vu=3,Ku=5,Uu=100,Wu="",Gu={"1-2":"Division 1-2",3:"Division 3",4:"Division 4",5:"Division 5",6:"Division 6",7:"Division 7","7-8":"Division 7-8",9:"Division 9",10:"Division 10",11:"Division 11",12:"Division 12",13:"Division 13",14:"Division 14",15:"Division 15",16:"Division 16",17:"Division 17",18:"Division 18",19:"Division 19",20:"Division 20"},Zu="Cliquez sur les différentes sections du diagramme pour explorer ces relations en détail. Vous découvrirez comment la diversité des origines et des professions a contribué à la richesse et à la complexité de Lausanne au XIX<sup>ème</sup> siècle, et comment ces facteurs ont joué un rôle déterminant dans la formation des communautés urbaines.",Qu={"1-2":"Division 1-2",3:"Division 3",4:"Division 4",5:"Division 5",6:"Division 6",7:"Division 7","7-8":"Division 7-8",9:"Division 9",10:"Division 10",11:"Division 11",12:"Division 12",13:"Division 13",14:"Division 14",15:"Division 15",16:"Division 16",17:"Division 17",18:"Division 18",19:"Division 19",20:"Division 20"};class ju{constructor(){B(this,"data");B(this,"width");B(this,"height");this.loadData().then(()=>{this.initDimensions(),this.initPacking()})}async loadData(){return new Promise(e=>{Un(Fu).then(n=>{this.data=n,e()})})}initDimensions(){const e=document.getElementById(pn);if(e){const n=Math.min(e.clientWidth,e.clientHeight);this.width=n,this.height=n}}initPacking(){const n=(f=>wu().size([this.width,this.height]).padding(Vu)($e(f).sum(d=>d.value).sort((d,_)=>_.value-d.value)))(this.data);let i=n;const r=ri().domain([0,1]).range([mn,Bu]),o=Iu().domain([wi(n.descendants(),f=>f.r),xi(n.descendants(),f=>f.r)]).range([Ku,Uu]),s=Y(`#${pn}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",`-${this.width/2} -${this.height/2} ${this.width} ${this.height}`).style("display","block").style("background",r(0)).style("cursor","pointer").on("click",f=>h(f,n)),a=s.append("g").selectAll("circle").data(n.descendants().slice(1)).join("circle").attr("fill",f=>f.children?r(f.depth):mn).attr("pointer-events",f=>f.children?null:"none").on("mouseover",function(){Y(this).attr("stroke",Yu)}).on("mouseout",function(){Y(this).attr("stroke",null)}).on("click",(f,d)=>i!==d&&(h(f,d),f.stopPropagation())),c=s.append("g").style("font-family","var(--default-font-family)").attr("pointer-events","none").attr("text-anchor","middle").selectAll("text").data(n.descendants()).join("text").attr("dy","0.3em").style("font-size",f=>`${o(f.r)}px`).style("fill-opacity",f=>f.parent===n?1:0).style("display",f=>f.parent===n?"inline":"none").text(f=>f.data.name);let u;const l=f=>{const d=this.width/f[2];u=f,c.attr("transform",_=>`translate(${(_.x-f[0])*d},${(_.y-f[1])*d})`),a.attr("transform",_=>`translate(${(_.x-f[0])*d},${(_.y-f[1])*d})`),a.attr("r",_=>_.r*d)};l([n.x,n.y,n.r*2]);function h(f,d){const _=document.getElementById(Xu);if(_){const g=Gu[d.data.name]||Wu;_.innerHTML=g}const v=document.getElementById(Hu);if(v){const g=Qu[d.data.name]||Zu;v.innerHTML=g}i=d;const y=s.transition().duration(f.altKey?7500:750).tween("zoom",()=>{const g=Fn(u,[i.x,i.y,i.r*2]);return w=>l(g(w))});c.filter(function(g){return g.parent===i||this.style.display==="inline"}).transition(y).style("fill-opacity",g=>g.parent===i?1:0).on("start",function(g){g.parent===i&&(this.style.display="inline")}).on("end",function(g){g.parent!==i&&(this.style.display="none")})}}}document.addEventListener("DOMContentLoaded",()=>{new ju});const yn=2e3;document.addEventListener("DOMContentLoaded",()=>{function t(s){const a=s.getBoundingClientRect(),c=window.innerHeight||document.documentElement.clientHeight,u=window.innerWidth||document.documentElement.clientWidth;return a.top>=0&&a.left>=0&&a.bottom<=c+1&&a.right<=u+1}function e(s,a){const c=window.pageYOffset,u=s.getBoundingClientRect().top,l=performance.now();function h(f){const d=f-l,_=Math.min(d/a,1);window.scrollTo({top:c+u*n(_)}),d<a&&window.requestAnimationFrame(h)}window.requestAnimationFrame(h)}function n(s){return s<.5?2*s*s:-1+(4-2*s)*s}function i(s){return s.deltaY>0?"down":"up"}function r(s){s.preventDefault();const a=["title-container","p1-container","p2-container","p3-container","p4-container","p5-container","p6-container","p7-container","final-container"];for(let c=0;c<a.length;c++){const u=c>=1?document.getElementById(a[c-1]):null,l=document.getElementById(a[c]),h=c<a.length-1?document.getElementById(a[c+1]):null;u&&t(l)&&i(s)==="up"&&e(u,yn),h&&t(l)&&i(s)==="down"&&e(h,yn)}}document.addEventListener("wheel",r,{passive:!1}),document.addEventListener("touchmove",r,{passive:!1});const o=document.getElementById("title-container");e(o,0)});const Ju="data/networks",tc="road_vocation_data",ec="vocation",nc="#network-graph",ic="network-chart",rc="#network-title",oc="#network-text",sc="#979487",vn="#aaaaaa",ac={road_vocation_data:{road:"#289e61",vocation:"#9e2846"},bipartite_division_type_metiers:{division:"#289e61",job_category:"#9e2846"},bipartite_origine_category_type_metiers:{origine_category:"#289e61",job_category:"#9e2846"},bipartite_street_type_metiers:{street:"#289e61",job_category:"#9e2846"},bipartite_rue_origines:{street:"#289e61",origine_category:"#9e2846"},bipartite_divisions_origines:{division:"#289e61",origine_category:"#9e2846"}},le=`Lorem ipsum dolor sit amet. Et dolores quia et iste cupiditate sit nisi eligendi ab veritatis voluptatem ea omnis autem. Eos dolor modi eum adipisci facere ex dolores fugiat et laboriosam rerum rem nihil dolor. Et dolores iure ut odio voluptas ut nobis nemo.

Est quisquam totam sit illum rerum aut quia labore. Non voluptas libero sed adipisci quia aut voluptatem sint et nihil nihil ut ipsum voluptatem sit galisum reprehenderit.

Qui vero dolore et doloremque omnis ea error labore rem numquam cumque? Et totam alias et adipisci soluta ut excepturi error id quisquam quia sit voluptates voluptatum ut unde recusandae quo explicabo dolor. Qui temporibus consequuntur est alias quaerat vel culpa quia ut maxime ducimus sed esse assumenda a tempora culpa.`,uc={road_vocation_data:{title:"Vocations Voisines",text:"Ce premier graphe tisse un lien entre les vocations et les rues. Chaque métier est connecté à une rue, la taille de chaque nœud reflétant le nombre de personnes concernées. Les liens entre les rues et les métiers mettent en lumière des proximités intéressantes : par exemple, les rues de <i>Chavannes</i> et de <i>La Sallaz</i> se retrouvent proches dans notre graphe, illustrant la forte présence de paysans parmi leurs habitants, comme l'indiquent les liens avec les nœuds 'laboureur' et 'fermier'. De plus, des rues géographiquement voisines comme <i>Rue Saint François</i> et <i>Place Saint François</i> se retrouvent également proches dans notre réseau, révélant une similarité dans la composition professionnelle de leurs résidents."},bipartite_division_type_metiers:{title:"Réseau de divisions et de catégories de métiers",text:"Ce graphe met en lumière les liens entre les divisions de la ville de Lausanne et les classes de métiers. Il offre une vue claire sur la répartition des professions à travers la ville. Par exemple, il est évident que la majorité des rentiers proviennent des divisions 17 et 1-2, qui correspondent respectivement à la campagne vers le sud de Lausanne et au quartier de Marterey et ses environs."},bipartite_origine_category_type_metiers:{title:"Réseau des classes d'origines et de catégories de métiers",text:"Le troisième graphe dévoile les interactions entre les classes d'origine et les classes de vocations On observe une distribution plutôt hétérogène des métiers pour chaque origine. Mais par exemple, Yverdon se distingue par une plus grande concentration de constructeurs et d'artisans. Le Lavaux, région connue pour son paysage viticole et agricole, présente une majorité de personnes engagées dans l'agriculture."},bipartite_street_type_metiers:{title:"Réseau de rues et de catégories de métiers",text:le},bipartite_rue_origines:{title:"Réseau de rues et d'origines",text:le},bipartite_divisions_origines:{title:"Réseau de divisions et d'origines",text:le}},cc=.1,lc=10;class fc{constructor(e=.7,n=.7,i=.1,r=7,o=40,s=1,a=8,c=5,u=5,l=5,h=-700,f=2,d=200){B(this,"svg");B(this,"gnodes");B(this,"glinks");B(this,"simulation");B(this,"data");B(this,"container");B(this,"dragActive",!1);B(this,"networkName",ec);B(this,"linkedById");this.expNodeSizeScale=e,this.expLinkWeightScale=n,this.transparency=i,this.minNodeSize=r,this.maxNodeSize=o,this.minLinkWeight=s,this.maxLinkWeight=a,this.labelSizeAdd=c,this.nodeSizeInc=u,this.labelSizeInc=l,this.chargeStrength=h,this.collideSizeAdd=f,this.transitionDuration=d,this.initDimensions(),this.initStaticElements(),this.initEvents(),this.updatePlot(tc)}async loadData(e){const n=`${Ju}/${e}.json`;return new Promise(i=>{Un(n).then(r=>{i(r)})})}initDimensions(){this.container=Y(nc);const e=document.getElementById(ic);e&&(this.width=e.clientWidth,this.height=e.clientHeight)}initStaticElements(){this.svg=this.container.append("svg").attr("width",this.width).attr("height",this.height),this.glinks=this.svg.append("g").attr("class","links"),this.gnodes=this.svg.append("g").attr("class","nodes")}initEvents(){const e=document.getElementById("graph-selector");e&&e.addEventListener("change",n=>{const i=n.target.value;this.updatePlot(i)})}get_scaled_size(e,n,i,r,o){return i-n==0?(r+o)/2:r+(e-n)*(o-r)/(i-n)}isConnected(e,n){return this.linkedById[e].indexOf(n)>-1||this.linkedById[n].indexOf(e)>-1||e==n}drag(e){const n=o=>{this.dragActive=!0,o.active||e.alphaTarget(.3).restart(),o.subject.fx=o.subject.x,o.subject.fy=o.subject.y},i=o=>{o.subject.fx=o.x,o.subject.fy=o.y},r=o=>{this.dragActive=!1,o.active||e.alphaTarget(0),o.subject.fx=null,o.subject.fy=null};return co().on("start",n).on("drag",i).on("end",r)}initData(){let e=this.data.nodes.reduce((o,s)=>Math.max(o,s.size),0),n=this.data.nodes.reduce((o,s)=>Math.min(o,s.size),1/0);e=Math.pow(e,this.expNodeSizeScale),n=Math.pow(n,this.expNodeSizeScale),this.data.nodes.forEach(o=>o.size=this.get_scaled_size(Math.pow(o.size,this.expNodeSizeScale),n,e,this.minNodeSize,this.maxNodeSize));let i=this.data.links.reduce((o,s)=>Math.max(o,s.weight),0),r=this.data.links.reduce((o,s)=>Math.min(o,s.weight),1/0);i=Math.pow(i,this.expLinkWeightScale),r=Math.pow(r,this.expLinkWeightScale),this.data.links.forEach(o=>o.weight=this.get_scaled_size(Math.pow(o.weight,this.expLinkWeightScale),r,i,this.minLinkWeight,this.maxLinkWeight)),this.linkedById={},this.data.links.forEach(o=>{this.linkedById[o.source]=[],this.linkedById[o.target]=[]}),this.data.links.forEach(o=>{this.linkedById[o.source].push(o.target),this.linkedById[o.target].push(o.source)})}createLinks(){this.glinks.attr("stroke",sc).attr("stroke-opacity",1).selectAll("line").data(this.data.links).enter().append("line").attr("stroke-width",function(e){return e.weight})}createNodes(){const e=this.gnodes.selectAll(".node").data(this.data.nodes).enter().append("g").attr("class","node");e.append("circle").attr("class","node-circle").attr("r",function(n){return n.size}).attr("fill",n=>{const i=ac[this.networkName],r=i?i[n.type]:vn;return r||vn}).call(this.drag(this.simulation)).on("mouseover",(n,i)=>{if(this.dragActive)return;const r=i.id;this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("r",o=>{if(o.id==r)return o.size+this.nodeSizeInc;if(this.isConnected(r,o.id)){let s=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const a=this.data.links.filter(h=>h.source.id==r||h.target.id==r),c=a.reduce((h,f)=>Math.min(h,f.weight),1/0),u=a.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(s,c,u,this.minNodeSize,this.maxNodeSize)}return o.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",o=>o.source.id==r||o.target.id==r?1:this.transparency),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("font-size",o=>{if(o.id==r)return o.size+this.labelSizeInc+this.labelSizeAdd;if(this.isConnected(r,o.id)){let s=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const a=this.data.links.filter(h=>h.source.id==r||h.target.id==r),c=a.reduce((h,f)=>Math.min(h,f.weight),1/0),u=a.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(s,c,u,this.minNodeSize,this.maxNodeSize)+this.labelSizeAdd}return o.size+this.labelSizeAdd})}).on("mouseout",n=>{this.dragActive||(this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("r",function(i){return i.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",1),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("font-size",i=>i.size+this.labelSizeAdd))}),e.append("text").attr("class","node-text").text(function(n){return n.label}).attr("font-size",n=>n.size+this.labelSizeAdd).attr("font-family","sans-serif").attr("font-weight","bold").attr("text-anchor","middle").attr("alignment-baseline","middle").style("pointer-events","none")}initZoom(){const e=Ou().scaleExtent([cc,lc]).on("zoom",({transform:n})=>{this.gnodes.attr("transform",n),this.glinks.attr("transform",n)});this.svg.call(e)}initSimulation(){this.simulation=Sa().force("link",xa().id(function(n){return n.id})).force("charge",za().strength(this.chargeStrength)).force("center",Js(this.width/2,this.height/2)).force("collide",va().radius(n=>n.size+this.collideSizeAdd));const e=()=>{this.glinks.selectAll("line").attr("x1",n=>n.source.x).attr("y1",n=>n.source.y).attr("x2",n=>n.target.x).attr("y2",n=>n.target.y),this.gnodes.selectAll(".node-circle").attr("cx",n=>n.x).attr("cy",n=>n.y),this.gnodes.selectAll(".node-text").attr("x",n=>n.x+10).attr("y",n=>n.y+4).attr("dx",-9).attr("dy",".1em")};this.simulation.nodes(this.data.nodes).on("tick",e),this.simulation.force("link").links(this.data.links)}async updatePlot(e){return new Promise(n=>{this.loadData(e).then(i=>{this.networkName=e,this.deletePlot(),this.data=i,this.initData(),this.initSimulation(),this.createLinks(),this.createNodes(),this.initZoom();const r=document.querySelector(rc),o=document.querySelector(oc),s=uc[e];r&&o&&(r.innerHTML=s.title,o.innerHTML=s.text)}),n()})}deletePlot(){this.gnodes.selectAll("*").remove(),this.glinks.selectAll("*").remove()}}document.addEventListener("DOMContentLoaded",()=>{console.log("Loading networks..."),new fc,console.log("Networks loaded.")});

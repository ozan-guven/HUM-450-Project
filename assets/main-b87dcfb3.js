var ai=Object.defineProperty;var ui=(t,n,e)=>n in t?ai(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var B=(t,n,e)=>(ui(t,typeof n!="symbol"?n+"":n,e),e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();function qt(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function ci(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function _e(t){let n,e,i;t.length!==2?(n=qt,e=(a,c)=>qt(t(a),c),i=(a,c)=>t(a)-c):(n=t===qt||t===ci?t:li,e=t,i=t);function r(a,c,u=0,l=a.length){if(u<l){if(n(c,c)!==0)return l;do{const h=u+l>>>1;e(a[h],c)<0?u=h+1:l=h}while(u<l)}return u}function o(a,c,u=0,l=a.length){if(u<l){if(n(c,c)!==0)return l;do{const h=u+l>>>1;e(a[h],c)<=0?u=h+1:l=h}while(u<l)}return u}function s(a,c,u=0,l=a.length){const h=r(a,c,u,l-1);return h>u&&i(a[h-1],c)>-i(a[h],c)?h-1:h}return{left:r,center:s,right:o}}function li(){return 0}function fi(t){return t===null?NaN:+t}const hi=_e(qt),di=hi.right;_e(fi).center;const gi=di,pi=Math.sqrt(50),mi=Math.sqrt(10),yi=Math.sqrt(2);function Yt(t,n,e){const i=(n-t)/Math.max(0,e),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),s=o>=pi?10:o>=mi?5:o>=yi?2:1;let a,c,u;return r<0?(u=Math.pow(10,-r)/s,a=Math.round(t*u),c=Math.round(n*u),a/u<t&&++a,c/u>n&&--c,u=-u):(u=Math.pow(10,r)*s,a=Math.round(t/u),c=Math.round(n/u),a*u<t&&++a,c*u>n&&--c),c<a&&.5<=e&&e<2?Yt(t,n,e*2):[a,c,u]}function vi(t,n,e){if(n=+n,t=+t,e=+e,!(e>0))return[];if(t===n)return[t];const i=n<t,[r,o,s]=i?Yt(n,t,e):Yt(t,n,e);if(!(o>=r))return[];const a=o-r+1,c=new Array(a);if(i)if(s<0)for(let u=0;u<a;++u)c[u]=(o-u)/-s;else for(let u=0;u<a;++u)c[u]=(o-u)*s;else if(s<0)for(let u=0;u<a;++u)c[u]=(r+u)/-s;else for(let u=0;u<a;++u)c[u]=(r+u)*s;return c}function hn(t,n,e){return n=+n,t=+t,e=+e,Yt(t,n,e)[2]}function _i(t,n,e){n=+n,t=+t,e=+e;const i=n<t,r=i?hn(n,t,e):hn(t,n,e);return(i?-1:1)*(r<0?1/-r:r)}function xi(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e<i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e<r||e===void 0&&r>=r)&&(e=r)}return e}function wi(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e>i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e>r||e===void 0&&r>=r)&&(e=r)}return e}var bi={value:()=>{}};function Et(){for(var t=0,n=arguments.length,e={},i;t<n;++t){if(!(i=arguments[t]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new Ft(e)}function Ft(t){this._=t}function Mi(t,n){return t.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");if(r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}Ft.prototype=Et.prototype={constructor:Ft,on:function(t,n){var e=this._,i=Mi(t+"",e),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(t=i[o]).type)&&(r=Ni(e[r],t.name)))return r;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<s;)if(r=(t=i[o]).type)e[r]=Ln(e[r],t.name,n);else if(n==null)for(r in e)e[r]=Ln(e[r],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new Ft(t)},call:function(t,n){if((r=arguments.length-2)>0)for(var e=new Array(r),i=0,r,o;i<r;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(n,e)}};function Ni(t,n){for(var e=0,i=t.length,r;e<i;++e)if((r=t[e]).name===n)return r.value}function Ln(t,n,e){for(var i=0,r=t.length;i<r;++i)if(t[i].name===n){t[i]=bi,t=t.slice(0,i).concat(t.slice(i+1));break}return e!=null&&t.push({name:n,value:e}),t}var dn="http://www.w3.org/1999/xhtml";const Pn={svg:"http://www.w3.org/2000/svg",xhtml:dn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nn(t){var n=t+="",e=n.indexOf(":");return e>=0&&(n=t.slice(0,e))!=="xmlns"&&(t=t.slice(e+1)),Pn.hasOwnProperty(n)?{space:Pn[n],local:t}:t}function Ai(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===dn&&n.documentElement.namespaceURI===dn?n.createElement(t):n.createElementNS(e,t)}}function ki(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function xe(t){var n=nn(t);return(n.local?ki:Ai)(n)}function Ei(){}function bn(t){return t==null?Ei:function(){return this.querySelector(t)}}function Si(t){typeof t!="function"&&(t=bn(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],s=o.length,a=i[r]=new Array(s),c,u,l=0;l<s;++l)(c=o[l])&&(u=t.call(c,c.__data__,l,o))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new V(i,this._parents)}function zi(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ti(){return[]}function we(t){return t==null?Ti:function(){return this.querySelectorAll(t)}}function Di(t){return function(){return zi(t.apply(this,arguments))}}function Ii(t){typeof t=="function"?t=Di(t):t=we(t);for(var n=this._groups,e=n.length,i=[],r=[],o=0;o<e;++o)for(var s=n[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(i.push(t.call(c,c.__data__,u,s)),r.push(c));return new V(i,r)}function be(t){return function(){return this.matches(t)}}function Me(t){return function(n){return n.matches(t)}}var $i=Array.prototype.find;function Ci(t){return function(){return $i.call(this.children,t)}}function Li(){return this.firstElementChild}function Pi(t){return this.select(t==null?Li:Ci(typeof t=="function"?t:Me(t)))}var Ri=Array.prototype.filter;function Oi(){return Array.from(this.children)}function qi(t){return function(){return Ri.call(this.children,t)}}function Fi(t){return this.selectAll(t==null?Oi:qi(typeof t=="function"?t:Me(t)))}function Xi(t){typeof t!="function"&&(t=be(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],s=o.length,a=i[r]=[],c,u=0;u<s;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&a.push(c);return new V(i,this._parents)}function Ne(t){return new Array(t.length)}function Hi(){return new V(this._enter||this._groups.map(Ne),this._parents)}function Vt(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}Vt.prototype={constructor:Vt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Bi(t){return function(){return t}}function Yi(t,n,e,i,r,o){for(var s=0,a,c=n.length,u=o.length;s<u;++s)(a=n[s])?(a.__data__=o[s],i[s]=a):e[s]=new Vt(t,o[s]);for(;s<c;++s)(a=n[s])&&(r[s]=a)}function Vi(t,n,e,i,r,o,s){var a,c,u=new Map,l=n.length,h=o.length,f=new Array(l),d;for(a=0;a<l;++a)(c=n[a])&&(f[a]=d=s.call(c,c.__data__,a,n)+"",u.has(d)?r[a]=c:u.set(d,c));for(a=0;a<h;++a)d=s.call(t,o[a],a,o)+"",(c=u.get(d))?(i[a]=c,c.__data__=o[a],u.delete(d)):e[a]=new Vt(t,o[a]);for(a=0;a<l;++a)(c=n[a])&&u.get(f[a])===c&&(r[a]=c)}function Ki(t){return t.__data__}function Ui(t,n){if(!arguments.length)return Array.from(this,Ki);var e=n?Vi:Yi,i=this._parents,r=this._groups;typeof t!="function"&&(t=Bi(t));for(var o=r.length,s=new Array(o),a=new Array(o),c=new Array(o),u=0;u<o;++u){var l=i[u],h=r[u],f=h.length,d=Wi(t.call(l,l&&l.__data__,u,i)),_=d.length,v=a[u]=new Array(_),y=s[u]=new Array(_),g=c[u]=new Array(f);e(l,h,v,y,g,d,n);for(var w=0,M=0,m,b;w<_;++w)if(m=v[w]){for(w>=M&&(M=w+1);!(b=y[M])&&++M<_;);m._next=b||null}}return s=new V(s,i),s._enter=a,s._exit=c,s}function Wi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Gi(){return new V(this._exit||this._groups.map(Ne),this._parents)}function Zi(t,n,e){var i=this.enter(),r=this,o=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),n!=null&&(r=n(r),r&&(r=r.selection())),e==null?o.remove():e(o),i&&r?i.merge(r).order():r}function Qi(t){for(var n=t.selection?t.selection():t,e=this._groups,i=n._groups,r=e.length,o=i.length,s=Math.min(r,o),a=new Array(r),c=0;c<s;++c)for(var u=e[c],l=i[c],h=u.length,f=a[c]=new Array(h),d,_=0;_<h;++_)(d=u[_]||l[_])&&(f[_]=d);for(;c<r;++c)a[c]=e[c];return new V(a,this._parents)}function ji(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var i=t[n],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Ji(t){t||(t=tr);function n(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o){for(var s=e[o],a=s.length,c=r[o]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(n)}return new V(r,this._parents).order()}function tr(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function nr(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function er(){return Array.from(this)}function ir(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function rr(){let t=0;for(const n of this)++t;return t}function or(){return!this.node()}function sr(t){for(var n=this._groups,e=0,i=n.length;e<i;++e)for(var r=n[e],o=0,s=r.length,a;o<s;++o)(a=r[o])&&t.call(a,a.__data__,o,r);return this}function ar(t){return function(){this.removeAttribute(t)}}function ur(t){return function(){this.removeAttributeNS(t.space,t.local)}}function cr(t,n){return function(){this.setAttribute(t,n)}}function lr(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function fr(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}}function hr(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function dr(t,n){var e=nn(t);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((n==null?e.local?ur:ar:typeof n=="function"?e.local?hr:fr:e.local?lr:cr)(e,n))}function Ae(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gr(t){return function(){this.style.removeProperty(t)}}function pr(t,n,e){return function(){this.style.setProperty(t,n,e)}}function mr(t,n,e){return function(){var i=n.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,e)}}function yr(t,n,e){return arguments.length>1?this.each((n==null?gr:typeof n=="function"?mr:pr)(t,n,e??"")):pt(this.node(),t)}function pt(t,n){return t.style.getPropertyValue(n)||Ae(t).getComputedStyle(t,null).getPropertyValue(n)}function vr(t){return function(){delete this[t]}}function _r(t,n){return function(){this[t]=n}}function xr(t,n){return function(){var e=n.apply(this,arguments);e==null?delete this[t]:this[t]=e}}function wr(t,n){return arguments.length>1?this.each((n==null?vr:typeof n=="function"?xr:_r)(t,n)):this.node()[t]}function ke(t){return t.trim().split(/^|\s+/)}function Mn(t){return t.classList||new Ee(t)}function Ee(t){this._node=t,this._names=ke(t.getAttribute("class")||"")}Ee.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Se(t,n){for(var e=Mn(t),i=-1,r=n.length;++i<r;)e.add(n[i])}function ze(t,n){for(var e=Mn(t),i=-1,r=n.length;++i<r;)e.remove(n[i])}function br(t){return function(){Se(this,t)}}function Mr(t){return function(){ze(this,t)}}function Nr(t,n){return function(){(n.apply(this,arguments)?Se:ze)(this,t)}}function Ar(t,n){var e=ke(t+"");if(arguments.length<2){for(var i=Mn(this.node()),r=-1,o=e.length;++r<o;)if(!i.contains(e[r]))return!1;return!0}return this.each((typeof n=="function"?Nr:n?br:Mr)(e,n))}function kr(){this.textContent=""}function Er(t){return function(){this.textContent=t}}function Sr(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function zr(t){return arguments.length?this.each(t==null?kr:(typeof t=="function"?Sr:Er)(t)):this.node().textContent}function Tr(){this.innerHTML=""}function Dr(t){return function(){this.innerHTML=t}}function Ir(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function $r(t){return arguments.length?this.each(t==null?Tr:(typeof t=="function"?Ir:Dr)(t)):this.node().innerHTML}function Cr(){this.nextSibling&&this.parentNode.appendChild(this)}function Lr(){return this.each(Cr)}function Pr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Rr(){return this.each(Pr)}function Or(t){var n=typeof t=="function"?t:xe(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function qr(){return null}function Fr(t,n){var e=typeof t=="function"?t:xe(t),i=n==null?qr:typeof n=="function"?n:bn(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})}function Xr(){var t=this.parentNode;t&&t.removeChild(this)}function Hr(){return this.each(Xr)}function Br(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Yr(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Vr(t){return this.select(t?Yr:Br)}function Kr(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ur(t){return function(n){t.call(this,n,this.__data__)}}function Wr(t){return t.trim().split(/^|\s+/).map(function(n){var e="",i=n.indexOf(".");return i>=0&&(e=n.slice(i+1),n=n.slice(0,i)),{type:n,name:e}})}function Gr(t){return function(){var n=this.__on;if(n){for(var e=0,i=-1,r=n.length,o;e<r;++e)o=n[e],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):n[++i]=o;++i?n.length=i:delete this.__on}}}function Zr(t,n,e){return function(){var i=this.__on,r,o=Ur(n);if(i){for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),r.value=n;return}}this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function Qr(t,n,e){var i=Wr(t+""),r,o=i.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(r=0,l=a[c];r<o;++r)if((s=i[r]).type===l.type&&s.name===l.name)return l.value}return}for(a=n?Zr:Gr,r=0;r<o;++r)this.each(a(i[r],n,e));return this}function Te(t,n,e){var i=Ae(t),r=i.CustomEvent;typeof r=="function"?r=new r(n,e):(r=i.document.createEvent("Event"),e?(r.initEvent(n,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(n,!1,!1)),t.dispatchEvent(r)}function jr(t,n){return function(){return Te(this,t,n)}}function Jr(t,n){return function(){return Te(this,t,n.apply(this,arguments))}}function to(t,n){return this.each((typeof n=="function"?Jr:jr)(t,n))}function*no(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var De=[null];function V(t,n){this._groups=t,this._parents=n}function St(){return new V([[document.documentElement]],De)}function eo(){return this}V.prototype=St.prototype={constructor:V,select:Si,selectAll:Ii,selectChild:Pi,selectChildren:Fi,filter:Xi,data:Ui,enter:Hi,exit:Gi,join:Zi,merge:Qi,selection:eo,order:ji,sort:Ji,call:nr,nodes:er,node:ir,size:rr,empty:or,each:sr,attr:dr,style:yr,property:wr,classed:Ar,text:zr,html:$r,raise:Lr,lower:Rr,append:Or,insert:Fr,remove:Hr,clone:Vr,datum:Kr,on:Qr,dispatch:to,[Symbol.iterator]:no};function Y(t){return typeof t=="string"?new V([[document.querySelector(t)]],[document.documentElement]):new V([[t]],De)}function io(t){let n;for(;n=t.sourceEvent;)t=n;return t}function rt(t,n){if(t=io(t),n===void 0&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}if(n.getBoundingClientRect){var r=n.getBoundingClientRect();return[t.clientX-r.left-n.clientLeft,t.clientY-r.top-n.clientTop]}}return[t.pageX,t.pageY]}const ro={passive:!1},Mt={capture:!0,passive:!1};function sn(t){t.stopImmediatePropagation()}function dt(t){t.preventDefault(),t.stopImmediatePropagation()}function Ie(t){var n=t.document.documentElement,e=Y(t).on("dragstart.drag",dt,Mt);"onselectstart"in n?e.on("selectstart.drag",dt,Mt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function $e(t,n){var e=t.document.documentElement,i=Y(t).on("dragstart.drag",null);n&&(i.on("click.drag",dt,Mt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}const Tt=t=>()=>t;function gn(t,{sourceEvent:n,subject:e,target:i,identifier:r,active:o,x:s,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}gn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function oo(t){return!t.ctrlKey&&!t.button}function so(){return this.parentNode}function ao(t,n){return n??{x:t.x,y:t.y}}function uo(){return navigator.maxTouchPoints||"ontouchstart"in this}function co(){var t=oo,n=so,e=ao,i=uo,r={},o=Et("start","drag","end"),s=0,a,c,u,l,h=0;function f(m){m.on("mousedown.drag",d).filter(i).on("touchstart.drag",y).on("touchmove.drag",g,ro).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(m,b){if(!(l||!t.call(this,m,b))){var E=M(this,n.call(this,m,b),m,b,"mouse");E&&(Y(m.view).on("mousemove.drag",_,Mt).on("mouseup.drag",v,Mt),Ie(m.view),sn(m),u=!1,a=m.clientX,c=m.clientY,E("start",m))}}function _(m){if(dt(m),!u){var b=m.clientX-a,E=m.clientY-c;u=b*b+E*E>h}r.mouse("drag",m)}function v(m){Y(m.view).on("mousemove.drag mouseup.drag",null),$e(m.view,u),dt(m),r.mouse("end",m)}function y(m,b){if(t.call(this,m,b)){var E=m.changedTouches,T=n.call(this,m,b),D=E.length,C,$;for(C=0;C<D;++C)($=M(this,T,m,b,E[C].identifier,E[C]))&&(sn(m),$("start",m,E[C]))}}function g(m){var b=m.changedTouches,E=b.length,T,D;for(T=0;T<E;++T)(D=r[b[T].identifier])&&(dt(m),D("drag",m,b[T]))}function w(m){var b=m.changedTouches,E=b.length,T,D;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),T=0;T<E;++T)(D=r[b[T].identifier])&&(sn(m),D("end",m,b[T]))}function M(m,b,E,T,D,C){var $=o.copy(),k=rt(C||E,b),R,L,p;if((p=e.call(m,new gn("beforestart",{sourceEvent:E,target:f,identifier:D,active:s,x:k[0],y:k[1],dx:0,dy:0,dispatch:$}),T))!=null)return R=p.x-k[0]||0,L=p.y-k[1]||0,function N(x,A,z){var S=k,I;switch(x){case"start":r[D]=N,I=s++;break;case"end":delete r[D],--s;case"drag":k=rt(z||A,b),I=s;break}$.call(x,m,new gn(x,{sourceEvent:A,subject:p,target:f,identifier:D,active:I,x:k[0]+R,y:k[1]+L,dx:k[0]-S[0],dy:k[1]-S[1],dispatch:$}),T)}}return f.filter=function(m){return arguments.length?(t=typeof m=="function"?m:Tt(!!m),f):t},f.container=function(m){return arguments.length?(n=typeof m=="function"?m:Tt(m),f):n},f.subject=function(m){return arguments.length?(e=typeof m=="function"?m:Tt(m),f):e},f.touchable=function(m){return arguments.length?(i=typeof m=="function"?m:Tt(!!m),f):i},f.on=function(){var m=o.on.apply(o,arguments);return m===o?f:m},f.clickDistance=function(m){return arguments.length?(h=(m=+m)*m,f):Math.sqrt(h)},f}function Nn(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Ce(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function zt(){}var Nt=.7,Kt=1/Nt,gt="\\s*([+-]?\\d+)\\s*",At="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",J="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lo=/^#([0-9a-f]{3,8})$/,fo=new RegExp(`^rgb\\(${gt},${gt},${gt}\\)$`),ho=new RegExp(`^rgb\\(${J},${J},${J}\\)$`),go=new RegExp(`^rgba\\(${gt},${gt},${gt},${At}\\)$`),po=new RegExp(`^rgba\\(${J},${J},${J},${At}\\)$`),mo=new RegExp(`^hsl\\(${At},${J},${J}\\)$`),yo=new RegExp(`^hsla\\(${At},${J},${J},${At}\\)$`),Rn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Nn(zt,ft,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:On,formatHex:On,formatHex8:vo,formatHsl:_o,formatRgb:qn,toString:qn});function On(){return this.rgb().formatHex()}function vo(){return this.rgb().formatHex8()}function _o(){return Le(this).formatHsl()}function qn(){return this.rgb().formatRgb()}function ft(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=lo.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?Fn(n):e===3?new H(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?Dt(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?Dt(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=fo.exec(t))?new H(n[1],n[2],n[3],1):(n=ho.exec(t))?new H(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=go.exec(t))?Dt(n[1],n[2],n[3],n[4]):(n=po.exec(t))?Dt(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=mo.exec(t))?Bn(n[1],n[2]/100,n[3]/100,1):(n=yo.exec(t))?Bn(n[1],n[2]/100,n[3]/100,n[4]):Rn.hasOwnProperty(t)?Fn(Rn[t]):t==="transparent"?new H(NaN,NaN,NaN,0):null}function Fn(t){return new H(t>>16&255,t>>8&255,t&255,1)}function Dt(t,n,e,i){return i<=0&&(t=n=e=NaN),new H(t,n,e,i)}function xo(t){return t instanceof zt||(t=ft(t)),t?(t=t.rgb(),new H(t.r,t.g,t.b,t.opacity)):new H}function pn(t,n,e,i){return arguments.length===1?xo(t):new H(t,n,e,i??1)}function H(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}Nn(H,pn,Ce(zt,{brighter(t){return t=t==null?Kt:Math.pow(Kt,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Nt:Math.pow(Nt,t),new H(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new H(ct(this.r),ct(this.g),ct(this.b),Ut(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xn,formatHex:Xn,formatHex8:wo,formatRgb:Hn,toString:Hn}));function Xn(){return`#${ut(this.r)}${ut(this.g)}${ut(this.b)}`}function wo(){return`#${ut(this.r)}${ut(this.g)}${ut(this.b)}${ut((isNaN(this.opacity)?1:this.opacity)*255)}`}function Hn(){const t=Ut(this.opacity);return`${t===1?"rgb(":"rgba("}${ct(this.r)}, ${ct(this.g)}, ${ct(this.b)}${t===1?")":`, ${t})`}`}function Ut(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ct(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ut(t){return t=ct(t),(t<16?"0":"")+t.toString(16)}function Bn(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new G(t,n,e,i)}function Le(t){if(t instanceof G)return new G(t.h,t.s,t.l,t.opacity);if(t instanceof zt||(t=ft(t)),!t)return new G;if(t instanceof G)return t;t=t.rgb();var n=t.r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),o=Math.max(n,e,i),s=NaN,a=o-r,c=(o+r)/2;return a?(n===o?s=(e-i)/a+(e<i)*6:e===o?s=(i-n)/a+2:s=(n-e)/a+4,a/=c<.5?o+r:2-o-r,s*=60):a=c>0&&c<1?0:s,new G(s,a,c,t.opacity)}function bo(t,n,e,i){return arguments.length===1?Le(t):new G(t,n,e,i??1)}function G(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}Nn(G,bo,Ce(zt,{brighter(t){return t=t==null?Kt:Math.pow(Kt,t),new G(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Nt:Math.pow(Nt,t),new G(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new H(an(t>=240?t-240:t+120,r,i),an(t,r,i),an(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new G(Yn(this.h),It(this.s),It(this.l),Ut(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ut(this.opacity);return`${t===1?"hsl(":"hsla("}${Yn(this.h)}, ${It(this.s)*100}%, ${It(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Yn(t){return t=(t||0)%360,t<0?t+360:t}function It(t){return Math.max(0,Math.min(1,t||0))}function an(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}const An=t=>()=>t;function Mo(t,n){return function(e){return t+e*n}}function No(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(i){return Math.pow(t+i*n,e)}}function Ao(t){return(t=+t)==1?Pe:function(n,e){return e-n?No(n,e,t):An(isNaN(n)?e:n)}}function Pe(t,n){var e=n-t;return e?Mo(t,e):An(isNaN(t)?n:t)}const Wt=function t(n){var e=Ao(n);function i(r,o){var s=e((r=pn(r)).r,(o=pn(o)).r),a=e(r.g,o.g),c=e(r.b,o.b),u=Pe(r.opacity,o.opacity);return function(l){return r.r=s(l),r.g=a(l),r.b=c(l),r.opacity=u(l),r+""}}return i.gamma=t,i}(1);function ko(t,n){n||(n=[]);var e=t?Math.min(n.length,t.length):0,i=n.slice(),r;return function(o){for(r=0;r<e;++r)i[r]=t[r]*(1-o)+n[r]*o;return i}}function Eo(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function So(t,n){var e=n?n.length:0,i=t?Math.min(e,t.length):0,r=new Array(i),o=new Array(e),s;for(s=0;s<i;++s)r[s]=kn(t[s],n[s]);for(;s<e;++s)o[s]=n[s];return function(a){for(s=0;s<i;++s)o[s]=r[s](a);return o}}function zo(t,n){var e=new Date;return t=+t,n=+n,function(i){return e.setTime(t*(1-i)+n*i),e}}function W(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function To(t,n){var e={},i={},r;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(r in n)r in t?e[r]=kn(t[r],n[r]):i[r]=n[r];return function(o){for(r in e)i[r]=e[r](o);return i}}var mn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,un=new RegExp(mn.source,"g");function Do(t){return function(){return t}}function Io(t){return function(n){return t(n)+""}}function Re(t,n){var e=mn.lastIndex=un.lastIndex=0,i,r,o,s=-1,a=[],c=[];for(t=t+"",n=n+"";(i=mn.exec(t))&&(r=un.exec(n));)(o=r.index)>e&&(o=n.slice(e,o),a[s]?a[s]+=o:a[++s]=o),(i=i[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,c.push({i:s,x:W(i,r)})),e=un.lastIndex;return e<n.length&&(o=n.slice(e),a[s]?a[s]+=o:a[++s]=o),a.length<2?c[0]?Io(c[0].x):Do(n):(n=c.length,function(u){for(var l=0,h;l<n;++l)a[(h=c[l]).i]=h.x(u);return a.join("")})}function kn(t,n){var e=typeof n,i;return n==null||e==="boolean"?An(n):(e==="number"?W:e==="string"?(i=ft(n))?(n=i,Wt):Re:n instanceof ft?Wt:n instanceof Date?zo:Eo(n)?ko:Array.isArray(n)?So:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?To:W)(t,n)}function $o(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}var Vn=180/Math.PI,yn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Oe(t,n,e,i,r,o){var s,a,c;return(s=Math.sqrt(t*t+n*n))&&(t/=s,n/=s),(c=t*e+n*i)&&(e-=t*c,i-=n*c),(a=Math.sqrt(e*e+i*i))&&(e/=a,i/=a,c/=a),t*i<n*e&&(t=-t,n=-n,c=-c,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(n,t)*Vn,skewX:Math.atan(c)*Vn,scaleX:s,scaleY:a}}var $t;function Co(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?yn:Oe(n.a,n.b,n.c,n.d,n.e,n.f)}function Lo(t){return t==null||($t||($t=document.createElementNS("http://www.w3.org/2000/svg","g")),$t.setAttribute("transform",t),!(t=$t.transform.baseVal.consolidate()))?yn:(t=t.matrix,Oe(t.a,t.b,t.c,t.d,t.e,t.f))}function qe(t,n,e,i){function r(u){return u.length?u.pop()+" ":""}function o(u,l,h,f,d,_){if(u!==h||l!==f){var v=d.push("translate(",null,n,null,e);_.push({i:v-4,x:W(u,h)},{i:v-2,x:W(l,f)})}else(h||f)&&d.push("translate("+h+n+f+e)}function s(u,l,h,f){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),f.push({i:h.push(r(h)+"rotate(",null,i)-2,x:W(u,l)})):l&&h.push(r(h)+"rotate("+l+i)}function a(u,l,h,f){u!==l?f.push({i:h.push(r(h)+"skewX(",null,i)-2,x:W(u,l)}):l&&h.push(r(h)+"skewX("+l+i)}function c(u,l,h,f,d,_){if(u!==h||l!==f){var v=d.push(r(d)+"scale(",null,",",null,")");_.push({i:v-4,x:W(u,h)},{i:v-2,x:W(l,f)})}else(h!==1||f!==1)&&d.push(r(d)+"scale("+h+","+f+")")}return function(u,l){var h=[],f=[];return u=t(u),l=t(l),o(u.translateX,u.translateY,l.translateX,l.translateY,h,f),s(u.rotate,l.rotate,h,f),a(u.skewX,l.skewX,h,f),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,h,f),u=l=null,function(d){for(var _=-1,v=f.length,y;++_<v;)h[(y=f[_]).i]=y.x(d);return h.join("")}}}var Po=qe(Co,"px, ","px)","deg)"),Ro=qe(Lo,", ",")",")"),Oo=1e-12;function Kn(t){return((t=Math.exp(t))+1/t)/2}function qo(t){return((t=Math.exp(t))-1/t)/2}function Fo(t){return((t=Math.exp(2*t))-1)/(t+1)}const Fe=function t(n,e,i){function r(o,s){var a=o[0],c=o[1],u=o[2],l=s[0],h=s[1],f=s[2],d=l-a,_=h-c,v=d*d+_*_,y,g;if(v<Oo)g=Math.log(f/u)/n,y=function(T){return[a+T*d,c+T*_,u*Math.exp(n*T*g)]};else{var w=Math.sqrt(v),M=(f*f-u*u+i*v)/(2*u*e*w),m=(f*f-u*u-i*v)/(2*f*e*w),b=Math.log(Math.sqrt(M*M+1)-M),E=Math.log(Math.sqrt(m*m+1)-m);g=(E-b)/n,y=function(T){var D=T*g,C=Kn(b),$=u/(e*w)*(C*Fo(n*D+b)-qo(b));return[a+$*d,c+$*_,u*C/Kn(n*D+b)]}}return y.duration=g*1e3*n/Math.SQRT2,y}return r.rho=function(o){var s=Math.max(.001,+o),a=s*s,c=a*a;return t(s,a,c)},r}(Math.SQRT2,2,4);var mt=0,xt=0,vt=0,Xe=1e3,Gt,wt,Zt=0,ht=0,en=0,kt=typeof performance=="object"&&performance.now?performance:Date,He=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function En(){return ht||(He(Xo),ht=kt.now()+en)}function Xo(){ht=0}function Qt(){this._call=this._time=this._next=null}Qt.prototype=Sn.prototype={constructor:Qt,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?En():+e)+(n==null?0:+n),!this._next&&wt!==this&&(wt?wt._next=this:Gt=this,wt=this),this._call=t,this._time=e,vn()},stop:function(){this._call&&(this._call=null,this._time=1/0,vn())}};function Sn(t,n,e){var i=new Qt;return i.restart(t,n,e),i}function Ho(){En(),++mt;for(var t=Gt,n;t;)(n=ht-t._time)>=0&&t._call.call(void 0,n),t=t._next;--mt}function Un(){ht=(Zt=kt.now())+en,mt=xt=0;try{Ho()}finally{mt=0,Yo(),ht=0}}function Bo(){var t=kt.now(),n=t-Zt;n>Xe&&(en-=n,Zt=t)}function Yo(){for(var t,n=Gt,e,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Gt=e);wt=t,vn(i)}function vn(t){if(!mt){xt&&(xt=clearTimeout(xt));var n=t-ht;n>24?(t<1/0&&(xt=setTimeout(Un,t-kt.now()-en)),vt&&(vt=clearInterval(vt))):(vt||(Zt=kt.now(),vt=setInterval(Bo,Xe)),mt=1,He(Un))}}function Wn(t,n,e){var i=new Qt;return n=n==null?0:+n,i.restart(r=>{i.stop(),t(r+n)},n,e),i}var Vo=Et("start","end","cancel","interrupt"),Ko=[],Be=0,Gn=1,_n=2,Xt=3,Zn=4,xn=5,Ht=6;function rn(t,n,e,i,r,o){var s=t.__transition;if(!s)t.__transition={};else if(e in s)return;Uo(t,e,{name:n,index:i,group:r,on:Vo,tween:Ko,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Be})}function zn(t,n){var e=Z(t,n);if(e.state>Be)throw new Error("too late; already scheduled");return e}function tt(t,n){var e=Z(t,n);if(e.state>Xt)throw new Error("too late; already running");return e}function Z(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function Uo(t,n,e){var i=t.__transition,r;i[n]=e,e.timer=Sn(o,0,e.time);function o(u){e.state=Gn,e.timer.restart(s,e.delay,e.time),e.delay<=u&&s(u-e.delay)}function s(u){var l,h,f,d;if(e.state!==Gn)return c();for(l in i)if(d=i[l],d.name===e.name){if(d.state===Xt)return Wn(s);d.state===Zn?(d.state=Ht,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[l]):+l<n&&(d.state=Ht,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[l])}if(Wn(function(){e.state===Xt&&(e.state=Zn,e.timer.restart(a,e.delay,e.time),a(u))}),e.state=_n,e.on.call("start",t,t.__data__,e.index,e.group),e.state===_n){for(e.state=Xt,r=new Array(f=e.tween.length),l=0,h=-1;l<f;++l)(d=e.tween[l].value.call(t,t.__data__,e.index,e.group))&&(r[++h]=d);r.length=h+1}}function a(u){for(var l=u<e.duration?e.ease.call(null,u/e.duration):(e.timer.restart(c),e.state=xn,1),h=-1,f=r.length;++h<f;)r[h].call(t,l);e.state===xn&&(e.on.call("end",t,t.__data__,e.index,e.group),c())}function c(){e.state=Ht,e.timer.stop(),delete i[n];for(var u in i)return;delete t.__transition}}function Bt(t,n){var e=t.__transition,i,r,o=!0,s;if(e){n=n==null?null:n+"";for(s in e){if((i=e[s]).name!==n){o=!1;continue}r=i.state>_n&&i.state<xn,i.state=Ht,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete e[s]}o&&delete t.__transition}}function Wo(t){return this.each(function(){Bt(this,t)})}function Go(t,n){var e,i;return function(){var r=tt(this,t),o=r.tween;if(o!==e){i=e=o;for(var s=0,a=i.length;s<a;++s)if(i[s].name===n){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function Zo(t,n,e){var i,r;if(typeof e!="function")throw new Error;return function(){var o=tt(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:n,value:e},c=0,u=r.length;c<u;++c)if(r[c].name===n){r[c]=a;break}c===u&&r.push(a)}o.tween=r}}function Qo(t,n){var e=this._id;if(t+="",arguments.length<2){for(var i=Z(this.node(),e).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===t)return s.value;return null}return this.each((n==null?Go:Zo)(e,t,n))}function Tn(t,n,e){var i=t._id;return t.each(function(){var r=tt(this,i);(r.value||(r.value={}))[n]=e.apply(this,arguments)}),function(r){return Z(r,i).value[n]}}function Ye(t,n){var e;return(typeof n=="number"?W:n instanceof ft?Wt:(e=ft(n))?(n=e,Wt):Re)(t,n)}function jo(t){return function(){this.removeAttribute(t)}}function Jo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ts(t,n,e){var i,r=e+"",o;return function(){var s=this.getAttribute(t);return s===r?null:s===i?o:o=n(i=s,e)}}function ns(t,n,e){var i,r=e+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?o:o=n(i=s,e)}}function es(t,n,e){var i,r,o;return function(){var s,a=e(this),c;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=a+"",s===c?null:s===i&&c===r?o:(r=c,o=n(i=s,a)))}}function is(t,n,e){var i,r,o;return function(){var s,a=e(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=a+"",s===c?null:s===i&&c===r?o:(r=c,o=n(i=s,a)))}}function rs(t,n){var e=nn(t),i=e==="transform"?Ro:Ye;return this.attrTween(t,typeof n=="function"?(e.local?is:es)(e,i,Tn(this,"attr."+t,n)):n==null?(e.local?Jo:jo)(e):(e.local?ns:ts)(e,i,n))}function os(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function ss(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function as(t,n){var e,i;function r(){var o=n.apply(this,arguments);return o!==i&&(e=(i=o)&&ss(t,o)),e}return r._value=n,r}function us(t,n){var e,i;function r(){var o=n.apply(this,arguments);return o!==i&&(e=(i=o)&&os(t,o)),e}return r._value=n,r}function cs(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;var i=nn(t);return this.tween(e,(i.local?as:us)(i,n))}function ls(t,n){return function(){zn(this,t).delay=+n.apply(this,arguments)}}function fs(t,n){return n=+n,function(){zn(this,t).delay=n}}function hs(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?ls:fs)(n,t)):Z(this.node(),n).delay}function ds(t,n){return function(){tt(this,t).duration=+n.apply(this,arguments)}}function gs(t,n){return n=+n,function(){tt(this,t).duration=n}}function ps(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?ds:gs)(n,t)):Z(this.node(),n).duration}function ms(t,n){if(typeof n!="function")throw new Error;return function(){tt(this,t).ease=n}}function ys(t){var n=this._id;return arguments.length?this.each(ms(n,t)):Z(this.node(),n).ease}function vs(t,n){return function(){var e=n.apply(this,arguments);if(typeof e!="function")throw new Error;tt(this,t).ease=e}}function _s(t){if(typeof t!="function")throw new Error;return this.each(vs(this._id,t))}function xs(t){typeof t!="function"&&(t=be(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],s=o.length,a=i[r]=[],c,u=0;u<s;++u)(c=o[u])&&t.call(c,c.__data__,u,o)&&a.push(c);return new st(i,this._parents,this._name,this._id)}function ws(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,i=n.length,r=e.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var c=n[a],u=e[a],l=c.length,h=s[a]=new Array(l),f,d=0;d<l;++d)(f=c[d]||u[d])&&(h[d]=f);for(;a<i;++a)s[a]=n[a];return new st(s,this._parents,this._name,this._id)}function bs(t){return(t+"").trim().split(/^|\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||n==="start"})}function Ms(t,n,e){var i,r,o=bs(n)?zn:tt;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(n,e),s.on=r}}function Ns(t,n){var e=this._id;return arguments.length<2?Z(this.node(),e).on.on(t):this.each(Ms(e,t,n))}function As(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function ks(){return this.on("end.remove",As(this._id))}function Es(t){var n=this._name,e=this._id;typeof t!="function"&&(t=bn(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a=i[s],c=a.length,u=o[s]=new Array(c),l,h,f=0;f<c;++f)(l=a[f])&&(h=t.call(l,l.__data__,f,a))&&("__data__"in l&&(h.__data__=l.__data__),u[f]=h,rn(u[f],n,e,f,u,Z(l,e)));return new st(o,this._parents,n,e)}function Ss(t){var n=this._name,e=this._id;typeof t!="function"&&(t=we(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var c=i[a],u=c.length,l,h=0;h<u;++h)if(l=c[h]){for(var f=t.call(l,l.__data__,h,c),d,_=Z(l,e),v=0,y=f.length;v<y;++v)(d=f[v])&&rn(d,n,e,v,f,_);o.push(f),s.push(l)}return new st(o,s,n,e)}var zs=St.prototype.constructor;function Ts(){return new zs(this._groups,this._parents)}function Ds(t,n){var e,i,r;return function(){var o=pt(this,t),s=(this.style.removeProperty(t),pt(this,t));return o===s?null:o===e&&s===i?r:r=n(e=o,i=s)}}function Ve(t){return function(){this.style.removeProperty(t)}}function Is(t,n,e){var i,r=e+"",o;return function(){var s=pt(this,t);return s===r?null:s===i?o:o=n(i=s,e)}}function $s(t,n,e){var i,r,o;return function(){var s=pt(this,t),a=e(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),pt(this,t))),s===c?null:s===i&&c===r?o:(r=c,o=n(i=s,a))}}function Cs(t,n){var e,i,r,o="style."+n,s="end."+o,a;return function(){var c=tt(this,t),u=c.on,l=c.value[o]==null?a||(a=Ve(n)):void 0;(u!==e||r!==l)&&(i=(e=u).copy()).on(s,r=l),c.on=i}}function Ls(t,n,e){var i=(t+="")=="transform"?Po:Ye;return n==null?this.styleTween(t,Ds(t,i)).on("end.style."+t,Ve(t)):typeof n=="function"?this.styleTween(t,$s(t,i,Tn(this,"style."+t,n))).each(Cs(this._id,t)):this.styleTween(t,Is(t,i,n),e).on("end.style."+t,null)}function Ps(t,n,e){return function(i){this.style.setProperty(t,n.call(this,i),e)}}function Rs(t,n,e){var i,r;function o(){var s=n.apply(this,arguments);return s!==r&&(i=(r=s)&&Ps(t,s,e)),i}return o._value=n,o}function Os(t,n,e){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;return this.tween(i,Rs(t,n,e??""))}function qs(t){return function(){this.textContent=t}}function Fs(t){return function(){var n=t(this);this.textContent=n??""}}function Xs(t){return this.tween("text",typeof t=="function"?Fs(Tn(this,"text",t)):qs(t==null?"":t+""))}function Hs(t){return function(n){this.textContent=t.call(this,n)}}function Bs(t){var n,e;function i(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&Hs(r)),n}return i._value=t,i}function Ys(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Bs(t))}function Vs(){for(var t=this._name,n=this._id,e=Ke(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=Z(c,n);rn(c,t,e,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new st(i,this._parents,t,e)}function Ks(){var t,n,e=this,i=e._id,r=e.size();return new Promise(function(o,s){var a={value:s},c={value:function(){--r===0&&o()}};e.each(function(){var u=tt(this,i),l=u.on;l!==t&&(n=(t=l).copy(),n._.cancel.push(a),n._.interrupt.push(a),n._.end.push(c)),u.on=n}),r===0&&o()})}var Us=0;function st(t,n,e,i){this._groups=t,this._parents=n,this._name=e,this._id=i}function Ke(){return++Us}var it=St.prototype;st.prototype={constructor:st,select:Es,selectAll:Ss,selectChild:it.selectChild,selectChildren:it.selectChildren,filter:xs,merge:ws,selection:Ts,transition:Vs,call:it.call,nodes:it.nodes,node:it.node,size:it.size,empty:it.empty,each:it.each,on:Ns,attr:rs,attrTween:cs,style:Ls,styleTween:Os,text:Xs,textTween:Ys,remove:ks,tween:Qo,delay:hs,duration:ps,ease:ys,easeVarying:_s,end:Ks,[Symbol.iterator]:it[Symbol.iterator]};function Ws(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Gs={time:null,delay:0,duration:250,ease:Ws};function Zs(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}function Qs(t){var n,e;t instanceof st?(n=t._id,t=t._name):(n=Ke(),(e=Gs).time=En(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,c,u=0;u<a;++u)(c=s[u])&&rn(c,t,n,u,s,e||Zs(c,n));return new st(i,this._parents,t,n)}St.prototype.interrupt=Wo;St.prototype.transition=Qs;function js(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function Ue(t,n){return fetch(t,n).then(js)}function Js(t,n){var e,i=1;t==null&&(t=0),n==null&&(n=0);function r(){var o,s=e.length,a,c=0,u=0;for(o=0;o<s;++o)a=e[o],c+=a.x,u+=a.y;for(c=(c/s-t)*i,u=(u/s-n)*i,o=0;o<s;++o)a=e[o],a.x-=c,a.y-=u}return r.initialize=function(o){e=o},r.x=function(o){return arguments.length?(t=+o,r):t},r.y=function(o){return arguments.length?(n=+o,r):n},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function ta(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return We(this.cover(n,e),n,e,t)}function We(t,n,e,i){if(isNaN(n)||isNaN(e))return t;var r,o=t._root,s={data:i},a=t._x0,c=t._y0,u=t._x1,l=t._y1,h,f,d,_,v,y,g,w;if(!o)return t._root=s,t;for(;o.length;)if((v=n>=(h=(a+u)/2))?a=h:u=h,(y=e>=(f=(c+l)/2))?c=f:l=f,r=o,!(o=o[g=y<<1|v]))return r[g]=s,t;if(d=+t._x.call(null,o.data),_=+t._y.call(null,o.data),n===d&&e===_)return s.next=o,r?r[g]=s:t._root=s,t;do r=r?r[g]=new Array(4):t._root=new Array(4),(v=n>=(h=(a+u)/2))?a=h:u=h,(y=e>=(f=(c+l)/2))?c=f:l=f;while((g=y<<1|v)===(w=(_>=f)<<1|d>=h));return r[w]=o,r[g]=s,t}function na(t){var n,e,i=t.length,r,o,s=new Array(i),a=new Array(i),c=1/0,u=1/0,l=-1/0,h=-1/0;for(e=0;e<i;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(o=+this._y.call(null,n))||(s[e]=r,a[e]=o,r<c&&(c=r),r>l&&(l=r),o<u&&(u=o),o>h&&(h=o));if(c>l||u>h)return this;for(this.cover(c,u).cover(l,h),e=0;e<i;++e)We(this,s[e],a[e],t[e]);return this}function ea(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(e))r=(e=Math.floor(t))+1,o=(i=Math.floor(n))+1;else{for(var s=r-e||1,a=this._root,c,u;e>t||t>=r||i>n||n>=o;)switch(u=(n<i)<<1|t<e,c=new Array(4),c[u]=a,a=c,s*=2,u){case 0:r=e+s,o=i+s;break;case 1:e=r-s,o=i+s;break;case 2:r=e+s,i=o-s;break;case 3:e=r-s,i=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=e,this._y0=i,this._x1=r,this._y1=o,this}function ia(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function ra(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function F(t,n,e,i,r){this.node=t,this.x0=n,this.y0=e,this.x1=i,this.y1=r}function oa(t,n,e){var i,r=this._x0,o=this._y0,s,a,c,u,l=this._x1,h=this._y1,f=[],d=this._root,_,v;for(d&&f.push(new F(d,r,o,l,h)),e==null?e=1/0:(r=t-e,o=n-e,l=t+e,h=n+e,e*=e);_=f.pop();)if(!(!(d=_.node)||(s=_.x0)>l||(a=_.y0)>h||(c=_.x1)<r||(u=_.y1)<o))if(d.length){var y=(s+c)/2,g=(a+u)/2;f.push(new F(d[3],y,g,c,u),new F(d[2],s,g,y,u),new F(d[1],y,a,c,g),new F(d[0],s,a,y,g)),(v=(n>=g)<<1|t>=y)&&(_=f[f.length-1],f[f.length-1]=f[f.length-1-v],f[f.length-1-v]=_)}else{var w=t-+this._x.call(null,d.data),M=n-+this._y.call(null,d.data),m=w*w+M*M;if(m<e){var b=Math.sqrt(e=m);r=t-b,o=n-b,l=t+b,h=n+b,i=d.data}}return i}function sa(t){if(isNaN(l=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var n,e=this._root,i,r,o,s=this._x0,a=this._y0,c=this._x1,u=this._y1,l,h,f,d,_,v,y,g;if(!e)return this;if(e.length)for(;;){if((_=l>=(f=(s+c)/2))?s=f:c=f,(v=h>=(d=(a+u)/2))?a=d:u=d,n=e,!(e=e[y=v<<1|_]))return this;if(!e.length)break;(n[y+1&3]||n[y+2&3]||n[y+3&3])&&(i=n,g=y)}for(;e.data!==t;)if(r=e,!(e=e.next))return this;return(o=e.next)&&delete e.next,r?(o?r.next=o:delete r.next,this):n?(o?n[y]=o:delete n[y],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(i?i[g]=e:this._root=e),this):(this._root=o,this)}function aa(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function ua(){return this._root}function ca(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function la(t){var n=[],e,i=this._root,r,o,s,a,c;for(i&&n.push(new F(i,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(i=e.node,o=e.x0,s=e.y0,a=e.x1,c=e.y1)&&i.length){var u=(o+a)/2,l=(s+c)/2;(r=i[3])&&n.push(new F(r,u,l,a,c)),(r=i[2])&&n.push(new F(r,o,l,u,c)),(r=i[1])&&n.push(new F(r,u,s,a,l)),(r=i[0])&&n.push(new F(r,o,s,u,l))}return this}function fa(t){var n=[],e=[],i;for(this._root&&n.push(new F(this._root,this._x0,this._y0,this._x1,this._y1));i=n.pop();){var r=i.node;if(r.length){var o,s=i.x0,a=i.y0,c=i.x1,u=i.y1,l=(s+c)/2,h=(a+u)/2;(o=r[0])&&n.push(new F(o,s,a,l,h)),(o=r[1])&&n.push(new F(o,l,a,c,h)),(o=r[2])&&n.push(new F(o,s,h,l,u)),(o=r[3])&&n.push(new F(o,l,h,c,u))}e.push(i)}for(;i=e.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function ha(t){return t[0]}function da(t){return arguments.length?(this._x=t,this):this._x}function ga(t){return t[1]}function pa(t){return arguments.length?(this._y=t,this):this._y}function Dn(t,n,e){var i=new In(n??ha,e??ga,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function In(t,n,e,i,r,o){this._x=t,this._y=n,this._x0=e,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Qn(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var X=Dn.prototype=In.prototype;X.copy=function(){var t=new In(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,i;if(!n)return t;if(!n.length)return t._root=Qn(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var r=0;r<4;++r)(i=n.source[r])&&(i.length?e.push({source:i,target:n.target[r]=new Array(4)}):n.target[r]=Qn(i));return t};X.add=ta;X.addAll=na;X.cover=ea;X.data=ia;X.extent=ra;X.find=oa;X.remove=sa;X.removeAll=aa;X.root=ua;X.size=ca;X.visit=la;X.visitAfter=fa;X.x=da;X.y=pa;function lt(t){return function(){return t}}function at(t){return(t()-.5)*1e-6}function ma(t){return t.x+t.vx}function ya(t){return t.y+t.vy}function va(t){var n,e,i,r=1,o=1;typeof t!="function"&&(t=lt(t==null?1:+t));function s(){for(var u,l=n.length,h,f,d,_,v,y,g=0;g<o;++g)for(h=Dn(n,ma,ya).visitAfter(a),u=0;u<l;++u)f=n[u],v=e[f.index],y=v*v,d=f.x+f.vx,_=f.y+f.vy,h.visit(w);function w(M,m,b,E,T){var D=M.data,C=M.r,$=v+C;if(D){if(D.index>f.index){var k=d-D.x-D.vx,R=_-D.y-D.vy,L=k*k+R*R;L<$*$&&(k===0&&(k=at(i),L+=k*k),R===0&&(R=at(i),L+=R*R),L=($-(L=Math.sqrt(L)))/L*r,f.vx+=(k*=L)*($=(C*=C)/(y+C)),f.vy+=(R*=L)*$,D.vx-=k*($=1-$),D.vy-=R*$)}return}return m>d+$||E<d-$||b>_+$||T<_-$}}function a(u){if(u.data)return u.r=e[u.data.index];for(var l=u.r=0;l<4;++l)u[l]&&u[l].r>u.r&&(u.r=u[l].r)}function c(){if(n){var u,l=n.length,h;for(e=new Array(l),u=0;u<l;++u)h=n[u],e[h.index]=+t(h,u,n)}}return s.initialize=function(u,l){n=u,i=l,c()},s.iterations=function(u){return arguments.length?(o=+u,s):o},s.strength=function(u){return arguments.length?(r=+u,s):r},s.radius=function(u){return arguments.length?(t=typeof u=="function"?u:lt(+u),c(),s):t},s}function _a(t){return t.index}function jn(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function xa(t){var n=_a,e=h,i,r=lt(30),o,s,a,c,u,l=1;t==null&&(t=[]);function h(y){return 1/Math.min(a[y.source.index],a[y.target.index])}function f(y){for(var g=0,w=t.length;g<l;++g)for(var M=0,m,b,E,T,D,C,$;M<w;++M)m=t[M],b=m.source,E=m.target,T=E.x+E.vx-b.x-b.vx||at(u),D=E.y+E.vy-b.y-b.vy||at(u),C=Math.sqrt(T*T+D*D),C=(C-o[M])/C*y*i[M],T*=C,D*=C,E.vx-=T*($=c[M]),E.vy-=D*$,b.vx+=T*($=1-$),b.vy+=D*$}function d(){if(s){var y,g=s.length,w=t.length,M=new Map(s.map((b,E)=>[n(b,E,s),b])),m;for(y=0,a=new Array(g);y<w;++y)m=t[y],m.index=y,typeof m.source!="object"&&(m.source=jn(M,m.source)),typeof m.target!="object"&&(m.target=jn(M,m.target)),a[m.source.index]=(a[m.source.index]||0)+1,a[m.target.index]=(a[m.target.index]||0)+1;for(y=0,c=new Array(w);y<w;++y)m=t[y],c[y]=a[m.source.index]/(a[m.source.index]+a[m.target.index]);i=new Array(w),_(),o=new Array(w),v()}}function _(){if(s)for(var y=0,g=t.length;y<g;++y)i[y]=+e(t[y],y,t)}function v(){if(s)for(var y=0,g=t.length;y<g;++y)o[y]=+r(t[y],y,t)}return f.initialize=function(y,g){s=y,u=g,d()},f.links=function(y){return arguments.length?(t=y,d(),f):t},f.id=function(y){return arguments.length?(n=y,f):n},f.iterations=function(y){return arguments.length?(l=+y,f):l},f.strength=function(y){return arguments.length?(e=typeof y=="function"?y:lt(+y),_(),f):e},f.distance=function(y){return arguments.length?(r=typeof y=="function"?y:lt(+y),v(),f):r},f}const wa=1664525,ba=1013904223,Jn=4294967296;function Ma(){let t=1;return()=>(t=(wa*t+ba)%Jn)/Jn}function Na(t){return t.x}function Aa(t){return t.y}var ka=10,Ea=Math.PI*(3-Math.sqrt(5));function Sa(t){var n,e=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,c=Sn(h),u=Et("tick","end"),l=Ma();t==null&&(t=[]);function h(){f(),u.call("tick",n),e<i&&(c.stop(),u.call("end",n))}function f(v){var y,g=t.length,w;v===void 0&&(v=1);for(var M=0;M<v;++M)for(e+=(o-e)*r,a.forEach(function(m){m(e)}),y=0;y<g;++y)w=t[y],w.fx==null?w.x+=w.vx*=s:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=s:(w.y=w.fy,w.vy=0);return n}function d(){for(var v=0,y=t.length,g;v<y;++v){if(g=t[v],g.index=v,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var w=ka*Math.sqrt(.5+v),M=v*Ea;g.x=w*Math.cos(M),g.y=w*Math.sin(M)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function _(v){return v.initialize&&v.initialize(t,l),v}return d(),n={tick:f,restart:function(){return c.restart(h),n},stop:function(){return c.stop(),n},nodes:function(v){return arguments.length?(t=v,d(),a.forEach(_),n):t},alpha:function(v){return arguments.length?(e=+v,n):e},alphaMin:function(v){return arguments.length?(i=+v,n):i},alphaDecay:function(v){return arguments.length?(r=+v,n):+r},alphaTarget:function(v){return arguments.length?(o=+v,n):o},velocityDecay:function(v){return arguments.length?(s=1-v,n):1-s},randomSource:function(v){return arguments.length?(l=v,a.forEach(_),n):l},force:function(v,y){return arguments.length>1?(y==null?a.delete(v):a.set(v,_(y)),n):a.get(v)},find:function(v,y,g){var w=0,M=t.length,m,b,E,T,D;for(g==null?g=1/0:g*=g,w=0;w<M;++w)T=t[w],m=v-T.x,b=y-T.y,E=m*m+b*b,E<g&&(D=T,g=E);return D},on:function(v,y){return arguments.length>1?(u.on(v,y),n):u.on(v)}}}function za(){var t,n,e,i,r=lt(-30),o,s=1,a=1/0,c=.81;function u(d){var _,v=t.length,y=Dn(t,Na,Aa).visitAfter(h);for(i=d,_=0;_<v;++_)n=t[_],y.visit(f)}function l(){if(t){var d,_=t.length,v;for(o=new Array(_),d=0;d<_;++d)v=t[d],o[v.index]=+r(v,d,t)}}function h(d){var _=0,v,y,g=0,w,M,m;if(d.length){for(w=M=m=0;m<4;++m)(v=d[m])&&(y=Math.abs(v.value))&&(_+=v.value,g+=y,w+=y*v.x,M+=y*v.y);d.x=w/g,d.y=M/g}else{v=d,v.x=v.data.x,v.y=v.data.y;do _+=o[v.data.index];while(v=v.next)}d.value=_}function f(d,_,v,y){if(!d.value)return!0;var g=d.x-n.x,w=d.y-n.y,M=y-_,m=g*g+w*w;if(M*M/c<m)return m<a&&(g===0&&(g=at(e),m+=g*g),w===0&&(w=at(e),m+=w*w),m<s&&(m=Math.sqrt(s*m)),n.vx+=g*d.value*i/m,n.vy+=w*d.value*i/m),!0;if(d.length||m>=a)return;(d.data!==n||d.next)&&(g===0&&(g=at(e),m+=g*g),w===0&&(w=at(e),m+=w*w),m<s&&(m=Math.sqrt(s*m)));do d.data!==n&&(M=o[d.data.index]*i/m,n.vx+=g*M,n.vy+=w*M);while(d=d.next)}return u.initialize=function(d,_){t=d,e=_,l()},u.strength=function(d){return arguments.length?(r=typeof d=="function"?d:lt(+d),l(),u):r},u.distanceMin=function(d){return arguments.length?(s=d*d,u):Math.sqrt(s)},u.distanceMax=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.theta=function(d){return arguments.length?(c=d*d,u):Math.sqrt(c)},u}function Ta(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function jt(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,i=t.slice(0,e);return[i.length>1?i[0]+i.slice(2):i,+t.slice(e+1)]}function yt(t){return t=jt(Math.abs(t)),t?t[1]:NaN}function Da(t,n){return function(e,i){for(var r=e.length,o=[],s=0,a=t[0],c=0;r>0&&a>0&&(c+a+1>i&&(a=Math.max(1,i-c)),o.push(e.substring(r-=a,r+a)),!((c+=a+1)>i));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}}function Ia(t){return function(n){return n.replace(/[0-9]/g,function(e){return t[+e]})}}var $a=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Jt(t){if(!(n=$a.exec(t)))throw new Error("invalid format: "+t);var n;return new $n({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Jt.prototype=$n.prototype;function $n(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}$n.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ca(t){t:for(var n=t.length,e=1,i=-1,r;e<n;++e)switch(t[e]){case".":i=r=e;break;case"0":i===0&&(i=e),r=e;break;default:if(!+t[e])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var Ge;function La(t,n){var e=jt(t,n);if(!e)return t+"";var i=e[0],r=e[1],o=r-(Ge=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+jt(t,Math.max(0,n+o-1))[0]}function te(t,n){var e=jt(t,n);if(!e)return t+"";var i=e[0],r=e[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const ne={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ta,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>te(t*100,n),r:te,s:La,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ee(t){return t}var ie=Array.prototype.map,re=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Pa(t){var n=t.grouping===void 0||t.thousands===void 0?ee:Da(ie.call(t.grouping,Number),t.thousands+""),e=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?ee:Ia(ie.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(h){h=Jt(h);var f=h.fill,d=h.align,_=h.sign,v=h.symbol,y=h.zero,g=h.width,w=h.comma,M=h.precision,m=h.trim,b=h.type;b==="n"?(w=!0,b="g"):ne[b]||(M===void 0&&(M=12),m=!0,b="g"),(y||f==="0"&&d==="=")&&(y=!0,f="0",d="=");var E=v==="$"?e:v==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",T=v==="$"?i:/[%p]/.test(b)?s:"",D=ne[b],C=/[defgprs%]/.test(b);M=M===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function $(k){var R=E,L=T,p,N,x;if(b==="c")L=D(k)+L,k="";else{k=+k;var A=k<0||1/k<0;if(k=isNaN(k)?c:D(Math.abs(k),M),m&&(k=Ca(k)),A&&+k==0&&_!=="+"&&(A=!1),R=(A?_==="("?_:a:_==="-"||_==="("?"":_)+R,L=(b==="s"?re[8+Ge/3]:"")+L+(A&&_==="("?")":""),C){for(p=-1,N=k.length;++p<N;)if(x=k.charCodeAt(p),48>x||x>57){L=(x===46?r+k.slice(p+1):k.slice(p))+L,k=k.slice(0,p);break}}}w&&!y&&(k=n(k,1/0));var z=R.length+k.length+L.length,S=z<g?new Array(g-z+1).join(f):"";switch(w&&y&&(k=n(S+k,S.length?g-L.length:1/0),S=""),d){case"<":k=R+k+L+S;break;case"=":k=R+S+k+L;break;case"^":k=S.slice(0,z=S.length>>1)+R+k+L+S.slice(z);break;default:k=S+R+k+L;break}return o(k)}return $.toString=function(){return h+""},$}function l(h,f){var d=u((h=Jt(h),h.type="f",h)),_=Math.max(-8,Math.min(8,Math.floor(yt(f)/3)))*3,v=Math.pow(10,-_),y=re[8+_/3];return function(g){return d(v*g)+y}}return{format:u,formatPrefix:l}}var Ct,Ze,Qe;Ra({thousands:",",grouping:[3],currency:["$",""]});function Ra(t){return Ct=Pa(t),Ze=Ct.format,Qe=Ct.formatPrefix,Ct}function Oa(t){return Math.max(0,-yt(Math.abs(t)))}function qa(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yt(n)/3)))*3-yt(Math.abs(t)))}function Fa(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,yt(n)-yt(t))+1}function Xa(t){var n=0,e=t.children,i=e&&e.length;if(!i)n=1;else for(;--i>=0;)n+=e[i].value;t.value=n}function Ha(){return this.eachAfter(Xa)}function Ba(t,n){let e=-1;for(const i of this)t.call(n,i,++e,this);return this}function Ya(t,n){for(var e=this,i=[e],r,o,s=-1;e=i.pop();)if(t.call(n,e,++s,this),r=e.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function Va(t,n){for(var e=this,i=[e],r=[],o,s,a,c=-1;e=i.pop();)if(r.push(e),o=e.children)for(s=0,a=o.length;s<a;++s)i.push(o[s]);for(;e=r.pop();)t.call(n,e,++c,this);return this}function Ka(t,n){let e=-1;for(const i of this)if(t.call(n,i,++e,this))return i}function Ua(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,i=n.children,r=i&&i.length;--r>=0;)e+=i[r].value;n.value=e})}function Wa(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})}function Ga(t){for(var n=this,e=Za(n,t),i=[n];n!==e;)n=n.parent,i.push(n);for(var r=i.length;t!==e;)i.splice(r,0,t),t=t.parent;return i}function Za(t,n){if(t===n)return t;var e=t.ancestors(),i=n.ancestors(),r=null;for(t=e.pop(),n=i.pop();t===n;)r=t,t=e.pop(),n=i.pop();return r}function Qa(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n}function ja(){return Array.from(this)}function Ja(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t}function tu(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n}function*nu(){var t=this,n,e=[t],i,r,o;do for(n=e.reverse(),e=[];t=n.pop();)if(yield t,i=t.children)for(r=0,o=i.length;r<o;++r)e.push(i[r]);while(e.length)}function Cn(t,n){t instanceof Map?(t=[void 0,t],n===void 0&&(n=ru)):n===void 0&&(n=iu);for(var e=new tn(t),i,r=[e],o,s,a,c;i=r.pop();)if((s=n(i.data))&&(c=(s=Array.from(s)).length))for(i.children=s,a=c-1;a>=0;--a)r.push(o=s[a]=new tn(s[a])),o.parent=i,o.depth=i.depth+1;return e.eachBefore(su)}function eu(){return Cn(this).eachBefore(ou)}function iu(t){return t.children}function ru(t){return Array.isArray(t)?t[1]:null}function ou(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function su(t){var n=0;do t.height=n;while((t=t.parent)&&t.height<++n)}function tn(t){this.data=t,this.depth=this.height=0,this.parent=null}tn.prototype=Cn.prototype={constructor:tn,count:Ha,each:Ba,eachAfter:Va,eachBefore:Ya,find:Ka,sum:Ua,sort:Wa,path:Ga,ancestors:Qa,descendants:ja,leaves:Ja,links:tu,copy:eu,[Symbol.iterator]:nu};function au(t){return t==null?null:uu(t)}function uu(t){if(typeof t!="function")throw new Error;return t}function oe(){return 0}function cu(t){return function(){return t}}const lu=1664525,fu=1013904223,se=4294967296;function hu(){let t=1;return()=>(t=(lu*t+fu)%se)/se}function du(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function gu(t,n){let e=t.length,i,r;for(;e;)r=n()*e--|0,i=t[e],t[e]=t[r],t[r]=i;return t}function pu(t,n){for(var e=0,i=(t=gu(Array.from(t),n)).length,r=[],o,s;e<i;)o=t[e],s&&je(s,o)?++e:(s=yu(r=mu(r,o)),e=0);return s}function mu(t,n){var e,i;if(cn(n,t))return[n];for(e=0;e<t.length;++e)if(Lt(n,t[e])&&cn(bt(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(i=e+1;i<t.length;++i)if(Lt(bt(t[e],t[i]),n)&&Lt(bt(t[e],n),t[i])&&Lt(bt(t[i],n),t[e])&&cn(Je(t[e],t[i],n),t))return[t[e],t[i],n];throw new Error}function Lt(t,n){var e=t.r-n.r,i=n.x-t.x,r=n.y-t.y;return e<0||e*e<i*i+r*r}function je(t,n){var e=t.r-n.r+Math.max(t.r,n.r,1)*1e-9,i=n.x-t.x,r=n.y-t.y;return e>0&&e*e>i*i+r*r}function cn(t,n){for(var e=0;e<n.length;++e)if(!je(t,n[e]))return!1;return!0}function yu(t){switch(t.length){case 1:return vu(t[0]);case 2:return bt(t[0],t[1]);case 3:return Je(t[0],t[1],t[2])}}function vu(t){return{x:t.x,y:t.y,r:t.r}}function bt(t,n){var e=t.x,i=t.y,r=t.r,o=n.x,s=n.y,a=n.r,c=o-e,u=s-i,l=a-r,h=Math.sqrt(c*c+u*u);return{x:(e+o+c/h*l)/2,y:(i+s+u/h*l)/2,r:(h+r+a)/2}}function Je(t,n,e){var i=t.x,r=t.y,o=t.r,s=n.x,a=n.y,c=n.r,u=e.x,l=e.y,h=e.r,f=i-s,d=i-u,_=r-a,v=r-l,y=c-o,g=h-o,w=i*i+r*r-o*o,M=w-s*s-a*a+c*c,m=w-u*u-l*l+h*h,b=d*_-f*v,E=(_*m-v*M)/(b*2)-i,T=(v*y-_*g)/b,D=(d*M-f*m)/(b*2)-r,C=(f*g-d*y)/b,$=T*T+C*C-1,k=2*(o+E*T+D*C),R=E*E+D*D-o*o,L=-(Math.abs($)>1e-6?(k+Math.sqrt(k*k-4*$*R))/(2*$):R/k);return{x:i+E+T*L,y:r+D+C*L,r:L}}function ae(t,n,e){var i=t.x-n.x,r,o,s=t.y-n.y,a,c,u=i*i+s*s;u?(o=n.r+e.r,o*=o,c=t.r+e.r,c*=c,o>c?(r=(u+c-o)/(2*u),a=Math.sqrt(Math.max(0,c/u-r*r)),e.x=t.x-r*i-a*s,e.y=t.y-r*s+a*i):(r=(u+o-c)/(2*u),a=Math.sqrt(Math.max(0,o/u-r*r)),e.x=n.x+r*i-a*s,e.y=n.y+r*s+a*i)):(e.x=n.x+e.r,e.y=n.y)}function ue(t,n){var e=t.r+n.r-1e-6,i=n.x-t.x,r=n.y-t.y;return e>0&&e*e>i*i+r*r}function ce(t){var n=t._,e=t.next._,i=n.r+e.r,r=(n.x*e.r+e.x*n.r)/i,o=(n.y*e.r+e.y*n.r)/i;return r*r+o*o}function Pt(t){this._=t,this.next=null,this.previous=null}function _u(t,n){if(!(o=(t=du(t)).length))return 0;var e,i,r,o,s,a,c,u,l,h,f;if(e=t[0],e.x=0,e.y=0,!(o>1))return e.r;if(i=t[1],e.x=-i.r,i.x=e.r,i.y=0,!(o>2))return e.r+i.r;ae(i,e,r=t[2]),e=new Pt(e),i=new Pt(i),r=new Pt(r),e.next=r.previous=i,i.next=e.previous=r,r.next=i.previous=e;t:for(c=3;c<o;++c){ae(e._,i._,r=t[c]),r=new Pt(r),u=i.next,l=e.previous,h=i._.r,f=e._.r;do if(h<=f){if(ue(u._,r._)){i=u,e.next=i,i.previous=e,--c;continue t}h+=u._.r,u=u.next}else{if(ue(l._,r._)){e=l,e.next=i,i.previous=e,--c;continue t}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=e,r.next=i,e.next=i.previous=i=r,s=ce(e);(r=r.next)!==i;)(a=ce(r))<s&&(e=r,s=a);i=e.next}for(e=[i._],r=i;(r=r.next)!==i;)e.push(r._);for(r=pu(e,n),c=0;c<o;++c)e=t[c],e.x-=r.x,e.y-=r.y;return r.r}function xu(t){return Math.sqrt(t.value)}function wu(){var t=null,n=1,e=1,i=oe;function r(o){const s=hu();return o.x=n/2,o.y=e/2,t?o.eachBefore(le(t)).eachAfter(ln(i,.5,s)).eachBefore(fe(1)):o.eachBefore(le(xu)).eachAfter(ln(oe,1,s)).eachAfter(ln(i,o.r/Math.min(n,e),s)).eachBefore(fe(Math.min(n,e)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(t=au(o),r):t},r.size=function(o){return arguments.length?(n=+o[0],e=+o[1],r):[n,e]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:cu(+o),r):i},r}function le(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function ln(t,n,e){return function(i){if(r=i.children){var r,o,s=r.length,a=t(i)*n||0,c;if(a)for(o=0;o<s;++o)r[o].r+=a;if(c=_u(r,e),a)for(o=0;o<s;++o)r[o].r-=a;i.r=c+a}}}function fe(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function ti(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function bu(t){return function(){return t}}function Mu(t){return+t}var he=[0,1];function j(t){return t}function wn(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:bu(isNaN(n)?NaN:.5)}function Nu(t,n){var e;return t>n&&(e=t,t=n,n=e),function(i){return Math.max(t,Math.min(n,i))}}function Au(t,n,e){var i=t[0],r=t[1],o=n[0],s=n[1];return r<i?(i=wn(r,i),o=e(s,o)):(i=wn(i,r),o=e(o,s)),function(a){return o(i(a))}}function ku(t,n,e){var i=Math.min(t.length,n.length)-1,r=new Array(i),o=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++s<i;)r[s]=wn(t[s],t[s+1]),o[s]=e(n[s],n[s+1]);return function(a){var c=gi(t,a,1,i)-1;return o[c](r[c](a))}}function ni(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ei(){var t=he,n=he,e=kn,i,r,o,s=j,a,c,u;function l(){var f=Math.min(t.length,n.length);return s!==j&&(s=Nu(t[0],t[f-1])),a=f>2?ku:Au,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?o:(c||(c=a(t.map(i),n,e)))(i(s(f)))}return h.invert=function(f){return s(r((u||(u=a(n,t.map(i),W)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,Mu),l()):t.slice()},h.range=function(f){return arguments.length?(n=Array.from(f),l()):n.slice()},h.rangeRound=function(f){return n=Array.from(f),e=$o,l()},h.clamp=function(f){return arguments.length?(s=f?!0:j,l()):s!==j},h.interpolate=function(f){return arguments.length?(e=f,l()):e},h.unknown=function(f){return arguments.length?(o=f,h):o},function(f,d){return i=f,r=d,l()}}function Eu(){return ei()(j,j)}function Su(t,n,e,i){var r=_i(t,n,e),o;switch(i=Jt(i??",f"),i.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(n));return i.precision==null&&!isNaN(o=qa(r,s))&&(i.precision=o),Qe(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=Fa(r,Math.max(Math.abs(t),Math.abs(n))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=Oa(r))&&(i.precision=o-(i.type==="%")*2);break}}return Ze(i)}function ii(t){var n=t.domain;return t.ticks=function(e){var i=n();return vi(i[0],i[i.length-1],e??10)},t.tickFormat=function(e,i){var r=n();return Su(r[0],r[r.length-1],e??10,i)},t.nice=function(e){e==null&&(e=10);var i=n(),r=0,o=i.length-1,s=i[r],a=i[o],c,u,l=10;for(a<s&&(u=s,s=a,a=u,u=r,r=o,o=u);l-- >0;){if(u=hn(s,a,e),u===c)return i[r]=s,i[o]=a,n(i);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;c=u}return t},t}function ri(){var t=Eu();return t.copy=function(){return ni(t,ri())},ti.apply(t,arguments),ii(t)}function de(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function zu(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Tu(t){return t<0?-t*t:t*t}function Du(t){var n=t(j,j),e=1;function i(){return e===1?t(j,j):e===.5?t(zu,Tu):t(de(e),de(1/e))}return n.exponent=function(r){return arguments.length?(e=+r,i()):e},ii(n)}function oi(){var t=Du(ei());return t.copy=function(){return ni(t,oi()).exponent(t.exponent())},ti.apply(t,arguments),t}function Iu(){return oi.apply(null,arguments).exponent(.5)}const Rt=t=>()=>t;function $u(t,{sourceEvent:n,target:e,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function ot(t,n,e){this.k=t,this.x=n,this.y=e}ot.prototype={constructor:ot,scale:function(t){return t===1?this:new ot(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new ot(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var si=new ot(1,0,0);ot.prototype;function fn(t){t.stopImmediatePropagation()}function _t(t){t.preventDefault(),t.stopImmediatePropagation()}function Cu(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Lu(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function ge(){return this.__zoom||si}function Pu(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ru(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ou(t,n,e){var i=t.invertX(n[0][0])-e[0][0],r=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],s=t.invertY(n[1][1])-e[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function qu(){var t=Cu,n=Lu,e=Ou,i=Pu,r=Ru,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Fe,u=Et("start","zoom","end"),l,h,f,d=500,_=150,v=0,y=10;function g(p){p.property("__zoom",ge).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",$).filter(r).on("touchstart.zoom",k).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(p,N,x,A){var z=p.selection?p.selection():p;z.property("__zoom",ge),p!==z?b(p,N,x,A):z.interrupt().each(function(){E(this,arguments).event(A).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},g.scaleBy=function(p,N,x,A){g.scaleTo(p,function(){var z=this.__zoom.k,S=typeof N=="function"?N.apply(this,arguments):N;return z*S},x,A)},g.scaleTo=function(p,N,x,A){g.transform(p,function(){var z=n.apply(this,arguments),S=this.__zoom,I=x==null?m(z):typeof x=="function"?x.apply(this,arguments):x,P=S.invert(I),O=typeof N=="function"?N.apply(this,arguments):N;return e(M(w(S,O),I,P),z,s)},x,A)},g.translateBy=function(p,N,x,A){g.transform(p,function(){return e(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof x=="function"?x.apply(this,arguments):x),n.apply(this,arguments),s)},null,A)},g.translateTo=function(p,N,x,A,z){g.transform(p,function(){var S=n.apply(this,arguments),I=this.__zoom,P=A==null?m(S):typeof A=="function"?A.apply(this,arguments):A;return e(si.translate(P[0],P[1]).scale(I.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof x=="function"?-x.apply(this,arguments):-x),S,s)},A,z)};function w(p,N){return N=Math.max(o[0],Math.min(o[1],N)),N===p.k?p:new ot(N,p.x,p.y)}function M(p,N,x){var A=N[0]-x[0]*p.k,z=N[1]-x[1]*p.k;return A===p.x&&z===p.y?p:new ot(p.k,A,z)}function m(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function b(p,N,x,A){p.on("start.zoom",function(){E(this,arguments).event(A).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(A).end()}).tween("zoom",function(){var z=this,S=arguments,I=E(z,S).event(A),P=n.apply(z,S),O=x==null?m(P):typeof x=="function"?x.apply(z,S):x,Q=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),q=z.__zoom,K=typeof N=="function"?N.apply(z,S):N,nt=c(q.invert(O).concat(Q/q.k),K.invert(O).concat(Q/K.k));return function(U){if(U===1)U=K;else{var et=nt(U),on=Q/et[2];U=new ot(on,O[0]-et[0]*on,O[1]-et[1]*on)}I.zoom(null,U)}})}function E(p,N,x){return!x&&p.__zooming||new T(p,N)}function T(p,N){this.that=p,this.args=N,this.active=0,this.sourceEvent=null,this.extent=n.apply(p,N),this.taps=0}T.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,N){return this.mouse&&p!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&p!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&p!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var N=Y(this.that).datum();u.call(p,this.that,new $u(p,{sourceEvent:this.sourceEvent,target:g,type:p,transform:this.that.__zoom,dispatch:u}),N)}};function D(p,...N){if(!t.apply(this,arguments))return;var x=E(this,N).event(p),A=this.__zoom,z=Math.max(o[0],Math.min(o[1],A.k*Math.pow(2,i.apply(this,arguments)))),S=rt(p);if(x.wheel)(x.mouse[0][0]!==S[0]||x.mouse[0][1]!==S[1])&&(x.mouse[1]=A.invert(x.mouse[0]=S)),clearTimeout(x.wheel);else{if(A.k===z)return;x.mouse=[S,A.invert(S)],Bt(this),x.start()}_t(p),x.wheel=setTimeout(I,_),x.zoom("mouse",e(M(w(A,z),x.mouse[0],x.mouse[1]),x.extent,s));function I(){x.wheel=null,x.end()}}function C(p,...N){if(f||!t.apply(this,arguments))return;var x=p.currentTarget,A=E(this,N,!0).event(p),z=Y(p.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",Q,!0),S=rt(p,x),I=p.clientX,P=p.clientY;Ie(p.view),fn(p),A.mouse=[S,this.__zoom.invert(S)],Bt(this),A.start();function O(q){if(_t(q),!A.moved){var K=q.clientX-I,nt=q.clientY-P;A.moved=K*K+nt*nt>v}A.event(q).zoom("mouse",e(M(A.that.__zoom,A.mouse[0]=rt(q,x),A.mouse[1]),A.extent,s))}function Q(q){z.on("mousemove.zoom mouseup.zoom",null),$e(q.view,A.moved),_t(q),A.event(q).end()}}function $(p,...N){if(t.apply(this,arguments)){var x=this.__zoom,A=rt(p.changedTouches?p.changedTouches[0]:p,this),z=x.invert(A),S=x.k*(p.shiftKey?.5:2),I=e(M(w(x,S),A,z),n.apply(this,N),s);_t(p),a>0?Y(this).transition().duration(a).call(b,I,A,p):Y(this).call(g.transform,I,A,p)}}function k(p,...N){if(t.apply(this,arguments)){var x=p.touches,A=x.length,z=E(this,N,p.changedTouches.length===A).event(p),S,I,P,O;for(fn(p),I=0;I<A;++I)P=x[I],O=rt(P,this),O=[O,this.__zoom.invert(O),P.identifier],z.touch0?!z.touch1&&z.touch0[2]!==O[2]&&(z.touch1=O,z.taps=0):(z.touch0=O,S=!0,z.taps=1+!!l);l&&(l=clearTimeout(l)),S&&(z.taps<2&&(h=O[0],l=setTimeout(function(){l=null},d)),Bt(this),z.start())}}function R(p,...N){if(this.__zooming){var x=E(this,N).event(p),A=p.changedTouches,z=A.length,S,I,P,O;for(_t(p),S=0;S<z;++S)I=A[S],P=rt(I,this),x.touch0&&x.touch0[2]===I.identifier?x.touch0[0]=P:x.touch1&&x.touch1[2]===I.identifier&&(x.touch1[0]=P);if(I=x.that.__zoom,x.touch1){var Q=x.touch0[0],q=x.touch0[1],K=x.touch1[0],nt=x.touch1[1],U=(U=K[0]-Q[0])*U+(U=K[1]-Q[1])*U,et=(et=nt[0]-q[0])*et+(et=nt[1]-q[1])*et;I=w(I,Math.sqrt(U/et)),P=[(Q[0]+K[0])/2,(Q[1]+K[1])/2],O=[(q[0]+nt[0])/2,(q[1]+nt[1])/2]}else if(x.touch0)P=x.touch0[0],O=x.touch0[1];else return;x.zoom("touch",e(M(I,P,O),x.extent,s))}}function L(p,...N){if(this.__zooming){var x=E(this,N).event(p),A=p.changedTouches,z=A.length,S,I;for(fn(p),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),S=0;S<z;++S)I=A[S],x.touch0&&x.touch0[2]===I.identifier?delete x.touch0:x.touch1&&x.touch1[2]===I.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(I=rt(I,this),Math.hypot(h[0]-I[0],h[1]-I[1])<y)){var P=Y(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return g.wheelDelta=function(p){return arguments.length?(i=typeof p=="function"?p:Rt(+p),g):i},g.filter=function(p){return arguments.length?(t=typeof p=="function"?p:Rt(!!p),g):t},g.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:Rt(!!p),g):r},g.extent=function(p){return arguments.length?(n=typeof p=="function"?p:Rt([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),g):n},g.scaleExtent=function(p){return arguments.length?(o[0]=+p[0],o[1]=+p[1],g):[o[0],o[1]]},g.translateExtent=function(p){return arguments.length?(s[0][0]=+p[0][0],s[1][0]=+p[1][0],s[0][1]=+p[0][1],s[1][1]=+p[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(p){return arguments.length?(e=p,g):e},g.duration=function(p){return arguments.length?(a=+p,g):a},g.interpolate=function(p){return arguments.length?(c=p,g):c},g.on=function(){var p=u.on.apply(u,arguments);return p===u?g:p},g.clickDistance=function(p){return arguments.length?(v=(p=+p)*p,g):Math.sqrt(v)},g.tapDistance=function(p){return arguments.length?(y=+p,g):y},g}const Fu="data/circle_packing_data.json",pe="circle-packing-plot",Xu="circle-packing-title",Hu="circle-packing-text",me="#f4efda",Bu="#9e2846",Yu="#000000",Vu=3,Ku=5,Uu=100,Wu="",Gu={"1-2":"Division 1-2",3:"Division 3",4:"Division 4",5:"Division 5",6:"Division 6",7:"Division 7","7-8":"Division 7-8",9:"Division 9",10:"Division 10",11:"Division 11",12:"Division 12",13:"Division 13",14:"Division 14",15:"Division 15",16:"Division 16",17:"Division 17",18:"Division 18",19:"Division 19",20:"Division 20"},Zu="Cliquez sur les diffrentes sections du diagramme pour explorer ces relations en dtail. Vous dcouvrirez comment la diversit des origines et des professions a contribu  la richesse et  la complexit de Lausanne au XIX<sup>me</sup> sicle, et comment ces facteurs ont jou un rle dterminant dans la formation des communauts urbaines.",Qu={"1-2":"Division 1-2",3:"Division 3",4:"Division 4",5:"Division 5",6:"Division 6",7:"Division 7","7-8":"Division 7-8",9:"Division 9",10:"Division 10",11:"Division 11",12:"Division 12",13:"Division 13",14:"Division 14",15:"Division 15",16:"Division 16",17:"Division 17",18:"Division 18",19:"Division 19",20:"Division 20"};class ju{constructor(){B(this,"data");B(this,"width");B(this,"height");this.loadData().then(()=>{this.initDimensions(),this.initPacking()})}async loadData(){return new Promise(n=>{Ue(Fu).then(e=>{this.data=e,n()})})}initDimensions(){const n=document.getElementById(pe);if(n){const e=Math.min(n.clientWidth,n.clientHeight);this.width=e,this.height=e}}initPacking(){const e=(f=>wu().size([this.width,this.height]).padding(Vu)(Cn(f).sum(d=>d.value).sort((d,_)=>_.value-d.value)))(this.data);let i=e;const r=ri().domain([0,1]).range([me,Bu]),o=Iu().domain([wi(e.descendants(),f=>f.r),xi(e.descendants(),f=>f.r)]).range([Ku,Uu]),s=Y(`#${pe}`).append("svg").attr("width",this.width).attr("height",this.height).attr("viewBox",`-${this.width/2} -${this.height/2} ${this.width} ${this.height}`).style("display","block").style("background",r(0)).style("cursor","pointer").on("click",f=>h(f,e)),a=s.append("g").selectAll("circle").data(e.descendants().slice(1)).join("circle").attr("fill",f=>f.children?r(f.depth):me).attr("pointer-events",f=>f.children?null:"none").on("mouseover",function(){Y(this).attr("stroke",Yu)}).on("mouseout",function(){Y(this).attr("stroke",null)}).on("click",(f,d)=>i!==d&&(h(f,d),f.stopPropagation())),c=s.append("g").style("font-family","var(--default-font-family)").attr("pointer-events","none").attr("text-anchor","middle").selectAll("text").data(e.descendants()).join("text").attr("dy","0.3em").style("font-size",f=>`${o(f.r)}px`).style("fill-opacity",f=>f.parent===e?1:0).style("display",f=>f.parent===e?"inline":"none").text(f=>f.data.name);let u;const l=f=>{const d=this.width/f[2];u=f,c.attr("transform",_=>`translate(${(_.x-f[0])*d},${(_.y-f[1])*d})`),a.attr("transform",_=>`translate(${(_.x-f[0])*d},${(_.y-f[1])*d})`),a.attr("r",_=>_.r*d)};l([e.x,e.y,e.r*2]);function h(f,d){const _=document.getElementById(Xu);if(_){const g=Gu[d.data.name]||Wu;_.innerHTML=g}const v=document.getElementById(Hu);if(v){const g=Qu[d.data.name]||Zu;v.innerHTML=g}i=d;const y=s.transition().duration(f.altKey?7500:750).tween("zoom",()=>{const g=Fe(u,[i.x,i.y,i.r*2]);return w=>l(g(w))});c.filter(function(g){return g.parent===i||this.style.display==="inline"}).transition(y).style("fill-opacity",g=>g.parent===i?1:0).on("start",function(g){g.parent===i&&(this.style.display="inline")}).on("end",function(g){g.parent!==i&&(this.style.display="none")})}}}document.addEventListener("DOMContentLoaded",()=>{new ju});const ye=2e3;document.addEventListener("DOMContentLoaded",()=>{function t(s){const a=s.getBoundingClientRect(),c=window.innerHeight||document.documentElement.clientHeight,u=window.innerWidth||document.documentElement.clientWidth;return a.top>=0&&a.left>=0&&a.bottom<=c+1&&a.right<=u+1}function n(s,a){const c=window.pageYOffset,u=s.getBoundingClientRect().top,l=performance.now();function h(f){const d=f-l,_=Math.min(d/a,1);window.scrollTo({top:c+u*e(_)}),d<a&&window.requestAnimationFrame(h)}window.requestAnimationFrame(h)}function e(s){return s<.5?2*s*s:-1+(4-2*s)*s}function i(s){return s.deltaY>0?"down":"up"}function r(s){s.preventDefault();const a=["title-container","p1-container","p2-container","p3-container","p4-container","p5-container","p6-container","p7-container","final-container"];for(let c=0;c<a.length;c++){const u=c>=1?document.getElementById(a[c-1]):null,l=document.getElementById(a[c]),h=c<a.length-1?document.getElementById(a[c+1]):null;u&&t(l)&&i(s)==="up"&&n(u,ye),h&&t(l)&&i(s)==="down"&&n(h,ye)}}document.addEventListener("wheel",r,{passive:!1}),document.addEventListener("touchmove",r,{passive:!1});const o=document.getElementById("title-container");n(o,0)});const Ju="data/networks",tc="road_vocation_data",nc="vocation",ec="#network-graph",ic="network-chart",rc="#network-title",oc="#network-text",sc="#5c5c5c",ve="#aaaaaa",ac={road_vocation_data:{road:"#289e61",vocation:"#9e2846"},bipartite_division_type_metiers:{division:"#289e61",job_category:"#9e2846"},bipartite_origine_category_type_metiers:{origine_category:"#289e61",job_category:"#9e2846"},bipartite_street_type_metiers:{street:"#289e61",job_category:"#9e2846"}},Ot=`Lorem ipsum dolor sit amet. Et dolores quia et iste cupiditate sit nisi eligendi ab veritatis voluptatem ea omnis autem. Eos dolor modi eum adipisci facere ex dolores fugiat et laboriosam rerum rem nihil dolor. Et dolores iure ut odio voluptas ut nobis nemo.

Est quisquam totam sit illum rerum aut quia labore. Non voluptas libero sed adipisci quia aut voluptatem sint et nihil nihil ut ipsum voluptatem sit galisum reprehenderit.

Qui vero dolore et doloremque omnis ea error labore rem numquam cumque? Et totam alias et adipisci soluta ut excepturi error id quisquam quia sit voluptates voluptatum ut unde recusandae quo explicabo dolor. Qui temporibus consequuntur est alias quaerat vel culpa quia ut maxime ducimus sed esse assumenda a tempora culpa.`,uc={road_vocation_data:{title:"Rseau des rues et vocations",text:Ot},bipartite_division_type_metiers:{title:"Rseau de divisions et de catgories de mtiers",text:Ot},bipartite_origine_category_type_metiers:{title:"Rseau des classes d'origines et de catgories de mtiers",text:Ot},bipartite_street_type_metiers:{title:"Rseau de rues et de catgories de mtiers",text:Ot}},cc=.1,lc=10;class fc{constructor(n=.7,e=.7,i=.1,r=7,o=40,s=1,a=8,c=5,u=5,l=5,h=-700,f=2,d=200){B(this,"svg");B(this,"gnodes");B(this,"glinks");B(this,"simulation");B(this,"data");B(this,"container");B(this,"dragActive",!1);B(this,"networkName",nc);B(this,"linkedById");this.expNodeSizeScale=n,this.expLinkWeightScale=e,this.transparency=i,this.minNodeSize=r,this.maxNodeSize=o,this.minLinkWeight=s,this.maxLinkWeight=a,this.labelSizeAdd=c,this.nodeSizeInc=u,this.labelSizeInc=l,this.chargeStrength=h,this.collideSizeAdd=f,this.transitionDuration=d,this.initDimensions(),this.initStaticElements(),this.initEvents(),this.updatePlot(tc)}async loadData(n){const e=`${Ju}/${n}.json`;return new Promise(i=>{Ue(e).then(r=>{i(r)})})}initDimensions(){this.container=Y(ec);const n=document.getElementById(ic);n&&(this.width=n.clientWidth,this.height=n.clientHeight)}initStaticElements(){this.svg=this.container.append("svg").attr("width",this.width).attr("height",this.height),this.glinks=this.svg.append("g").attr("class","links"),this.gnodes=this.svg.append("g").attr("class","nodes")}initEvents(){const n=document.getElementById("graph-selector");n&&n.addEventListener("change",e=>{const i=e.target.value;this.updatePlot(i)})}get_scaled_size(n,e,i,r,o){return i-e==0?(r+o)/2:r+(n-e)*(o-r)/(i-e)}isConnected(n,e){return this.linkedById[n].indexOf(e)>-1||this.linkedById[e].indexOf(n)>-1||n==e}drag(n){const e=o=>{this.dragActive=!0,o.active||n.alphaTarget(.3).restart(),o.subject.fx=o.subject.x,o.subject.fy=o.subject.y},i=o=>{o.subject.fx=o.x,o.subject.fy=o.y},r=o=>{this.dragActive=!1,o.active||n.alphaTarget(0),o.subject.fx=null,o.subject.fy=null};return co().on("start",e).on("drag",i).on("end",r)}initData(){let n=this.data.nodes.reduce((o,s)=>Math.max(o,s.size),0),e=this.data.nodes.reduce((o,s)=>Math.min(o,s.size),1/0);n=Math.pow(n,this.expNodeSizeScale),e=Math.pow(e,this.expNodeSizeScale),this.data.nodes.forEach(o=>o.size=this.get_scaled_size(Math.pow(o.size,this.expNodeSizeScale),e,n,this.minNodeSize,this.maxNodeSize));let i=this.data.links.reduce((o,s)=>Math.max(o,s.weight),0),r=this.data.links.reduce((o,s)=>Math.min(o,s.weight),1/0);i=Math.pow(i,this.expLinkWeightScale),r=Math.pow(r,this.expLinkWeightScale),this.data.links.forEach(o=>o.weight=this.get_scaled_size(Math.pow(o.weight,this.expLinkWeightScale),r,i,this.minLinkWeight,this.maxLinkWeight)),this.linkedById={},this.data.links.forEach(o=>{this.linkedById[o.source]=[],this.linkedById[o.target]=[]}),this.data.links.forEach(o=>{this.linkedById[o.source].push(o.target),this.linkedById[o.target].push(o.source)})}createLinks(){this.glinks.attr("stroke",sc).attr("stroke-opacity",1).selectAll("line").data(this.data.links).enter().append("line").attr("stroke-width",function(n){return n.weight})}createNodes(){const n=this.gnodes.selectAll(".node").data(this.data.nodes).enter().append("g").attr("class","node");n.append("circle").attr("class","node-circle").attr("r",function(e){return e.size}).attr("fill",e=>{const i=ac[this.networkName],r=i?i[e.type]:ve;return r||ve}).call(this.drag(this.simulation)).on("mouseover",(e,i)=>{if(this.dragActive)return;const r=i.id;this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("r",o=>{if(o.id==r)return o.size+this.nodeSizeInc;if(this.isConnected(r,o.id)){let s=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const a=this.data.links.filter(h=>h.source.id==r||h.target.id==r),c=a.reduce((h,f)=>Math.min(h,f.weight),1/0),u=a.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(s,c,u,this.minNodeSize,this.maxNodeSize)}return o.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",o=>o.source.id==r||o.target.id==r?1:this.transparency),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",o=>this.isConnected(r,o.id)||o.id==r?1:this.transparency).attr("font-size",o=>{if(o.id==r)return o.size+this.labelSizeInc+this.labelSizeAdd;if(this.isConnected(r,o.id)){let s=this.data.links.find(h=>h.source.id==o.id&&h.target.id==r||h.source.id==r&&h.target.id==o.id).weight;this.linkedById[r];const a=this.data.links.filter(h=>h.source.id==r||h.target.id==r),c=a.reduce((h,f)=>Math.min(h,f.weight),1/0),u=a.reduce((h,f)=>Math.max(h,f.weight),-1/0);return this.get_scaled_size(s,c,u,this.minNodeSize,this.maxNodeSize)+this.labelSizeAdd}return o.size+this.labelSizeAdd})}).on("mouseout",e=>{this.dragActive||(this.gnodes.selectAll(".node-circle").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("r",function(i){return i.size}),this.glinks.selectAll("line").transition().duration(this.transitionDuration).attr("stroke-opacity",1),this.gnodes.selectAll(".node-text").transition().duration(this.transitionDuration).attr("fill-opacity",1).attr("font-size",i=>i.size+this.labelSizeAdd))}),n.append("text").attr("class","node-text").text(function(e){return e.label}).attr("font-size",e=>e.size+this.labelSizeAdd).attr("font-family","sans-serif").attr("font-weight","bold").attr("text-anchor","middle").attr("alignment-baseline","middle").style("pointer-events","none")}initZoom(){const n=qu().scaleExtent([cc,lc]).on("zoom",({transform:e})=>{this.gnodes.attr("transform",e),this.glinks.attr("transform",e)});this.svg.call(n)}initSimulation(){this.simulation=Sa().force("link",xa().id(function(e){return e.id})).force("charge",za().strength(this.chargeStrength)).force("center",Js(this.width/2,this.height/2)).force("collide",va().radius(e=>e.size+this.collideSizeAdd));const n=()=>{this.glinks.selectAll("line").attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),this.gnodes.selectAll(".node-circle").attr("cx",e=>e.x).attr("cy",e=>e.y),this.gnodes.selectAll(".node-text").attr("x",e=>e.x+10).attr("y",e=>e.y+4).attr("dx",-9)};this.simulation.nodes(this.data.nodes).on("tick",n),this.simulation.force("link").links(this.data.links)}async updatePlot(n){return new Promise(e=>{this.loadData(n).then(i=>{this.networkName=n,this.deletePlot(),this.data=i,this.initData(),this.initSimulation(),this.createLinks(),this.createNodes(),this.initZoom();const r=document.querySelector(rc),o=document.querySelector(oc),s=uc[n];r&&o&&(r.innerHTML=s.title,o.innerHTML=s.text)}),e()})}deletePlot(){this.gnodes.selectAll("*").remove(),this.glinks.selectAll("*").remove()}}document.addEventListener("DOMContentLoaded",()=>{console.log("Loading networks..."),new fc,console.log("Networks loaded.")});
